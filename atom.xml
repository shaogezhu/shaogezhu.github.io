<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://shaogezhu.cn</id>
    <title>ç”°åŸ‚ã®æŠ€æœ¯åˆ†äº«</title>
    <subtitle>å’Œä½ ä¸€èµ·é‡è§æ›´å¥½çš„è‡ªå·±</subtitle>
    <icon>https://shaogezhu.cn/images/favicon.ico</icon>
    <link href="https://shaogezhu.cn" />
    <author>
      <name>ç”°åŸ‚ã€</name>
    </author>
    <updated>2022-03-19T17:25:23.000Z</updated>
    <category term="Java" />
    <category term="Spring" />
    <category term="Linux" />
    <category term="åç«¯" />
    <category term="é¢è¯•" />
    <category term="é«˜å¹¶å‘" />
    <entry>
        <id>https://shaogezhu.cn/2022/3/ead1dab4ce75/</id>
        <title>JVMåƒåœ¾æ”¶é›†-ZGCçš„æŸ“è‰²æŒ‡é’ˆ</title>
        <link rel="alternate" href="https://shaogezhu.cn/2022/3/ead1dab4ce75/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šæŸ“è‰²æŒ‡é’ˆ&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å‰è¨€&#34;&gt;#&lt;/a&gt; å‰è¨€ï¼š&lt;/h2&gt;
&lt;p&gt;ğŸ¥‚ä»‹ç»æŸ“è‰²æŒ‡é’ˆä¹‹å‰ï¼Œå¤§å®¶å…ˆå›é¡¾ä»¥ä¸‹ä¸Šä¸€ç¯‡æ–‡ç«  &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuc2hhb2dlemh1LmNuLzIwMjIvMy8zYTY4MTg5MmY5MGMv&#34;&gt;ã€ŠJVM åƒåœ¾æ”¶é›† - ä¸‰è‰²æ ‡è®°ã€‹&lt;/span&gt; ï¼Œå¤§éƒ¨åˆ†è¿½è¸ªå¼åƒåœ¾æ”¶é›†å™¨åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µéƒ½é‡‡ç”¨äº†ä¸‰è‰²æ ‡è®°æŠ€æœ¯ã€‚ä½†ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚ï¼šZGC æ”¶é›†å™¨æœ‰ä¸€ä¸ªæ ‡å¿—æ€§çš„è®¾è®¡ï¼Œå°±æ˜¯é‡‡ç”¨äº†&lt;font color=&#34;blue&#34;&gt;&lt;strong&gt;æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯&lt;/strong&gt;&lt;/font&gt;(Colored Pointerï¼Œå…¶ä»–ç±»ä¼¼çš„æŠ€æœ¯ä¸­å¯èƒ½å°†å®ƒç§°ä¸º Tag Pointer æˆ–è€… Version Pointer)ã€‚ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹æŸ“è‰²æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;åº”ç”¨åœºæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åº”ç”¨åœºæ™¯&#34;&gt;#&lt;/a&gt; åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;p&gt;ğŸŒ´ğŸŒ´ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬è¦&lt;strong&gt;åœ¨å¯¹è±¡ä¸Šå­˜å‚¨ä¸€äº›é¢å¤–çš„ã€åªä¾›æ”¶é›†å™¨æˆ–è€…è™šæ‹Ÿæœºæœ¬èº«ä½¿ç”¨çš„æ•°æ®&lt;/strong&gt;ï¼Œé€šå¸¸ä¼šåœ¨å¯¹è±¡å¤´ä¸­å¢åŠ é¢å¤–çš„å­˜å‚¨å­—æ®µï¼Œå¦‚å¯¹è±¡çš„å“ˆå¸Œç ã€åˆ†ä»£å¹´é¾„ã€é”è®°å½•ç­‰å°±æ˜¯è¿™æ ·å­˜å‚¨çš„ã€‚æ¯”å¦‚ 64 ä½çš„ JVMï¼Œå¯¹è±¡å¤´çš„ Mark Word ä¸­ä¿å­˜çš„ä¿¡æ¯å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jm1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸˆè¿™ç§è®°å½•æ–¹å¼åœ¨&lt;font color=&#34;purple&#34;&gt;&lt;strong&gt;æœ‰å¯¹è±¡è®¿é—®çš„åœºæ™¯ä¸‹&lt;/strong&gt;&lt;/font&gt;æ˜¯å¾ˆè‡ªç„¶æµç•…çš„ï¼Œä¸ä¼šæœ‰ä»€ä¹ˆé¢å¤–è´Ÿæ‹…ã€‚ä½†å¦‚æœæœ‰ä¸€äº›å¯¹è±¡æ ¹æœ¬å°±ä¸ä¼šå»è®¿é—®å®ƒï¼Œä½†åˆå¸Œæœ›å¾—çŸ¥è¯¥å¯¹è±¡çš„æŸäº›ä¿¡æ¯çš„åœºæ™¯å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°±æœ‰è¿™æ ·çš„åœºæ™¯ â€”â€” è¿½è¸ªå¼æ”¶é›†ç®—æ³•çš„æ ‡è®°é˜¶æ®µå°±å¯èƒ½å­˜åœ¨&lt;font color=&#34;green&#34;&gt;&lt;strong&gt;åªè·ŸæŒ‡é’ˆæ‰“äº¤é“è€Œä¸å¿…æ¶‰åŠæŒ‡é’ˆæ‰€å¼•ç”¨çš„å¯¹è±¡æœ¬èº«&lt;/strong&gt;&lt;/font&gt;çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ğŸŒ°ä¾‹å¦‚ å¯¹è±¡æ ‡è®°çš„è¿‡ç¨‹ä¸­éœ€è¦ç»™å¯¹è±¡æ‰“ä¸Šä¸‰è‰²æ ‡è®°ï¼Œè¿™äº›æ ‡è®°æœ¬è´¨ä¸Šå°±&lt;strong&gt;åªå’Œå¯¹è±¡çš„å¼•ç”¨æœ‰å…³ï¼Œè€Œä¸å¯¹è±¡æœ¬èº«æ— å…³&lt;/strong&gt; â€”â€” æŸä¸ªå¯¹è±¡åªæœ‰å®ƒçš„å¼•ç”¨å…³ç³»èƒ½å†³å®šå®ƒå­˜æ´»ä¸å¦ï¼Œå¯¹è±¡ä¸Šå…¶ä»–æ‰€æœ‰çš„å±æ€§éƒ½ä¸èƒ½å¤Ÿå½±å“å®ƒçš„å­˜æ´»åˆ¤å®šç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‘©HotSpot è™šæ‹Ÿæœºçš„å‡ ç§æ”¶é›†å™¨æœ‰ä¸åŒçš„æ ‡è®°å®ç°æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ“ æŠŠæ ‡è®°ç›´æ¥è®°å½•åœ¨å¯¹è±¡å¤´ä¸Š (Serial æ”¶é›†å™¨ï¼‰&lt;/li&gt;
&lt;li&gt;ğŸ“ æŠŠæ ‡è®°è®°å½•åœ¨ä¸å¯¹è±¡ç›¸äº’ç‹¬ç«‹çš„æ•°æ®ç»“æ„ä¸Š (G1ã€Shenandoah ä½¿ç”¨äº†ä¸€ç§ç›¸å½“äºå †å†…å­˜çš„ 1/64 å¤§å°çš„ï¼Œç§°ä¸º BitMap çš„ç»“æ„æ¥è®°å½•æ ‡è®°ä¿¡æ¯ï¼‰&lt;/li&gt;
&lt;li&gt;ğŸ“ ZGC çš„æŸ“è‰²æŒ‡é’ˆ&lt;strong&gt;ç›´æ¥æŠŠæ ‡è®°ä¿¡æ¯è®°åœ¨å¼•ç”¨å¯¹è±¡çš„æŒ‡é’ˆä¸Š&lt;/strong&gt;ï¼ˆè¿™ä¸ªæ—¶å€™ï¼Œä¸å…¶è¯´å¯è¾¾æ€§åˆ†ææ˜¯éå†å¯¹è±¡å›¾æ¥æ ‡è®°å¯¹è±¡ï¼Œè¿˜ä¸å¦‚è¯´æ˜¯éå† â€œå¼•ç”¨å›¾â€ æ¥æ ‡è®° â€œå¼•ç”¨â€ äº†ã€‚ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h2 id=&#34;æŸ“è‰²æŒ‡é’ˆ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æŸ“è‰²æŒ‡é’ˆ&#34;&gt;#&lt;/a&gt; æŸ“è‰²æŒ‡é’ˆ&lt;/h2&gt;
&lt;p&gt;âœ¨&lt;font color=&#34;purple&#34;&gt;&lt;strong&gt;æŸ“è‰²æŒ‡é’ˆæ˜¯ä¸€ç§ç›´æ¥å°†å°‘é‡é¢å¤–çš„ä¿¡æ¯å­˜å‚¨åœ¨æŒ‡é’ˆä¸Šçš„æŠ€æœ¯&lt;/strong&gt;&lt;/font&gt;ã€‚åœ¨ 64 ä½ Linux ä¸­ï¼Œå¯¹è±¡æŒ‡é’ˆæ˜¯ 64 ä½ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jm2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ğŸ»åœ¨è¿™ä¸ª 64 ä½çš„æŒ‡é’ˆä¸Šï¼Œé«˜ 18 ä½éƒ½æ˜¯ 0ï¼Œæš‚æ—¶ä¸ç”¨æ¥å¯»å€ã€‚å‰©ä½™çš„ 46 ä½æŒ‡é’ˆæ‰€èƒ½æ”¯æŒå†…å­˜å¯ä»¥è¾¾åˆ° 64TBÂ , è¿™å¯ä»¥æ»¡è¶³å¤šæ•°å¤§å‹æœåŠ¡å™¨çš„éœ€è¦äº†ã€‚ä¸è¿‡ ZGC å¹¶æ²¡æœ‰æŠŠ 46Â ä½éƒ½ç”¨æ¥ä¿å­˜å¯¹è±¡ä¿¡æ¯ï¼Œè€Œæ˜¯ç”¨é«˜ 4 ä½ä¿å­˜äº†å››ä¸ªæ ‡å¿—ä½ï¼Œå¯¼è‡´ ZGC å¯ä»¥ç®¡ç†çš„æœ€å¤§å†…å­˜ä¸è¶…è¿‡ 4Â TB ã€‚&lt;/p&gt;
&lt;p&gt;â­â­é€šè¿‡è¿™å››ä¸ªæ ‡å¿—ä½ï¼ŒJVM å¯ä»¥&lt;strong&gt;ä»æŒ‡é’ˆä¸Šç›´æ¥çœ‹åˆ°&lt;/strong&gt;å¯¹è±¡çš„ä¸‰è‰²æ ‡è®°çŠ¶æ€ï¼ˆMarked0ã€Marked1ï¼‰ã€æ˜¯å¦è¿›å…¥äº†é‡åˆ†é…é›†ï¼ˆRemappedï¼‰ã€æ˜¯å¦éœ€è¦é€šè¿‡ finalize æ–¹æ³•æ¥è®¿é—®åˆ°ï¼ˆFinalizableï¼‰ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ— éœ€è¿›è¡Œå¯¹è±¡è®¿é—®å°±å¯ä»¥è·å¾— GC ä¿¡æ¯ï¼Œè¿™å¤§å¤§æé«˜äº† GC æ•ˆç‡ã€‚&lt;/strong&gt; ğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;p&gt;ğŸºå¯ä»¥çœ‹åˆ°æŸ“è‰²æŒ‡é’ˆçš„ä¼˜ç‚¹å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚ä¸è¿‡ï¼Œè¦ä½¿ç”¨æŸ“è‰²æŒ‡é’ˆæœ‰ä¸€ä¸ªå¿…é¡»è§£å†³çš„&lt;font color=&#34;orange&#34;&gt;&lt;strong&gt;å‰ç½®é—®é¢˜&lt;/strong&gt;&lt;/font&gt;ï¼šJava è™šæ‹Ÿæœºä½œä¸ºä¸€ä¸ªæ™®æ™®é€šé€šçš„è¿›ç¨‹ï¼Œè¿™æ ·éšæ„é‡æ–°å®šä¹‰å†…å­˜ä¸­æŸäº›æŒ‡é’ˆçš„å…¶ä¸­å‡ ä½ï¼Œæ“ä½œç³»ç»Ÿæ˜¯å¦æ”¯æŒï¼Ÿå¤„ç†å™¨æ˜¯å¦æ”¯æŒï¼ŸğŸ¤·â€&lt;/p&gt;
&lt;p&gt;ğŸ‘©ğŸ»â€ç¨‹åºä»£ç æœ€ç»ˆéƒ½è¦è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤æµäº¤ä»˜ç»™å¤„ç†å™¨å»æ‰§è¡Œï¼Œå¤„ç†å™¨å¯ä¸ä¼šç®¡æŒ‡ä»¤æµä¸­çš„æŒ‡é’ˆå“ªéƒ¨åˆ†å­˜çš„æ˜¯æ ‡å¿—ä½ï¼Œå“ªéƒ¨åˆ†æ‰æ˜¯çœŸæ­£çš„å¯»å€åœ°å€ï¼Œåªä¼šæŠŠæ•´ä¸ªæŒ‡é’ˆéƒ½è§†ä½œä¸€ä¸ªå†…å­˜åœ°å€æ¥å¯¹å¾…ã€‚&lt;/p&gt;
&lt;p&gt;ğŸˆåœ¨æˆ‘ä»¬å¸¸ç”¨çš„ x86-64 å¹³å°ä¸Šæ˜¯ä¸æ”¯æŒé‡æ–°å®šä¹‰æœºå™¨æŒ‡ä»¤çš„ï¼ŒZGC è®¾è®¡è€…ä»¬å°±é‡‡ç”¨äº†&lt;strong&gt;è™šæ‹Ÿå†…å­˜æ˜ å°„æŠ€æœ¯&lt;/strong&gt;æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;h2 id=&#34;è™šæ‹Ÿå†…å­˜æ˜ å°„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è™šæ‹Ÿå†…å­˜æ˜ å°„&#34;&gt;#&lt;/a&gt; è™šæ‹Ÿå†…å­˜æ˜ å°„&lt;/h2&gt;
&lt;p&gt;ğŸ¬åœ¨ x86 å¹³å°ä¸Šï¼Œå¤„ç†å™¨ä¼šä½¿ç”¨åˆ†é¡µç®¡ç†æœºåˆ¶æŠŠ&lt;font color=&#34;blue&#34;&gt;&lt;strong&gt;çº¿æ€§åœ°å€ç©ºé—´&lt;/strong&gt;&lt;/font&gt;å’Œ&lt;font color=&#34;orange&#34;&gt;&lt;strong&gt;ç‰©ç†åœ°å€ç©ºé—´&lt;/strong&gt;&lt;/font&gt;åˆ†åˆ«åˆ’åˆ†ä¸ºå¤§å°ç›¸åŒçš„å—ï¼Œè¿™æ ·çš„å†…å­˜å—è¢«ç§°ä¸º **â€œé¡µâ€(Page)**ã€‚é€šè¿‡åœ¨çº¿æ€§è™šæ‹Ÿç©ºé—´çš„é¡µä¸ç‰©ç†åœ°å€ç©ºé—´çš„é¡µä¹‹é—´å»ºç«‹çš„æ˜ å°„è¡¨ï¼Œåˆ†é¡µç®¡ç†æœºåˆ¶ä¼šè¿›è¡Œçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€ç©ºé—´çš„æ˜ å°„ï¼Œå®Œæˆçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ã€‚&lt;br /&gt;
&lt;br&gt;&lt;br /&gt;
âœ¨ç®€å•çš„ç†è§£ä¸ºï¼š&lt;strong&gt;ç”¨ mmap æŠŠä¸åŒçš„è™šæ‹Ÿå†…å­˜åœ°å€æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†å†…å­˜åœ°å€ä¸Šã€‚&lt;/strong&gt; å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jm3.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‹ZGC ä¸ºäº†è§£å†³ä¸Šé¢çš„å¯»å€åœ°å€é—®é¢˜ï¼Œä½¿ç”¨äº†è™šæ‹Ÿå†…å­˜æ˜ å°„æŠ€æœ¯ï¼Œ&lt;strong&gt;æŠŠåŒä¸€å—å„¿ç‰©ç†å†…å­˜æ˜ å°„ä¸º Marked0ã€Marked1 å’Œ Remapped ä¸‰ä¸ªè™šæ‹Ÿå†…å­˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ¹å½“åº”ç”¨ç¨‹åºåˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šåœ¨å †ä¸Šç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œè¿™æ—¶Â ZGCÂ ä¼šä¸ºè¿™ä¸ªå¯¹è±¡åœ¨ Marked0ã€Marked1 å’Œ Remapped è¿™ä¸‰ä¸ªè§†å›¾ç©ºé—´åˆ†åˆ«ç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œè¿™ä¸‰ä¸ªè™šæ‹Ÿåœ°å€æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ¦&lt;font color=&#34;green&#34;&gt;&lt;strong&gt;Marked0ã€Marked1 å’Œ Remapped è¿™ä¸‰ä¸ªè™šæ‹Ÿå†…å­˜ä½œä¸º ZGC çš„ä¸‰ä¸ªè§†å›¾ç©ºé—´&lt;/strong&gt;&lt;/font&gt;ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹å†…åªèƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆã€‚ZGC å°±æ˜¯é€šè¿‡è¿™ä¸‰ä¸ªè§†å›¾ç©ºé—´çš„åˆ‡æ¢ï¼Œæ¥å®Œæˆå¹¶å‘çš„åƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ™‡å¥½äº†å…³äºæŸ“è‰²æŒ‡é’ˆçš„å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰ä»€ä¹ˆç–‘é—®æ¬¢è¿è¯„è®ºåŒºè®¨è®ºã€‚&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PSï¼š&lt;/strong&gt; åœ¨ JDK 15 ä¸­ ï¼Œå·²ç»å¯ä»¥é€šè¿‡æŒ‡ä»¤Â â€“XX:+UseZGC æ¥å¯ç”¨é‡‡ç”¨æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯çš„ ZGC æ”¶é›†å™¨äº†ã€‚&lt;br /&gt;
ğŸš€ğŸš€ğŸš€&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <category term="JVM" scheme="https://shaogezhu.cn/tags/JVM/" />
        <category term="åƒåœ¾å›æ”¶" scheme="https://shaogezhu.cn/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" />
        <updated>2022-03-19T17:25:23.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2022/3/24dc16aab990/</id>
        <title>JVMåƒåœ¾å›æ”¶-ä¸‰è‰²æ ‡è®°</title>
        <link rel="alternate" href="https://shaogezhu.cn/2022/3/24dc16aab990/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šä¸‰è‰²æ ‡è®°&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;ğŸ‹Â è¿™æ¬¡ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ JVM åƒåœ¾å›æ”¶&lt;strong&gt;å¯è¾¾æ€§åˆ†æç®—æ³•&lt;/strong&gt;çš„å®ç°åŸç†ã€‚&lt;/p&gt;
&lt;p&gt;ğŸˆğŸˆğŸˆä¸Šç¯‡æ–‡ç« &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuc2hhb2dlemh1LmNuLzIwMjIvMy9jOGQ2ZmNkYjZmMDcv&#34;&gt;ã€ŠJVM åƒåœ¾å›æ”¶ - è®°å¿†é›†å’Œå¡è¡¨ã€‹&lt;/span&gt; å·²ç»å’Œå¤§å®¶ä»‹ç»äº† JVM æ˜¯å¦‚ä½•å¿«é€Ÿçš„æ‰«æå’Œæ ‡è®° GC Roots çš„ã€‚æ ‡è®°	å®Œ GC Roots ä¹‹åï¼ŒJVM å°±éœ€è¦ä» GC Roots å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾äº†ï¼ˆå³å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ï¼‰ã€‚&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆ JVM åˆæ˜¯å¦‚ä½•éå†å¯¹è±¡å›¾çš„å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;â˜•ç°ä»£å¤§å¤šæ•°è·Ÿè¸ªåƒåœ¾æ”¶é›†å™¨ (å¦‚ CMSã€G1ã€Shenandoah) éƒ½å®ç°&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt;ä¸‰è‰²æ ‡è®°&lt;/strong&gt;&lt;/span&gt;æŠ½è±¡çš„ä¸€äº›å˜ä½“æ¥å¯¹ â€œåƒåœ¾â€ è¿›è¡Œæ ‡è®°çš„ã€‚ä¹‹æ‰€ä»¥éƒ½é€‰æ‹©ä¸‰è‰²æ ‡è®°æ˜¯å› ä¸ºå®ƒèƒ½å¤Ÿ&lt;strong&gt;è§£å†³æˆ–è€…é™ä½ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ã€‚&lt;/strong&gt; ğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±è¿›å…¥æœ¬æ–‡æ­£é¢˜ï¼š&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰è‰²æ ‡è®°&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸‰è‰²æ ‡è®°&#34;&gt;#&lt;/a&gt; ä¸‰è‰²æ ‡è®°&lt;/h2&gt;
&lt;p&gt;â˜˜ä¸‰è‰²æ ‡è®°ç®—æ³•æŠŠéå†å¯¹è±¡å›¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¯¹è±¡ï¼ŒæŒ‰ç…§ â€œæ˜¯å¦è¢«è®¿é—®è¿‡â€ åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§é¢œè‰²ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç™½è‰²âœ¨ï¼š&lt;/strong&gt; è¡¨ç¤ºå¯¹è±¡å°šæœªè¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ã€‚ &lt;span class=&#34;grey&#34;&gt;ï¼ˆæ˜¾ç„¶åœ¨å¯è¾¾æ€§åˆ†æåˆšåˆšå¼€å§‹çš„é˜¶æ®µï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ï¼Œè‹¥åœ¨åˆ†æç»“æŸçš„é˜¶æ®µï¼Œä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡ï¼Œå³ä»£è¡¨ä¸å¯è¾¾ï¼‰&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç°è‰²âœ¨ï¼š&lt;/strong&gt; è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä½†è¿™ä¸ªå¯¹è±¡ä¸Šè‡³å°‘å­˜åœ¨ä¸€ä¸ªå¼•ç”¨è¿˜æ²¡æœ‰è¢«æ‰«æè¿‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»‘è‰²âœ¨ï¼š&lt;/strong&gt; è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä¸”è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½å·²ç»æ‰«æè¿‡ã€‚ &lt;span class=&#34;grey&#34;&gt;ï¼ˆé»‘è‰²çš„å¯¹è±¡ä»£è¡¨å·²ç»æ‰«æè¿‡ï¼Œå®ƒæ˜¯å®‰å…¨å­˜æ´»çš„ï¼Œå¦‚æœæœ‰å…¶ä»–å¯¹è±¡å¼•ç”¨æŒ‡å‘äº†é»‘è‰²å¯¹è±¡ï¼Œæ— é¡»é‡æ–°æ‰«æä¸€éã€‚é»‘è‰²å¯¹è±¡ä¸å¯èƒ½ç›´æ¥ (ä¸ç»è¿‡ç°è‰²å¯¹è±¡) æŒ‡å‘æŸä¸ªç™½è‰²å¯¹è±¡ï¼‰&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸŒ´ğŸŒ´ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä¸‰è‰²æ ‡è®°éå†å¯¹è±¡å›¾çš„å¤§è‡´è¿‡ç¨‹ï¼š&lt;br /&gt;
&lt;img data-src=&#34;/assets/2022-3/jjm.gif&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;â­åˆå§‹çŠ¶æ€&lt;/strong&gt;åªæœ‰ GC Roots æ˜¯é»‘è‰²çš„ã€‚è¢« GC Roots ç›´æ¥å¼•ç”¨çš„å¯¹è±¡ä¼šå˜æˆç°è‰²&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;â­æ‰«æè¿‡ç¨‹ä¸­&lt;/strong&gt;ï¼ŒæŒ‰ç…§ä»¥ä¸‹ä¸¤ç‚¹æ‰«ææ•´ä¸ªå¼•ç”¨é“¾&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å‰ç°è‰²èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹çš„è¯ï¼Œå°†å½“å‰èŠ‚ç‚¹å˜ä¸ºé»‘è‰²ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰ç°è‰²èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹çš„è¯ï¼Œå½“å‰èŠ‚ç‚¹å˜ä¸ºé»‘è‰²ï¼Œä¸”å­èŠ‚ç‚¹å˜ä¸ºç°è‰²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;â­æ‰«æå®Œæˆæ—¶&lt;/strong&gt;ï¼Œé»‘è‰²å¯¹è±¡å°±æ˜¯å­˜æ´»çš„å¯¹è±¡ï¼Œç™½è‰²å¯¹è±¡å°±æ˜¯å·²æ¶ˆäº¡å¯å›æ”¶çš„å¯¹è±¡&lt;/p&gt;
&lt;p&gt;æ‰«æå®Œæˆä¹‹åï¼Œåƒåœ¾æ”¶é›†å™¨åªéœ€è¦å›æ”¶ä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜å³å¯ã€‚ä¹ä¸€çœ‹ä¸Šé¢çš„è¿‡ç¨‹å¥½åƒæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä¸è¦å¿˜äº†æˆ‘ä»¬çš„&lt;span class=&#34;green&#34;&gt;&lt;strong&gt;æ”¶é›†çº¿ç¨‹æ˜¯å’Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„&lt;/strong&gt;&lt;/span&gt;ã€‚ğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;p&gt;ğŸŒ»ğŸŒ»é‚£ä¹ˆå°±ä¼šé‡åˆ°ä¸€äº›é—®é¢˜äº†ï¼Œæˆ‘ä»¬çš„æ”¶é›†å™¨åœ¨å¯¹è±¡å›¾ä¸Šæ ‡è®°é¢œè‰²çš„åŒæ—¶ï¼Œç”¨æˆ·çº¿ç¨‹åœ¨ä¿®æ”¹å¼•ç”¨å…³ç³» â€”â€” å³ä¿®æ”¹å¯¹è±¡å›¾çš„ç»“æ„ï¼Œè¿™æ ·å¯èƒ½ä¼šå‡ºç°ä¸‹é¢ä¸¤ç§åæœï¼š&lt;/p&gt;
&lt;p&gt;ğŸ“ä¸€ç§æ˜¯&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;æŠŠåŸæœ¬æ¶ˆäº¡çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå­˜æ´»&lt;/strong&gt;&lt;/font&gt;ï¼Œè¿™ä¸æ˜¯å¥½äº‹ï¼Œä½†å…¶å®æ˜¯å¯ä»¥å®¹å¿çš„ï¼Œåªä¸è¿‡äº§ç”Ÿäº†ä¸€ç‚¹é€ƒè¿‡æœ¬æ¬¡æ”¶é›†çš„æµ®åŠ¨åƒåœ¾è€Œå·²ï¼Œä¸‹æ¬¡æ”¶é›†æ¸…ç†æ‰å°±å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ“å¦ä¸€ç§æ˜¯&lt;font color=&#34;red&#34;&gt;&lt;strong&gt;æŠŠåŸæœ¬å­˜æ´»çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå·²æ¶ˆäº¡&lt;/strong&gt;&lt;/font&gt;ï¼Œè¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†ï¼Œç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ¥æ¼”ç¤ºä¸€ä¸‹ä¸Šé¢çš„é”™è¯¯å…·ä½“æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬ä¸€ç§æµ®åŠ¨åƒåœ¾&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¬¬ä¸€ç§æµ®åŠ¨åƒåœ¾&#34;&gt;#&lt;/a&gt; ç¬¬ä¸€ç§ï¼šæµ®åŠ¨åƒåœ¾&lt;/h3&gt;
&lt;p&gt;ğŸºå‡è®¾ GC çº¿ç¨‹å·²ç»éå†åˆ° Eï¼ˆå˜ä¸ºç°è‰²äº†ï¼‰ï¼Œæ­¤æ—¶ D &amp;gt; E çš„å¼•ç”¨æ–­å¼€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jjm1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;D &amp;gt; E çš„å¼•ç”¨æ–­å¼€ä¹‹åï¼ŒEã€Hã€GÂ ä¸‰ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼Œåº”è¯¥è¦è¢«å›æ”¶çš„ã€‚ç„¶è€Œå› ä¸º E å·²ç»å˜ä¸ºç°è‰²äº†ï¼Œå…¶ä»ä¼šè¢«å½“ä½œå­˜æ´»å¯¹è±¡ç»§ç»­éå†ä¸‹å»ã€‚æœ€ç»ˆçš„ç»“æœæ˜¯ï¼šè¿™éƒ¨åˆ†å¯¹è±¡ä»ä¼šè¢«æ ‡è®°ä¸ºå­˜æ´»ï¼Œå³æœ¬è½® GC ä¸ä¼šå›æ”¶è¿™éƒ¨åˆ†å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‘©è¿™éƒ¨åˆ†æœ¬åº”è¯¥å›æ”¶ä½†æ˜¯æ²¡æœ‰å›æ”¶åˆ°çš„å†…å­˜ï¼Œè¢«ç§°ä¹‹ä¸ºæµ®åŠ¨åƒåœ¾ã€‚æµ®åŠ¨åƒåœ¾å¹¶ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œä¸‹æ¬¡æ”¶é›†æ—¶æ¸…ç†æ‰å°±å¥½ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬äºŒç§å¯¹è±¡æ¶ˆå¤±&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¬¬äºŒç§å¯¹è±¡æ¶ˆå¤±&#34;&gt;#&lt;/a&gt; ç¬¬äºŒç§ï¼šâ€œå¯¹è±¡æ¶ˆå¤±â€&lt;/h3&gt;
&lt;p&gt;ğŸ¬å‡è®¾ GC çº¿ç¨‹å·²ç»éå†åˆ° Eï¼ˆå˜ä¸ºç°è‰²äº†ï¼‰ï¼Œæ­¤æ—¶ E &amp;gt; G çš„å¼•ç”¨æ–­å¼€ï¼Œæ–°å¢ D &amp;gt; G çš„å¼•ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jjm2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘€æ­¤æ—¶å› ä¸º E å·²ç»æ²¡æœ‰å¯¹ G çš„å¼•ç”¨äº†ï¼Œæ‰€ä»¥ä¸ä¼šå°† G ç½®ä¸ºç°è‰²ï¼›å°½ç®¡å› ä¸º D é‡æ–°å¼•ç”¨äº† Gï¼Œä½†å› ä¸º D å·²ç»æ˜¯é»‘è‰²äº†ï¼Œä¸ä¼šå†é‡æ–°åšéå†å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‘æœ€ç»ˆå¯¼è‡´çš„ç»“æœæ˜¯ï¼šG ä¼šä¸€ç›´æ˜¯ç™½è‰²ï¼Œæœ€åè¢«å½“ä½œåƒåœ¾è¿›è¡Œæ¸…é™¤ã€‚è¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†ï¼Œç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯ï¼Œæ˜¯ä¸å¯ä»¥æ¥å—çš„ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;ğŸ¥‡æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°å‘ç”Ÿè¿™ç§é”™è¯¯æ˜¯éœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ‰å¯ä»¥æˆç«‹çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼š&lt;/strong&gt; èµ‹å€¼å™¨æ’å…¥äº†ä¸€æ¡æˆ–å¤šæ¡ä»é»‘è‰²å¯¹è±¡åˆ°ç™½è‰²å¯¹è±¡çš„æ–°å¼•ç”¨ã€‚(å³æ–°å¢ D&amp;gt; G çš„å¼•ç”¨)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬äºŒä¸ªæ¡ä»¶ï¼š&lt;/strong&gt; èµ‹å€¼å™¨åˆ é™¤äº†å…¨éƒ¨ä»ç°è‰²å¯¹è±¡åˆ°è¯¥ç™½è‰²å¯¹è±¡çš„ç›´æ¥æˆ–é—´æ¥å¼•ç”¨ã€‚(å³æ–­å¼€ E&amp;gt; G çš„å¼•ç”¨)&lt;/p&gt;
&lt;p&gt;ğŸ¹æˆ‘ä»¬è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€ç ´åè¿™ä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä»»æ„ä¸€ä¸ªæ¡ä»¶ å³å¯é¿å…å‘ç”Ÿå¹¶å‘æ‰«ææ—¶çš„å¯¹è±¡æ¶ˆå¤±é—®é¢˜ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;ğŸğŸå…ˆæ¥ç ´åç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œå½“é»‘è‰²å¯¹è±¡æ’å…¥æ–°çš„æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªæ–°æ’å…¥çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œç­‰å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„é»‘è‰²å¯¹è±¡ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™å¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ&lt;strong&gt;é»‘è‰²å¯¹è±¡ä¸€æ—¦æ–°æ’å…¥äº†æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ä¹‹åï¼Œå®ƒå°±å˜å›ç°è‰²å¯¹è±¡äº†ã€‚&lt;/strong&gt; è¿™ç§è§£å†³æ–¹æ¡ˆç§°ä¸º&lt;font color=&#34;blue&#34;&gt;&lt;strong&gt;å¢é‡æ›´æ–°&lt;/strong&gt;&lt;/font&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‰ğŸ‰ä¹Ÿå¯ä»¥ç ´åç¬¬äºŒä¸ªæ¡ä»¶ï¼Œå½“ç°è‰²å¯¹è±¡è¦åˆ é™¤æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼Œæˆ‘ä»¬å°±å°†è¿™ä¸ªè¦åˆ é™¤çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œåœ¨å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„ç°è‰²å¯¹è±¡ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™ä¹Ÿå¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ&lt;strong&gt;æ— è®ºå¼•ç”¨å…³ç³»åˆ é™¤ä¸å¦ï¼Œéƒ½ä¼šæŒ‰ç…§åˆšåˆšå¼€å§‹æ‰«æé‚£ä¸€åˆ»çš„å¯¹è±¡å›¾å¿«ç…§æ¥è¿›è¡Œæœç´¢ã€‚&lt;/strong&gt; è¿™ç§è§£å†³æ–¹æ¡ˆç§°ä¸º&lt;font color=&#34;green&#34;&gt;&lt;strong&gt;åŸå§‹å¿«ç…§&lt;/strong&gt;&lt;/font&gt;ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;ğŸ˜æ— è®ºé‡‡ç”¨å“ªä¸€ç§æ–¹æ¡ˆï¼Œéƒ½å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚åœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œå¢é‡æ›´æ–°å’ŒåŸå§‹å¿«ç…§è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéƒ½æœ‰å®é™…åº”ç”¨ï¼Œè­¬å¦‚ï¼ŒCMS å°±æ˜¯åŸºäºå¢é‡æ›´æ–°æ¥åšå¹¶å‘æ ‡è®°çš„ï¼ŒG1ã€Shenandoah åˆ™æ˜¯ç”¨åŸå§‹å¿«ç…§æ–¹å¼æ¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ™‡è¯»å®Œä¸Šé¢çš„å†…å®¹ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹ JVM å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚JVM è™šæ‹Ÿæœºæ ‡è®°å®Œä¸å¯è¾¾å¯¹è±¡ä¹‹åè¿˜éœ€è¦å¯¹è¿™äº›å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜è¿›è¡Œå›æ”¶ï¼Œå…·ä½“çš„å›æ”¶åŠ¨ä½œæ˜¯ç”±è™šæ‹Ÿæœºé‡‡ç”¨å“ªæ¬¾åƒåœ¾å›æ”¶å™¨æ‰€å†³å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <category term="JVM" scheme="https://shaogezhu.cn/tags/JVM/" />
        <category term="åƒåœ¾å›æ”¶" scheme="https://shaogezhu.cn/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" />
        <updated>2022-03-11T17:25:23.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2022/3/53fe22309155/</id>
        <title>JVMåƒåœ¾å›æ”¶-è®°å¿†é›†å’Œå¡è¡¨</title>
        <link rel="alternate" href="https://shaogezhu.cn/2022/3/53fe22309155/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šè®°å¿†é›†å’Œå¡è¡¨&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;ğŸ¥‚åœ¨è¯´è®°å¿†é›†å’Œå¡è¡¨ä¹‹å‰ï¼Œå…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹&lt;strong&gt;è·¨ä»£å¼•ç”¨&lt;/strong&gt;çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jvm1.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ«å‡å¦‚è¦ç°åœ¨è¿›è¡Œä¸€æ¬¡åªå±€é™äºæ–°ç”Ÿä»£åŒºåŸŸå†…çš„æ”¶é›† (Minor GC)ï¼Œä½†æ–°ç”Ÿä»£çš„å®ä¾‹å¯¹è±¡ 1 åœ¨è€å¹´ä»£ä¸­è¢«å¼•ç”¨ï¼Œä¸ºäº†æ‰¾å‡ºè¯¥åŒºåŸŸ (æ–°ç”Ÿä»£) ä¸­æ‰€æœ‰çš„å­˜æ´»å¯¹è±¡ï¼Œä¸å¾—ä¸åœ¨å›ºå®šçš„ GC Roots ä¹‹å¤–ï¼Œå†&lt;strong&gt;é¢å¤–éå†æ•´ä¸ªè€å¹´ä»£&lt;/strong&gt;ä¸­æ‰€æœ‰å¯¹è±¡æ¥ç¡®ä¿å¯è¾¾æ€§åˆ†æç»“æœçš„æ­£ç¡®æ€§ï¼Œåè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·ã€‚éå†æ•´ä¸ªè€å¹´ä»£æ‰€æœ‰å¯¹è±¡çš„æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œï¼Œä½†æ— ç–‘ä¼šä¸ºå†…å­˜å›æ”¶å¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½è´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ğŸ»äº‹å®ä¸Šå¹¶ä¸åªæ˜¯æ–°ç”Ÿä»£ã€è€å¹´ä»£ä¹‹é—´æ‰æœ‰&lt;strong&gt;è·¨ä»£å¼•ç”¨&lt;/strong&gt;çš„é—®é¢˜ï¼Œæ‰€æœ‰æ¶‰åŠéƒ¨åˆ†åŒºåŸŸæ”¶é›†ï¼ˆPartial GC) è¡Œä¸ºçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå…¸å‹çš„å¦‚&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt; G1&lt;/strong&gt;&lt;/span&gt;ã€&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt;ZGC&lt;/strong&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt; Shenandoah&lt;/strong&gt;&lt;/span&gt; æ”¶é›†å™¨ï¼Œéƒ½ä¼šé¢ä¸´ç›¸åŒçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢&#34;&gt;#&lt;/a&gt; é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œ&lt;strong&gt;è·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£å¼•ç”¨æ¥è¯´ä»…å æå°‘æ•°&lt;/strong&gt;ã€‚åŸå› æ˜¯è·¨ä»£å¼•ç”¨çš„å¯¹è±¡åº”è¯¥å€¾å‘äºåŒæ—¶ç”Ÿå­˜æˆ–è€…åŒæ—¶æ­»äº¡çš„ï¼ˆä¸¾ä¸ªğŸŒ°ï¼šå¦‚æœæŸä¸ªæ–°ç”Ÿä»£å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨ï¼Œç”±äºè€å¹´ä»£å¯¹è±¡éš¾ä»¥æ¶ˆäº¡ï¼Œè¯¥å¼•ç”¨ä¼šä½¿å¾—æ–°ç”Ÿä»£å¯¹è±¡åœ¨æ”¶é›†æ—¶åŒæ ·å¾—ä»¥å­˜æ´»ï¼Œè¿›è€Œåœ¨å¹´é¾„å¢é•¿ä¹‹åæ™‹å‡åˆ°è€å¹´ä»£ä¸­ï¼Œè¿™æ—¶è·¨ä»£å¼•ç”¨ä¹Ÿéšå³è¢«æ¶ˆé™¤äº†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ğŸŒ´ğŸŒ´ä¾æ®ä¸Šé¢è¯´æ‰€ï¼Œå°±ä¸åº”å†ä¸ºäº†å°‘é‡çš„è·¨ä»£å¼•ç”¨å»æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼Œä¹Ÿä¸å¿…æµªè´¹ç©ºé—´ä¸“é—¨è®°å½•æ¯ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨åŠå­˜åœ¨å“ªäº›è·¨ä»£å¼•ç”¨ï¼Œåªéœ€åœ¨æ–°ç”Ÿä»£ä¸Šå»ºç«‹ä¸€ä¸ªå…¨å±€çš„æ•°æ®ç»“æ„ï¼ˆè¯¥ç»“æ„è¢«ç§°ä¸º &lt;strong&gt;â€œè®°å¿†é›†â€&lt;/strong&gt; ï¼ŒRemembered Set)ï¼Œ &lt;strong&gt;è¿™ä¸ªç»“æ„æŠŠè€å¹´ä»£åˆ’åˆ†æˆè‹¥å¹²å°å—ï¼Œæ ‡è¯†å‡ºè€å¹´ä»£çš„å“ªä¸€å—å†…å­˜ä¼šå­˜åœ¨è·¨ä»£å¼•ç”¨ã€‚&lt;/strong&gt; æ­¤åå½“å‘ç”Ÿ Minor GC æ—¶ï¼Œåªæœ‰åŒ…å«äº†è·¨ä»£å¼•ç”¨çš„å°å—å†…å­˜é‡Œçš„å¯¹è±¡æ‰ä¼šè¢«åŠ å…¥åˆ° GCRoots è¿›è¡Œæ‰«æã€‚è™½ç„¶è¿™ç§æ–¹æ³•éœ€è¦åœ¨å¯¹è±¡æ”¹å˜å¼•ç”¨å…³ç³» (å¦‚å°†è‡ªå·±æˆ–è€…æŸä¸ªå±æ€§èµ‹å€¼) æ—¶ç»´æŠ¤è®°å½•æ•°æ®çš„æ­£ç¡®æ€§ï¼Œä¼šå¢åŠ ä¸€äº›è¿è¡Œæ—¶çš„å¼€é”€ï¼Œä½†æ¯”èµ·æ”¶é›†æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£æ¥è¯´ä»ç„¶æ˜¯åˆ’ç®—çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ªå…¨å±€çš„æ•°æ®ç»“æ„è®°å¿†é›†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è®°å¿†é›†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è®°å¿†é›†&#34;&gt;#&lt;/a&gt; è®°å¿†é›†&lt;/h2&gt;
&lt;p&gt;âœ¨è®°å¿†é›†æ˜¯ä¸€ç§ç”¨äºè®°å½•ä»&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt;éæ”¶é›†åŒºåŸŸ&lt;/strong&gt;&lt;/span&gt;æŒ‡å‘&lt;span class=&#34;pink&#34;&gt;&lt;strong&gt;æ”¶é›†åŒºåŸŸ&lt;/strong&gt;&lt;/span&gt;çš„æŒ‡é’ˆé›†åˆçš„&lt;span class=&#34;red&#34;&gt;&lt;strong&gt;æŠ½è±¡&lt;/strong&gt;&lt;/span&gt;æ•°æ®ç»“æ„ã€‚å¦‚æœæˆ‘ä»¬ä¸è€ƒè™‘æ•ˆç‡å’Œæˆæœ¬çš„è¯ï¼Œæœ€ç®€å•çš„å®ç°å¯ä»¥ç”¨éæ”¶é›†åŒºåŸŸä¸­æ‰€æœ‰å«è·¨ä»£å¼•ç”¨çš„å¯¹è±¡æ•°ç»„æ¥å®ç°è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤º:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// ä»¥å¯¹è±¡æŒ‡é’ˆæ¥å®ç°è®°å¿†é›†çš„ä¼ªä»£ç &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token class-name&#34;&gt;Class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;RememberedSet&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token class-name&#34;&gt;Object&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; set&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;OBJECT_INTERGENERATIONAL_REFERENCE_SIZE&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ğŸˆè¿™ç§è®°å½•å…¨éƒ¨å«è·¨ä»£å¼•ç”¨å¯¹è±¡çš„å®ç°æ–¹æ¡ˆï¼Œæ— è®ºæ˜¯ç©ºé—´å ç”¨è¿˜æ˜¯ç»´æŠ¤æˆæœ¬éƒ½ç›¸å½“é«˜æ˜‚ã€‚è€Œåœ¨åƒåœ¾æ”¶é›†çš„åœºæ™¯ä¸­ï¼Œ&lt;strong&gt;æ”¶é›†å™¨åªéœ€è¦é€šè¿‡è®°å¿†é›†åˆ¤æ–­å‡ºæŸä¸€å—éæ”¶é›†åŒºåŸŸæ˜¯å¦å­˜åœ¨æœ‰æŒ‡å‘äº†æ”¶é›†åŒºåŸŸçš„æŒ‡é’ˆå°±å¯ä»¥äº†&lt;/strong&gt;ï¼Œå¹¶ä¸éœ€è¦äº†è§£è¿™äº›è·¨ä»£æŒ‡é’ˆçš„å…¨éƒ¨ç»†èŠ‚ã€‚é‚£è®¾è®¡è€…åœ¨å®ç°è®°å¿†é›†çš„æ—¶å€™ï¼Œä¾¿å¯ä»¥é€‰æ‹©æ›´ä¸ºç²—çŠ·çš„è®°å½•ç²’åº¦æ¥èŠ‚çœè®°å¿†é›†çš„å­˜å‚¨å’Œç»´æŠ¤æˆæœ¬ã€‚ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å¯ä¾›é€‰æ‹©ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„ï¼‰çš„è®°å½•ç²¾åº¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—é•¿ç²¾åº¦ï¼š&lt;/strong&gt; æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªæœºå™¨å­—é•¿ï¼ˆå°±æ˜¯å¤„ç†å™¨çš„å¯»å€ä½æ•°ï¼Œå¦‚å¸¸è§çš„ 32 ä½æˆ– 64 ä½ï¼Œè¿™ä¸ª ç²¾åº¦å†³å®šäº†æœºå™¨è®¿é—®ç‰©ç†å†…å­˜åœ°å€çš„æŒ‡é’ˆé•¿åº¦ï¼‰ï¼Œè¯¥å­—åŒ…å«è·¨ä»£æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡ç²¾åº¦ï¼š&lt;/strong&gt; æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡é‡Œæœ‰å­—æ®µå«æœ‰è·¨ä»£æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¡ç²¾åº¦ï¼š&lt;/strong&gt; æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€å—å†…å­˜åŒºåŸŸï¼Œè¯¥åŒºåŸŸå†…æœ‰å¯¹è±¡å«æœ‰è·¨ä»£æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸğŸä¸Šé¢çš„ï¼Œç¬¬ä¸‰ç§ â€œå¡ç²¾åº¦â€ æ‰€æŒ‡çš„æ˜¯ç”¨ä¸€ç§ç§°ä¸º **â€œå¡è¡¨â€(Card Table)** çš„æ–¹å¼å»å®ç°è®°å¿†é›†ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„è®°å¿†é›†çš„å®ç°å½¢å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢&#34;&gt;#&lt;/a&gt; å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ğŸ‘€å‰é¢ä»‹ç»è®°å¿†é›†çš„æ—¶å€™æåˆ° è®°å¿†é›†å…¶å®æ˜¯ä¸€ç§&lt;span class=&#34;red&#34;&gt;&lt;strong&gt; &amp;quot; æŠ½è±¡â€&lt;/strong&gt;&lt;/span&gt; çš„æ•°æ®ç»“æ„ï¼ŒæŠ½è±¡çš„æ„æ€æ˜¯&lt;span class=&#34;orange&#34;&gt;åªå®šä¹‰äº†è®°å¿†é›†çš„è¡Œä¸ºæ„å›¾ï¼Œå¹¶æ²¡æœ‰å®šä¹‰å…¶è¡Œä¸ºçš„å…·ä½“å®ç°&lt;/span&gt;ã€‚&lt;strong&gt;&lt;span class=&#34;blue&#34;&gt;å¡è¡¨&lt;/span&gt;å°±æ˜¯è®°å¿†é›†çš„ä¸€ç§å…·ä½“å®ç°&lt;/strong&gt;ï¼Œå®ƒå®šä¹‰äº†è®°å¿†é›†çš„è®°å½•ç²¾åº¦ã€ä¸å †å†…å­˜çš„æ˜ å°„å…³ç³»ç­‰ã€‚å…³äºè®°å¿†é›†ä¸å¡è¡¨çš„å…³ç³»ï¼Œå¯ä»¥æŒ‰ç…§ Java ä¸­ Map ä¸ HashMap çš„å…³ç³»æ¥ç±»æ¯”ç†è§£ï¼ˆå³æ¥å£å’Œå®ç°ç±»æ¥çš„å…³ç³»ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‹ä¸‹é¢æ¥è¯¦ç»†è¯´ä¸€ä¸‹è®°å¿†é›†çš„å…·ä½“å®ç°å¡è¡¨&lt;/p&gt;
&lt;h2 id=&#34;å¡è¡¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¡è¡¨&#34;&gt;#&lt;/a&gt; å¡è¡¨&lt;/h2&gt;
&lt;p&gt;âœ¨å¡è¡¨æ˜¯ä½¿ç”¨ä¸€ä¸ª ** å­—èŠ‚æ•°ç»„ CARD_TABLE []Â ** å®ç°ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”å…¶æ ‡è¯†çš„å†…å­˜åŒºåŸŸä¸€å—ç‰¹å®šå¤§å°çš„å†…å­˜å—ï¼Œæ¯ä¸ªå†…å­˜å—ç§°ä¸ºå¡é¡µï¼Œhotspot ä½¿ç”¨çš„å¡é¡µæ˜¯ 2^9 å¤§å° å³ 512 å­—èŠ‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jvm2.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ¦è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæŸä¸ªåŒºåŸŸæŒ‰ç…§å¡é¡µè¿›è¡Œåˆ’åˆ†ï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨è¦å¯¹æ–°ç”Ÿä»£åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠè€å¹´ä»£åŒºåŸŸçœ‹æˆæ˜¯ä¸€ä¸ªå¡é¡µä¸€ä¸ªå¡é¡µåˆ’åˆ†å¥½çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2022-3/jvm3.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºğŸ¹ï¼Œå› ä¸º cardpage1 ä¸­å­˜åœ¨æŒ‡å‘æ–°ç”Ÿä»£çš„è·¨ä»£å¼•ç”¨ï¼Œæ‰€ä»¥å¯¹åº”å¡è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸º 1ï¼Œè¡¨æ˜è¯¥ page åŒºåŸŸå­˜åœ¨è·¨ä»£åº”ç”¨çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğŸ“å¡è¡¨è§’åº¦ï¼š&lt;/strong&gt; å› ä¸º page1 ä¸­å­˜åœ¨è·¨ä»£é¥®ç”¨çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¡è¡¨å¯¹åº”çš„ç¬¬ä¸€ä¸ªä½ç½®è®°ä¸º 1ï¼Œè¡¨æ˜ page1 è¿™ä¸ªå…ƒç´ å˜è„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğŸ“å†…å­˜å›æ”¶è§’åº¦ï¼š&lt;/strong&gt; å› ä¸ºå¡è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸º 1ï¼Œè¡¨æ˜è¯¥ page åŒºåŸŸå­˜åœ¨è·¨ä»£åº”ç”¨çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶çš„æ—¶å€™éœ€è¦æ‰«æè¯¥åŒºåŸŸã€‚&lt;/p&gt;
&lt;p&gt;ğŸ˜ä¸€ä¸ªå¡é¡µçš„å†…å­˜ä¸­é€šå¸¸åŒ…å«ä¸æ­¢ä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦å¡é¡µå†…æœ‰ä¸€ä¸ª (æˆ–æ›´å¤šï¼‰å¯¹è±¡çš„å­—æ®µå­˜åœ¨ç€è·¨ä»£æŒ‡é’ˆï¼Œé‚£å°±å°†å¯¹åº”å¡è¡¨çš„æ•°ç»„å…ƒç´ çš„å€¼æ ‡è¯†ä¸º 1ï¼Œç§°ä¸ºè¿™ä¸ª&lt;span class=&#34;purple&#34;&gt;å…ƒç´ å˜è„ï¼ˆDirty)&lt;/span&gt;ï¼Œæ²¡æœ‰åˆ™æ ‡è¯†ä¸º 0ã€‚åœ¨åƒåœ¾æ”¶é›†å‘ç”Ÿæ—¶ï¼Œ** åªè¦ç­›é€‰å‡ºå¡è¡¨ä¸­å˜è„çš„å…ƒç´ ï¼Œå°±èƒ½è½»æ˜“å¾—å‡ºå“ªäº›å¡é¡µå†…å­˜å—ä¸­åŒ…å«è·¨ä»£æŒ‡é’ˆï¼ŒæŠŠå®ƒä»¬åŠ å…¥ GC Roots ä¸­ä¸€å¹¶æ‰«æã€‚** è¿™æ ·å°±ä¸éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£å¤§å¤§å‡å°‘ GC Roots çš„æ‰«æèŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <category term="JVM" scheme="https://shaogezhu.cn/tags/JVM/" />
        <category term="åƒåœ¾å›æ”¶" scheme="https://shaogezhu.cn/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" />
        <updated>2022-03-05T16:23:23.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/11/275d4281e1a0/</id>
        <title>MySQLä¸­ï¼šä¸€æ¡updateè¯­å¥æ˜¯æ€æ ·æ‰§è¡Œçš„</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/11/275d4281e1a0/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;ğŸ¥‚ä¸Šä¸€ç¯‡æ–‡ç« è¯´å®Œ MySQL çš„äº‹åŠ¡å’Œé”äº†ï¼Œè¿™æ¬¡æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹åœ¨ MySQL ä¸­ä¸€æ¡æ›´æ–°è¯­å¥çš„è¯¦ç»†æ‰§è¡Œæµç¨‹ (æœ¬æ–‡æ— ç‰¹æ®Šè¯´æ˜å‡æ˜¯é‡‡ç”¨ Innodb å­˜å‚¨å¼•æ“)ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;å‰æœŸå‡†å¤‡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å‰æœŸå‡†å¤‡&#34;&gt;#&lt;/a&gt; å‰æœŸå‡†å¤‡&lt;/h2&gt;
&lt;p&gt;â­â­é¦–å…ˆåˆ›å»ºä¸€å¼ è¡¨ï¼Œç„¶åæ’å…¥ä¸‰æ¡æ•°æ®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;CREATE&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;TABLE&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	ID &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;NOT&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;NULL&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	c &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;NOT&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token keyword&#34;&gt;PRIMARY&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;KEY&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;ID&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;ENGINE&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;InnoDB&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;DEFAULT&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;CHARSET&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;utf8 &lt;span class=&#34;token keyword&#34;&gt;COMMENT&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;æµ‹è¯•è¡¨&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;INSERT&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;INTO&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;VALUES&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è®©åæ‰§è¡Œæ›´æ–°æ“ä½œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;update&lt;/span&gt; T &lt;span class=&#34;token keyword&#34;&gt;set&lt;/span&gt; c&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;c&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;where&lt;/span&gt; ID&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åœ¨è¯´æ›´æ–°æ“ä½œå‰ï¼Œå¤§å®¶å…ˆæ¥çœ‹ä¸€ä¸‹ sql è¯­å¥åœ¨ MySQL ä¸­çš„æ‰§è¡Œæµç¨‹ğŸ¬~&lt;/p&gt;
&lt;h2 id=&#34;sqlè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#sqlè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹&#34;&gt;#&lt;/a&gt; SQL è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/sql1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘©å¦‚å›¾æ‰€ç¤ºï¼šMySQL æ•°æ®åº“ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªå±‚çº§ï¼š&lt;strong&gt;æœåŠ¡å±‚&lt;/strong&gt;å’Œ&lt;strong&gt;å­˜å‚¨å¼•æ“å±‚æœåŠ¡å±‚&lt;/strong&gt;ï¼š&lt;span class=&#34;blue&#34;&gt;&lt;strong&gt;server å±‚åŒ…æ‹¬&lt;/strong&gt;&lt;/span&gt;ï¼šè¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ï¼ŒåŒ…æ‹¬å¤§å¤šæ•° MySQL ä¸­çš„æ ¸å¿ƒåŠŸèƒ½æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼ŒåŒ…æ‹¬ å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚ &lt;span class=&#34;purple&#34;&gt;&lt;strong&gt;å­˜å‚¨å¼•æ“å±‚&lt;/strong&gt;&lt;/span&gt;ï¼šå­˜å‚¨å¼•æ“å±‚åŒ…æ‹¬ MySQL å¸¸è§çš„å­˜å‚¨å¼•æ“ï¼ŒåŒ…æ‹¬ MyISAMã€InnoDB å’Œ Memory ç­‰ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ InnoDBï¼Œä¹Ÿæ˜¯ç°åœ¨ MySQL çš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;serverå±‚ä¸­çš„ç»„ä»¶ä»‹ç»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#serverå±‚ä¸­çš„ç»„ä»¶ä»‹ç»&#34;&gt;#&lt;/a&gt; server å±‚ä¸­çš„ç»„ä»¶ä»‹ç»&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¿æ¥å™¨âœ¨ï¼š&lt;/strong&gt; éœ€è¦ MySQL å®¢æˆ·ç«¯ç™»å½•ï¼Œéœ€è¦ä¸€ä¸ª è¿æ¥å™¨ æ¥è¿æ¥ç”¨æˆ·å’Œ MySQL æ•°æ®åº“ï¼Œâ€œmysql -u ç”¨æˆ·å -p å¯†ç â€ è¿›è¡Œ MySQL ç™»å½•ï¼Œåœ¨å®Œæˆ TCP æ¡æ‰‹ åï¼Œè¿æ¥å™¨ä¼šæ ¹æ®è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç éªŒè¯ç™»å½•èº«ä»½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢ç¼“å­˜âœ¨ï¼š&lt;/strong&gt; MySQL åœ¨å¾—åˆ°ä¸€ä¸ªæ‰§è¡Œè¯·æ±‚åï¼Œä¼šé¦–å…ˆå» æŸ¥è¯¢ç¼“å­˜ ä¸­æŸ¥æ‰¾ï¼Œæ˜¯å¦æ‰§è¡Œè¿‡è¿™æ¡ SQL è¯­å¥ï¼Œä¹‹å‰æ‰§è¡Œè¿‡å¾—è¯­å¥ä»¥åŠç»“æœä¼šä»¥ key-value å¯¹çš„å½¢å¼ï¼Œæ”¾åœ¨å†…å­˜ä¸­ã€‚key æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œvalue æ˜¯æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœé€šè¿‡ key èƒ½å¤ŸæŸ¥æ‰¾åˆ°è¿™æ¡ SQL è¯­å¥ï¼Œç›´æ¥è¿”å› SQL çš„æ‰§è¡Œç»“æœã€‚è‹¥ä¸å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœå°±ä¼šè¢«æ”¾å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ã€‚ä½†æ˜¯æŸ¥è¯¢ç¼“å­˜ä¸å»ºè®®ä½¿ç”¨ï¼Œ å› ä¸ºåœ¨ MySQL ä¸­å¯¹æŸå¼ è¡¨è¿›è¡Œäº†æ›´æ–°æ“ä½œï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜å°±ä¼šå¤±æ•ˆï¼Œå¯¹äºæ›´æ–°é¢‘ç¹çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡å¾ˆä½ã€‚éœ€è¦æ³¨æ„ï¼šåœ¨ MySQL8.0 ç‰ˆæœ¬ï¼ŒæŸ¥è¯¢ç¼“å­˜åŠŸèƒ½å°±åˆ é™¤äº†ï¼Œä¸å­˜åœ¨æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½äº†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æå™¨âœ¨:&lt;/strong&gt; åˆ†ä¸ºè¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æ
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯æ³•åˆ†æï¼š&lt;/strong&gt; é¦–å…ˆï¼ŒMySQL ä¼šæ ¹æ® SQL è¯­å¥è¿›è¡Œè§£æï¼Œåˆ†æå™¨ä¼šå…ˆåš è¯æ³•åˆ†æï¼Œä½ å†™çš„ SQL å°±æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡ SQL è¯­å¥ï¼ŒMySQL éœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­æ³•åˆ†æï¼š&lt;/strong&gt; ç„¶åè¿›è¡Œ è¯­æ³•åˆ†æï¼Œ æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚å¦‚æœ SQL è¯­å¥ä¸æ­£ç¡®ï¼Œå°±æç¤ºï¼šYou have an error in your SQL suntax&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŒ–å™¨âœ¨ï¼š&lt;/strong&gt; ç»è¿‡åˆ†æå™¨åˆ†æåï¼ŒSQL å°±åˆæ³•äº†ï¼Œä½†åœ¨æ‰§è¡Œä¹‹å‰ï¼Œè¿˜éœ€è¦è¿›è¡Œä¼˜åŒ–å™¨çš„å¤„ç†ï¼Œ&lt;font color=&#34;blue&#34;&gt;ä¼˜åŒ–å™¨ä¼šåˆ¤æ–­ä½¿ç”¨äº†å“ªç§ç´¢å¼•ï¼Œä½¿ç”¨å“ªç§è¿æ¥&lt;/font&gt;ï¼Œä¼˜åŒ–å™¨çš„ä½œç”¨ å°±æ˜¯ç¡®å®šæ•ˆç‡æœ€é«˜çš„æ‰§è¡Œæ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œå™¨âœ¨ï¼š&lt;/strong&gt; åœ¨æ‰§è¡Œé˜¶æ®µï¼ŒMySQL é¦–å…ˆä¼šåˆ¤æ–­æœ‰æ²¡æœ‰æ‰§è¡Œè¯­å¥çš„æƒé™ï¼Œè‹¥æ— æƒé™ï¼Œè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼›è‹¥æœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨æ—¶ï¼Œæ‰§è¡Œå™¨ä¼šæ ¹æ®æ ‡çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¯¥å¼•æ“æä¾›çš„æ¥å£ï¼Œå¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ç±»ä¼¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;äº†è§£å®Œ SQL è¯­å¥çš„æ‰§è¡Œæµç¨‹æˆ‘ä»¬æ¥ä¸‹æ¥è¯¦ç»†åˆ†æä¸€ä¸‹ä¸Šé¢ &lt;code&gt;update T set c=c+1 where ID=2;&lt;/code&gt;  æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;updateè¯­å¥åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#updateè¯­å¥åˆ†æ&#34;&gt;#&lt;/a&gt; Update è¯­å¥åˆ†æ&lt;/h2&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;update&lt;/span&gt; T &lt;span class=&#34;token keyword&#34;&gt;set&lt;/span&gt; c&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;c&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;where&lt;/span&gt; ID&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;blockquote&gt;
&lt;p&gt;ğŸ…åœ¨æ‰§è¡Œ&lt;strong&gt; update æ›´æ–°&lt;/strong&gt;æ“ä½œçš„æ—¶å€™ï¼Œè·Ÿè¿™ä¸ªè¡¨æœ‰å…³çš„æŸ¥è¯¢ç¼“å­˜ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥å°±ä¼šæŠŠè¡¨ T ä¸Šæ‰€æœ‰ç¼“å­˜ç»“æœéƒ½æ¸…ç©ºã€‚æ¥ä¸‹æ¥ï¼Œåˆ†æå™¨ä¼šç»è¿‡è¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼ŒçŸ¥é“äº†è¿™æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥åï¼Œä¼˜åŒ–å™¨å†³å®šè¦ä½¿ç”¨å“ªä¸€ä¸ªç´¢å¼•ï¼Œç„¶åæ‰§è¡Œå™¨è´Ÿè´£å…·ä½“çš„æ‰§è¡Œï¼Œå…ˆæ‰¾åˆ°è¿™ä¸€è¡Œï¼Œç„¶ååšæ›´æ–°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŒ‰ç…§æˆ‘ä»¬å¹³å¸¸çš„æ€è·¯ï¼Œå°±æ˜¯ &lt;strong&gt;æ‰¾å‡ºè¿™æ¡è®°å½•ï¼ŒæŠŠå®ƒçš„å€¼æ”¹å¥½ï¼Œä¿å­˜å°± OK äº†&lt;/strong&gt; ã€‚ä½†æˆ‘ä»¬è¿½ç©¶ä¸€ä¸‹ç»†èŠ‚ï¼Œç”±äºæ¶‰åŠåˆ°ä¿®æ”¹æ•°æ®ï¼Œæ‰€ä»¥æ¶‰åŠåˆ°æ—¥å¿—äº†ã€‚æ›´æ–°æ“ä½œæ¶‰åŠåˆ°ä¸¤ä¸ªé‡è¦çš„æ—¥å¿—æ¨¡å—ã€‚ &lt;code&gt;redo log(é‡åšæ—¥å¿—)&lt;/code&gt; ï¼Œ &lt;code&gt;bin log(å½’æ¡£æ—¥å¿—)&lt;/code&gt; ã€‚MySQL ä¸­çš„è¿™ä¸¤ä¸ªæ—¥å¿—ä¹Ÿæ˜¯å¿…å­¦çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;redo-logé‡åšæ—¥å¿—&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redo-logé‡åšæ—¥å¿—&#34;&gt;#&lt;/a&gt; redo log (é‡åšæ—¥å¿—)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ MySQL é‡Œï¼Œå¦‚æœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹ IO æˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜ã€‚&lt;br /&gt;
MySQL é‡Œä½¿ç”¨ WAL (é¢„å†™å¼æ—¥å¿—) æŠ€æœ¯ï¼ŒWAL çš„å…¨ç§°æ˜¯  &lt;code&gt;Write-Ahead Logging&lt;/code&gt; ï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯ &lt;strong&gt;&lt;font color=&#34;red&#34;&gt;å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜&lt;/font&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…·ä½“æ¥è¯´ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDB å¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° redo log é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDB å¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšã€‚&lt;/li&gt;
&lt;li&gt;InnoDB çš„ redo log æ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ 1GBï¼Œé‚£ä¹ˆæ€»å…±å°±å¯ä»¥è®°å½• 4GB çš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¬å®Œä¸Šé¢å¯¹ redo log æ—¥å¿—çš„ä»‹ç»åï¼Œå°ä¼™ä¼´ä»¬å¯èƒ½ä¼šé—®ï¼š &lt;code&gt;redo logæ—¥å¿—å­˜å‚¨åœ¨å“ªï¼Ÿ&lt;/code&gt; ï¼Œ   &lt;code&gt;æ•°æ®åº“ä¿¡æ¯ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œredo logæ—¥å¿—ä¹Ÿä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œä¸ºä»€ä¹ˆè¦å…ˆå†™åˆ°redo logä¸­å†å†™åˆ°æ•°æ®åº“ä¸­å‘¢ï¼Ÿ&lt;/code&gt; ï¼Œ &lt;code&gt;redo logæ—¥å¿—å¦‚æœå­˜æ»¡æ•°æ®äº†æ€ä¹ˆåŠï¼Ÿ&lt;/code&gt; ç­‰ç­‰ã€‚æ¥ä¸‹æ¥å°±è§£ç­”ä¸€ä¸‹è¿™äº›ç–‘é—®ã€‚&lt;/p&gt;
&lt;h4 id=&#34;redo-logå­˜å‚¨åœ¨å“ªé‡Œ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redo-logå­˜å‚¨åœ¨å“ªé‡Œ&#34;&gt;#&lt;/a&gt; redo log å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ&lt;/h4&gt;
&lt;p&gt;ğŸ¦InnoDB å¼•æ“å…ˆæŠŠè®°å½•å†™åˆ° redo log ä¸­ï¼Œredo log åœ¨å“ªï¼Œå®ƒä¹Ÿæ˜¯åœ¨ç£ç›˜ä¸Šï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå†™ç£ç›˜çš„è¿‡ç¨‹ï¼Œ ä½†æ˜¯ä¸æ›´æ–°è¿‡ç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ›´æ–°è¿‡ç¨‹æ˜¯åœ¨ç£ç›˜ä¸Šéšæœº IOï¼Œè´¹æ—¶ã€‚ è€Œå†™ redo log æ˜¯åœ¨ç£ç›˜ä¸Šé¡ºåº IOã€‚æ•ˆç‡è¦é«˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;redo-log-ç©ºé—´æ˜¯å›ºå®šé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redo-log-ç©ºé—´æ˜¯å›ºå®šé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢&#34;&gt;#&lt;/a&gt; redo log ç©ºé—´æ˜¯å›ºå®šï¼Œé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;ğŸ¹é¦–å…ˆä¸ç”¨æ‹…å¿ƒ redo log ä¼šç”¨å®Œç©ºé—´ï¼Œå› ä¸ºå®ƒæ˜¯&lt;strong&gt;å¾ªç¯åˆ©ç”¨&lt;/strong&gt;çš„ã€‚ä¾‹å¦‚ redo log æ—¥å¿—é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶åˆ†åˆ«ä¸º 1Gã€‚å®ƒå†™çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-11/sql2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç®€å•æ€»ç»“ä¸€ä¸‹:&lt;/strong&gt; redo log æ—¥å¿—æ˜¯ Innodb å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥åº”å¯¹&lt;strong&gt;å¼‚å¸¸æ¢å¤&lt;/strong&gt;ï¼Œ&lt;strong&gt;Crash-safe&lt;/strong&gt;ï¼Œredo å¯ä»¥ä¿è¯ mysql å¼‚å¸¸é‡å¯æ—¶ï¼Œå°†æœªæäº¤çš„äº‹åŠ¡å›æ»šï¼Œå·²æäº¤çš„äº‹åŠ¡å®‰å…¨è½åº“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;crash-safe:&lt;/strong&gt; æœ‰äº† redo logï¼ŒInnoDB å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º crash-safeã€‚&lt;/p&gt;
&lt;h3 id=&#34;binlogå½’æ¡£æ—¥å¿—&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#binlogå½’æ¡£æ—¥å¿—&#34;&gt;#&lt;/a&gt; binlog (å½’æ¡£æ—¥å¿—)&lt;/h3&gt;
&lt;p&gt;ğŸ™‡redo log æ˜¯ innoDB å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ã€‚è€Œ binlog æ˜¯ mysql server å±‚çš„æ—¥å¿—ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¶å® bin log æ—¥å¿—å‡ºç°çš„æ—¶é—´æ¯” redo log æ—©ï¼Œå› ä¸ºæœ€å¼€å§‹ MySQL æ˜¯æ²¡æœ‰ InnoDB å­˜å‚¨å¼•æ“çš„ï¼Œ5.5 ä¹‹å‰æ˜¯ MyISAMã€‚ä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿ â€”â€” ä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;redo-logå’Œbin-logçš„æ€»ç»“&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redo-logå’Œbin-logçš„æ€»ç»“&#34;&gt;#&lt;/a&gt;  &lt;code&gt;redo log&lt;/code&gt;  å’Œ &lt;code&gt;bin log&lt;/code&gt;  çš„æ€»ç»“ğŸ“:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;redo log æ˜¯ä¸ºäº†ä¿è¯ innoDB å¼•æ“çš„ crash-safe èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ mysql å¼‚å¸¸å®•æœºé‡å¯çš„æ—¶å€™ï¼Œä¹‹å‰æäº¤çš„äº‹åŠ¡å¯ä»¥ä¿è¯ä¸ä¸¢å¤±ï¼›(å› ä¸ºæˆåŠŸæäº¤çš„äº‹åŠ¡è‚¯å®šæ˜¯å†™å…¥äº† redo log, å¯ä»¥ä» redo log æ¢å¤)&lt;/li&gt;
&lt;li&gt;bin log æ˜¯å½’æ¡£æ—¥å¿—ï¼Œå°†æ¯ä¸ªæ›´æ–°æ“ä½œéƒ½è¿½åŠ åˆ°æ—¥å¿—ä¸­ã€‚è¿™æ ·å½“éœ€è¦å°†æ—¥å¿—æ¢å¤åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ ¹æ®å…¨é‡å¤‡ä»½ + bin log é‡æ”¾å®ç°ã€‚ å¦‚æœæ²¡æœ‰å¼€å¯ binlog, é‚£ä¹ˆæ•°æ®åªèƒ½æ¢å¤åˆ°å…¨é‡å¤‡ä»½çš„æ—¶é—´ç‚¹ï¼Œè€Œä¸èƒ½æ¢å¤åˆ°ä»»æ„æ—¶é—´ç‚¹ã€‚å¦‚æœè¿å…¨é‡å¤‡ä»½ä¹Ÿæ²¡åšï¼Œmysql å®•æœºï¼Œç£ç›˜ä¹Ÿåäº†ï¼Œé‚£å°±å¾ˆå°´å°¬äº†ã€‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;redo-logå’Œbin-logçš„åŒºåˆ«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redo-logå’Œbin-logçš„åŒºåˆ«&#34;&gt;#&lt;/a&gt;  &lt;code&gt;redo log&lt;/code&gt;  å’Œ &lt;code&gt;bin log&lt;/code&gt;  çš„åŒºåˆ«ğŸ“:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›bin log æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;redo log æ˜¯ç‰©ç†æ—¥å¿—&lt;/strong&gt;ï¼Œè®°å½•çš„æ˜¯ â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›&lt;strong&gt;bin log æ˜¯é€»è¾‘æ—¥å¿—&lt;/strong&gt;ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚ â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1â€ã€‚&lt;/li&gt;
&lt;li&gt;redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€ æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;innodbå¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#innodbå¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹&#34;&gt;#&lt;/a&gt; InnoDB å¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„ update è¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹&lt;/h2&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;update&lt;/span&gt; T &lt;span class=&#34;token keyword&#34;&gt;set&lt;/span&gt; c&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;c&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;where&lt;/span&gt; ID&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/sql3.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğŸ‘€æ‰‹åŠ¨ç”¨ begin å¼€å¯äº‹åŠ¡ï¼Œç„¶åæ‰§è¡Œ update è¯­å¥ï¼Œå†ç„¶åæ‰§è¡Œ commit è¯­å¥ï¼Œé‚£ä¸Šé¢çš„ update æ›´æ–°æµç¨‹ä¹‹å‰ å“ªäº›æ˜¯ update è¯­å¥æ‰§è¡Œä¹‹ååšçš„ï¼Œå“ªäº›æ˜¯ commit è¯­å¥æ‰§è¡Œä¹‹ååšçš„ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;äº‹å®ä¸ŠğŸ‹ï¼Œredo log åœ¨å†…å­˜ä¸­æœ‰ä¸€ä¸ª &lt;code&gt;redo log buffer&lt;/code&gt; ,binlog ä¹Ÿæœ‰ä¸€ä¸ª &lt;code&gt;binlog cache&lt;/code&gt; . æ‰€ä»¥åœ¨æ‰‹åŠ¨å¼€å¯çš„äº‹åŠ¡ä¸­ï¼Œä½ æ‰§è¡Œ sql è¯­å¥ï¼Œå…¶å®æ˜¯å†™åˆ° &lt;code&gt;redo log buffer&lt;/code&gt;  å’Œ &lt;code&gt;binlog cache&lt;/code&gt;  ä¸­å»çš„ (è‚¯å®šä¸å¯èƒ½æ˜¯ç›´æ¥å†™ç£ç›˜æ—¥å¿—ï¼Œä¸€ä¸ªæ˜¯æ€§èƒ½å·®ä¸€ä¸ªæ˜¯å›æ»šçš„æ—¶å€™ä¸å¯èƒ½å»å›æ»šç£ç›˜æ—¥å¿—å§)ï¼Œç„¶åå½“ä½ æ‰§è¡Œ commit çš„æ—¶å€™ï¼Œé¦–å…ˆè¦å°† redo log çš„æäº¤çŠ¶æ€æ¸¸ prepare æ”¹ä¸º commit çŠ¶æ€ï¼Œç„¶åå°±è¦æŠŠ &lt;code&gt;binlog cache&lt;/code&gt;  åˆ·æ–°åˆ° binlog æ—¥å¿— (å¯èƒ½ä¹Ÿåªæ˜¯ flush åˆ°æ“ä½œç³»ç»Ÿçš„ page cacheï¼Œè¿™ä¸ªå°±çœ‹ä½ çš„ mysql é…ç½®)ï¼Œ &lt;code&gt;redo log buffer&lt;/code&gt;  åˆ·æ–°åˆ° redo log æ—¥å¿— (åˆ·æ–°æ—¶æœºä¹Ÿæ˜¯å¯ä»¥é…ç½®çš„)ã€‚ å¦‚æœä½ å›æ»šçš„è¯ï¼Œå°±åªç”¨æŠŠ &lt;code&gt;binlog cache&lt;/code&gt;  å’Œ &lt;code&gt;redo log buffer&lt;/code&gt;  ä¸­çš„æ•°æ®æ¸…é™¤å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
 &lt;br&gt;
&lt;p&gt;&lt;strong&gt;ğŸˆåœ¨ update è¿‡ç¨‹ä¸­ï¼Œmysql çªç„¶å®•æœºï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœ redolog å†™å…¥äº†ï¼Œå¤„äº prepare çŠ¶æ€ï¼Œbinlog è¿˜æ²¡å†™å…¥ï¼Œé‚£ä¹ˆå®•æœºé‡å¯åï¼Œredolog ä¸­çš„è¿™ä¸ªäº‹åŠ¡å°±ç›´æ¥å›æ»šäº†ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœ redolog å†™å…¥äº†ï¼Œbinlog ä¹Ÿå†™å…¥äº†ï¼Œä½† redolog è¿˜æ²¡æœ‰æ›´æ–°ä¸º commit çŠ¶æ€ï¼Œé‚£ä¹ˆå®•æœºé‡å¯ä»¥åï¼Œmysql ä¼šå»æ£€æŸ¥å¯¹åº”äº‹åŠ¡åœ¨ binlog ä¸­æ˜¯å¦å®Œæ•´ã€‚å¦‚æœæ˜¯ï¼Œå°±æäº¤äº‹åŠ¡ï¼›å¦‚æœä¸æ˜¯ï¼Œå°±å›æ»šäº‹åŠ¡ã€‚ (redolog å¤„äº prepare çŠ¶æ€ï¼Œbinlog å®Œæ•´å¯åŠ¨æ—¶å°±æäº¤äº‹åŠ¡ï¼Œä¸ºå•¥è¦è¿™ä¹ˆè®¾è®¡ï¼Ÿä¸»è¦æ˜¯å› ä¸º binlog å†™å…¥äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¢«ä»åº“æˆ–è€…ç”¨è¿™ä¸ª binlog æ¢å¤å‡ºæ¥çš„åº“ä½¿ç”¨ï¼Œä¸ºäº†æ•°æ®ä¸€è‡´æ€§å°±é‡‡ç”¨äº†è¿™ä¸ªç­–ç•¥)&lt;br /&gt;
 redo log å’Œ binlog æ˜¯é€šè¿‡ xid è¿™ä¸ªå­—æ®µå…³è”èµ·æ¥çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;br&gt;</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="MySQL" scheme="https://shaogezhu.cn/tags/MySQL/" />
        <category term="ç¬”è®°" scheme="https://shaogezhu.cn/tags/%E7%AC%94%E8%AE%B0/" />
        <updated>2021-11-30T15:29:53.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/11/2a1449b2531c/</id>
        <title>MySQLå¸¸è§çš„é”åˆ†æ</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/11/2a1449b2531c/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;ğŸŒ´ğŸŒ´æ•°æ®åº“é”å®šæœºåˆ¶ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°æ®åº“&lt;strong&gt;ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§&lt;/strong&gt;ï¼Œè€Œä½¿å„ç§å…±äº«èµ„æºåœ¨è¢«å¹¶å‘è®¿é—®å˜å¾—æœ‰åºæ‰€è®¾è®¡çš„ä¸€ç§è§„åˆ™ã€‚å¯¹äºä»»ä½•ä¸€ç§æ•°æ®åº“æ¥è¯´éƒ½éœ€è¦æœ‰ç›¸åº”çš„é”å®šæœºåˆ¶ï¼Œæ‰€ä»¥ MySQL è‡ªç„¶ä¹Ÿä¸èƒ½ä¾‹å¤–ã€‚ä¸‹é¢å°±ç»™å¤§å®¶è¯¦ç»†ä»‹ç»ä¸€ä¸‹&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;mysqlçš„é”&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#mysqlçš„é”&#34;&gt;#&lt;/a&gt; MySQL çš„é”&lt;/h2&gt;
&lt;h3 id=&#34;æ¦‚è¿°&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ¦‚è¿°&#34;&gt;#&lt;/a&gt; æ¦‚è¿°&lt;/h3&gt;
&lt;p&gt;ğŸŒ»ğŸŒ»MySQL æ•°æ®åº“ç”±äºå…¶è‡ªèº«æ¶æ„çš„ç‰¹ç‚¹ï¼Œå­˜åœ¨å¤šç§æ•°æ®å­˜å‚¨å¼•æ“ï¼Œæ¯ç§å­˜å‚¨å¼•æ“æ‰€é’ˆå¯¹çš„åº”ç”¨åœºæ™¯ç‰¹ç‚¹éƒ½ä¸å¤ªä¸€æ ·ï¼Œä¸ºäº†æ»¡è¶³å„è‡ªç‰¹å®šåº”ç”¨åœºæ™¯çš„éœ€æ±‚ï¼Œæ¯ç§å­˜å‚¨å¼•æ“çš„é”å®šæœºåˆ¶éƒ½æ˜¯ä¸ºå„è‡ªæ‰€é¢å¯¹çš„ç‰¹å®šåœºæ™¯è€Œä¼˜åŒ–è®¾è®¡ï¼Œæ‰€ä»¥å„å­˜å‚¨å¼•æ“çš„é”å®šæœºåˆ¶ä¹Ÿæœ‰è¾ƒå¤§åŒºåˆ«ã€‚æœ¬æ–‡æ²¡æœ‰è¯´æ˜çš„æƒ…å†µä¸‹é»˜è®¤ä½¿ç”¨çš„æ˜¯ Innodb å¼•æ“ã€‚&lt;/p&gt;
&lt;h4 id=&#34;innodbåŸç†ç®€å•è¯´ä¸€ä¸‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#innodbåŸç†ç®€å•è¯´ä¸€ä¸‹&#34;&gt;#&lt;/a&gt; Innodb åŸç† (ç®€å•è¯´ä¸€ä¸‹)ï¼š&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;innodb ä¸€å®šå­˜åœ¨èšç°‡ç´¢å¼•ï¼Œé»˜è®¤ä»¥ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•ğŸš€&lt;/li&gt;
&lt;li&gt;æœ‰å‡ ä¸ªç´¢å¼•ï¼Œå°±æœ‰å‡ æ£µ B + æ ‘ (ä¸è€ƒè™‘ hash ç´¢å¼•çš„æƒ…å½¢)ğŸš€&lt;/li&gt;
&lt;li&gt;èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸ºç£ç›˜ä¸Šçš„çœŸå®æ•°æ®ã€‚éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹è¿˜æ˜¯ç´¢å¼•ï¼ŒæŒ‡å‘èšç°‡ç´¢å¼• B + æ ‘ã€‚ğŸš€&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é”çš„åˆ†ç±»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#é”çš„åˆ†ç±»&#34;&gt;#&lt;/a&gt; é”çš„åˆ†ç±»&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…±äº«é” (S é”)ğŸ”’:&lt;/strong&gt; å‡è®¾äº‹åŠ¡ T1 å¯¹æ•°æ® A åŠ ä¸Šå…±äº«é”ï¼Œé‚£ä¹ˆäº‹åŠ¡ T2 å¯ä»¥è¯»æ•°æ® Aï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® Aã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ’ä»–é” (X é”)ğŸ”’:&lt;/strong&gt; å‡è®¾äº‹åŠ¡ T1 å¯¹æ•°æ® A åŠ ä¸Šæ’ä»–é”ï¼Œé‚£ä¹ˆäº‹åŠ¡ T2 ä¸èƒ½è¯»æ•°æ® Aï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® Aã€‚&lt;br /&gt;
æˆ‘ä»¬é€šè¿‡ &lt;code&gt;update&lt;/code&gt; ã€ &lt;code&gt;delete&lt;/code&gt;  ç­‰è¯­å¥åŠ ä¸Šçš„é”éƒ½æ˜¯è¡Œçº§åˆ«çš„é”ã€‚åªæœ‰ &lt;code&gt;LOCK TABLE â€¦ READ&lt;/code&gt;  å’Œ &lt;code&gt;LOCK TABLE â€¦ WRITE&lt;/code&gt;  æ‰èƒ½ç”³è¯·è¡¨çº§åˆ«çš„é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å‘å…±äº«é” (IS é”)ğŸ”’:&lt;/strong&gt; ä¸€ä¸ªäº‹åŠ¡åœ¨è·å–ï¼ˆä»»ä½•ä¸€è¡Œ / æˆ–è€…å…¨è¡¨ï¼‰S é”ä¹‹å‰ï¼Œä¸€å®šä¼šå…ˆåœ¨æ‰€åœ¨çš„è¡¨ä¸ŠåŠ  IS é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„å‘æ’ä»–é” (IX é”)ğŸ”’:&lt;/strong&gt; ä¸€ä¸ªäº‹åŠ¡åœ¨è·å–ï¼ˆä»»ä½•ä¸€è¡Œ / æˆ–è€…å…¨è¡¨ï¼‰X é”ä¹‹å‰ï¼Œä¸€å®šä¼šå…ˆåœ¨æ‰€åœ¨çš„è¡¨ä¸ŠåŠ  IX é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ„å‘é”å­˜åœ¨çš„ç›®çš„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ„å‘é”å­˜åœ¨çš„ç›®çš„&#34;&gt;#&lt;/a&gt; æ„å‘é”å­˜åœ¨çš„ç›®çš„&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œè¯´ä¸€ä¸‹æ„å‘é”å­˜åœ¨çš„ç›®çš„ã€‚å‡è®¾äº‹åŠ¡ T1ï¼Œç”¨ X é”æ¥é”ä½äº†è¡¨ä¸Šçš„å‡ æ¡è®°å½•ï¼Œé‚£ä¹ˆæ­¤æ—¶è¡¨ä¸Šå­˜åœ¨ IX é”ï¼Œå³æ„å‘æ’ä»–é”ã€‚é‚£ä¹ˆæ­¤æ—¶äº‹åŠ¡ T2 è¦è¿›è¡Œ &lt;code&gt;LOCK TABLE â€¦ WRITE&lt;/code&gt;  çš„è¡¨çº§åˆ«é”çš„è¯·æ±‚ï¼Œå¯ä»¥ç›´æ¥æ ¹æ®æ„å‘é”æ˜¯å¦å­˜åœ¨è€Œåˆ¤æ–­æ˜¯å¦æœ‰é”å†²çªã€‚ğŸˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;åŠ é”ç®—æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åŠ é”ç®—æ³•&#34;&gt;#&lt;/a&gt; åŠ é”ç®—æ³•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Record Locksï¼š&lt;/strong&gt; ç®€å•ç¿»è¯‘ä¸º&lt;strong&gt;è¡Œé”&lt;/strong&gt;ã€‚æ³¨æ„äº†ï¼Œè¯¥é”æ˜¯å¯¹ç´¢å¼•è®°å½•è¿›è¡ŒåŠ é”ï¼é”æ˜¯åŠ åœ¨ç´¢å¼•ä¸Šè€Œä¸æ˜¯è¡Œä¸Šçš„ã€‚æ³¨æ„äº†ï¼Œinnodb ä¸€å®šå­˜åœ¨èšç°‡ç´¢å¼•ï¼Œå› æ­¤è¡Œé”æœ€ç»ˆéƒ½ä¼šè½åˆ°èšç°‡ç´¢å¼•ä¸Šï¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap Locksï¼š&lt;/strong&gt; ç®€å•ç¿»è¯‘ä¸º&lt;strong&gt;é—´éš™é”&lt;/strong&gt;ï¼Œæ˜¯å¯¹ç´¢å¼•çš„é—´éš™åŠ é”ï¼Œå…¶ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œé˜²æ­¢å…¶ä»–äº‹ç‰©æ’å…¥æ•°æ®ã€‚åœ¨ &lt;code&gt;Read Committed&lt;/code&gt;  éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸ä¼šä½¿ç”¨é—´éš™é”ã€‚è¿™é‡Œæˆ‘å¯¹å®˜ç½‘è¡¥å……ä¸€ä¸‹ï¼Œéš”ç¦»çº§åˆ«æ¯” &lt;code&gt;Read Committed&lt;/code&gt;  ä½çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨é—´éš™é”ï¼Œå¦‚éš”ç¦»çº§åˆ«ä¸º &lt;code&gt;Read Uncommited&lt;/code&gt;  æ—¶ï¼Œä¹Ÿä¸å­˜åœ¨é—´éš™é”ã€‚å½“éš”ç¦»çº§åˆ«ä¸º &lt;code&gt;Repeatable Read&lt;/code&gt;  å’Œ &lt;code&gt;Serializable&lt;/code&gt;  æ—¶ï¼Œå°±ä¼šå­˜åœ¨é—´éš™é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Next-Key Locksï¼š&lt;/strong&gt; è¿™ä¸ªç†è§£ä¸º Record Lock + ç´¢å¼•å‰é¢çš„ Gap Lockã€‚è®°ä½äº†ï¼Œé”ä½çš„æ˜¯ç´¢å¼•å‰é¢çš„é—´éš™ï¼æ¯”å¦‚ä¸€ä¸ªç´¢å¼•åŒ…å«å€¼ï¼Œ10ï¼Œ11ï¼Œ13 å’Œ 20ã€‚é‚£ä¹ˆï¼Œé—´éš™é”çš„èŒƒå›´å¦‚ä¸‹&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;negative infinity&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; positive infinity&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿˜æœ‰ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥çœ‹ä¸€ä¸‹ MySQL çš„å®˜æ–¹æ–‡æ¡£ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9kZXYubXlzcWwuY29tL2RvYy9yZWZtYW4vNS43L2VuL2lubm9kYi1sb2NraW5nLmh0bWw=&#34;&gt;https://dev.mysql.com/doc/refman/5.7/en/innodb-locking.html&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¿«ç…§è¯»å’Œå½“å‰è¯»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¿«ç…§è¯»å’Œå½“å‰è¯»&#34;&gt;#&lt;/a&gt; å¿«ç…§è¯»å’Œå½“å‰è¯»&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ mysql ä¸­ select åˆ†ä¸ºå¿«ç…§è¯»å’Œå½“å‰è¯»ï¼Œæ‰§è¡Œä¸‹é¢çš„è¯­å¥&lt;br /&gt;
 &lt;code&gt;select * from table where id = ?; &lt;/code&gt; &lt;br /&gt;
æ‰§è¡Œçš„æ˜¯å¿«ç…§è¯»ï¼Œè¯»çš„æ˜¯æ•°æ®åº“è®°å½•çš„å¿«ç…§ç‰ˆæœ¬ï¼Œæ˜¯ä¸åŠ é”çš„ã€‚ï¼ˆè¿™ç§è¯´æ³•åœ¨éš”ç¦»çº§åˆ«ä¸º Serializable ä¸­ä¸æˆç«‹ï¼Œåé¢ä¼šå†è¡¥å……ã€‚ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæ‰§è¡Œ&lt;br /&gt;
 &lt;code&gt;select * from table where id = ? lock in share mode; &lt;/code&gt; &lt;br /&gt;
ä¼šå¯¹è¯»å–è®°å½•åŠ  S é” (å…±äº«é”)ï¼Œæ‰§è¡Œ	&lt;br /&gt;
 &lt;code&gt;select * from table where id = ? for update&lt;/code&gt; &lt;br /&gt;
 ä¼šå¯¹è¯»å–è®°å½•åŠ  X é” (æ’ä»–é”)ï¼Œé‚£ä¹ˆåŠ çš„æ˜¯è¡¨é”è¿˜æ˜¯è¡Œé”å‘¢ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;è¡¨é”orè¡Œé”&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¡¨é”orè¡Œé”&#34;&gt;#&lt;/a&gt; è¡¨é” or è¡Œé”&lt;/h3&gt;
&lt;p&gt;ğŸ¦é’ˆå¯¹è¿™ç‚¹ï¼Œæˆ‘ä»¬å…ˆå›å¿†ä¸€ä¸‹äº‹åŠ¡çš„å››ä¸ªéš”ç¦»çº§åˆ«ï¼Œä»–ä»¬ç”±å¼±åˆ°å¼ºå¦‚ä¸‹æ‰€ç¤º:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Read Uncommited(RU)ï¼š&lt;/strong&gt; è¯»æœªæäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Read Committed (RC)ï¼š&lt;/strong&gt; è¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Repeatable Read (RR):&lt;/strong&gt; å¯é‡å¤è¯»ï¼ŒåŠ å…¥é—´éš™é”ï¼Œä¸€å®šç¨‹åº¦ä¸Šé¿å…äº†å¹»è¯»çš„äº§ç”Ÿï¼æ³¨æ„äº†ï¼Œåªæ˜¯ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¹¶æ²¡æœ‰å®Œå…¨é¿å…ï¼æˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« è¯´æ˜ï¼å¦å¤–å°±æ˜¯è®°ä½ä»è¯¥çº§åˆ«æ‰å¼€å§‹åŠ å…¥é—´éš™é” (è¿™å¥è¯è®°ä¸‹æ¥ï¼Œåé¢æœ‰ç”¨åˆ°)!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Serializableï¼š&lt;/strong&gt; ä¸²è¡ŒåŒ–ï¼Œè¯¥çº§åˆ«ä¸‹è¯»å†™ä¸²è¡ŒåŒ–ï¼Œä¸”æ‰€æœ‰çš„ &lt;code&gt;select&lt;/code&gt;  è¯­å¥åéƒ½è‡ªåŠ¨åŠ ä¸Š &lt;code&gt;lock in share mode&lt;/code&gt; ï¼Œå³ä½¿ç”¨äº†å…±äº«é”ã€‚å› æ­¤åœ¨è¯¥éš”ç¦»çº§åˆ«ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯å½“å‰è¯»ï¼Œè€Œä¸æ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå…³äºæ˜¯è¡¨é”è¿˜æ˜¯è¡Œé”ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°ç½‘ä¸Šæœ€æµä¼ çš„ä¸€ä¸ªè¯´æ³•æ˜¯è¿™æ ·çš„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;InnoDB è¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ï¼Œè¿™ä¸€ç‚¹ MySQL ä¸ Oracle ä¸åŒï¼Œåè€…æ˜¯é€šè¿‡åœ¨æ•°æ®å—ä¸­å¯¹ç›¸åº”æ•°æ®è¡ŒåŠ é”æ¥å®ç°çš„ã€‚ InnoDB è¿™ç§è¡Œé”å®ç°ç‰¹ç‚¹æ„å‘³ç€ï¼šåªæœ‰é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼ŒInnoDB æ‰ä½¿ç”¨è¡Œçº§é”ï¼Œå¦åˆ™ï¼ŒInnoDB å°†ä½¿ç”¨è¡¨é”ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ğŸ‹è¿™å¥è¯å¤§å®¶å¯ä»¥æœä¸€ä¸‹ï¼Œéƒ½æ˜¯ä½ æŠ„æˆ‘çš„ï¼Œæˆ‘æŠ„ä½ çš„ã€‚é‚£ä¹ˆï¼Œè¿™å¥è¯æœ¬èº«æœ‰ä¸¤å¤„é”™è¯¯ï¼&lt;br /&gt;
&lt;strong&gt;é”™è¯¯ä¸€:&lt;/strong&gt; å¹¶ä¸æ˜¯ç”¨è¡¨é”æ¥å®ç°é”è¡¨çš„æ“ä½œï¼Œè€Œæ˜¯åˆ©ç”¨äº† &lt;code&gt;Next-Key Locks&lt;/code&gt; ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ç”¨äº†è¡Œé” + é—´éš™é”æ¥å®ç°é”è¡¨çš„æ“ä½œï¼&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œæˆ‘æ¥ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰è¡¨æ•°æ®å¦‚ä¸‹ï¼ŒpId ä¸ºä¸»é”®ç´¢å¼•&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;pId(int)&lt;/th&gt;
&lt;th&gt;name(varchar)&lt;/th&gt;
&lt;th&gt;num(int)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;aaa&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;bbb&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;ccc&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ‰§è¡Œè¯­å¥ (name åˆ—æ— ç´¢å¼•)&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption data-lang=&#34;SQL&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;where&lt;/span&gt; name &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token identifier&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;`&lt;/span&gt;aaa&lt;span class=&#34;token punctuation&#34;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;update&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶åœ¨ pId=1,2,7 è¿™ä¸‰æ¡è®°å½•ä¸Šå­˜åœ¨è¡Œé” (æŠŠè¡Œé”ä½äº†)ã€‚å¦å¤–ï¼Œåœ¨ (-âˆ,1)(1,2)(2,7)(7,+âˆ) ä¸Šå­˜åœ¨é—´éš™é” (æŠŠé—´éš™é”ä½äº†)ã€‚å› æ­¤ï¼Œç»™äººä¸€ç§æ•´ä¸ªè¡¨é”ä½çš„é”™è§‰ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ps:&lt;/strong&gt; å¯¹è¯¥ç»“è®ºæœ‰ç–‘é—®çš„ï¼Œå¯è‡ªè¡Œæ‰§è¡Œ &lt;code&gt;show engine innodb status&lt;/code&gt; ; è¯­å¥è¿›è¡Œåˆ†æã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯äºŒ:&lt;/strong&gt; æ‰€æœ‰æ–‡ç« éƒ½ä¸æéš”ç¦»çº§åˆ«ï¼&lt;br /&gt;
æ³¨æ„ä¸Šé¢è¯´çš„ï¼Œä¹‹æ‰€ä»¥èƒ½å¤Ÿé”è¡¨ï¼Œæ˜¯é€šè¿‡&lt;strong&gt;è¡Œé” + é—´éš™é”&lt;/strong&gt;æ¥å®ç°çš„ã€‚é‚£ä¹ˆï¼ŒRU å’Œ RC éƒ½ä¸å­˜åœ¨é—´éš™é”ï¼Œè¿™ç§è¯´æ³•åœ¨ RU å’Œ RC ä¸­è¿˜èƒ½æˆç«‹ä¹ˆï¼Ÿ&lt;br /&gt;
å› æ­¤ï¼Œè¯¥è¯´æ³•åªåœ¨ RR å’Œ Serializable ä¸­æ˜¯æˆç«‹çš„ã€‚å¦‚æœéš”ç¦»çº§åˆ«ä¸º RU å’Œ RCï¼Œæ— è®ºæ¡ä»¶åˆ—ä¸Šæ˜¯å¦æœ‰ç´¢å¼•ï¼Œéƒ½ä¸ä¼šé”è¡¨ï¼Œåªé”è¡Œï¼&lt;/p&gt;
&lt;h3 id=&#34;åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åˆ†æ&#34;&gt;#&lt;/a&gt; åˆ†æ&lt;/h3&gt;
&lt;p&gt;ğŸ¹ä¸‹é¢æ¥å¯¹å¼€å§‹çš„é—®é¢˜ä½œå‡ºè§£ç­”ï¼Œå‡è®¾æœ‰è¡¨å¦‚ä¸‹ï¼ŒpId ä¸ºä¸»é”®ç´¢å¼•&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;pId(int)&lt;/th&gt;
&lt;th&gt;name(varchar)&lt;/th&gt;
&lt;th&gt;num(int)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;aaa&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;bbb&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;bbb&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;ccc&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;ğŸğŸRC/RU + æ¡ä»¶åˆ—éç´¢å¼•&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 å½“ num = 200ï¼Œæœ‰ä¸¤æ¡è®°å½•ã€‚è¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 å½“ num &amp;gt; 200ï¼Œæœ‰ä¸€æ¡è®°å½•ã€‚è¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ ä¸Šè¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 for update&lt;/code&gt; &lt;br /&gt;
 å½“ num = 200ï¼Œæœ‰ä¸¤æ¡è®°å½•ã€‚è¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 for update&lt;/code&gt; &lt;br /&gt;
 å½“ num &amp;gt; 200ï¼Œæœ‰ä¸€æ¡è®°å½•ã€‚è¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ ä¸Šè¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ğŸ‰ğŸ‰RC/RU + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•&lt;/strong&gt;&lt;br /&gt;
æ©ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“ pId æ˜¯ä¸»é”®åˆ—ï¼Œå› æ­¤ pId ç”¨çš„å°±æ˜¯èšç°‡ç´¢å¼•ã€‚æ­¤æƒ…å†µå…¶å®å’Œ RC/RU + æ¡ä»¶åˆ—éç´¢å¼•æƒ…å†µæ˜¯ç±»ä¼¼çš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2 lock in share mode&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  S é”ï¼Œä¸ºå½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2 lock in share mode&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId=3ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  S é”ï¼Œä¸ºå½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2 for update&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  X é”ï¼Œä¸ºå½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2 for update&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId=3ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  X é”ï¼Œä¸ºå½“å‰è¯»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•åŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•åŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„&#34;&gt;#&lt;/a&gt; ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•ï¼ŒåŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„ï¼Ÿ&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¶å®æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨ RC/RU éš”ç¦»çº§åˆ«ä¸­ï¼ŒMySQL Server åšäº†ä¼˜åŒ–ã€‚åœ¨æ¡ä»¶åˆ—æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œå°½ç®¡é€šè¿‡èšç°‡ç´¢å¼•æ¥æ‰«æå…¨è¡¨ï¼Œè¿›è¡Œå…¨è¡¨åŠ é”ã€‚ä½†æ˜¯ï¼ŒMySQL Server å±‚ä¼šè¿›è¡Œè¿‡æ»¤å¹¶æŠŠä¸ç¬¦åˆæ¡ä»¶çš„é”å½“å³é‡Šæ”¾æ‰ï¼Œå› æ­¤ä½ çœ‹èµ·æ¥æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ RC/RU + æ¡ä»¶åˆ—éç´¢å¼•æ¯”æœ¬ä¾‹å¤šäº†ä¸€ä¸ªé‡Šæ”¾ä¸ç¬¦åˆæ¡ä»¶çš„é”çš„è¿‡ç¨‹ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ğŸğŸRC/RU + æ¡ä»¶åˆ—æ˜¯éèšç°‡ç´¢å¼•&lt;/strong&gt;&lt;br /&gt;
ğŸ‘‰ğŸ»æˆ‘ä»¬åœ¨ num åˆ—ä¸Šå»ºä¸Šéå”¯ä¸€ç´¢å¼•ã€‚æ­¤æ—¶æœ‰ä¸€æ£µèšç°‡ç´¢å¼• (ä¸»é”®ç´¢å¼•ï¼ŒpId) å½¢æˆçš„ B + ç´¢å¼•æ ‘ï¼Œå…¶å¶å­èŠ‚ç‚¹ä¸ºç¡¬ç›˜ä¸Šçš„çœŸå®æ•°æ®ã€‚ä»¥åŠå¦ä¸€æ£µéèšç°‡ç´¢å¼• (éå”¯ä¸€ç´¢å¼•ï¼Œnum) å½¢æˆçš„ B + ç´¢å¼•æ ‘ï¼Œå…¶å¶å­èŠ‚ç‚¹ä¾ç„¶ä¸ºç´¢å¼•èŠ‚ç‚¹ï¼Œä¿å­˜äº† num åˆ—çš„å­—æ®µå€¼ï¼Œå’Œå¯¹åº”çš„èšç°‡ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥åˆ†æå¼€å§‹ğŸ‘€&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200&lt;/code&gt; &lt;br /&gt;
 ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 å½“ num = 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ num = 200 çš„ä¸¤æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ S é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 å½“ num &amp;gt; 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ç¬¦åˆæ¡ä»¶çš„ num = 300 çš„ä¸€æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ S é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 for update&lt;/code&gt; &lt;br /&gt;
 å½“ num = 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ num = 200 çš„ä¸¤æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ X é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 for update&lt;/code&gt; &lt;br /&gt;
 å½“ num &amp;gt; 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ç¬¦åˆæ¡ä»¶çš„ num = 300 çš„ä¸€æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ X é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;RR/Serializable + æ¡ä»¶åˆ—éç´¢å¼•ğŸ“&lt;/strong&gt;&lt;br /&gt;
RR çº§åˆ«éœ€è¦å¤šè€ƒè™‘çš„å°±æ˜¯ &lt;code&gt;gap lock&lt;/code&gt; ï¼Œä»–çš„åŠ é”ç‰¹å¾åœ¨äºï¼Œæ— è®ºä½ æ€ä¹ˆæŸ¥éƒ½æ˜¯é”å…¨è¡¨ã€‚å¦‚ä¸‹æ‰€ç¤º&lt;br /&gt;
æ¥ä¸‹æ¥åˆ†æå¼€å§‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œåœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œåœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 for update&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 for update&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚å¹¶ä¸”åœ¨&lt;br /&gt;
èšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;RR/Serializable + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•ğŸ“&lt;/strong&gt;&lt;br /&gt;
æ©ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“ pId æ˜¯ä¸»é”®åˆ—ï¼Œå› æ­¤ pId ç”¨çš„å°±æ˜¯èšç°‡ç´¢å¼•ã€‚è¯¥æƒ…å†µçš„åŠ é”ç‰¹å¾åœ¨äºï¼Œå¦‚æœ where åçš„æ¡ä»¶ä¸ºç²¾ç¡®æŸ¥è¯¢ (= çš„æƒ…å†µ)ï¼Œé‚£ä¹ˆåªå­˜åœ¨ record lockã€‚å¦‚æœ where åçš„æ¡ä»¶ä¸ºèŒƒå›´æŸ¥è¯¢ (&amp;gt; æˆ– &amp;lt; çš„æƒ…å†µ)ï¼Œé‚£ä¹ˆå­˜åœ¨çš„æ˜¯ record lock+gap lockã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œä¸å­˜åœ¨ gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2 lock in share mode&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œä¸å­˜åœ¨ gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2 lock in share mode&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 2 for update&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 2 for update&lt;/code&gt; &lt;br /&gt;
 åœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId = 6 [lock in share mode|for update]&lt;/code&gt; &lt;br /&gt;
 æ³¨æ„äº†ï¼ŒpId=6 æ˜¯ä¸å­˜åœ¨çš„åˆ—ï¼Œè¿™ç§æƒ…å†µä¼šåœ¨ (3,7) ä¸ŠåŠ  gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where pId &amp;gt; 18 [lock in share mode|for update]&lt;/code&gt; &lt;br /&gt;
 æ³¨æ„äº†ï¼ŒpId&amp;gt;18ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ç©ºçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯åœ¨ (7,+âˆ) ä¸ŠåŠ  gap lockã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;RR/Serializable + æ¡ä»¶åˆ—æ˜¯éèšç°‡ç´¢å¼•ğŸ“&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œéèšç°‡ç´¢å¼•ï¼Œéœ€è¦åŒºåˆ†æ˜¯å¦ä¸ºå”¯ä¸€ç´¢å¼•ã€‚å› ä¸ºå¦‚æœæ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œé—´éš™é”çš„åŠ é”æ–¹å¼æ˜¯æœ‰åŒºåˆ«çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å…ˆè¯´ä¸€ä¸‹ï¼Œå”¯ä¸€ç´¢å¼•çš„æƒ…å†µã€‚å¦‚æœæ˜¯å”¯ä¸€ç´¢å¼•ï¼Œæƒ…å†µå’Œ RR/Serializable + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•ç±»ä¼¼ï¼Œå”¯ä¸€æœ‰åŒºåˆ«çš„æ˜¯ï¼šè¿™ä¸ªæ—¶å€™æœ‰ä¸¤æ£µç´¢å¼•æ ‘ï¼ŒåŠ é”æ˜¯åŠ åœ¨å¯¹åº”çš„éèšç°‡ç´¢å¼•æ ‘å’Œèšç°‡ç´¢å¼•æ ‘ä¸Šï¼å¤§å®¶å¯ä»¥è‡ªè¡Œæ¨æ•²ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‹é¢è¯´ä¸€ä¸‹ï¼Œéèšç°‡ç´¢å¼•æ˜¯éå”¯ä¸€ç´¢å¼•çš„æƒ…å†µï¼Œä»–å’Œå”¯ä¸€ç´¢å¼•çš„åŒºåˆ«å°±æ˜¯é€šè¿‡ç´¢å¼•è¿›è¡Œç²¾ç¡®æŸ¥è¯¢ä»¥åï¼Œä¸ä»…å­˜åœ¨ record lockï¼Œè¿˜å­˜åœ¨ gap lockã€‚è€Œé€šè¿‡å”¯ä¸€ç´¢å¼•è¿›è¡Œç²¾ç¡®æŸ¥è¯¢åï¼Œåªå­˜åœ¨ record lockï¼Œä¸å­˜åœ¨ gap lockã€‚è€è§„çŸ©åœ¨ num åˆ—å»ºç«‹éå”¯ä¸€ç´¢å¼•&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200&lt;/code&gt; &lt;br /&gt;
 åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚&lt;br /&gt;
åœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 lock in share mode&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 200 for update&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  X é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 200 for update&lt;/code&gt; &lt;br /&gt;
 æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  X é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lock&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num = 250 [lock in share mode|for update]&lt;/code&gt; &lt;br /&gt;
 æ³¨æ„äº†ï¼Œnum=250 æ˜¯ä¸å­˜åœ¨çš„åˆ—ï¼Œè¿™ç§æƒ…å†µä¼šåœ¨ (200,300) ä¸ŠåŠ  gap lockã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;select * from table where num &amp;gt; 400 [lock in share mode|for update]&lt;/code&gt; &lt;br /&gt;
 æ³¨æ„äº†ï¼ŒpId&amp;gt;400ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ç©ºçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯åœ¨ (400,+âˆ) ä¸ŠåŠ  gap lockã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;mysqlä¸­çš„æ­»é”&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#mysqlä¸­çš„æ­»é”&#34;&gt;#&lt;/a&gt; MySQL ä¸­çš„æ­»é”&lt;/h2&gt;
&lt;h3 id=&#34;æ­»é”çš„äº§ç”Ÿ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ­»é”çš„äº§ç”Ÿ&#34;&gt;#&lt;/a&gt; æ­»é”çš„äº§ç”Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æ­»é”ğŸ”’ï¼š&lt;/strong&gt; æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹ã€‚è¡¨çº§é”ä¸ä¼šäº§ç”Ÿæ­»é”ã€‚æ‰€ä»¥è§£å†³æ­»é”ä¸»è¦è¿˜æ˜¯é’ˆå¯¹äºæœ€å¸¸ç”¨çš„ InnoDBã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ­»é”çš„å…³é”®åœ¨äºï¼šä¸¤ä¸ª (æˆ–ä»¥ä¸Š) çš„ Select åŠ é”çš„é¡ºåºä¸ä¸€è‡´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹åº”çš„è§£å†³æ­»é”é—®é¢˜çš„å…³é”®å°±æ˜¯ï¼šè®©ä¸åŒçš„ Select åŠ é”æœ‰æ¬¡åº&lt;/p&gt;
&lt;h3 id=&#34;æ­»é”çš„æ£€æµ‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ­»é”çš„æ£€æµ‹&#34;&gt;#&lt;/a&gt; æ­»é”çš„æ£€æµ‹&lt;/h3&gt;
&lt;p&gt;âœ¨åœ¨å¹¶å‘ç³»ç»Ÿä¸­ä¸åŒçº¿ç¨‹å‡ºç°å¾ªç¯èµ„æºä¾èµ–ï¼Œæ¶‰åŠçš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…åˆ«çš„çº¿ç¨‹é‡Šæ”¾èµ„æºæ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™å‡ ä¸ªçº¿ç¨‹éƒ½è¿›å…¥æ— é™ç­‰å¾…çš„çŠ¶æ€ï¼Œç§°ä¸ºæ­»é”ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;äº‹åŠ¡ A&lt;/th&gt;
&lt;th&gt;äº‹åŠ¡ B&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td colspan=&#34;2&#34;&gt;&lt;code&gt;begin; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;update t set k=k+1 where id=1; &lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;begin; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;update t set k=k+1 where id=2; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&#34;2&#34;&gt;&lt;code&gt;update t set k=k+1 where id=2; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;update t set k=k+1 where id=1; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;äº‹åŠ¡ A åœ¨ç­‰å¾…äº‹åŠ¡ B é‡Šæ”¾ id=2 çš„è¡Œé”ï¼Œè€Œäº‹åŠ¡ B åœ¨ç­‰å¾…äº‹åŠ¡ A é‡Šæ”¾ id=1 çš„è¡Œé”ã€‚äº‹åŠ¡ A å’Œäº‹åŠ¡ B åœ¨äº’ç›¸ç­‰å¾…å¯¹æ–¹çš„èµ„æºé‡Šæ”¾ï¼Œå°±æ˜¯è¿›å…¥äº†æ­»é”çŠ¶æ€ã€‚å½“å‡ºç°æ­»é”ä»¥åï¼Œæœ‰ä¸¤ç§ç­–ç•¥ğŸ¥‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ç§ç­–ç•¥æ˜¯ï¼Œç›´æ¥è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°è¶…æ—¶ã€‚è¿™ä¸ªè¶…æ—¶æ—¶é—´å¯ä»¥é€šè¿‡å‚æ•° &lt;code&gt;innodb_lock_wait_timeout&lt;/code&gt;  æ¥è®¾ç½®&lt;/li&gt;
&lt;li&gt;å¦ä¸€ç§ç­–ç•¥æ˜¯ï¼Œå‘èµ·æ­»é”æ£€æµ‹ï¼Œå‘ç°æ­»é”åï¼Œä¸»åŠ¨å›æ»šæ­»é”é“¾æ¡ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶ä»–äº‹åŠ¡å¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚å°†å‚æ•° &lt;code&gt;innodb_deadlock_detect&lt;/code&gt;  è®¾ç½®ä¸º onï¼Œè¡¨ç¤ºå¼€å¯è¿™ä¸ªé€»è¾‘&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ InnoDB ä¸­ï¼Œ &lt;code&gt;innodb_lock_wait_timeout&lt;/code&gt;  çš„é»˜è®¤å€¼æ˜¯ 50sï¼Œæ„å‘³ç€å¦‚æœé‡‡ç”¨ç¬¬ä¸€ä¸ªç­–ç•¥ï¼Œå½“å‡ºç°æ­»é”ä»¥åï¼Œç¬¬ä¸€ä¸ªè¢«é”ä½çš„çº¿ç¨‹è¦è¿‡ 50s æ‰ä¼šè¶…æ—¶é€€å‡ºï¼Œç„¶åå…¶ä»–çº¿ç¨‹æ‰æœ‰å¯èƒ½ç»§ç»­æ‰§è¡Œã€‚å¯¹äºåœ¨çº¿æœåŠ¡æ¥è¯´ï¼Œè¿™ä¸ªç­‰å¾…æ—¶é—´å¾€å¾€æ˜¯æ— æ³•æ¥å—çš„&lt;/p&gt;
&lt;p&gt;âœ¨æ­£å¸¸æƒ…å†µä¸‹è¿˜æ˜¯è¦é‡‡ç”¨ä¸»åŠ¨æ­»é”æ£€æŸ¥ç­–ç•¥ï¼Œè€Œä¸” &lt;code&gt;innodb_deadlock_detect&lt;/code&gt;  çš„é»˜è®¤å€¼æœ¬èº«å°±æ˜¯ onã€‚ä¸»åŠ¨æ­»é”ç›‘æµ‹åœ¨å‘ç”Ÿæ­»é”çš„æ—¶å€™ï¼Œæ˜¯èƒ½å¤Ÿå¿«é€Ÿå‘ç°å¹¶è¿›è¡Œå¤„ç†çš„ï¼Œä½†æ˜¯å®ƒæœ‰é¢å¤–è´Ÿæ‹…çš„ã€‚æ¯å½“ä¸€ä¸ªäº‹åŠ¡è¢«é”çš„æ—¶å€™ï¼Œå°±è¦çœ‹çœ‹å®ƒæ‰€ä¾èµ–çš„çº¿ç¨‹æœ‰æ²¡æœ‰è¢«åˆ«äººé”ä½ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œæœ€ååˆ¤æ–­æ˜¯å¦å‡ºç°äº†å¾ªç¯ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯æ­»é”&lt;/p&gt;
&lt;p&gt;ğŸ¬å¦‚æœæ‰€æœ‰äº‹åŠ¡éƒ½è¦æ›´æ–°åŒä¸€è¡Œçš„åœºæ™¯ï¼Œæ¯ä¸ªæ–°æ¥çš„è¢«å µä½çš„çº¿ç¨‹éƒ½è¦åˆ¤æ–­ä¼šä¸ä¼šç”±äºè‡ªå·±çš„åŠ å…¥å¯¼è‡´æ­»é”ï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦æ˜¯ &lt;strong&gt;O(n)&lt;/strong&gt; çš„æ“ä½œ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğŸ‘©æ€ä¹ˆè§£å†³ç”±è¿™ç§çƒ­ç‚¹è¡Œæ›´æ–°å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœç¡®ä¿è¿™ä¸ªä¸šåŠ¡ä¸€å®šä¸ä¼šå‡ºç°æ­»é”ï¼Œå¯ä»¥ä¸´æ—¶æŠŠæ­»é”æ£€æµ‹å…³æ‰&lt;/li&gt;
&lt;li&gt;æ§åˆ¶å¹¶å‘åº¦&lt;/li&gt;
&lt;li&gt;å°†ä¸€è¡Œæ”¹æˆé€»è¾‘ä¸Šçš„å¤šè¡Œæ¥å‡å°‘é”å†²çªã€‚ä»¥å½±é™¢è´¦æˆ·ä¸ºä¾‹ï¼Œå¯ä»¥è€ƒè™‘æ”¾åœ¨å¤šæ¡è®°å½•ä¸Šï¼Œæ¯”å¦‚ 10 ä¸ªè®°å½•ï¼Œå½±é™¢çš„è´¦æˆ·æ€»é¢ç­‰äºè¿™ 10 ä¸ªè®°å½•çš„å€¼çš„æ€»å’Œã€‚è¿™æ ·æ¯æ¬¡è¦ç»™å½±é™¢è´¦æˆ·åŠ é‡‘é¢çš„æ—¶å€™ï¼Œéšæœºé€‰å…¶ä¸­ä¸€æ¡è®°å½•æ¥åŠ ã€‚è¿™æ ·æ¯æ¬¡å†²çªæ¦‚ç‡å˜æˆå‘˜åŸæ¥çš„ 1/10ï¼Œå¯ä»¥å‡å°‘é”ç­‰å¾…ä¸ªæ•°ï¼Œä¹Ÿå°±å‡å°‘äº†æ­»é”æ£€æµ‹çš„ CPU æ¶ˆè€—&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•&#34;&gt;#&lt;/a&gt; è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;â­ç»ˆæ­¢ï¼ˆæˆ–æ’¤é”€ï¼‰è¿›ç¨‹ã€‚ç»ˆæ­¢ï¼ˆæˆ–æ’¤é”€ï¼‰ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ­»é”è¿›ç¨‹ï¼Œç›´è‡³æ‰“ç ´å¾ªç¯ç¯è·¯ï¼Œä½¿ç³»ç»Ÿä»æ­»é”çŠ¶æ€ä¸­è§£é™¤å‡ºæ¥ã€‚&lt;/li&gt;
&lt;li&gt;â­æŠ¢å èµ„æºã€‚ä»ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ä¸­æŠ¢å è¶³å¤Ÿæ•°é‡çš„èµ„æºï¼Œåˆ†é…ç»™æ­»é”è¿›ç¨‹ï¼Œä»¥æ‰“ç ´æ­»é”çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ğŸ”‘ç¬¬ä¸€ç§æ–¹æ³•æ‰‹åŠ¨å®ç°ï¼š&lt;/strong&gt;&lt;br /&gt;
åœ¨ mysql ä¸­ï¼Œè¾“å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;show processlist;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kill æ‰ç­‰å¾…ä¸­æˆ–è€…ç¡çœ çš„è¿›ç¨‹ï¼Œé‡å¤æ“ä½œå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kill 10430(è¿›ç¨‹Id);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="MySQL" scheme="https://shaogezhu.cn/tags/MySQL/" />
        <updated>2021-11-21T08:43:00.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/11/f5f4ddb13fdd/</id>
        <title>lambdaQueryWrapperä¸­å¸¸ç”¨çš„æ–¹æ³•</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/11/f5f4ddb13fdd/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;âœ¨mybatis-plus æ˜¯ç°åœ¨æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ’ä»¶ï¼Œæå¤§çš„æé«˜äº†æˆ‘ä»¬å¼€å‘çš„æ•ˆç‡ï¼ŒLambdaQueryWrapper ç±»æˆ‘ä»¬ä¹Ÿç»å¸¸ä½¿ç”¨ï¼Œæˆ‘æŠŠå¤§éƒ¨åˆ†çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠæœ¬ç½‘å€æ”¶è—èµ·æ¥ æ–¹ä¾¿ä»¥åæŸ¥é˜…ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/lm.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="MySQL" scheme="https://shaogezhu.cn/categories/mysql/" />
        <category term="èµ„æ–™" scheme="https://shaogezhu.cn/tags/%E8%B5%84%E6%96%99/" />
        <category term="mybatis" scheme="https://shaogezhu.cn/tags/mybatis/" />
        <updated>2021-11-16T14:31:30.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/11/a702195cf0e5/</id>
        <title>HTTPåè®® å’Œ HTTPSåè®® è¯¦è§£</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/11/a702195cf0e5/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;æˆ‘ä»¬ç»å¸¸è¯´çš„é€šä¿¡åè®®ï¼Œä»¥åŠä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ï¼Œéƒ½æ˜¯ä»€ä¹ˆï¼Ÿ http å’Œ https æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå»ºç«‹é“¾æ¥çš„æµç¨‹ä¸€æ ·ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ https å°±å®‰å…¨äº†ï¼Ÿ è¯»å®Œè¿™ç¯‡æ–‡ç« ä½ å°±ä¼šæœ‰éå¸¸æ·±åˆ»çš„è®¤è¯†ğŸ™‡&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;åè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åè®®&#34;&gt;#&lt;/a&gt; åè®®&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œç½‘ç»œåè®®æ˜¯è®¡ç®—æœºä¹‹é—´ä¸ºäº†å®ç°ç½‘ç»œé€šä¿¡è€Œè¾¾æˆçš„ä¸€ç§ â€œçº¦å®šâ€ æˆ–è€…â€ è§„åˆ™ â€œï¼Œæœ‰äº†è¿™ç§â€ çº¦å®š â€œï¼Œä¸åŒå‚å•†çš„ç”Ÿäº§è®¾å¤‡ï¼Œä»¥åŠä¸åŒæ“ä½œç³»ç»Ÿç»„æˆçš„è®¡ç®—æœºä¹‹é—´ï¼Œå°±å¯ä»¥å®ç°é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;http-åè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#http-åè®®&#34;&gt;#&lt;/a&gt; HTTP åè®®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;âœ¨HTTP&lt;/strong&gt;ï¼ˆHyperText Transfer Protocolï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„åº”ç”¨å±‚åè®®ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶ HTML é¡µé¢çš„æ–¹æ³•ï¼Œè¢«ç”¨äºåœ¨ Web æµè§ˆå™¨å’Œç½‘ç«™æœåŠ¡å™¨ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;httpå»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#httpå»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; http å»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æŠ¥æ–‡&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨æ ¹æ®è¯·æ±‚æŠ¥æ–‡æ”¶é›†å¯¹åº”çš„ç»„åˆæˆå“åº”æŠ¥æ–‡&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯æ”¶åˆ°å“åº”æŠ¥æ–‡åè¿›è¡Œè§£ææ¸²æŸ“&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;httpç‰¹ç‚¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#httpç‰¹ç‚¹&#34;&gt;#&lt;/a&gt; HTTP ç‰¹ç‚¹&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;http åè®®æ”¯æŒå®¢æˆ·ç«¯ / æœåŠ¡ç«¯æ¨¡å¼ï¼Œä¹Ÿæ˜¯ä¸€ç§è¯·æ±‚ / å“åº”æ¨¡å¼çš„åè®®ã€‚&lt;/li&gt;
&lt;li&gt;ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰ GETã€HEADã€POSTã€‚&lt;/li&gt;
&lt;li&gt;çµæ´»ï¼šHTTP å…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚ä¼ è¾“çš„ç±»å‹ç”± Content-Type åŠ ä»¥æ ‡è®°ã€‚&lt;/li&gt;
&lt;li&gt;æ— è¿æ¥ï¼šé™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ï¼Œä½†æ˜¯å´ä¸åˆ©äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¿æŒä¼šè¯è¿æ¥ï¼Œä¸ºäº†å¼¥è¡¥è¿™ç§ä¸è¶³ï¼Œäº§ç”Ÿäº†ä¸¤é¡¹è®°å½• http çŠ¶æ€çš„æŠ€æœ¯ï¼Œä¸€ä¸ªå«åš Cookie, ä¸€ä¸ªå«åš Sessionã€‚&lt;/li&gt;
&lt;li&gt;æ— çŠ¶æ€ï¼šæ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†ï¼Œåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å¿…é¡»é‡ä¼ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;https-åè®®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#https-åè®®&#34;&gt;#&lt;/a&gt; HTTPS åè®®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;âœ¨HTTPS&lt;/strong&gt;ï¼ˆHypertext Transfer Protocol Secureï¼šè¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼‰æ˜¯ä¸€ç§é€è¿‡è®¡ç®—æœºç½‘ç»œè¿›è¡Œå®‰å…¨é€šä¿¡çš„ä¼ è¾“åè®®ã€‚HTTPS ç»ç”± HTTP è¿›è¡Œé€šä¿¡ï¼Œä½†åˆ©ç”¨ SSL/TLS æ¥åŠ å¯†æ•°æ®åŒ…ã€‚HTTPS å¼€å‘çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯æä¾›å¯¹ç½‘ç«™æœåŠ¡å™¨çš„èº«ä»½è®¤è¯ï¼Œä¿æŠ¤äº¤æ¢æ•°æ®çš„éšç§ä¸å®Œæ•´æ€§ã€‚&lt;/p&gt;
&lt;h4 id=&#34;httpså»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#httpså»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; https å»ºç«‹é“¾æ¥çš„è¿‡ç¨‹&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/http1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;client å‘ server å‘é€è¯·æ±‚ https://www.shaogezhu.cn ï¼Œç„¶åè¿æ¥åˆ° server çš„ 443 ç«¯å£ï¼Œå‘é€çš„ä¿¡æ¯åŒ…å«å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;server æ¥æ”¶åˆ°ä¿¡æ¯ä¹‹åç»™äºˆ client å“åº”æ¡æ‰‹ä¿¡æ¯ï¼ŒåŒ…å«åŒ¹é…å¥½çš„åå•†åŠ å¯†ç®—æ³•ï¼Œè¿™ä¸ªåŠ å¯†ç®—æ³•ä¸€å®šæ˜¯ client å‘é€ç»™ server åŠ å¯†ç®—æ³•çš„å­é›†ã€‚&lt;/li&gt;
&lt;li&gt;éšå³ server ç»™ client å‘é€ç¬¬äºŒä¸ªå“åº”æŠ¥æ–‡æ˜¯æ•°å­—è¯ä¹¦ã€‚æœåŠ¡ç«¯å¿…é¡»è¦æœ‰ä¸€å¥—æ•°å­—è¯ä¹¦ï¼Œå¯ä»¥è‡ªå·±åˆ¶ä½œï¼Œä¹Ÿå¯ä»¥å‘ç»„ç»‡ç”³è¯·ã€‚åŒºåˆ«å°±æ˜¯è‡ªå·±é¢å‘çš„è¯ä¹¦éœ€è¦å®¢æˆ·ç«¯éªŒè¯é€šè¿‡ï¼Œæ‰å¯ä»¥ç»§ç»­è®¿é—®ï¼Œè€Œä½¿ç”¨å—ä¿¡ä»»çš„å…¬å¸ç”³è¯·çš„è¯ä¹¦åˆ™ä¸ä¼šå¼¹å‡ºæç¤ºé¡µé¢ï¼Œè¿™å¥—è¯ä¹¦å…¶å®å°±æ˜¯ä¸€å¯¹å…¬é’¥å’Œç§é’¥ã€‚ä¼ é€è¯ä¹¦ï¼Œè¿™ä¸ªè¯ä¹¦å…¶å®å°±æ˜¯å…¬é’¥ï¼Œåªæ˜¯åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ï¼Œå¦‚è¯ä¹¦çš„é¢å‘æœºæ„ï¼Œè¿‡æœŸæ—¶é—´ã€æœåŠ¡ç«¯çš„å…¬é’¥ï¼Œç¬¬ä¸‰æ–¹è¯ä¹¦è®¤è¯æœºæ„ (CA) çš„ç­¾åï¼ŒæœåŠ¡ç«¯çš„åŸŸåä¿¡æ¯ç­‰å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯è§£æéªŒè¯è¯ä¹¦ï¼Œè¿™éƒ¨åˆ†å·¥ä½œæ˜¯ç”±å®¢æˆ·ç«¯çš„ SSL/TLS æ¥å®Œæˆçš„ï¼Œé¦–å…ˆä¼šéªŒè¯å…¬é’¥æ˜¯å¦æœ‰æ•ˆï¼Œæ¯”å¦‚é¢å‘æœºæ„ï¼Œè¿‡æœŸæ—¶é—´ç­‰ç­‰ï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œåˆ™ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†ï¼Œæç¤ºè¯ä¹¦å­˜åœ¨é—®é¢˜ã€‚å¦‚æœè¯ä¹¦æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå°±ç”Ÿæˆä¸€ä¸ªéšå³å€¼ï¼ˆé¢„ä¸»ç§˜é’¥ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯è®¤è¯è¯ä¹¦é€šè¿‡ä¹‹åï¼Œæ¥ä¸‹æ¥æ˜¯é€šè¿‡ç”Ÿæˆä¼šè¯å¯†é’¥ã€‚ç„¶åé€šè¿‡è¯ä¹¦çš„å…¬é’¥åŠ å¯†ä¼šè¯å¯†é’¥ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡ç«¯ä½¿ç”¨ç§é’¥è§£å¯†å¾—åˆ°ä¼šè¯å¯†é’¥ï¼Œç„¶åæœåŠ¡ç«¯ä¼šé€šè¿‡ä¼šè¯ç§˜é’¥åŠ å¯†ä¸€æ¡æ¶ˆæ¯å›ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå®¢æˆ·ç«¯èƒ½å¤Ÿæ­£å¸¸æ¥å—çš„è¯è¡¨æ˜ SSL å±‚è¿æ¥å»ºç«‹å®Œæˆäº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;httpsçš„ç‰¹ç‚¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#httpsçš„ç‰¹ç‚¹&#34;&gt;#&lt;/a&gt; https çš„ç‰¹ç‚¹&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†…å®¹åŠ å¯†ï¼š&lt;/strong&gt; é‡‡ç”¨æ··åˆåŠ å¯†æŠ€æœ¯ï¼Œä¸­é—´è€…æ— æ³•ç›´æ¥æŸ¥çœ‹æ˜æ–‡å†…å®¹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯èº«ä»½ï¼š&lt;/strong&gt; é€šè¿‡è¯ä¹¦è®¤è¯å®¢æˆ·ç«¯è®¿é—®çš„æ˜¯è‡ªå·±çš„æœåŠ¡å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿æŠ¤æ•°æ®å®Œæ•´æ€§ï¼š&lt;/strong&gt; é˜²æ­¢ä¼ è¾“çš„å†…å®¹è¢«ä¸­é—´äººå†’å……æˆ–è€…ç¯¡æ”¹&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;http-ä¸-https-åŒºåˆ«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#http-ä¸-https-åŒºåˆ«&#34;&gt;#&lt;/a&gt; HTTP ä¸ HTTPS åŒºåˆ«&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;HTTP æ˜æ–‡ä¼ è¾“ï¼Œæ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œå®‰å…¨æ€§è¾ƒå·®ï¼ŒHTTPSï¼ˆSSL+HTTPï¼‰ æ•°æ®ä¼ è¾“è¿‡ç¨‹æ˜¯åŠ å¯†çš„ï¼Œå®‰å…¨æ€§è¾ƒå¥½ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ HTTPS åè®®éœ€è¦åˆ° &lt;strong&gt;CA&lt;/strong&gt;ï¼ˆCertificate Authorityï¼Œæ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼‰ ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦è¾ƒå°‘ï¼Œå› è€Œéœ€è¦ä¸€å®šè´¹ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;HTTP é¡µé¢å“åº”é€Ÿåº¦æ¯” HTTPS å¿«ï¼Œä¸»è¦æ˜¯å› ä¸º HTTP ä½¿ç”¨ TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº¤æ¢ 3 ä¸ªåŒ…ï¼Œè€Œ HTTPS é™¤äº† TCP çš„ä¸‰ä¸ªåŒ…ï¼Œè¿˜è¦åŠ ä¸Š ssl æ¡æ‰‹éœ€è¦çš„ 9 ä¸ªåŒ…ï¼Œæ‰€ä»¥ä¸€å…±æ˜¯ 12 ä¸ªåŒ…ã€‚&lt;/li&gt;
&lt;li&gt;http å’Œ https ä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ã€‚&lt;/li&gt;
&lt;li&gt;HTTPS å…¶å®å°±æ˜¯å»ºæ„åœ¨ SSL/TLS ä¹‹ä¸Šçš„ HTTP åè®®ï¼Œæ‰€ä»¥ï¼Œè¦æ¯”è¾ƒ HTTPS æ¯” HTTP è¦æ›´è€—è´¹æœåŠ¡å™¨èµ„æºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;CA è®¤è¯&lt;/strong&gt;ï¼šç¬¬ä¸‰æ–¹æ•°å­—ç­¾åè®¤è¯æœºæ„ï¼Œä¸ºäº†ç¡®è®¤ https ä¸­æœåŠ¡å™¨å‘é€çš„å…¬å¼€ç§˜é’¥æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œå› æ­¤ä¼šå…ˆå‘é€ç»™å¯ä¿¡çš„ç¬¬ä¸‰æ–¹è¿›è¡Œç­¾åï¼Œå®¢æˆ·ç«¯ä½¿ç”¨æœºæ„çš„å…¬å¼€ç§˜é’¥è¿›è¡Œç­¾åè®¤è¯ï¼Œç”¨æ¥ä¿è¯æœåŠ¡å™¨å…¬å¼€ç§˜é’¥çš„å¯é æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•°å­—æ‘˜è¦ï¼š&lt;/strong&gt; é€šè¿‡å•å‘ hash å‡½æ•°å¯¹åŸæ–‡è¿›è¡Œå“ˆå¸Œï¼Œå°†éœ€åŠ å¯†çš„æ˜æ–‡ â€œæ‘˜è¦â€ æˆä¸€ä¸²å›ºå®šé•¿åº¦ (å¦‚ 128bit) çš„å¯†æ–‡ï¼Œä¸åŒçš„æ˜æ–‡æ‘˜è¦æˆçš„å¯†æ–‡å…¶ç»“æœæ€»æ˜¯ä¸ç›¸åŒï¼ŒåŒæ ·çš„æ˜æ–‡å…¶æ‘˜è¦å¿…å®šä¸€è‡´ï¼Œå¹¶ä¸”å³ä½¿çŸ¥é“äº†æ‘˜è¦ä¹Ÿä¸èƒ½åæ¨å‡ºæ˜æ–‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†&#34;&gt;#&lt;/a&gt; å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;éå¯¹ç§°åŠ å¯†ğŸŒ´ï¼š&lt;/strong&gt; å…¬å¼€ç§˜é’¥æ˜¯ä»»ä½•äººéƒ½å¯ä»¥è½»æ˜“è·å¾—ï¼Œå¹¶ä¸”å¯ä»¥éšæ„å‘é€ã€‚ä½†æ˜¯å…¬å¼€å¯†é’¥åŠ å¯†åçš„å†…å®¹åªæœ‰æä¾›å…¬å¼€ç§˜é’¥çš„æœåŠ¡æ–¹å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§æœ‰ç§˜é’¥è¿›è¡Œè§£å¯†&lt;br /&gt;
&lt;strong&gt;å¯¹ç§°åŠ å¯†ğŸŒ´ï¼š&lt;/strong&gt; åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯åŒä¸€ç§˜é’¥ï¼Œæ‰€ä»¥åªè¦è·å¾—åŠ å¯†ç§˜é’¥å°±å¯ä»¥è¿›è¡Œè§£å¯†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;tcpä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#tcpä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/http2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ğŸ‘€ï¼š&lt;/strong&gt;&lt;br /&gt;
ï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å°è¯•è¿æ¥æœåŠ¡å™¨ï¼Œå‘æœåŠ¡å™¨å‘é€ syn åŒ…ï¼ˆåŒæ­¥åºåˆ—ç¼–å· Synchronize Sequence Numbersï¼‰ï¼Œseq=aï¼Œå®¢æˆ·ç«¯è¿›å…¥ SYN_SEND çŠ¶æ€ç­‰å¾…æœåŠ¡å™¨ç¡®è®¤&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯ syn åŒ…å¹¶ç¡®è®¤ï¼ˆAck=a+1ï¼‰ï¼Œseq=bï¼ŒåŒæ—¶å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª SYN åŒ…ï¼ˆsyn=1ï¼‰ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥ SYN_RECV çŠ¶æ€&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ SYN+ACK åŒ…ï¼Œå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ… ACK (ack=b+1ï¼‰ï¼Œæ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹&lt;/p&gt;
&lt;p&gt;ï¼ˆ4ï¼‰Server ç«¯åœ¨æ”¶åˆ° Client çš„ ACK å¸§ä¹‹åï¼Œä¼šä» SYN_RCVD çŠ¶æ€ä¼šè¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œè‡³æ­¤ï¼ŒServer æ–¹å‘çš„é€šé“è¿æ¥å»ºç«‹æˆåŠŸï¼ŒServer å¯ä»¥å‘é€æ•°æ®ç»™ Clientï¼ŒTCP çš„å…¨åŒå·¥è¿æ¥å»ºç«‹å®Œæˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-11/http3.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ğŸ‘€ï¼š&lt;/strong&gt;&lt;br /&gt;
ï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨æ–­å¼€æ–¹ï¼ˆå¯ä»¥æ˜¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼‰ï¼Œå‘å¯¹æ–¹å‘é€ä¸€ä¸ª FIN ç»“æŸè¯·æ±‚æŠ¥æ–‡ï¼Œæ­¤æŠ¥æ–‡çš„ FIN ä½è¢«è®¾ç½®ä¸º 1ï¼Œå¹¶ä¸”æ­£ç¡®è®¾ç½® Sequence Numberï¼ˆåºåˆ—å·ï¼‰å’Œ AcknowledgmentNumberï¼ˆç¡®è®¤å·ï¼‰ã€‚å‘é€å®Œæˆåï¼Œä¸»åŠ¨æ–­å¼€æ–¹è¿›å…¥ FIN_WAIT_1 çŠ¶æ€ï¼Œè¿™è¡¨ç¤ºä¸»åŠ¨æ–­å¼€æ–¹æ²¡æœ‰ä¸šåŠ¡æ•°æ®è¦å‘é€ç»™å¯¹æ–¹ï¼Œå‡†å¤‡å…³é—­ SOCKET è¿æ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ”¶åˆ°äº†ä¸»åŠ¨æ–­å¼€æ–¹å‘é€çš„ FIN æ–­å¼€è¯·æ±‚æŠ¥æ–‡åï¼Œè¢«åŠ¨æ–­å¼€æ–¹ä¼šå‘é€ä¸€ä¸ª ACK å“åº”æŠ¥æ–‡ï¼ŒæŠ¥æ–‡çš„ Acknowledgment Numberï¼ˆç¡®è®¤å·ï¼‰å€¼ä¸ºæ–­å¼€è¯·æ±‚æŠ¥æ–‡çš„ Sequence Numberï¼ˆåºåˆ—å·ï¼‰åŠ  1ï¼Œè¯¥ ACK ç¡®è®¤æŠ¥æ–‡çš„å«ä¹‰æ˜¯ï¼šâ€œæˆ‘åŒæ„ä½ çš„è¿æ¥æ–­å¼€è¯·æ±‚â€ã€‚ä¹‹åï¼Œè¢«åŠ¨æ–­å¼€æ–¹å°±è¿›å…¥äº† CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ï¼ŒTCP åè®®æœåŠ¡ä¼šé€šçŸ¥é«˜å±‚çš„åº”ç”¨è¿›ç¨‹ï¼Œå¯¹æ–¹å‘æœ¬åœ°æ–¹å‘çš„è¿æ¥å·²ç»å…³é—­ï¼Œå¯¹æ–¹å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè‹¥æœ¬åœ°è¿˜è¦å‘é€æ•°æ®ç»™å¯¹æ–¹ï¼Œå¯¹æ–¹ä¾ç„¶ä¼šæ¥å—ã€‚è¢«åŠ¨æ–­å¼€æ–¹çš„ CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰è¿˜è¦æŒç»­ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ª CLOSE-WAIT çŠ¶æ€æŒç»­çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ğŸ»ä¸»åŠ¨æ–­å¼€æ–¹åœ¨æ”¶åˆ°äº† ACK æŠ¥æ–‡åï¼Œç”± FIN_WAIT_1 è½¬æ¢æˆ FIN_WAIT_2 çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šåœ¨å‘é€å®Œæˆ ACK æŠ¥æ–‡åï¼Œè¢«åŠ¨æ–­å¼€æ–¹è¿˜å¯ä»¥ç»§ç»­å®Œæˆä¸šåŠ¡æ•°æ®çš„å‘é€ï¼Œå¾…å‰©ä½™æ•°æ®å‘é€å®Œæˆåï¼Œæˆ–è€… CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰æˆªæ­¢åï¼Œè¢«åŠ¨æ–­å¼€æ–¹ä¼šå‘ä¸»åŠ¨æ–­å¼€æ–¹å‘é€ä¸€ä¸ª FIN+ACK ç»“æŸå“åº”æŠ¥æ–‡ï¼Œè¡¨ç¤ºè¢«åŠ¨æ–­å¼€æ–¹çš„æ•°æ®éƒ½å‘é€å®Œäº†ï¼Œç„¶åï¼Œè¢«åŠ¨æ–­å¼€æ–¹è¿›å…¥ LAST_ACK çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ4ï¼‰ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨æ–­å¼€æ–¹æ”¶åœ¨åˆ° FIN+ACK æ–­å¼€å“åº”æŠ¥æ–‡åï¼Œè¿˜éœ€è¦è¿›è¡Œæœ€åçš„ç¡®è®¤ï¼Œå‘è¢«åŠ¨æ–­å¼€æ–¹å‘é€ä¸€ä¸ª ACK ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åï¼Œè‡ªå·±å°±è¿›å…¥ TIME_WAIT çŠ¶æ€ï¼Œç­‰å¾…è¶…æ—¶åæœ€ç»ˆå…³é—­è¿æ¥ã€‚å¤„äº TIME_WAIT çŠ¶æ€çš„ä¸»åŠ¨æ–­å¼€æ–¹ï¼Œåœ¨ç­‰å¾…å®Œæˆ 2MSL çš„æ—¶é—´åï¼Œå¦‚æœæœŸé—´æ²¡æœ‰æ”¶åˆ°å…¶ä»–æŠ¥æ–‡ï¼Œåˆ™è¯æ˜å¯¹æ–¹å·²æ­£å¸¸å…³é—­ï¼Œä¸»åŠ¨æ–­å¼€æ–¹çš„è¿æ¥æœ€ç»ˆå…³é—­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‹“å±•çŸ¥è¯†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ‹“å±•çŸ¥è¯†&#34;&gt;#&lt;/a&gt; æ‹“å±•çŸ¥è¯†&lt;/h2&gt;
&lt;h4 id=&#34;ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹&#34;&gt;#&lt;/a&gt; ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å› ä¸ºå½“ Server ç«¯æ”¶åˆ° Client ç«¯çš„ SYN è¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€ SYN+ACK æŠ¥æ–‡ã€‚å…¶ä¸­ ACK æŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYN æŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“ Server ç«¯æ”¶åˆ° FIN æŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­ SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œå‘Šè¯‰ Client ç«¯ï¼Œ&amp;quot;ä½ å‘çš„ FIN æŠ¥æ–‡æˆ‘æ”¶åˆ°äº†&amp;quot;ã€‚åªæœ‰ç­‰åˆ°æˆ‘ Server ç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€ FIN æŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ã€‚æ•…éœ€è¦å››æ­¥æ¡æ‰‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—&#34;&gt;#&lt;/a&gt; ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—ï¼Ÿ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;3 æ¬¡æ¡æ‰‹å®Œæˆä¸¤ä¸ªé‡è¦çš„åŠŸèƒ½ï¼Œæ—¢è¦åŒæ–¹åšå¥½å‘é€æ•°æ®çš„å‡†å¤‡å·¥ä½œ (åŒæ–¹éƒ½çŸ¥é“å½¼æ­¤å·²å‡†å¤‡å¥½)ï¼Œä¹Ÿè¦å…è®¸åŒæ–¹å°±åˆå§‹åºåˆ—å·è¿›è¡Œåå•†ï¼Œè¿™ä¸ªåºåˆ—å·åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­è¢«å‘é€å’Œç¡®è®¤ã€‚ç°åœ¨æŠŠä¸‰æ¬¡æ¡æ‰‹æ”¹æˆä»…éœ€è¦ä¸¤æ¬¡æ¡æ‰‹ï¼Œæ­»é”æ˜¯å¯èƒ½å‘ç”Ÿçš„ã€‚ä½œä¸ºä¾‹å­ï¼Œè€ƒè™‘è®¡ç®—æœº S å’Œ C ä¹‹é—´çš„é€šä¿¡ï¼Œå‡å®š C ç»™ S å‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚åˆ†ç»„ï¼ŒS æ”¶åˆ°äº†è¿™ä¸ªåˆ†ç»„ï¼Œå¹¶å‘ é€äº†ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚æŒ‰ç…§ä¸¤æ¬¡æ¡æ‰‹çš„åå®šï¼ŒS è®¤ä¸ºè¿æ¥å·²ç»æˆåŠŸåœ°å»ºç«‹äº†ï¼Œå¯ä»¥å¼€å§‹å‘é€æ•°æ®åˆ†ç»„ã€‚å¯æ˜¯ï¼ŒC åœ¨ S çš„åº”ç­”åˆ†ç»„åœ¨ä¼ è¾“ä¸­è¢«ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼Œå°†ä¸çŸ¥é“ S æ˜¯å¦å·²å‡†å¤‡å¥½ï¼Œä¸çŸ¥é“ S å»ºç«‹ä»€ä¹ˆæ ·çš„åºåˆ—å·ï¼ŒC ç”šè‡³æ€€ç–‘ S æ˜¯å¦æ”¶åˆ°è‡ªå·±çš„è¿æ¥è¯·æ±‚åˆ†ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒC è®¤ä¸ºè¿æ¥è¿˜æœªå»ºç«‹æˆåŠŸï¼Œå°†å¿½ç•¥ S å‘æ¥çš„ä»»ä½•æ•°æ®åˆ† ç»„ï¼Œåªç­‰å¾…è¿æ¥ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚è€Œ S åœ¨å‘å‡ºçš„åˆ†ç»„è¶…æ—¶åï¼Œé‡å¤å‘é€åŒæ ·çš„åˆ†ç»„ã€‚è¿™æ ·å°±å½¢æˆäº†æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨time-waitçŠ¶æ€å¿…é¡»ç­‰å¾…2mslçš„æ—¶é—´&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨time-waitçŠ¶æ€å¿…é¡»ç­‰å¾…2mslçš„æ—¶é—´&#34;&gt;#&lt;/a&gt; ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨ TIME-WAIT çŠ¶æ€å¿…é¡»ç­‰å¾… 2MSL çš„æ—¶é—´ï¼Ÿ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;è™½ç„¶æŒ‰é“ç†ï¼Œå››ä¸ªæŠ¥æ–‡éƒ½å‘é€å®Œæ¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥ CLOSE çŠ¶æ€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»å‡è±¡ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼Œæœ‰å¯ä»¥æœ€åä¸€ä¸ª ACK ä¸¢å¤±ã€‚æ‰€ä»¥ TIME_WAIT çŠ¶æ€å°±æ˜¯ç”¨æ¥é‡å‘å¯èƒ½ä¸¢å¤±çš„ ACK æŠ¥æ–‡ã€‚åœ¨ Client å‘é€å‡ºæœ€åçš„ ACK å›å¤ï¼Œä½†è¯¥ ACK å¯èƒ½ä¸¢å¤±ã€‚Server å¦‚æœæ²¡æœ‰æ”¶åˆ° ACKï¼Œå°†ä¸æ–­é‡å¤å‘é€ FIN ç‰‡æ®µã€‚æ‰€ä»¥ Client ä¸èƒ½ç«‹å³å…³é—­ï¼Œå®ƒå¿…é¡»ç¡®è®¤ Server æ¥æ”¶åˆ°äº†è¯¥ ACKã€‚Client ä¼šåœ¨å‘é€å‡º ACK ä¹‹åè¿›å…¥åˆ° TIME_WAIT çŠ¶æ€ã€‚Client ä¼šè®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œç­‰å¾… 2MSL çš„æ—¶é—´ã€‚å¦‚æœåœ¨è¯¥æ—¶é—´å†…å†æ¬¡æ”¶åˆ° FINï¼Œé‚£ä¹ˆ Client ä¼šé‡å‘ ACK å¹¶å†æ¬¡ç­‰å¾… 2MSLã€‚æ‰€è°“çš„ 2MSL æ˜¯ä¸¤å€çš„ MSL (Maximum Segment Lifetime)ã€‚MSL æŒ‡ä¸€ä¸ªç‰‡æ®µåœ¨ç½‘ç»œä¸­æœ€å¤§çš„å­˜æ´»æ—¶é—´ï¼Œ2MSL å°±æ˜¯ä¸€ä¸ªå‘é€å’Œä¸€ä¸ªå›å¤æ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚å¦‚æœç›´åˆ° 2MSLï¼ŒClient éƒ½æ²¡æœ‰å†æ¬¡æ”¶åˆ° FINï¼Œé‚£ä¹ˆ Client æ¨æ–­ ACK å·²ç»è¢«æˆåŠŸæ¥æ”¶ï¼Œåˆ™ç»“æŸ TCP è¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠ&#34;&gt;#&lt;/a&gt; å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;TCP è¿˜è®¾æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš” 75 ç§’é’Ÿå‘é€ä¸€æ¬¡ã€‚è‹¥ä¸€è¿å‘é€ 10 ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;tcpæ€ä¹ˆä¿è¯å¯é æ€§&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#tcpæ€ä¹ˆä¿è¯å¯é æ€§&#34;&gt;#&lt;/a&gt; TCP æ€ä¹ˆä¿è¯å¯é æ€§&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åºåˆ—å·å’Œç¡®è®¤å·æœºåˆ¶ï¼š&lt;/strong&gt;&lt;br /&gt;
TCP å‘é€ç«¯å‘é€æ•°æ®åŒ…çš„æ—¶å€™ä¼šé€‰æ‹©åºåˆ—å·ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°æ•°æ®åŒ…åä¼šæ£€æµ‹æ•°æ®åŒ…çš„å®Œæ•´æ€§ï¼Œå¦‚æœæ£€æµ‹é€šè¿‡ä¼šå“åº”ç¡®è®¤å·è¡¨ç¤ºæ”¶åˆ°äº†æ•°æ®åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶é‡å‘æœºåˆ¶ï¼š&lt;/strong&gt;&lt;br /&gt;
å‘é€ç«¯å‘é€äº†æ•°æ®åŒ…åä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦‚æœä¸€å®šæ—¶é—´æ²¡æœ‰æ”¶åˆ°æ¥æ”¶ç«¯çš„ç¡®è®¤ï¼Œå°†ä¼šé‡æ–°å‘é€è¯¥æ•°æ®åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹ä¹±åºæ•°æ®åŒ…é‡æ–°æ’åºï¼š&lt;/strong&gt;&lt;br /&gt;
ä» IP ç½‘ç»œå±‚ä¼ è¾“åˆ° TCP å±‚çš„æ•°æ®åŒ…å¯èƒ½ä¼šä¹±åºï¼ŒTCP å±‚ä¼šå¯¹æ•°æ®åŒ…é‡æ–°æ’åºå†å‘ç»™åº”ç”¨å±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸¢å¼ƒé‡å¤æ•°æ®ï¼š&lt;/strong&gt;&lt;br /&gt;
ä» IP ç½‘ç»œå±‚ä¼ è¾“åˆ° TCP å±‚çš„æ•°æ®åŒ…å¯èƒ½ä¼šé‡å¤ï¼ŒTCP å±‚ä¼šä¸¢å¼ƒé‡å¤çš„æ•°æ®åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµé‡æ§åˆ¶ï¼š&lt;/strong&gt;&lt;br /&gt;
TCP å‘é€ç«¯å’Œæ¥æ”¶ç«¯éƒ½æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ï¼Œä¸ºäº†é˜²æ­¢å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿåº¦å¤ªå¿«å¯¼è‡´æ¥æ”¶ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå‘é€ç«¯åªèƒ½å‘é€æ¥æ”¶ç«¯å¯ä»¥æ¥çº³çš„æ•°æ®ï¼Œä¸ºäº†è¾¾åˆ°è¿™ç§æ§åˆ¶æ•ˆæœï¼ŒTCP ç”¨äº†æµé‡æ§åˆ¶åè®®ï¼ˆå¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®ï¼‰æ¥å®ç°ã€‚&lt;br /&gt;
ã€æ»‘åŠ¨çª—å£è¯¦è§£ã€‘&lt;br /&gt;
æ»‘åŠ¨çª—å£é€šä¿—æ¥è®²å°±æ˜¯ä¸€ç§æµé‡æ§åˆ¶æŠ€æœ¯ã€‚&lt;br /&gt;
å®ƒæœ¬è´¨ä¸Šæ˜¯æè¿°æ¥æ”¶æ–¹çš„ TCP æ•°æ®æŠ¥ç¼“å†²åŒºå¤§å°çš„æ•°æ®ï¼Œå‘é€æ–¹æ ¹æ®è¿™ä¸ªæ•°æ®æ¥è®¡ç®—è‡ªå·±æœ€å¤šèƒ½å‘é€å¤šé•¿çš„æ•°æ®ï¼Œå¦‚æœå‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹çš„çª—å£å¤§å°ä¸º 0 çš„è¯ï¼Œé‚£ä¹ˆå‘é€æ–¹å°†åœæ­¢å‘é€æ•°æ®ï¼Œç­‰åˆ°æ¥æ”¶æ–¹å‘é€çª—å£å¤§å°ä¸ä¸º 0 çš„æ•°æ®æŠ¥çš„åˆ°æ¥ã€‚é¦–æ¬¡å‘é€æ•°æ®æ—¶çš„çª—å£æ˜¯é“¾è·¯å¸¦å®½å†³å®šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‹¥å¡æ§åˆ¶ï¼š&lt;/strong&gt;&lt;br /&gt;
åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”±äºç½‘ç»œçŠ¶æ€çš„é—®é¢˜ï¼Œé€ æˆç½‘ç»œæ‹¥å µï¼Œæ­¤æ—¶å¼•å…¥æ‹¥å¡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨ä¿è¯ TCP å¯é æ€§çš„åŒæ—¶ï¼Œæé«˜æ€§èƒ½ï¼Œå…·ä½“ä¸ºæ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ä¸å¿«æ¢å¤â€¦â€¦&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ã€æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‘&lt;/strong&gt;&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-11/http4.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ…¢å¯åŠ¨ï¼š&lt;/strong&gt; TCP åˆšå»ºç«‹è¿æ¥ä¹‹åï¼Œä¼šä¸€ç‚¹ä¸€ç‚¹æé«˜å‘é€æ•°æ®æŠ¥çš„æ•°é‡ï¼Œå³æ¯å½“å‘é€æ–¹æ”¶åˆ°ä¸€ä¸ª ACKï¼Œå°±ä¼šå°†æ‹¥å¡çª—å£çš„å¤§å°å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›å½“å¢é•¿åˆ°æ…¢å¯åŠ¨é—¨é™ ssthresh æ—¶ï¼Œå¯åŠ¨æ‹¥å¡é¿å…ç®—æ³•&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‹¥å¡é¿å…ï¼š&lt;/strong&gt; ä¸ºäº†é¿å…æ‹¥å¡ï¼Œè¶…è¿‡æ…¢å¯åŠ¨é—¨é™åï¼Œæ‹¥å¡çª—å£çš„å¤§å°æ¯æ”¶åˆ°ä¸€ä¸ª ACKï¼ŒåŠ  1ï¼Œä¸ºçº¿æ€§å¢é•¿&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é‡ä¼ ï¼š&lt;/strong&gt; å½“å‡ºç°æ‹¥å¡çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†ä¸¢åŒ…çš„ç°è±¡ï¼Œå¿«é€Ÿé‡ä¼ ç®— *** å°†æ‹¥å¡çª—å£å˜ä¸ºåŸæ¥çš„ä¸€åŠï¼Œå¹¶ä¸”è®©æ…¢å¯åŠ¨é—¨é™å˜ä¸ºæ‹¥å¡çª—å£å¤§å°&lt;br /&gt;
å¦‚æœä¸è¿›è¡Œå¿«é€Ÿé‡ä¼ ï¼Œè¿›è¡Œè¶…æ—¶é‡ä¼ ï¼Œåˆ™æ˜¯å°†æ…¢å¯åŠ¨é—¨é™è®¾ç½®ä¸ºæ‹¥å¡çª—å£å¤§å°çš„ä¸€åŠï¼Œå¹¶ä¸”å°†æ‹¥å¡çª—å£å¤§å°ç½®ä¸º 1&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«æ¢å¤ï¼š&lt;/strong&gt; è®©æ‹¥å¡çª—å£å¤§å° +3 ï¼ˆå³ç¡®è®¤æ”¶åˆ°äº†ä¸‰ä¸ªæ•°æ®æŠ¥ï¼‰ï¼Œå¹¶æ‰§è¡Œæ‹¥å¡é¿å…çš„çº¿æ€§å¢é•¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;çŠ¶æ€ç åˆ†ç±»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#çŠ¶æ€ç åˆ†ç±»&#34;&gt;#&lt;/a&gt; çŠ¶æ€ç åˆ†ç±»&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;1XX- ä¿¡æ¯å‹ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;2XX- æˆåŠŸå‹ï¼Œè¯·æ±‚æˆåŠŸæ”¶åˆ°ï¼Œç†è§£å¹¶å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;3XX - é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;4XX - å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;5XX - æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å¸¸è§çš„çŠ¶æ€ç &#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¸¸è§çš„çŠ¶æ€ç &#34;&gt;#&lt;/a&gt; å¸¸è§çš„çŠ¶æ€ç &lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;200 OK - å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ&lt;/li&gt;
&lt;li&gt;301 - èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰è¢«æ°¸ä¹…è½¬ç§»åˆ°å…¶å®ƒ URL&lt;/li&gt;
&lt;li&gt;302 - ä¸´æ—¶è·³è½¬&lt;/li&gt;
&lt;li&gt;400 Bad Request - å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£&lt;/li&gt;
&lt;li&gt;401 Unauthorized - è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’Œ WWW- Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ï¼ˆç®€å•ç†è§£ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ ä»¤ç‰Œï¼Œç”¨æˆ·åï¼Œå¯†ç é”™è¯¯ï¼‰&lt;/li&gt;
&lt;li&gt;403 Forbidden ä»£è¡¨å®¢æˆ·ç«¯é”™è¯¯ï¼ŒæŒ‡çš„æ˜¯æœåŠ¡å™¨ç«¯æœ‰èƒ½åŠ›å¤„ç†è¯¥è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æˆæƒè®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;404 - è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯è¾“å…¥äº†é”™è¯¯çš„ URL&lt;/li&gt;
&lt;li&gt;500 - æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿäº†ä¸å¯é¢„æœŸçš„é”™è¯¯&lt;/li&gt;
&lt;li&gt;503 Server Unavailable - æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="å…«è‚¡æ–‡" scheme="https://shaogezhu.cn/tags/%E5%85%AB%E8%82%A1%E6%96%87/" />
        <category term="åŸºç¡€" scheme="https://shaogezhu.cn/tags/%E5%9F%BA%E7%A1%80/" />
        <updated>2021-11-05T14:57:49.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/11/5c2b3693deda/</id>
        <title>å½»åº•ç†è§£ è¿›ç¨‹ã€çº¿ç¨‹ã€å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/11/5c2b3693deda/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;é¢è¯•ç»å¸¸è¢«é—®åˆ°çš„é—®é¢˜ï¼Œä»Šå¤©ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ğŸ“Œ&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;è¿›ç¨‹å’Œçº¿ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿›ç¨‹å’Œçº¿ç¨‹&#34;&gt;#&lt;/a&gt; è¿›ç¨‹å’Œçº¿ç¨‹&lt;/h2&gt;
&lt;h3 id=&#34;è¿›ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿›ç¨‹&#34;&gt;#&lt;/a&gt; è¿›ç¨‹&lt;/h3&gt;
&lt;p&gt;æ•™ç§‘ä¹¦ä¸Šè§£é‡Šï¼š&lt;strong&gt;&lt;font color=&#34;blue&#34;&gt;è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘€å¯ä»¥ç†è§£ä¸ºï¼šå…ˆåŠ è½½ç¨‹åº A çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åå¼€å§‹æ‰§è¡Œ Aï¼Œä¿å­˜ç¨‹åº A çš„ä¸Šä¸‹æ–‡ï¼Œè°ƒå…¥ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ç¨‹åº B çš„ç¨‹åºä¸Šä¸‹æ–‡ï¼Œç„¶åå¼€å§‹æ‰§è¡Œ B, ä¿å­˜ç¨‹åº B çš„ä¸Šä¸‹æ–‡ã€‚è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæœ‰&lt;strong&gt;è°ƒå…¥ï¼Œæ‰§è¡Œï¼Œä¿å­˜&lt;/strong&gt;çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;çº¿ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#çº¿ç¨‹&#34;&gt;#&lt;/a&gt; çº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;æ•™ç§‘ä¹¦ä¸Šè§£é‡Šï¼š&lt;strong&gt;&lt;font color=&#34;blue&#34;&gt;çº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘€å¯ä»¥ç†è§£ä¸ºï¼šä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æ‰§è¡Œå¯èƒ½æœ‰å¤šä¸ªåˆ†æ”¯å’Œå¤šä¸ªç¨‹åºæ®µï¼Œå°±å¥½æ¯”è¦å®ç°ç¨‹åº Aï¼Œå®é™…åˆ†æˆ aï¼Œbï¼Œc ç­‰å¤šä¸ªå—ï¼›è¿™é‡Œçš„ aï¼Œbï¼Œc å°±æ˜¯çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹æ˜¯å…±äº«äº†è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå•æ ¸ä»»åŠ¡ä¸­åˆ’åˆ†æ›´ä¸ºç»†å°çš„ CPU æ—¶é—´æ®µã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«&#34;&gt;#&lt;/a&gt; è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;è¿›ç¨‹ğŸŒ´ï¼š&lt;/strong&gt; æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹ä¹‹é—´çš„å†…å­˜ç©ºé—´ä¸å…±äº«ã€‚è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æœ‰æ“ä½œç³»ç»Ÿä¼ é€’ï¼Œå¯¼è‡´é€šè®¯æ•ˆç‡ä½ï¼Œåˆ‡æ¢å¼€é”€å¤§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çº¿ç¨‹ğŸŒ´ï¼š&lt;/strong&gt; ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çº¿ç¨‹&lt;strong&gt;å…±äº«&lt;/strong&gt;è¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œé€šè®¯æ•ˆç‡é«˜ï¼Œåˆ‡æ¢å¼€é”€å°ã€‚(PSï¼šå…±äº«æ„å‘³ç€ç«äº‰ï¼Œå¯¼è‡´æ•°æ®ä¸å®‰å…¨ï¼Œä¸ºäº†ä¿æŠ¤å†…å­˜ç©ºé—´çš„æ•°æ®å®‰å…¨ï¼Œå¼•å…¥ &amp;quot;äº’æ–¥é”&amp;quot;ã€‚ä¸€ä¸ªçº¿ç¨‹åœ¨è®¿é—®å†…å­˜ç©ºé—´çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹ä¸å…è®¸è®¿é—®ï¼Œå¿…é¡»ç­‰å¾…ä¹‹å‰çš„çº¿ç¨‹è®¿é—®ç»“æŸï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå†…å­˜ç©ºé—´)&lt;/p&gt;
&lt;h2 id=&#34;å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹&#34;&gt;#&lt;/a&gt; å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹&lt;/h2&gt;
&lt;h3 id=&#34;å…±åŒç‚¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å…±åŒç‚¹&#34;&gt;#&lt;/a&gt; å…±åŒç‚¹ï¼š&lt;/h3&gt;
&lt;p&gt;ğŸ‘‰ğŸ»è¡¨ç¤ºå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹çš„è°ƒåº¦æ˜¯ç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨å®Œæˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŒºåˆ«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åŒºåˆ«&#34;&gt;#&lt;/a&gt; åŒºåˆ«ï¼š&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¯¹æ¯”ç»´åº¦&lt;/th&gt;
&lt;th&gt;å¤šè¿›ç¨‹&lt;/th&gt;
&lt;th&gt;å¤šçº¿ç¨‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®å…±äº«ã€åŒæ­¥&lt;/td&gt;
&lt;td&gt;æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨ IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•&lt;/td&gt;
&lt;td&gt;å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼Œä½†ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å¯¼è‡´åŒæ­¥å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜ã€CPU&lt;/td&gt;
&lt;td&gt;å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPU åˆ©ç”¨ç‡ä½&lt;/td&gt;
&lt;td&gt;å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPU åˆ©ç”¨ç‡é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆ›å»ºé”€æ¯ã€åˆ‡æ¢&lt;/td&gt;
&lt;td&gt;åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢&lt;/td&gt;
&lt;td&gt;åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç¼–ç¨‹ã€è°ƒè¯•&lt;/td&gt;
&lt;td&gt;ç¼–ç¨‹ç®€å•ï¼Œè°ƒè¯•ç®€å•&lt;/td&gt;
&lt;td&gt;ç¼–ç¨‹å¤æ‚ï¼Œè°ƒè¯•å¤æ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¯é æ€§&lt;/td&gt;
&lt;td&gt;è¿›ç¨‹é—´ä¸ä¼šäº’ç›¸å½±å“&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰å°†å¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚æ‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;é€šä¿¡æ–¹å¼&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#é€šä¿¡æ–¹å¼&#34;&gt;#&lt;/a&gt; é€šä¿¡æ–¹å¼&lt;/h3&gt;
&lt;h3 id=&#34;è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼&#34;&gt;#&lt;/a&gt; è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶ˆæ¯é˜Ÿåˆ—ğŸ“ï¼š&lt;/strong&gt; æ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚æ¶ˆæ¯é˜Ÿåˆ—å­˜æ”¾åœ¨å†…æ ¸ä¸­ï¼Œåªæœ‰åœ¨å†…æ ¸é‡å¯ (å³ï¼Œæ“ä½œç³»ç»Ÿé‡å¯) æˆ–è€…æ˜¾ç¤ºåœ°åˆ é™¤ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼Œè¯¥æ¶ˆæ¯é˜Ÿåˆ—æ‰ä¼šè¢«çœŸæ­£çš„åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥—æ¥å­—ğŸ“ï¼š&lt;/strong&gt; æ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP/IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿¡å·é‡ğŸ“ï¼š&lt;/strong&gt; ä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…±äº«å†…å­˜ğŸ“ï¼š&lt;/strong&gt; ä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼java&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼java&#34;&gt;#&lt;/a&gt; çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼ˆJavaï¼‰&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;volatile&lt;/strong&gt;ï¼šä¿è¯äº†çº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼Œå…¶ä¸­å¯è§æ€§å°±æ˜¯å¯ä»¥è®©çº¿ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾… / é€šçŸ¥æœºåˆ¶&lt;/strong&gt;ï¼šwait (),notify () å’Œ notifyAll ()&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;threadLocal&lt;/strong&gt; å‚è§æ–‡ç« ï¼š&lt;a href=&#34;http://shaogezhu.cn/2021/10/17f071d31a96/&#34;&gt;å½»åº•æ˜ç™½ ThreadLocal&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;åº”ç”¨åœºæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åº”ç”¨åœºæ™¯&#34;&gt;#&lt;/a&gt; åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;h3 id=&#34;å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯&#34;&gt;#&lt;/a&gt; å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;nginx ä¸»æµçš„å·¥ä½œæ¨¡å¼æ˜¯å¤šè¿›ç¨‹æ¨¡å¼ï¼ˆä¹Ÿæ”¯æŒå¤šçº¿ç¨‹æ¨¡å‹ï¼‰&lt;/li&gt;
&lt;li&gt;å‡ ä¹æ‰€æœ‰çš„ web server æœåŠ¡å™¨æœåŠ¡éƒ½æœ‰å¤šè¿›ç¨‹çš„ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹é…åˆä¸€ä¸ª worker è¿›ç¨‹ï¼Œä¾‹å¦‚ apached,httpd ç­‰ç­‰ä»¥ d ç»“å°¾çš„è¿›ç¨‹åŒ…æ‹¬ init.d æœ¬èº«å°±æ˜¯ 0 çº§æ€»è¿›ç¨‹ï¼Œæ‰€æœ‰ä½ è®¤çŸ¥çš„è¿›ç¨‹éƒ½æ˜¯å®ƒçš„å­è¿›ç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;chrome æµè§ˆå™¨ä¹Ÿæ˜¯å¤šè¿›ç¨‹æ–¹å¼ã€‚ ï¼ˆ&lt;strong&gt;åŸå› ï¼š&lt;/strong&gt; â‘ å¯èƒ½å­˜åœ¨ä¸€äº›ç½‘é¡µä¸ç¬¦åˆç¼–ç¨‹è§„èŒƒï¼Œå®¹æ˜“å´©æºƒï¼Œé‡‡ç”¨å¤šè¿›ç¨‹ä¸€ä¸ªç½‘é¡µå´©æºƒä¸ä¼šå½±å“å…¶ä»–ç½‘é¡µï¼›è€Œé‡‡ç”¨å¤šçº¿ç¨‹ä¼šã€‚â‘¡ç½‘é¡µä¹‹é—´äº’ç›¸éš”ç¦»ï¼Œä¿è¯å®‰å…¨ï¼Œä¸å¿…æ‹…å¿ƒæŸä¸ªç½‘é¡µä¸­çš„æ¶æ„ä»£ç ä¼šå–å¾—å­˜æ”¾åœ¨å…¶ä»–ç½‘é¡µä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ï¼‰&lt;/li&gt;
&lt;li&gt;redis ä¹Ÿå¯ä»¥å½’ç±»åˆ° â€œå¤šè¿›ç¨‹å•çº¿ç¨‹â€ æ¨¡å‹ï¼ˆå¹³æ—¶å·¥ä½œæ˜¯å•ä¸ªè¿›ç¨‹ï¼Œæ¶‰åŠåˆ°è€—æ—¶æ“ä½œå¦‚æŒä¹…åŒ–æˆ– aof é‡å†™æ—¶ä¼šç”¨åˆ°å¤šä¸ªè¿›ç¨‹ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯&#34;&gt;#&lt;/a&gt; å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹é—´æœ‰æ•°æ®å…±äº«ï¼Œå¹¶ä¸”æ•°æ®æ˜¯éœ€è¦ä¿®æ”¹çš„ï¼ˆä¸åŒä»»åŠ¡é—´éœ€è¦å¤§é‡å…±äº«æ•°æ®æˆ–é¢‘ç¹é€šä¿¡æ—¶ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›éå‡è´¨çš„æœåŠ¡ï¼ˆæœ‰ä¼˜å…ˆçº§ä»»åŠ¡å¤„ç†ï¼‰äº‹ä»¶å“åº”æœ‰ä¼˜å…ˆçº§ã€‚&lt;/li&gt;
&lt;li&gt;å•ä»»åŠ¡å¹¶è¡Œè®¡ç®—ï¼Œåœ¨é CPU Bound çš„åœºæ™¯ä¸‹æé«˜å“åº”é€Ÿåº¦ï¼Œé™ä½æ—¶å»¶ã€‚&lt;/li&gt;
&lt;li&gt;ä¸äººæœ‰ IO äº¤äº’çš„åº”ç”¨ï¼Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼ˆé”®ç›˜é¼ æ ‡çš„è¾“å…¥ï¼Œç«‹åˆ»å“åº”ï¼‰&lt;/li&gt;
&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;br /&gt;
æ¡Œé¢è½¯ä»¶ï¼Œå“åº”ç”¨æˆ·è¾“å…¥çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œåå°ç¨‹åºå¤„ç†æ˜¯å¦å¤–çš„çº¿ç¨‹ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¦‚ä½•é€‰&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¦‚ä½•é€‰&#34;&gt;#&lt;/a&gt; å¦‚ä½•é€‰ï¼Ÿ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„ä¼˜å…ˆç”¨çº¿ç¨‹ï¼ˆè¿›ç¨‹çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€è¿‡å¤§ï¼‰&lt;/strong&gt;&lt;br /&gt;
è¿™ç§åŸåˆ™æœ€å¸¸è§çš„åº”ç”¨å°±æ˜¯ Web æœåŠ¡å™¨äº†ï¼Œæ¥ä¸€ä¸ªè¿æ¥å»ºç«‹ä¸€ä¸ªçº¿ç¨‹ï¼Œæ–­äº†å°±é”€æ¯çº¿ç¨‹ï¼Œè¦æ˜¯ç”¨è¿›ç¨‹ï¼Œåˆ›å»ºå’Œé”€æ¯çš„ä»£ä»·æ˜¯å¾ˆéš¾æ‰¿å—çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦è¿›è¡Œå¤§é‡è®¡ç®—çš„ä¼˜å…ˆä½¿ç”¨çº¿ç¨‹ï¼ˆCPU é¢‘ç¹åˆ‡æ¢ï¼‰&lt;/strong&gt;&lt;br /&gt;
æ‰€è°“å¤§é‡è®¡ç®—ï¼Œå½“ç„¶å°±æ˜¯è¦è€—è´¹å¾ˆå¤š CPUï¼Œåˆ‡æ¢é¢‘ç¹äº†ï¼Œè¿™ç§æƒ…å†µä¸‹çº¿ç¨‹æ˜¯æœ€åˆé€‚çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éƒ½æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œç”¨ä½ æœ€ç†Ÿæ‚‰ã€æœ€æ‹¿æ‰‹çš„æ–¹å¼&lt;/strong&gt;&lt;br /&gt;
è‡³äº â€œæ•°æ®å…±äº«ã€åŒæ­¥â€ã€â€œ ç¼–ç¨‹ ã€è°ƒè¯•â€ã€â€œå¯é æ€§â€ è¿™å‡ ä¸ªç»´åº¦çš„æ‰€è°“çš„ â€œå¤æ‚ã€ç®€å•â€ åº”è¯¥æ€ä¹ˆå–èˆï¼Œåªèƒ½è¯´ï¼šæ²¡æœ‰æ˜ç¡®çš„é€‰æ‹©æ–¹æ³•ã€‚é€‰æ‹©åŸåˆ™ï¼šå¦‚æœå¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹éƒ½èƒ½å¤Ÿæ»¡è¶³è¦æ±‚ï¼Œé‚£ä¹ˆé€‰æ‹©ä½ æœ€ç†Ÿæ‚‰ã€æœ€æ‹¿æ‰‹çš„é‚£ä¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ğŸ™‡å®é™…åº”ç”¨ä¸­åŸºæœ¬ä¸Šéƒ½æ˜¯ â€œè¿›ç¨‹ + çº¿ç¨‹â€ çš„ç»“åˆæ–¹å¼ï¼Œåƒä¸‡ä¸è¦çœŸçš„é™·å…¥ä¸€ç§éæ­¤å³å½¼çš„è¯¯åŒºã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‹“å±•çŸ¥è¯†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ‹“å±•çŸ¥è¯†&#34;&gt;#&lt;/a&gt; æ‹“å±•çŸ¥è¯†&lt;/h2&gt;
&lt;h3 id=&#34;è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•&#34;&gt;#&lt;/a&gt; è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…ˆåˆ°å…ˆæœåŠ¡&lt;/strong&gt;  ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å…ˆè¿›å…¥è¯¥é˜Ÿåˆ—çš„è¿›ç¨‹ä¸ºä¹‹åˆ†é…èµ„æºï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œåˆ°å®Œæˆæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå ç”¨ CPU æ—¶å†é‡æ–°è°ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ­ä½œä¸šä¼˜å…ˆ&lt;/strong&gt; ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰å‡ºä¸€ä¸ªä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹ä¸ºä¹‹åˆ†é…èµ„æºï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œåˆ°å®Œæˆæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå ç”¨ CPU æ—¶å†é‡æ–°è°ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´ç‰‡è½®è½¬&lt;/strong&gt; æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦æ˜¯ä¸€ç§æœ€å¤è€ï¼Œæœ€ç®€å•ï¼Œæœ€å…¬å¹³ä¸”ä½¿ç”¨æœ€å¹¿çš„ç®—æ³•ï¼Œåˆç§° RR (Round robin) è°ƒåº¦ã€‚æ¯ä¸ªè¿›ç¨‹è¢«åˆ†é…ä¸€ä¸ªæ—¶é—´æ®µï¼Œç§°ä½œå®ƒçš„æ—¶é—´ç‰‡ï¼Œå³è¯¥è¿›ç¨‹å…è®¸è¿è¡Œçš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜å…ˆçº§è°ƒåº¦&lt;/strong&gt;  ä¸ºæ¯ä¸ªæµç¨‹åˆ†é…ä¼˜å…ˆçº§ï¼Œé¦–å…ˆæ‰§è¡Œå…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿›ç¨‹ä»¥ FCFS æ–¹å¼æ‰§è¡Œã€‚å¯ä»¥æ ¹æ®å†…å­˜è¦æ±‚ï¼Œæ—¶é—´è¦æ±‚æˆ–ä»»ä½•å…¶ä»–èµ„æºè¦æ±‚æ¥ç¡®å®šä¼˜å…ˆçº§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº§åé¦ˆé˜Ÿåˆ—&lt;/strong&gt; å‰é¢ä»‹ç»çš„å‡ ç§è¿›ç¨‹è°ƒåº¦çš„ç®—æ³•éƒ½æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚å¦‚çŸ­è¿›ç¨‹ä¼˜å…ˆçš„è°ƒåº¦ç®—æ³•ï¼Œä»…ç…§é¡¾äº†çŸ­è¿›ç¨‹è€Œå¿½ç•¥äº†é•¿è¿›ç¨‹ ã€‚å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•æ—¢èƒ½ä½¿é«˜ä¼˜å…ˆçº§çš„ä½œä¸šå¾—åˆ°å“åº”åˆèƒ½ä½¿çŸ­ä½œä¸šï¼ˆè¿›ç¨‹ï¼‰è¿…é€Ÿå®Œæˆã€‚ï¼Œå› è€Œå®ƒæ˜¯ç›®å‰è¢«å…¬è®¤çš„ä¸€ç§è¾ƒå¥½çš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼ŒUNIX æ“ä½œç³»ç»Ÿé‡‡å–çš„ä¾¿æ˜¯è¿™ç§è°ƒåº¦ç®—æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ€»ç»“&#34;&gt;#&lt;/a&gt; æ€»ç»“&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯”å–»â­ï¼šå¦‚æœè¯´è¿›ç¨‹æ˜¯å·¥å‚ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±æ˜¯å·¥å‚é‡Œçš„å·¥äººï¼Œè€Œå·¥äººæ˜¯è¦å¹²æ´»çš„ã€‚å·¥å‚ï¼ˆè¿›ç¨‹ï¼‰ç»™å·¥äººï¼ˆçº¿ç¨‹ï¼‰æä¾›äº†å†…å­˜ç©ºé—´ï¼Œè®©å·¥äººï¼ˆçº¿ç¨‹ï¼‰å¹²æ´»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚å› æ­¤ï¼ŒæŸç§æ„ä¹‰ä¸Šå¯ä»¥è¯´åœ¨æ”¯æŒçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„è¿›ç¨‹è°ƒåº¦ï¼Œè€Œéƒ½æ˜¯çº¿ç¨‹è°ƒåº¦ã€‚çº¿ç¨‹çš„å‡ºç°ä¸»è¦æ˜¯ä¸ºäº†å¼¥è¡¥è¿›ç¨‹å„ç§æ“ä½œå¼€é”€å¤§çš„é—®é¢˜ï¼Œé™¤è¿™ç‚¹å¤–ï¼Œçº¿ç¨‹å’Œè¿›ç¨‹æ˜¯å·®ä¸å¤šçš„ã€‚å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ä¸€æ ·ï¼Œä¸€æ–¹é¢ä¸ºäº†å……åˆ†åˆ©ç”¨ CPU èµ„æºï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·äº¤äº’ä½“éªŒã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <updated>2021-11-02T15:31:06.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/10/61a222d598ec/</id>
        <title>springäº‹åŠ¡ å¸¸è§çš„å¤±æ•ˆåœºæ™¯</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/10/61a222d598ec/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;ä½¿ç”¨ spring çš„é¡¹ç›®ï¼Œåœ¨å¤„ç†&lt;strong&gt;è½¬è´¦ã€ä»˜æ¬¾&lt;/strong&gt;ç­‰æ“ä½œçš„æ—¶å€™ï¼Œä¸ºäº†æ•°æ®èƒ½è¢«æ­£ç¡®çš„ä¿®æ”¹ï¼Œé€šå¸¸ä¼šä½¿ç”¨ spring çš„æ³¨è§£ @Transactional å¯¹äº‹åŠ¡è¿›è¡Œæ§åˆ¶ã€‚spring å¯¹äº‹ç‰©ä¹Ÿæœ‰å¤±æ•ˆçš„åœºæ™¯æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œé˜²æ­¢ä»¥åç¨‹åºå‡ºç° bugğŸ‘€&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;springäº‹åŠ¡å¤±æ•ˆåœºæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#springäº‹åŠ¡å¤±æ•ˆåœºæ™¯&#34;&gt;#&lt;/a&gt; spring äº‹åŠ¡å¤±æ•ˆåœºæ™¯&lt;/h2&gt;
&lt;h3 id=&#34;1-æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1-æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡&#34;&gt;#&lt;/a&gt; 1ã€æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡&lt;/h3&gt;
&lt;p&gt;ä»¥ MySQL ä¸ºä¾‹ğŸŒ°ï¼Œå…¶ MyISAM å¼•æ“æ˜¯ä¸æ”¯æŒäº‹åŠ¡æ“ä½œçš„ï¼ŒInnoDB æ‰æ˜¯æ”¯æŒäº‹åŠ¡çš„å¼•æ“ï¼Œä¸€èˆ¬è¦æ”¯æŒäº‹åŠ¡éƒ½ä¼šä½¿ç”¨ InnoDBã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-æ²¡æœ‰è¢«-spring-ç®¡ç†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-æ²¡æœ‰è¢«-spring-ç®¡ç†&#34;&gt;#&lt;/a&gt; 2ã€æ²¡æœ‰è¢« Spring ç®¡ç†&lt;/h3&gt;
&lt;p&gt;å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// @Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderServiceImpl&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;updateOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœæŠŠ @Service æ³¨è§£æ³¨é‡Šæ‰ï¼Œè¿™ä¸ªç±»å°±ä¸ä¼šè¢«åŠ è½½æˆä¸€ä¸ª Beanï¼Œé‚£è¿™ä¸ªç±»å°±ä¸ä¼šè¢« Spring ç®¡ç†äº†ï¼Œäº‹åŠ¡è‡ªç„¶å°±å¤±æ•ˆäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-æ–¹æ³•ä¸æ˜¯-public-çš„&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#3-æ–¹æ³•ä¸æ˜¯-public-çš„&#34;&gt;#&lt;/a&gt; 3ã€æ–¹æ³•ä¸æ˜¯ public çš„&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ¥è‡ª Spring å®˜æ–¹æ–‡æ¡£âœ¨ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;When using proxies, you should apply the @Transactional annotation only to methods with public visibility. If you do annotate protected, private or package-visible methods with the @Transactional annotation, no error is raised, but the annotated method does not exhibit the configured transactional settings. Consider the use of AspectJ (see below) if you need to annotate non-public methods.&lt;/p&gt;
&lt;p&gt;å¤§æ¦‚æ„æ€å°±æ˜¯ &lt;strong&gt;@Transactional&lt;/strong&gt; åªèƒ½ç”¨äº &lt;strong&gt;public&lt;/strong&gt; çš„æ–¹æ³•ä¸Šï¼Œå¦åˆ™äº‹åŠ¡ä¸ä¼šå¤±æ•ˆï¼Œå¦‚æœè¦ç”¨åœ¨é public æ–¹æ³•ä¸Šï¼Œå¯ä»¥å¼€å¯ AspectJ ä»£ç†æ¨¡å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;4-å¼‚å¸¸è¢«æ•è·äº†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#4-å¼‚å¸¸è¢«æ•è·äº†&#34;&gt;#&lt;/a&gt; 4ã€å¼‚å¸¸è¢«æ•è·äº†&lt;/h3&gt;
&lt;p&gt;å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderServiceImpl&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;updateOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å°†å¼‚å¸¸æ•è·äº†ï¼Œæ²¡æœ‰æŠ›å‡ºæ¥ï¼Œspring å¹¶ä¸çŸ¥é“å‘ç”Ÿäº†å¼‚å¸¸ï¼Œæ‰€ä»¥ä¸ä¼šå›æ»šã€‚&lt;/p&gt;
&lt;h3 id=&#34;5-å¼‚å¸¸ç±»å‹é”™è¯¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#5-å¼‚å¸¸ç±»å‹é”™è¯¯&#34;&gt;#&lt;/a&gt; 5ã€å¼‚å¸¸ç±»å‹é”™è¯¯&lt;/h3&gt;
&lt;p&gt;è¿˜æ˜¯ä¸Šé¢çš„åˆ—å­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderServiceImpl&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;updateOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;å‘ç”Ÿå¼‚å¸¸&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·äº‹åŠ¡ä¹Ÿæ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œå› ä¸ºé»˜è®¤å›æ»šçš„æ˜¯ï¼šRuntimeExceptionï¼Œå¦‚æœä½ æƒ³è§¦å‘å…¶ä»–å¼‚å¸¸çš„å›æ»šï¼Œéœ€è¦åœ¨æ³¨è§£ä¸Šé…ç½®ä¸€ä¸‹ï¼Œå¦‚ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;rollbackFor &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;è¿™ä¸ªé…ç½®ä»…é™äº Throwable å¼‚å¸¸ç±»åŠå…¶å­ç±»ã€‚&lt;/p&gt;
&lt;h3 id=&#34;6-ä¸æ”¯æŒäº‹åŠ¡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#6-ä¸æ”¯æŒäº‹åŠ¡&#34;&gt;#&lt;/a&gt; 6ã€ä¸æ”¯æŒäº‹åŠ¡&lt;/h3&gt;
&lt;p&gt;æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token annotation punctuation&#34;&gt;@Service&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderServiceImpl&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;OrderService&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token function&#34;&gt;updateOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;// è°ƒç”¨ä¸‹è¾¹çš„æ–¹æ³•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token annotation punctuation&#34;&gt;@Transactional&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;propagation &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Propagation&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;NOT_SUPPORTED&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;updateOrder&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Order&lt;/span&gt; order&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ğŸˆPropagation.NOT_SUPPORTEDï¼š è¡¨ç¤ºä¸ä»¥äº‹åŠ¡è¿è¡Œï¼Œå½“å‰è‹¥å­˜åœ¨äº‹åŠ¡åˆ™æŒ‚èµ·ï¼Œè¯¦ç»†çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶åœ¨ä¸‹é¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;springäº‹åŠ¡çš„7ç§ä¼ æ’­æœºåˆ¶&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#springäº‹åŠ¡çš„7ç§ä¼ æ’­æœºåˆ¶&#34;&gt;#&lt;/a&gt; spring äº‹åŠ¡çš„ 7 ç§ä¼ æ’­æœºåˆ¶&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;REQUIRED&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå½“å‰æ–¹æ³•æœ‰äº‹åŠ¡åˆ™åŠ å…¥äº‹åŠ¡ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NOT_SUPPORTED&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸æ”¯æŒäº‹åŠ¡ï¼Œå¦‚æœå½“å‰æœ‰äº‹åŠ¡åˆ™æŒ‚èµ·äº‹åŠ¡è¿è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;REQUIREDS_NEW&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ–°å»ºä¸€ä¸ªäº‹åŠ¡å¹¶åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡å°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚æ–°å»ºçš„äº‹åŠ¡çš„æäº¤ä¸å›æ»šä¸€æŒ‚èµ·äº‹åŠ¡æ²¡æœ‰è”ç³»ï¼Œä¸ä¼šå½±å“æŒ‚èµ·äº‹åŠ¡çš„æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MANDATORY&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¼ºåˆ¶å½“å‰æ–¹æ³•ä½¿ç”¨äº‹åŠ¡è¿è¡Œï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NEVER&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“å‰æ–¹æ³•ä¸èƒ½å­˜åœ¨äº‹åŠ¡ï¼Œå³éäº‹åŠ¡çŠ¶æ€è¿è¡Œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SUPPORTS&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡äº‹åŠ¡ä¹Ÿæ”¯æŒéäº‹åŠ¡çŠ¶æ€è¿è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NESTED&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚åµŒå¥—äº‹åŠ¡çš„æäº¤ä¸å›æ»šä¸çˆ¶äº‹åŠ¡æ²¡æœ‰ä»»åŠ¡å…³ç³»ï¼Œåä¹‹ï¼Œå½“çˆ¶äº‹åŠ¡æäº¤åµŒå¥—äº‹åŠ¡ä¹Ÿä¸€èµ·æäº¤ï¼Œçˆ¶äº‹åŠ¡å›æ»šä¼šä¹Ÿå›æ»šåµŒå¥—äº‹åŠ¡çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ–°å»ºä¸€ä¸ªäº‹åŠ¡è¿è¡Œï¼Œè¿™æ—¶å€™åˆ™ä¸ PROPAGATION_REQUIRED åœºæ™¯ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="spring" scheme="https://shaogezhu.cn/tags/spring/" />
        <updated>2021-10-29T14:49:32.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/10/17f071d31a96/</id>
        <title>ç»ˆäºå¼„æ˜ç™½äº†ThreadLocal</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/10/17f071d31a96/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;ğŸŒˆå†™ SpringBoot é¡¹ç›®çš„æ—¶å€™ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€ä¸ªä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ç±»å°±æ˜¯ Threadlocalï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç±»ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;threadlocalæœ‰ä»€ä¹ˆç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#threadlocalæœ‰ä»€ä¹ˆç”¨&#34;&gt;#&lt;/a&gt; Threadlocal æœ‰ä»€ä¹ˆç”¨ï¼š&lt;/h2&gt;
&lt;p&gt;ğŸ“Œç®€å•çš„è¯´å°±æ˜¯ï¼Œ&lt;font color=&#34;blue&#34;&gt;ä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„ï¼ˆæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼‰ã€‚&lt;/font&gt;å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/tl1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;threadlocalä½¿ç”¨å®ä¾‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#threadlocalä½¿ç”¨å®ä¾‹&#34;&gt;#&lt;/a&gt; ThreadLocal ä½¿ç”¨å®ä¾‹&lt;/h2&gt;
&lt;h3 id=&#34;apiä»‹ç»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#apiä»‹ç»&#34;&gt;#&lt;/a&gt; API ä»‹ç»&lt;/h3&gt;
&lt;p&gt;ğŸ¦„åœ¨ä½¿ç”¨ Threadlocal ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹ä»¥ä¸‹å®ƒçš„ APIï¼š&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-10/tl2.png&#34; alt=&#34;16314961931.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ThreadLocal ç±»çš„ API éå¸¸çš„ç®€å•ï¼Œåœ¨è¿™é‡Œæ¯”è¾ƒé‡è¦çš„å°±æ˜¯ get ()ã€set ()ã€remove (),set ç”¨äºèµ‹å€¼æ“ä½œï¼Œget ç”¨äºè·å–å˜é‡çš„å€¼ï¼Œremove å°±æ˜¯åˆ é™¤å½“å‰å˜é‡çš„å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ initialValue æ–¹æ³•ä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è¢«è§¦å‘ï¼Œç”¨äºåˆå§‹åŒ–å½“å‰å˜é‡å€¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ initialValue è¿”å›çš„æ˜¯ nullã€‚&lt;/p&gt;
&lt;h3 id=&#34;threadlocalçš„ä½¿ç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#threadlocalçš„ä½¿ç”¨&#34;&gt;#&lt;/a&gt; ThreadLocal çš„ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;ğŸ‹è¯´å®Œäº† ThreadLocal ç±»çš„ API äº†ï¼Œé‚£æˆ‘ä»¬å°±æ¥åŠ¨æ‰‹å®è·µä¸€ä¸‹äº†ï¼Œæ¥ç†è§£å‰é¢çš„é‚£å¥è¯ï¼š&lt;strong&gt;ä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„ï¼ˆæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ThreadLocalTest&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; threadLocal &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token comment&#34;&gt;// é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä¿®æ”¹ â€œçº¿ç¨‹å˜é‡â€ çš„åˆå§‹å€¼ï¼Œé»˜è®¤æ˜¯ null&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Integer&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;initialValue&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// ä¸€å·çº¿ç¨‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Runnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä¸€å·çº¿ç¨‹setå‰ï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä¸€å·çº¿ç¨‹setåï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// äºŒå·çº¿ç¨‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Runnable&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token annotation punctuation&#34;&gt;@Override&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;äºŒå·çº¿ç¨‹setå‰ï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;äºŒå·çº¿ç¨‹setåï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// ä¸»çº¿ç¨‹ç¡ 1s&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// ä¸»çº¿ç¨‹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;ä¸»çº¿ç¨‹çš„threadlocalå€¼ï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; threadLocal&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;ç¨å¾®è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼šğŸ’¡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ª ThreadLocal å®ä¾‹å°±ç±»ä¼¼äºä¸€ä¸ªå˜é‡åï¼Œä¸åŒçš„ ThreadLocal å®ä¾‹å°±æ˜¯ä¸åŒçš„å˜é‡åï¼Œå®ƒä»¬å†…éƒ¨ä¼šå­˜æœ‰ä¸€ä¸ªå€¼ï¼ˆæš‚æ—¶è¿™ä¹ˆç†è§£ï¼‰&lt;font color=&#34;violet&#34;&gt;åœ¨åé¢çš„æè¿°ä¸­æ‰€è¯´çš„ â€œ&lt;font color=&#34;blue&#34;&gt;ThreadLocal å˜é‡æˆ–è€…æ˜¯çº¿ç¨‹å˜é‡&lt;/font&gt;â€ ä»£è¡¨çš„å°±æ˜¯ ThreadLocal ç±»çš„å®ä¾‹ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç±»ä¸­åˆ›å»ºäº†ä¸€ä¸ªé™æ€çš„ &lt;strong&gt;â€œThreadLocal å˜é‡â€&lt;/strong&gt;ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œåœ¨è¿™ä¸¤ä¸ªçº¿ç¨‹ä¸­åˆ†åˆ«è®¾ç½® ThreadLocal å˜é‡ä¸º 1 å’Œ 2ã€‚ç„¶åç­‰å¾…ä¸€å·å’ŒäºŒå·çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æŸ¥çœ‹ ThreadLocal å˜é‡çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¨‹åºç»“æœåŠåˆ†æâŒ›&lt;/strong&gt;&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-10/tl3.png&#34; alt=&#34;16314972101.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç¨‹åºç»“æœé‡ç‚¹çœ‹çš„æ˜¯ä¸»çº¿ç¨‹è¾“å‡ºçš„æ˜¯ 0ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œåœ¨ä¸€å·çº¿ç¨‹å’ŒäºŒå·çº¿ç¨‹ä¸­å°†æ™®é€šå˜é‡è®¾ç½®ä¸º 1 å’Œ 2ï¼Œé‚£ä¹ˆåœ¨ä¸€äºŒå·çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ååœ¨æ‰“å°è¿™ä¸ªå˜é‡ï¼Œè¾“å‡ºçš„å€¼è‚¯å®šæ˜¯ 1 æˆ–è€… 2ï¼ˆåˆ°åº•è¾“å‡ºå“ªä¸€ä¸ªç”±æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦é€»è¾‘æœ‰å…³ï¼‰ã€‚ä½†ä½¿ç”¨ ThreadLocal å˜é‡é€šè¿‡ä¸¤ä¸ªçº¿ç¨‹èµ‹å€¼åï¼Œåœ¨ä¸»çº¿ç¨‹ç¨‹ä¸­è¾“å‡ºçš„å´æ˜¯åˆå§‹å€¼ 0ã€‚åœ¨è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ â€œä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„â€ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯ &lt;font color=&#34;red&#34;&gt;ThreadLocal çš„æ ¸å¿ƒä½œç”¨ï¼šå®ç°çº¿ç¨‹èŒƒå›´çš„å±€éƒ¨å˜é‡ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;h2 id=&#34;threadlocal-çš„æºç åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#threadlocal-çš„æºç åˆ†æ&#34;&gt;#&lt;/a&gt; Threadlocal çš„æºç åˆ†æ&lt;/h2&gt;
&lt;h3 id=&#34;åŸç†&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åŸç†&#34;&gt;#&lt;/a&gt; åŸç†&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯ä¸ª Thread å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª ThreadLocalMapï¼Œ&lt;strong&gt;å½“åˆ›å»ºä¸€ä¸ª ThreadLocal çš„æ—¶å€™ï¼Œå°±ä¼šå°†è¯¥ ThreadLocal å¯¹è±¡æ·»åŠ åˆ°è¯¥ Map ä¸­ï¼Œå…¶ä¸­é”®å°±æ˜¯ ThreadLocalï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚&lt;/strong&gt; è¿™å¥è¯åˆšçœ‹å¯èƒ½ä¸æ˜¯å¾ˆæ‡‚ï¼Œä¸‹é¢æˆ‘ä»¬ä¸€èµ·çœ‹å®Œæºç å°±æ˜ç™½äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‰é¢æˆ‘ä»¬çš„ç†è§£æ˜¯æ‰€æœ‰çš„å¸¸é‡å€¼æˆ–è€…æ˜¯å¼•ç”¨ç±»å‹çš„å¼•ç”¨éƒ½æ˜¯ä¿å­˜åœ¨ ThreadLocal å®ä¾‹ä¸­çš„ï¼Œä½†å®é™…ä¸Šä¸æ˜¯çš„ï¼Œè¿™ç§è¯´æ³•åªæ˜¯è®©æˆ‘ä»¬æ›´å¥½çš„ç†è§£ ThreadLocal å˜é‡è¿™ä¸ªæ¦‚å¿µã€‚&lt;font color = &#34;blue&#34;&gt;&lt;strong&gt;å‘ ThreadLocal å­˜å…¥ä¸€ä¸ªå€¼ï¼Œå®é™…ä¸Šæ˜¯å‘å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­çš„ ThreadLocalMap å­˜å…¥å€¼&lt;/strong&gt;&lt;/font&gt;ï¼ŒThreadLocalMap æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£æˆä¸€ä¸ª Mapï¼Œè€Œå‘è¿™ä¸ª Map å­˜å€¼çš„ key å°±æ˜¯ ThreadLocal å®ä¾‹æœ¬èº«ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æºç &#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æºç &#34;&gt;#&lt;/a&gt; æºç &lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/tl4.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ä¹Ÿå°±æ˜¯è¯´ï¼Œæƒ³è¦å­˜å…¥çš„ ThreadLocal ä¸­çš„æ•°æ®å®é™…ä¸Šå¹¶æ²¡æœ‰å­˜åˆ° ThreadLocal å¯¹è±¡ä¸­å»ï¼Œè€Œæ˜¯ä»¥&lt;strong&gt;è¿™ä¸ª ThreadLocal å®ä¾‹ä½œä¸º key å­˜åˆ°äº†å½“å‰çº¿ç¨‹ä¸­çš„ä¸€ä¸ª Map ä¸­å»äº†&lt;/strong&gt;ï¼Œè·å– ThreadLocal çš„å€¼æ—¶åŒæ ·ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ ThreadLocal å¯ä»¥å®ç°çº¿ç¨‹ä¹‹é—´éš”ç¦»çš„åŸå› äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†…éƒ¨ç±»threadlocalmap&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å†…éƒ¨ç±»threadlocalmap&#34;&gt;#&lt;/a&gt; å†…éƒ¨ç±» ThreadLocalMap&lt;/h2&gt;
&lt;p&gt;ThreadLocalMap æ˜¯ ThreadLocal çš„å†…éƒ¨ç±»ï¼Œå®ç°äº†ä¸€å¥—è‡ªå·±çš„ Map ç»“æ„âœ¨&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ThreadLocalMap å±æ€§ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;WeakReference&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token class-name&#34;&gt;Object&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; k&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Object&lt;/span&gt; v&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;k&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; v&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åˆå§‹å®¹é‡ 16&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; INITIAL_CAPACITY &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ•£åˆ—è¡¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; table&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;//entry æœ‰æ•ˆæ•°é‡ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è´Ÿè½½å› å­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; threshold&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ThreadLocalMap è®¾ç½® ThreadLocal å˜é‡&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Object&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; tab &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; table&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; len &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tab&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;length&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// ä¸è¿ç®—  &amp;amp; (len-1) è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ è¦æ±‚æ•°ç»„ len è¦æ±‚ 2 çš„ n æ¬¡å¹‚ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å› ä¸º len å‡ä¸€åæœ€åä¸€ä¸ª bit æ˜¯ 1 ä¸è¿ç®—è®¡ç®—å‡ºæ¥çš„æ•°å€¼ä¸‹æ ‡ èƒ½ä¿è¯å…¨è¦†ç›– &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦è€…æ•°ç»„æœ‰æ•ˆä½ä¼šå‡åŠ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœæ˜¯ hashmap è®¡ç®—å®Œä¸‹æ ‡å ä¼šå¢åŠ é“¾è¡¨ æˆ–çº¢é»‘æ ‘çš„æŸ¥æ‰¾è®¡ç®—é‡ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;threadLocalHashCode &lt;span class=&#34;token operator&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;len&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// ä»ä¸‹æ ‡ä½ç½®å¼€å§‹å‘åå¾ªç¯æœç´¢  ä¸ä¼šæ­»å¾ªç¯  æœ‰æ‰©å®¹å› å­ å¿…å®šæœ‰ç©ºä½™æ§½ç‚¹&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt; e &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tab&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;   e &lt;span class=&#34;token operator&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;  e &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tab&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;nextIndex&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; len&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token class-name&#34;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// ä¸€ç§æƒ…å†µ æ˜¯å½“å‰å¼•ç”¨ è¿”å›å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;k &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; key&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// æ§½ç‚¹è¢« GC æ‰ é‡è®¾çŠ¶æ€ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;k &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token function&#34;&gt;replaceStaleEntry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;			&lt;span class=&#34;token comment&#34;&gt;// æ§½ç‚¹ä¸ºç©º è®¾ç½® value&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            tab&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Entry&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;key&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½® ThreadLocal æ•°é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; sz &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;size&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;			&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;			&lt;span class=&#34;token comment&#34;&gt;// æ²¡æœ‰å¯æ¸…ç†çš„æ§½ç‚¹ å¹¶ä¸”æ•°é‡å¤§äºè´Ÿè½½å› å­ rehash&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;cleanSomeSlots&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; sz&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sz &lt;span class=&#34;token operator&#34;&gt;&gt;=&lt;/span&gt; threshold&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token function&#34;&gt;rehash&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ThreadLocalMap å±æ€§ä»‹ç»ğŸ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å’Œæ™®é€š Hashmap ç±»ä¼¼å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„å†…ï¼Œä½†ä¸ hashmap ä½¿ç”¨çš„æ‹‰é“¾æ³•è§£å†³æ•£åˆ—å†²çªä¸åŒçš„æ˜¯ ThreadLocalMap ä½¿ç”¨å¼€æ”¾åœ°å€æ³•&lt;/li&gt;
&lt;li&gt;æ•°ç»„ åˆå§‹å®¹é‡ 16ï¼Œè´Ÿè½½å› å­ 2/3&lt;/li&gt;
&lt;li&gt;node èŠ‚ç‚¹ çš„ key å°è£…äº† WeakReference ç”¨äºå›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;threadlocalmapå­˜å‚¨ä½ç½®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#threadlocalmapå­˜å‚¨ä½ç½®&#34;&gt;#&lt;/a&gt; ThreadLocalMap å­˜å‚¨ä½ç½®&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å‚¨å­˜åœ¨ Thread ä¸­ï¼Œæœ‰ä¸¤ä¸ª ThreadLocalMap å˜é‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/tl4.5.png&#34; alt=&#34;16315167211.png&#34; /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;threadLocals åœ¨ ThreadLocal å¯¹è±¡æ–¹æ³• set ä¸­å»åˆ›å»º ä¹Ÿç”± ThreadLocal æ¥ç»´æŠ¤&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;T&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt; t &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentThread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;ThreadLocalMap&lt;/span&gt; map &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;getMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;t&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;map &lt;span class=&#34;token operator&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            map&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token function&#34;&gt;createMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;t&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;createMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt; t&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;T&lt;/span&gt; firstValue&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        t&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;threadLocals &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ThreadLocalMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; firstValue&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;inheritableThreadLocals å’Œ ThreadLocal ç±»ä¼¼ InheritableThreadLocal é‡å†™äº† createMap æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;createMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt; t&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;T&lt;/span&gt; firstValue&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        t&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;inheritableThreadLocals &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;ThreadLocalMap&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; firstValue&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;inheritableThreadLocals ä½œç”¨æ˜¯å°† ThreadLocalMap ä¼ é€’ç»™å­çº¿ç¨‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/tl5.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;init æ–¹æ³•ä¸­ æ¡ä»¶æ»¡è¶³åç›´æ¥ä¸ºå­çº¿ç¨‹åˆ›å»º ThreadLocalMap&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/tl6.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»…åœ¨åˆå§‹åŒ–å­çº¿ç¨‹çš„æ—¶å€™ä¼šä¼ é€’ ä¸­é€”æ”¹å˜å‰¯çº¿ç¨‹çš„ inheritableThreadLocals å˜é‡ ä¸ä¼šå°†å½±å“ç»“æœä¼ é€’åˆ°å­çº¿ç¨‹ ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨çº¿ç¨‹æ± è¦æ³¨æ„ çº¿ç¨‹ä¸å›æ”¶ å°½é‡é¿å…ä½¿ç”¨çˆ¶çº¿ç¨‹çš„ inheritableThreadLocals å¯¼è‡´é”™è¯¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;keyçš„å¼±å¼•ç”¨é—®é¢˜&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#keyçš„å¼±å¼•ç”¨é—®é¢˜&#34;&gt;#&lt;/a&gt; Key çš„å¼±å¼•ç”¨é—®é¢˜&lt;/h2&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦ç”¨å¼±å¼•ç”¨ï¼Œå®˜æ–¹æ˜¯è¿™æ ·å›ç­”çš„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;To help deal with very large and long-lived usages, the hash table entries use WeakReferences for keys.&lt;br /&gt;
 ä¸ºäº†å¤„ç†éå¸¸å¤§å’Œç”Ÿå‘½å‘¨æœŸéå¸¸é•¿çš„çº¿ç¨‹ï¼Œå“ˆå¸Œè¡¨ä½¿ç”¨å¼±å¼•ç”¨ä½œä¸º keyã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”Ÿå‘½å‘¨æœŸé•¿çš„çº¿ç¨‹å¯ä»¥ç†è§£ä¸ºï¼šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹&lt;/p&gt;
&lt;p&gt;ThreadLocal åœ¨æ²¡æœ‰å¤–éƒ¨å¯¹è±¡å¼ºå¼•ç”¨æ—¶å¦‚ Threadï¼Œå‘ç”Ÿ GC æ—¶å¼±å¼•ç”¨ Key ä¼šè¢«å›æ”¶ï¼Œè€Œ Value æ˜¯å¼ºå¼•ç”¨ä¸ä¼šå›æ”¶ï¼Œå¦‚æœåˆ›å»º ThreadLocal çš„çº¿ç¨‹ä¸€ç›´æŒç»­è¿è¡Œå¦‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ª Entry å¯¹è±¡ä¸­çš„ value å°±æœ‰å¯èƒ½ä¸€ç›´å¾—ä¸åˆ°å›æ”¶ï¼Œå‘ç”Ÿå†…å­˜æ³„éœ²ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;key ä½¿ç”¨å¼ºå¼•ç”¨ğŸŒ´ï¼š&lt;/strong&gt; å¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œä½†æ˜¯ ThreadLocalMap è¿˜æŒæœ‰ ThreadLocal çš„å¼ºå¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¸ä¼šè¢«å›æ”¶ï¼Œå¯¼è‡´ Entry å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;key ä½¿ç”¨å¼±å¼•ç”¨ğŸŒ´ï¼š&lt;/strong&gt; å¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œç”±äº ThreadLocalMap æŒæœ‰ ThreadLocal çš„å¼±å¼•ç”¨ï¼Œå³ä½¿æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¹Ÿä¼šè¢«å›æ”¶ã€‚value åœ¨ä¸‹ä¸€æ¬¡ ThreadLocalMap è°ƒç”¨ set,getï¼Œremove çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Java8 ä¸­å·²ç»åšäº†ä¸€äº›ä¼˜åŒ–å¦‚ï¼Œåœ¨ ThreadLocal çš„ get ()ã€set ()ã€remove () æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ä¼šæ¸…é™¤æ‰çº¿ç¨‹ ThreadLocalMap ä¸­æ‰€æœ‰ Entry ä¸­ Key ä¸º null çš„ Valueï¼Œå¹¶å°†æ•´ä¸ª Entry è®¾ç½®ä¸º nullï¼Œåˆ©äºä¸‹æ¬¡å†…å­˜å›æ”¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;javaä¸­çš„å››ç§å¼•ç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#javaä¸­çš„å››ç§å¼•ç”¨&#34;&gt;#&lt;/a&gt; java ä¸­çš„å››ç§å¼•ç”¨&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼ºå¼•ç”¨ğŸ“ï¼š&lt;/strong&gt; å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œå®ƒå°±ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚å³ä½¿å½“å‰å†…å­˜ç©ºé—´ä¸è¶³ï¼ŒJVM ä¹Ÿä¸ä¼šå›æ”¶å®ƒï¼Œè€Œæ˜¯æŠ›å‡º OutOfMemoryError é”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ã€‚å¦‚æœæƒ³ä¸­æ–­å¼ºå¼•ç”¨å’ŒæŸä¸ªå¯¹è±¡ä¹‹é—´çš„å…³è”ï¼Œå¯ä»¥æ˜¾å¼åœ°å°†å¼•ç”¨èµ‹å€¼ä¸º nullï¼Œè¿™æ ·ä¸€æ¥çš„è¯ï¼ŒJVM åœ¨åˆé€‚çš„æ—¶é—´å°±ä¼šå›æ”¶è¯¥å¯¹è±¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯å¼•ç”¨ğŸ“ï¼š&lt;/strong&gt; åœ¨ä½¿ç”¨è½¯å¼•ç”¨æ—¶ï¼Œå¦‚æœå†…å­˜çš„ç©ºé—´è¶³å¤Ÿï¼Œè½¯å¼•ç”¨å°±èƒ½ç»§ç»­è¢«ä½¿ç”¨ï¼Œè€Œä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œè½¯å¼•ç”¨æ‰ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ï¼ˆè½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ï¼Œæ¯”å¦‚ç½‘é¡µç¼“å­˜ã€å›¾ç‰‡ç¼“å­˜ç­‰ã€‚ä½¿ç”¨è½¯å¼•ç”¨èƒ½é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œå¢å¼ºç¨‹åºçš„å¥å£®æ€§ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼±å¼•ç”¨ğŸ“ï¼š&lt;/strong&gt; å…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰çš„ç”Ÿå‘½å‘¨æœŸæ›´çŸ­æš‚ã€‚å› ä¸ºå½“ JVM è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸€æ—¦å‘ç°å¼±å¼•ç”¨å¯¹è±¡ï¼Œæ— è®ºå½“å‰å†…å­˜ç©ºé—´æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå°†å¼±å¼•ç”¨å›æ”¶ã€‚ä¸è¿‡ç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½çš„çº¿ç¨‹ï¼Œæ‰€ä»¥å¹¶ä¸ä¸€å®šèƒ½è¿…é€Ÿå‘ç°å¼±å¼•ç”¨å¯¹è±¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šå¼•ç”¨ğŸ“ï¼š&lt;/strong&gt; è™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚è™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ï¼ˆæ³¨æ„å“¦ï¼Œå…¶å®ƒå¼•ç”¨æ˜¯è¢« JVM å›æ”¶åæ‰è¢«ä¼ å…¥ ReferenceQueue ä¸­çš„ã€‚ç”±äºè¿™ä¸ªæœºåˆ¶ï¼Œæ‰€ä»¥è™šå¼•ç”¨å¤§å¤šè¢«ç”¨äºå¼•ç”¨é”€æ¯å‰çš„å¤„ç†å·¥ä½œã€‚å¯ä»¥ä½¿ç”¨åœ¨å¯¹è±¡é”€æ¯å‰çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚è¯´èµ„æºé‡Šæ”¾ç­‰ã€‚ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šå¸¸ ThreadLocalMap çš„ç”Ÿå‘½å‘¨æœŸè·Ÿ Threadï¼ˆæ³¨æ„çº¿ç¨‹æ± ä¸­çš„ Threadï¼‰ä¸€æ ·é•¿ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤å¯¹åº” keyï¼ˆçº¿ç¨‹ä½¿ç”¨ç»“æŸå½’è¿˜ç»™çº¿ç¨‹æ± äº†ï¼Œå…¶ä¸­çš„ KV ä¸å†è¢«ä½¿ç”¨ä½†åˆä¸ä¼š GC å›æ”¶ï¼Œå¯è®¤ä¸ºæ˜¯å†…å­˜æ³„æ¼ï¼‰ï¼Œä¸€å®šä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œä½†æ˜¯ä½¿ç”¨å¼±å¼•ç”¨å¯ä»¥å¤šä¸€å±‚ä¿éšœï¼šå¼±å¼•ç”¨ ThreadLocal ä¼šè¢« GC å›æ”¶ï¼Œä¸ä¼šå†…å­˜æ³„æ¼ï¼Œå¯¹åº”çš„ value åœ¨ä¸‹ä¸€æ¬¡ ThreadLocalMap è°ƒç”¨ set,get,remove çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ï¼ŒJava8 å·²ç»åšäº†ä¸Šé¢çš„ä»£ç ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ€»ç»“&#34;&gt;#&lt;/a&gt; æ€»ç»“ï¼š&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ThreadLocal çš„ä½œç”¨ï¼š&lt;/strong&gt; å®ç°çº¿ç¨‹èŒƒå›´å†…çš„å±€éƒ¨å˜é‡ï¼Œå³ ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´æ˜¯éš”ç¦»çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ThreadLocal çš„åŸç†ï¼š&lt;/strong&gt; ThreadLocal å­˜å…¥å€¼æ—¶&lt;font color=&#34;red&#34;&gt;ä½¿ç”¨å½“å‰ ThreadLocal å®ä¾‹ä½œä¸º keyï¼ˆå¹¶ä¸æ˜¯ä»¥å½“å‰çº¿ç¨‹å¯¹è±¡ä½œä¸º keyï¼‰&lt;/font&gt;ï¼Œå­˜å…¥å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­çš„ Map ä¸­å»ã€‚æœ€å¼€å§‹åœ¨çœ‹æºç ä¹‹å‰ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä»¥å½“å‰çº¿ç¨‹å¯¹è±¡ä½œä¸º key å°†å¯¹è±¡å­˜å…¥åˆ° ThreadLocal ä¸­çš„ Map ä¸­å»....&lt;/p&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <updated>2021-10-23T03:11:55.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/10/95416e47530f/</id>
        <title>å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/10/95416e47530f/"/>
        <content type="html">&lt;h2 id=&#34;å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»&#34;&gt;#&lt;/a&gt; å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å†…å­˜æº¢å‡ºï¼š&lt;/strong&gt;ï¼ˆout of memoryï¼‰ï¼Œç®€å•è¯´å°±æ˜¯å†…å­˜ä¸å¤Ÿåˆ†äº†ï¼ŒæŒ‡ç¨‹åºè¦æ±‚çš„å†…å­˜è¶…å‡ºäº†ç³»ç»Ÿæ‰€èƒ½åˆ†é…çš„èŒƒå›´ï¼Œå‡ºç° OOMï¼›æ¯”å¦‚ç”³è¯·ä¸€ä¸ª int ç±»å‹ï¼Œä½†ç»™äº†å®ƒä¸€ä¸ª int æ‰èƒ½å­˜æ”¾çš„æ•°ï¼Œå°±ä¼šå‡ºç°å†…å­˜æº¢å‡ºï¼Œæˆ–è€…æ˜¯åˆ›å»ºä¸€ä¸ªå¤§çš„å¯¹è±¡ï¼Œè€Œå †å†…å­˜æ”¾ä¸ä¸‹è¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯å†…å­˜æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å†…å­˜æ³„æ¼ï¼š&lt;/strong&gt;ï¼ˆMemory Leakï¼‰ï¼Œæ˜¯æŒ‡ç¨‹åºåœ¨ç”³è¯·å†…å­˜åï¼Œæ— æ³•é‡Šæ”¾å·²ç”³è¯·çš„å†…å­˜ç©ºé—´ &lt;strong&gt;(æŒ‡åˆ†é…å‡ºå»çš„å†…å­˜æ— æ³•è¢« gc å›æ”¶)&lt;/strong&gt;ã€‚ä¸€æ¬¡å†…å­˜æ³„éœ²å±å®³å¯ä»¥å¿½ç•¥ï¼Œä½†å†…å­˜æ³„éœ²å †ç§¯åæœå¾ˆä¸¥é‡ï¼Œæ— è®ºå¤šå°‘å†…å­˜ï¼Œè¿Ÿæ—©ä¼šè¢«å å…‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å› æ­¤ï¼Œä»ä¸Šé¢ä¹Ÿå¯ä»¥æ¨æ–­å‡ºå†…å­˜æ³„éœ²å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;äºŒè€…çš„å…³ç³»ï¼šğŸ¥‚&lt;br /&gt;
å†…å­˜æº¢å‡ºä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå†…å­˜æ³„éœ²ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¤§å¤šæ•°æ—¶å€™ç¨‹åºçœ‹èµ·æ¥æ˜¯æ­£å¸¸è¿è¡Œçš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ&#34;&gt;#&lt;/a&gt; å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;åˆ†æå †å†…å­˜æº¢å‡ºçš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼šğŸŒ´&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨äº†å¤§é‡çš„é€’å½’æˆ–æ— é™é€’å½’ï¼ˆé€’å½’ä¸­ç”¨åˆ°äº†å¤§é‡çš„æ–°å»ºçš„å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨äº†å¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯ï¼ˆå¾ªç¯ä¸­ç”¨åˆ°äº†å¤§é‡çš„æ–°å»ºçš„å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;li&gt;ç±»ä¸­å’Œå¼•ç”¨å˜é‡è¿‡å¤šä½¿ç”¨äº† Static ä¿®é¥° å¦‚ public staitc Student sï¼›åœ¨ç±»ä¸­çš„å±æ€§ä¸­ä½¿ç”¨ static ä¿®é¥°çš„æœ€å¥½åªç”¨åŸºæœ¬ç±»å‹æˆ–å­—ç¬¦ä¸²ã€‚å¦‚ public static int i = 0; //public static String str;&lt;/li&gt;
&lt;li&gt;æ•°ç»„ï¼ŒListï¼ŒMap ä¸­å­˜æ”¾çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨è€Œä¸æ˜¯å¯¹è±¡ï¼Œå› ä¸ºè¿™äº›å¼•ç”¨ä¼šè®©å¯¹åº”çš„å¯¹è±¡ä¸èƒ½è¢«é‡Šæ”¾ï¼Œä¼šå¤§é‡å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;åˆ†ææ ˆå†…å­˜æº¢å‡ºçš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼šğŸŒ´&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨äº†å¤§é‡çš„é€’å½’æˆ–æ— é™é€’å½’&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨äº†å¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯ï¼ˆå¦‚å¾ªç¯ä¸­ä¸åœè°ƒç”¨æ–¹æ³•ï¼‰&lt;/li&gt;
&lt;li&gt;listï¼Œmapï¼Œæ•°ç»„ç­‰é•¿åº¦è¿‡å¤§ç­‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ&#34;&gt;#&lt;/a&gt; å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¿®æ”¹ JVM å¯åŠ¨å‚æ•° (-Xmsï¼Œ-Xmx)ï¼Œç›´æ¥å¢åŠ è™šæ‹Ÿæœºå†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥é”™è¯¯æ—¥å¿—ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å†…å­˜æŸ¥çœ‹å·¥å…·æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ (å¦‚ jconsole)&lt;/li&gt;
&lt;li&gt;å¯¹ä»£ç è¿›è¡Œä»”ç»†åˆ†æï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿå†…å­˜æº¢å‡ºçš„ä½ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;è¯¦ç»†æ’æŸ¥æ–¹æ¡ˆå¦‚ä¸‹:ğŸˆ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥åœ¨æ•°æ®åº“ä¸­å–çš„æ•°æ®é‡æ˜¯å¦è¶…è¿‡å†…å­˜&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥æ˜¯å¦æœ‰è¿‡å¤§çš„é›†åˆæˆ–å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥æ˜¯æ­»å¾ªç¯æˆ–é€’å½’æ˜¯å¦ä¼šå¯¼è‡´æº¢å‡º&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡å¯¹è±¡çš„åˆ›å»ºæ˜¯å¦ä¼šå‡ºç°å†…å­˜é—®é¢˜&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡çš„è¿æ¥å¯¹è±¡æˆ–ç›‘å¬å™¨ç­‰æœªå…³é—­&lt;br /&gt;
......&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²&#34;&gt;#&lt;/a&gt; åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å°½é‡å°‘ä½¿ç”¨æšä¸¾&lt;/li&gt;
&lt;li&gt;å°½é‡ä½¿ç”¨é™æ€å†…éƒ¨ç±»è€Œä¸æ˜¯å†…éƒ¨ç±»&lt;/li&gt;
&lt;li&gt;å°½é‡ä½¿ç”¨è½»é‡çº§çš„æ•°æ®ç»“æ„&lt;/li&gt;
&lt;li&gt;å…»æˆå…³é—­è¿æ¥å’Œæ³¨é”€ç›‘å¬å™¨çš„ä¹ æƒ¯&lt;/li&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨ static å…³é”®å­—&lt;/li&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨å•ä¾‹æ¨¡å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ğŸš€ğŸš€ğŸš€&lt;br /&gt;
&lt;br&gt;&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <updated>2021-10-19T15:30:09.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/10/4eb7eccc7c2a/</id>
        <title>Redis å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/10/4eb7eccc7c2a/"/>
        <content type="html">&lt;div class=&#34;note primary&#34;&gt;
&lt;p&gt;Redis æ˜¯é¢è¯•ä¸­çš„æœ€ç»å¸¸é—®åˆ°çš„æ•°æ®åº“ä¹‹ä¸€ï¼Œåœ¨æ—¥å¸¸é¡¹ç›®ä¸­æˆ‘ä»¬ä¸ºäº†å¿«é€Ÿè®¿é—®åˆ°ä¸€äº›æ•°æ®ï¼Œé¦–å…ˆæƒ³åˆ°çš„è‚¯å®šå°±æ˜¯ Redis äº†ã€‚ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹ Redis çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä»¥åä½¿ç”¨ğŸ‘©&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;redis-å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#redis-å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ&#34;&gt;#&lt;/a&gt; Redis å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;redis æ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œä¸åŒçš„åœºæ™¯ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹å¯ä»¥æœ‰æ•ˆçš„ä¼˜åŒ–å†…å­˜æ•°æ®çš„å­˜æ”¾ç©ºé—´ï¼šğŸŒ´ğŸŒ´&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;stringï¼š&lt;/strong&gt; æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼ŒäºŒè¿›åˆ¶å®‰å…¨çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§ 512Mã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;listï¼š&lt;/strong&gt; æŒ‰ç…§æ·»åŠ é¡ºåºä¿æŒé¡ºåºçš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hashï¼š&lt;/strong&gt; key-value å¯¹çš„ä¸€ç§é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;setï¼š&lt;/strong&gt; æ— åºçš„å­—ç¬¦ä¸²é›†åˆï¼Œä¸å­˜åœ¨é‡å¤çš„å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sorted setï¼š&lt;/strong&gt; å·²æ’åºçš„å­—ç¬¦ä¸²é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bitmapï¼š&lt;/strong&gt; æ›´ç»†åŒ–çš„ä¸€ç§æ“ä½œï¼Œä»¥ bit ä¸ºå•ä½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hyperloglogï¼š&lt;/strong&gt; åŸºäºæ¦‚ç‡çš„æ•°æ®ç»“æ„ã€‚ # 2.8.9 æ–°å¢&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Geo:&lt;/strong&gt;  åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œ å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œ   # 3.2 æ–°å¢&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµï¼ˆStreamï¼‰&lt;/strong&gt; # 5.0 æ–°å¢&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;h4 id=&#34;string&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#string&#34;&gt;#&lt;/a&gt; String&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç» ï¼š&lt;/strong&gt; string æ•°æ®ç»“æ„æ˜¯ç®€å•çš„ key-value ç±»å‹ã€‚è™½ç„¶ Redis æ˜¯ç”¨ C è¯­è¨€å†™çš„ï¼Œä½†æ˜¯ Redis å¹¶æ²¡æœ‰ä½¿ç”¨ C çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè€Œæ˜¯è‡ªå·±æ„å»ºäº†ä¸€ç§ &lt;strong&gt;&lt;span class=&#34;blue&#34;&gt;ç®€å•åŠ¨æ€å­—ç¬¦ä¸²&lt;/span&gt;&lt;/strong&gt; (simple dynamic stringï¼Œ&lt;strong&gt;SDS&lt;/strong&gt;)ã€‚ç›¸æ¯”äº C çš„åŸç”Ÿå­—ç¬¦ä¸²ï¼ŒRedis çš„ SDS ä¸å…‰å¯ä»¥ä¿å­˜æ–‡æœ¬æ•°æ®è¿˜å¯ä»¥ä¿å­˜äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶ä¸”è·å–å­—ç¬¦ä¸²é•¿åº¦å¤æ‚åº¦ä¸º O (1)ï¼ˆC å­—ç¬¦ä¸²ä¸º O (N)ï¼‰, é™¤æ­¤ä¹‹å¤–ï¼ŒRedis çš„ SDS API æ˜¯å®‰å…¨çš„ï¼Œä¸ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ï¼š&lt;/strong&gt; set,get,strlen,exists,decr,incr,setex ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ï¼š&lt;/strong&gt; ä¸€èˆ¬å¸¸ç”¨åœ¨éœ€è¦è®¡æ•°çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„è®¿é—®æ¬¡æ•°ã€çƒ­ç‚¹æ–‡ç« çš„ç‚¹èµè½¬å‘æ•°é‡ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ˜&lt;br /&gt;
&lt;strong&gt;æ™®é€šå­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; &lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; key value &lt;span class=&#34;token comment&#34;&gt;#è®¾ç½® key-value ç±»å‹çš„å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;OK&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; get key &lt;span class=&#34;token comment&#34;&gt;# æ ¹æ® key è·å¾—å¯¹åº”çš„ value&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;value&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; exists key  &lt;span class=&#34;token comment&#34;&gt;# åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; strlen key &lt;span class=&#34;token comment&#34;&gt;# è¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; del key &lt;span class=&#34;token comment&#34;&gt;# åˆ é™¤æŸä¸ª key å¯¹åº”çš„å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; get key&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nil&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;æ‰¹é‡è®¾ç½® :&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; mset key1 value1 key2 value2 &lt;span class=&#34;token comment&#34;&gt;# æ‰¹é‡è®¾ç½® key-value ç±»å‹çš„å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;OK&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; mget key1 key2 &lt;span class=&#34;token comment&#34;&gt;# æ‰¹é‡è·å–å¤šä¸ª key å¯¹åº”çš„ value&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è®¡æ•°å™¨ï¼ˆå­—ç¬¦ä¸²çš„å†…å®¹ä¸ºæ•´æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ï¼‰ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; &lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; number &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;OK&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; incr number &lt;span class=&#34;token comment&#34;&gt;# å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; get number&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; decr number &lt;span class=&#34;token comment&#34;&gt;# å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; get number&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è¿‡æœŸï¼ˆé»˜è®¤ä¸ºæ°¸ä¸è¿‡æœŸï¼‰ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; expire key  &lt;span class=&#34;token number&#34;&gt;60&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æ•°æ®åœ¨ 60s åè¿‡æœŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setex key &lt;span class=&#34;token number&#34;&gt;60&lt;/span&gt; value &lt;span class=&#34;token comment&#34;&gt;# æ•°æ®åœ¨ 60s åè¿‡æœŸ (setex:[set] + [ex] pire)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;OK&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ttl key &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹æ•°æ®è¿˜æœ‰å¤šä¹…è¿‡æœŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;56&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;list&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#list&#34;&gt;#&lt;/a&gt; List&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç» ï¼š&lt;/strong&gt; list å³æ˜¯ &lt;strong&gt;é“¾è¡¨&lt;/strong&gt;ã€‚é“¾è¡¨æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œç‰¹ç‚¹æ˜¯æ˜“äºæ•°æ®å…ƒç´ çš„æ’å…¥å’Œåˆ é™¤å¹¶ä¸”å¯ä»¥çµæ´»è°ƒæ•´é“¾è¡¨é•¿åº¦ï¼Œä½†æ˜¯é“¾è¡¨çš„éšæœºè®¿é—®å›°éš¾ã€‚è®¸å¤šé«˜çº§ç¼–ç¨‹è¯­è¨€éƒ½å†…ç½®äº†é“¾è¡¨çš„å®ç°æ¯”å¦‚ Java ä¸­çš„ LinkedListï¼Œä½†æ˜¯ C è¯­è¨€å¹¶æ²¡æœ‰å®ç°é“¾è¡¨ï¼Œæ‰€ä»¥ Redis å®ç°äº†è‡ªå·±çš„é“¾è¡¨æ•°æ®ç»“æ„ã€‚Redis çš„ list çš„å®ç°ä¸ºä¸€ä¸ª &lt;strong&gt;&lt;span class=&#34;orange&#34;&gt;åŒå‘é“¾è¡¨&lt;/span&gt;&lt;/strong&gt;ï¼Œå³å¯ä»¥æ”¯æŒåå‘æŸ¥æ‰¾å’Œéå†ï¼Œæ›´æ–¹ä¾¿æ“ä½œï¼Œä¸è¿‡å¸¦æ¥äº†éƒ¨åˆ†é¢å¤–çš„å†…å­˜å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤:&lt;/strong&gt; rpush,lpop,lpush,rpop,lrange,llen ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯:&lt;/strong&gt; å‘å¸ƒä¸è®¢é˜…æˆ–è€…è¯´æ¶ˆæ¯é˜Ÿåˆ—ã€æ…¢æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ¬&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ rpush/lpop å®ç°é˜Ÿåˆ—ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; rpush myList value1 &lt;span class=&#34;token comment&#34;&gt;# å‘ list çš„å¤´éƒ¨ï¼ˆå³è¾¹ï¼‰æ·»åŠ å…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; rpush myList value2 value3 &lt;span class=&#34;token comment&#34;&gt;# å‘ list çš„å¤´éƒ¨ï¼ˆæœ€å³è¾¹ï¼‰æ·»åŠ å¤šä¸ªå…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; lpop myList &lt;span class=&#34;token comment&#34;&gt;# å°† list çš„å°¾éƒ¨ (æœ€å·¦è¾¹) å…ƒç´ å–å‡º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; lrange myList &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡çš„ list åˆ—è¡¨ï¼Œ 0 ä¸º start,1 ä¸º end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; lrange myList &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; -1 &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œ-1 è¡¨ç¤ºå€’æ•°ç¬¬ä¸€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;é€šè¿‡ rpush/rpop å®ç°æ ˆï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; rpush myList2 value1 value2 value3&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; rpop myList2 &lt;span class=&#34;token comment&#34;&gt;# å°† list çš„å¤´éƒ¨ (æœ€å³è¾¹) å…ƒç´ å–å‡º&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä¸‹è¾¹å›¾æ–¹ä¾¿å¤§å®¶ç†è§£ï¼š&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-10/r1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ lrange æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡èŒƒå›´çš„åˆ—è¡¨å…ƒç´ ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; rpush myList value1 value2 value3&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; lrange myList &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡çš„ list åˆ—è¡¨ï¼Œ 0 ä¸º start,1 ä¸º end&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; lrange myList &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; -1 &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œ-1 è¡¨ç¤ºå€’æ•°ç¬¬ä¸€&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é€šè¿‡ lrange å‘½ä»¤ï¼Œä½ å¯ä»¥åŸºäº list å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œæ€§èƒ½éå¸¸é«˜ï¼&lt;br /&gt;
&lt;strong&gt;é€šè¿‡ llen æŸ¥çœ‹é“¾è¡¨é•¿åº¦ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; llen myList&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;hash&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hash&#34;&gt;#&lt;/a&gt; Hash&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç» ï¼š&lt;/strong&gt; hash ç±»ä¼¼äº JDK1.8 å‰çš„ HashMapï¼Œå†…éƒ¨å®ç°ä¹Ÿå·®ä¸å¤š (æ•°ç»„ + é“¾è¡¨)ã€‚ä¸è¿‡ï¼ŒRedis çš„ hash åšäº†æ›´å¤šä¼˜åŒ–ã€‚å¦å¤–ï¼Œhash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œ&lt;strong&gt;&lt;span class=&#34;pink&#34;&gt;ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡&lt;/span&gt;&lt;/strong&gt;ï¼Œåç»­æ“ä½œçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥ä»…ä»…ä¿®æ”¹è¿™ä¸ªå¯¹è±¡ä¸­çš„æŸä¸ªå­—æ®µçš„å€¼ã€‚ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ hash æ•°æ®ç»“æ„æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œå•†å“ä¿¡æ¯ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ï¼š&lt;/strong&gt; hset,hmset,hexists,hget,hgetall,hkeys,hvals ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ï¼š&lt;/strong&gt;  ç³»ç»Ÿä¸­å¯¹è±¡æ•°æ®çš„å­˜å‚¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸˆ&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hmset userInfoKey name &lt;span class=&#34;token string&#34;&gt;&#34;guide&#34;&lt;/span&gt; description &lt;span class=&#34;token string&#34;&gt;&#34;dev&#34;&lt;/span&gt; age &lt;span class=&#34;token string&#34;&gt;&#34;24&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;OK&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hexists userInfoKey name &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹ key å¯¹åº”çš„ value ä¸­æŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hget userInfoKey name &lt;span class=&#34;token comment&#34;&gt;# è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;guide&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hget userInfoKey age&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;24&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hgetall userInfoKey &lt;span class=&#34;token comment&#34;&gt;# è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š key çš„æ‰€æœ‰å­—æ®µå’Œå€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;name&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;guide&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;description&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;dev&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;age&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;24&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hkeys userInfoKey &lt;span class=&#34;token comment&#34;&gt;# è·å– key åˆ—è¡¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;name&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;description&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;age&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hvals userInfoKey &lt;span class=&#34;token comment&#34;&gt;# è·å– value åˆ—è¡¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;guide&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;dev&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;24&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hset userInfoKey name &lt;span class=&#34;token string&#34;&gt;&#34;GuideGeGe&#34;&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# ä¿®æ”¹æŸä¸ªå­—æ®µå¯¹åº”çš„å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; hget userInfoKey name&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;GuideGeGe&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;set&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#set&#34;&gt;#&lt;/a&gt; Set&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç» ï¼š&lt;/strong&gt; set ç±»ä¼¼äº Java ä¸­çš„ HashSet ã€‚Redis ä¸­çš„ set ç±»å‹æ˜¯ä¸€ç§æ— åºé›†åˆï¼Œé›†åˆä¸­çš„å…ƒç´ æ²¡æœ‰å…ˆåé¡ºåºã€‚å½“ä½ éœ€è¦å­˜å‚¨ä¸€ä¸ªåˆ—è¡¨æ•°æ®ï¼Œåˆä¸å¸Œæœ›å‡ºç°é‡å¤æ•°æ®æ—¶ï¼Œset æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå¹¶ä¸” set æä¾›äº†åˆ¤æ–­æŸä¸ªæˆå‘˜æ˜¯å¦åœ¨ä¸€ä¸ª set é›†åˆå†…çš„é‡è¦æ¥å£ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ list æ‰€ä¸èƒ½æä¾›çš„ã€‚å¯ä»¥åŸºäº set è½»æ˜“å®ç°äº¤é›†ã€å¹¶é›†ã€å·®é›†çš„æ“ä½œã€‚æ¯”å¦‚ï¼šä½ å¯ä»¥å°†ä¸€ä¸ªç”¨æˆ·æ‰€æœ‰çš„å…³æ³¨äººå­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œå°†å…¶æ‰€æœ‰ç²‰ä¸å­˜åœ¨ä¸€ä¸ªé›†åˆã€‚Redis å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®ç°å¦‚å…±åŒå…³æ³¨ã€å…±åŒç²‰ä¸ã€å…±åŒå–œå¥½ç­‰åŠŸèƒ½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå°±æ˜¯æ±‚äº¤é›†çš„è¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ï¼š&lt;/strong&gt; sadd,spop,smembers,sismember,scard,sinterstore,sunion ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯:&lt;/strong&gt; éœ€è¦å­˜æ”¾çš„æ•°æ®ä¸èƒ½é‡å¤ä»¥åŠéœ€è¦è·å–å¤šä¸ªæ•°æ®æºäº¤é›†å’Œå¹¶é›†ç­‰åœºæ™¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ™‡&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; sadd mySet value1 value2 &lt;span class=&#34;token comment&#34;&gt;# æ·»åŠ å…ƒç´ è¿›å»&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; sadd mySet value1 &lt;span class=&#34;token comment&#34;&gt;# ä¸å…è®¸æœ‰é‡å¤å…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; smembers mySet &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹ set ä¸­æ‰€æœ‰çš„å…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; scard mySet &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹ set çš„é•¿åº¦&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; sismember mySet value1 &lt;span class=&#34;token comment&#34;&gt;# æ£€æŸ¥æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ set ä¸­ï¼Œåªèƒ½æ¥æ”¶å•ä¸ªå…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; sadd mySet2 value2 value3&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; sinterstore mySet3 mySet mySet2 &lt;span class=&#34;token comment&#34;&gt;# è·å– mySet å’Œ mySet2 çš„äº¤é›†å¹¶å­˜æ”¾åœ¨ mySet3 ä¸­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; smembers mySet3&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;sorted-set&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#sorted-set&#34;&gt;#&lt;/a&gt; Sorted set&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç»ï¼š&lt;/strong&gt; å’Œ set ç›¸æ¯”ï¼Œsorted set å¢åŠ äº†ä¸€ä¸ªæƒé‡å‚æ•° scoreï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰ score è¿›è¡Œæœ‰åºæ’åˆ—ï¼Œè¿˜å¯ä»¥é€šè¿‡ score çš„èŒƒå›´æ¥è·å–å…ƒç´ çš„åˆ—è¡¨ã€‚æœ‰ç‚¹åƒæ˜¯ Java ä¸­ HashMap å’Œ TreeSet çš„ç»“åˆä½“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ï¼š&lt;/strong&gt; zadd,zcard,zscore,zrange,zrevrange,zrem ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ï¼š&lt;/strong&gt; éœ€è¦å¯¹æ•°æ®æ ¹æ®æŸä¸ªæƒé‡è¿›è¡Œæ’åºçš„åœºæ™¯ã€‚æ¯”å¦‚åœ¨ç›´æ’­ç³»ç»Ÿä¸­ï¼Œå®æ—¶æ’è¡Œä¿¡æ¯åŒ…å«ç›´æ’­é—´åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼Œå„ç§ç¤¼ç‰©æ’è¡Œæ¦œï¼Œå¼¹å¹•æ¶ˆæ¯ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‰æ¶ˆæ¯ç»´åº¦çš„æ¶ˆæ¯æ’è¡Œæ¦œï¼‰ç­‰ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¸¸ç”¨å‘½ä»¤å±•ç¤ºï¼šğŸ‹&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zadd myZset &lt;span class=&#34;token number&#34;&gt;3.0&lt;/span&gt; value1 &lt;span class=&#34;token comment&#34;&gt;# æ·»åŠ å…ƒç´ åˆ° sorted set ä¸­ 3.0 ä¸ºæƒé‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zadd myZset &lt;span class=&#34;token number&#34;&gt;2.0&lt;/span&gt; value2 &lt;span class=&#34;token number&#34;&gt;1.0&lt;/span&gt; value3 &lt;span class=&#34;token comment&#34;&gt;# ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zcard myZset &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹ sorted set ä¸­çš„å…ƒç´ æ•°é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zscore myZset value1 &lt;span class=&#34;token comment&#34;&gt;# æŸ¥çœ‹æŸä¸ª value çš„æƒé‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zrange  myZset &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; -1 &lt;span class=&#34;token comment&#34;&gt;# é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 -1 è¡¨ç¤ºè¾“å‡ºæ‰€æœ‰å…ƒç´ &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zrange  myZset &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start  1 ä¸º stop&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; zrevrange  myZset &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# é€†åºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start  1 ä¸º stop&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;bitmap-ä½å›¾&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bitmap-ä½å›¾&#34;&gt;#&lt;/a&gt; Bitmap ä½å›¾&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»‹ç»ï¼š&lt;/strong&gt;  bitmap å­˜å‚¨çš„æ˜¯è¿ç»­çš„äºŒè¿›åˆ¶æ•°å­—ï¼ˆ0 å’Œ 1ï¼‰ï¼Œé€šè¿‡ bitmap, åªéœ€è¦ä¸€ä¸ª bit ä½æ¥è¡¨ç¤ºæŸä¸ªå…ƒç´ å¯¹åº”çš„å€¼æˆ–è€…çŠ¶æ€ï¼Œkey å°±æ˜¯å¯¹åº”å…ƒç´ æœ¬èº« ã€‚æˆ‘ä»¬çŸ¥é“ 8 ä¸ª bit å¯ä»¥ç»„æˆä¸€ä¸ª byteï¼Œæ‰€ä»¥ bitmap æœ¬èº«ä¼šæå¤§çš„èŠ‚çœå‚¨å­˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¸¸ç”¨å‘½ä»¤ï¼š&lt;/strong&gt;  setbit ã€getbit ã€bitcountã€bitop&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯ï¼š&lt;/strong&gt;  é€‚åˆéœ€è¦ä¿å­˜çŠ¶æ€ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯å¦ç­¾åˆ°ã€æ˜¯å¦ç™»å½•...ï¼‰å¹¶éœ€è¦è¿›ä¸€æ­¥å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œåˆ†æçš„åœºæ™¯ã€‚æ¯”å¦‚ç”¨æˆ·ç­¾åˆ°æƒ…å†µã€æ´»è·ƒç”¨æˆ·æƒ…å†µã€ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ï¼ˆæ¯”å¦‚æ˜¯å¦ç‚¹èµè¿‡æŸä¸ªè§†é¢‘ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# SETBIT ä¼šè¿”å›ä¹‹å‰ä½çš„å€¼ï¼ˆé»˜è®¤æ˜¯ 0ï¼‰è¿™é‡Œä¼šç”Ÿæˆ 7 ä¸ªä½&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit mykey &lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit mykey &lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; getbit mykey &lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit mykey &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit mykey &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# é€šè¿‡ bitcount ç»Ÿè®¡è¢«è¢«è®¾ç½®ä¸º 1 çš„ä½çš„æ•°é‡ã€‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; bitcount mykey&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;é’ˆå¯¹ä¸Šé¢æåˆ°çš„ä¸€äº›åœºæ™¯ï¼Œè¿™é‡Œè¿›è¡Œè¿›ä¸€æ­¥è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯ä¸€ğŸ“ï¼šç”¨æˆ·è¡Œä¸ºåˆ†æ&lt;/strong&gt; å¾ˆå¤šç½‘ç«™ä¸ºäº†åˆ†æä½ çš„å–œå¥½ï¼Œéœ€è¦ç ”ç©¶ä½ ç‚¹èµè¿‡çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è®°å½•ä½ å–œæ¬¢è¿‡ 001 å·å°å§å§&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit beauty_girl_001 uid &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯äºŒğŸ“ï¼šç»Ÿè®¡æ´»è·ƒç”¨æˆ·&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ—¶é—´ä½œä¸º keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœå½“æ—¥æ´»è·ƒè¿‡å°±è®¾ç½®ä¸º 1&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘è¯¥å¦‚ä½•è®¡ç®—æŸå‡ å¤© / æœˆ / å¹´çš„æ´»è·ƒç”¨æˆ·å‘¢ (æš‚ä¸”çº¦å®šï¼Œç»Ÿè®¡æ—¶é—´å†…åªè¦æœ‰ä¸€å¤©åœ¨çº¿å°±ç§°ä¸ºæ´»è·ƒ)ï¼Œæœ‰è¯·ä¸‹ä¸€ä¸ª redis çš„å‘½ä»¤&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªä¿å­˜äºŒè¿›åˆ¶ä½çš„å­—ç¬¦ä¸² key è¿›è¡Œä½å…ƒæ“ä½œï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ° destkey ä¸Šã€‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# BITOP å‘½ä»¤æ”¯æŒ AND ã€ OR ã€ NOT ã€ XOR è¿™å››ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§å‚æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;BITOP operation destkey key &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;key &lt;span class=&#34;token punctuation&#34;&gt;..&lt;/span&gt;.&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;åˆå§‹åŒ–æ•°æ®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit &lt;span class=&#34;token number&#34;&gt;20210308&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit &lt;span class=&#34;token number&#34;&gt;20210308&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; setbit &lt;span class=&#34;token number&#34;&gt;20210309&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç»Ÿè®¡ 20210308~20210309 æ€»æ´»è·ƒç”¨æˆ·æ•°: 1&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; bitop and desk1 &lt;span class=&#34;token number&#34;&gt;20210308&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20210309&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; bitcount desk1&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç»Ÿè®¡ 20210308~20210309 åœ¨çº¿æ´»è·ƒç”¨æˆ·æ•°: 2&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; bitop or desk2 &lt;span class=&#34;token number&#34;&gt;20210308&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20210309&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; bitcount desk2&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯ä¸‰ğŸ“ï¼šç”¨æˆ·åœ¨çº¿çŠ¶æ€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºè·å–æˆ–è€…ç»Ÿè®¡ç”¨æˆ·åœ¨çº¿çŠ¶æ€ï¼Œä½¿ç”¨ bitmap æ˜¯ä¸€ä¸ªèŠ‚çº¦ç©ºé—´ä¸”æ•ˆç‡åˆé«˜çš„ä¸€ç§æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åªéœ€è¦ä¸€ä¸ª keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœåœ¨çº¿å°±è®¾ç½®ä¸º 1ï¼Œä¸åœ¨çº¿å°±è®¾ç½®ä¸º 0ã€‚&lt;/p&gt;
&lt;br&gt;
&lt;h4 id=&#34;hyperloglog-åŸºæ•°ç»Ÿè®¡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hyperloglog-åŸºæ•°ç»Ÿè®¡&#34;&gt;#&lt;/a&gt; HyperLogLog åŸºæ•°ç»Ÿè®¡&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Redis çš„åŸºæ•°ç»Ÿè®¡&lt;/strong&gt;ï¼Œè¿™ä¸ªç»“æ„å¯ä»¥éå¸¸çœå†…å­˜çš„å»ç»Ÿè®¡å„ç§è®¡æ•°ï¼Œæ¯”å¦‚æ³¨å†Œ IP æ•°ã€æ¯æ—¥è®¿é—® IP æ•°ã€é¡µé¢å®æ—¶ UVï¼‰ã€åœ¨çº¿ç”¨æˆ·æ•°ç­‰ã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰å±€é™æ€§ï¼Œå°±æ˜¯åªèƒ½ç»Ÿè®¡æ•°é‡ï¼Œè€Œæ²¡åŠæ³•å»çŸ¥é“å…·ä½“çš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç„¶ç”¨é›†åˆä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯ä¸€ä¸ªå¤§å‹çš„ç½‘ç«™ï¼Œæ¯å¤© IP æ¯”å¦‚æœ‰ 100 ä¸‡ï¼Œç²—ç®—ä¸€ä¸ª IP æ¶ˆè€— 15 å­—èŠ‚ï¼Œé‚£ä¹ˆ 100 ä¸‡ä¸ª IP å°±æ˜¯ 15Mã€‚è€Œ HyperLogLog åœ¨ Redis ä¸­æ¯ä¸ªé”®å ç”¨çš„å†…å®¹éƒ½æ˜¯ 12Kï¼Œç†è®ºå­˜å‚¨è¿‘ä¼¼æ¥è¿‘ 2^64 ä¸ªå€¼ï¼Œä¸ç®¡å­˜å‚¨çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå®ƒä¸€ä¸ªåŸºäºåŸºæ•°ä¼°ç®—çš„ç®—æ³•ï¼Œåªèƒ½æ¯”è¾ƒå‡†ç¡®çš„ä¼°ç®—å‡ºåŸºæ•°ï¼Œå¯ä»¥ä½¿ç”¨å°‘é‡å›ºå®šçš„å†…å­˜å»å­˜å‚¨å¹¶è¯†åˆ«é›†åˆä¸­çš„å”¯ä¸€å…ƒç´ ã€‚è€Œä¸”è¿™ä¸ªä¼°ç®—çš„åŸºæ•°å¹¶ä¸ä¸€å®šå‡†ç¡®ï¼Œæ˜¯ä¸€ä¸ªå¸¦æœ‰ 0.81% æ ‡å‡†é”™è¯¯çš„è¿‘ä¼¼å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;åº”ç”¨åœºæ™¯:âœ¨&lt;/strong&gt;&lt;br /&gt;
HyperLogLog ä¸»è¦çš„åº”ç”¨åœºæ™¯å°±æ˜¯è¿›è¡ŒåŸºæ•°ç»Ÿè®¡ã€‚è¿™ä¸ªé—®é¢˜çš„åº”ç”¨åœºæ™¯å…¶å®æ˜¯ååˆ†å¹¿æ³›çš„ã€‚ä¾‹å¦‚ï¼šå¯¹äº Google ä¸»é¡µé¢è€Œè¨€ï¼ŒåŒä¸€ä¸ªè´¦æˆ·å¯èƒ½ä¼šè®¿é—® Google ä¸»é¡µé¢å¤šæ¬¡ã€‚äºæ˜¯ï¼Œåœ¨è¯¸å¤šçš„è®¿é—®æµæ°´ä¸­ï¼Œå¦‚ä½•è®¡ç®—å‡º Google ä¸»é¡µé¢æ¯å¤©è¢«å¤šå°‘ä¸ªä¸åŒçš„è´¦æˆ·è®¿é—®è¿‡å°±æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚é‚£ä¹ˆå¯¹äº Google è¿™ç§è®¿é—®é‡å·¨å¤§çš„ç½‘é¡µè€Œè¨€ï¼Œå…¶å®ç»Ÿè®¡å‡ºæœ‰åäº¿ çš„è®¿é—®é‡æˆ–è€…åäº¿é›¶åä¸‡çš„è®¿é—®é‡å…¶å®æ˜¯æ²¡æœ‰å¤ªå¤šçš„åŒºåˆ«çš„ï¼Œå› æ­¤ï¼Œåœ¨è¿™ç§ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œä¸ºäº†èŠ‚çœæˆæœ¬ï¼Œå…¶å®å¯ä»¥åªè®¡ç®—å‡ºä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œè€Œæ²¡æœ‰å¿…è¦è®¡ç®—å‡ºç²¾å‡†çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ•°æ®ç»“æ„çš„å‘½ä»¤æœ‰ä¸‰ä¸ªï¼šPFADDã€PFCOUNTã€PFMERGE&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;redis&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; PFADD databases &lt;span class=&#34;token string&#34;&gt;&#34;Redis&#34;&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;MongoDB&#34;&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;MySQL&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;redis&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; PFADD databases &lt;span class=&#34;token string&#34;&gt;&#34;Redis&#34;&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Redis å·²ç»å­˜åœ¨ï¼Œä¸å¿…å¯¹ä¼°è®¡æ•°é‡è¿›è¡Œæ›´æ–°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;redis&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; PFCOUNT databases&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;geo-åœ°ç†ä½ç½®&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#geo-åœ°ç†ä½ç½®&#34;&gt;#&lt;/a&gt; Geo åœ°ç†ä½ç½®&lt;/h4&gt;
&lt;p&gt;Redis çš„ GEO ç‰¹æ€§åœ¨ Redis 3.2 ç‰ˆæœ¬ä¸­æ¨å‡ºï¼Œ è¿™ä¸ªåŠŸèƒ½å¯ä»¥å°†ç”¨æˆ·ç»™å®šçš„åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œ å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œã€‚GEO çš„æ•°æ®ç»“æ„æ€»å…±æœ‰å…­ä¸ªå‘½ä»¤ï¼šgeoaddã€geoposã€geodistã€georadiusã€georadiusbymemberã€gethash,&lt;strong&gt;GEO ä½¿ç”¨çš„æ˜¯å›½é™…é€šç”¨åæ ‡ç³» WGS-84ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;GEOADD: æ·»åŠ åœ°ç†ä½ç½®&lt;/li&gt;
&lt;li&gt;GEOPOSï¼šæŸ¥è¯¢åœ°ç†ä½ç½®ï¼ˆç»çº¬åº¦ï¼‰ï¼Œè¿”å›æ•°ç»„&lt;/li&gt;
&lt;li&gt;GEODISTï¼šè®¡ç®—ä¸¤ä½ä½ç½®é—´çš„è·ç¦»&lt;/li&gt;
&lt;li&gt;GEORADIUSï¼šä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ è¿”å›é”®åŒ…å«çš„ä½ç½®å…ƒç´ å½“ä¸­ï¼Œ ä¸ä¸­å¿ƒçš„è·ç¦»ä¸è¶…è¿‡ç»™å®šæœ€å¤§è·ç¦»çš„æ‰€æœ‰ä½ç½®å…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;GEORADIUSBYMEMBERï¼šä»¥ç»™å®šçš„åœ°ç†ä½ç½®ä¸ºä¸­å¿ƒï¼Œ è¿”å›é”®åŒ…å«çš„ä½ç½®å…ƒç´ å½“ä¸­ï¼Œ ä¸ä¸­å¿ƒçš„è·ç¦»ä¸è¶…è¿‡ç»™å®šæœ€å¤§è·ç¦»çš„æ‰€æœ‰ä½ç½®å…ƒç´ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; geoadd kcityGeo &lt;span class=&#34;token number&#34;&gt;116.405285&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;39.904989&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;beijing&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; geoadd kcityGeo &lt;span class=&#34;token number&#34;&gt;121.472644&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;31.231706&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;shanghai&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; geodist kcityGeo beijing shanghai km&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1067.5980&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; geopos kcityGeo beijing&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;116.40528291463851929&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;39.9049884229125027&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; geohash kcityGeo beijing&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;wx4g0b7xrt0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; georadiusbymember kcityGeo beijing &lt;span class=&#34;token number&#34;&gt;1200&lt;/span&gt; km withdist withcoord asc count &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;beijing&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;0.0000&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;116.40528291463851929&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;39.9049884229125027&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;shanghai&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1067.5980&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;121.47264629602432251&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;31.23170490709807012&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
&lt;h4 id=&#34;streams-æµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#streams-æµ&#34;&gt;#&lt;/a&gt; Streams æµ&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒå¤šæ’­çš„å¯æŒä¹…åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºå®ç°å‘å¸ƒè®¢é˜…åŠŸèƒ½&lt;/strong&gt;ï¼Œå€Ÿé‰´äº† kafka çš„è®¾è®¡ã€‚Redis Stream çš„ç»“æ„æœ‰ä¸€ä¸ªæ¶ˆæ¯é“¾è¡¨ï¼Œå°†æ‰€æœ‰åŠ å…¥çš„æ¶ˆæ¯éƒ½ä¸²èµ·æ¥ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ ID å’Œå¯¹åº”çš„å†…å®¹ã€‚æ¶ˆæ¯æ˜¯æŒä¹…åŒ–çš„ï¼ŒRedis é‡å¯åï¼Œå†…å®¹è¿˜åœ¨ã€‚ğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/r2.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª Stream éƒ½æœ‰å”¯ä¸€çš„åç§°ï¼Œå®ƒå°±æ˜¯ Redis çš„ keyï¼Œåœ¨æˆ‘ä»¬é¦–æ¬¡ä½¿ç”¨ xadd æŒ‡ä»¤è¿½åŠ æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯ä¸ª&lt;strong&gt; Stream&lt;/strong&gt; éƒ½å¯ä»¥æŒ‚å¤šä¸ªæ¶ˆè´¹ç»„ï¼Œæ¯ä¸ªæ¶ˆè´¹ç»„ä¼šæœ‰ä¸ªæ¸¸æ ‡ last_delivered_id åœ¨ Stream æ•°ç»„ä¹‹ä¸Šå¾€å‰ç§»åŠ¨ï¼Œè¡¨ç¤ºå½“å‰æ¶ˆè´¹ç»„å·²ç»æ¶ˆè´¹åˆ°å“ªæ¡æ¶ˆæ¯äº†ã€‚æ¯ä¸ªæ¶ˆè´¹ç»„éƒ½æœ‰ä¸€ä¸ª Stream å†…å”¯ä¸€çš„åç§°ï¼Œæ¶ˆè´¹ç»„ä¸ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå®ƒéœ€è¦å•ç‹¬çš„æŒ‡ä»¤ xgroup create è¿›è¡Œåˆ›å»ºï¼Œéœ€è¦æŒ‡å®šä» Stream çš„æŸä¸ªæ¶ˆæ¯ ID å¼€å§‹æ¶ˆè´¹ï¼Œè¿™ä¸ª ID ç”¨æ¥åˆå§‹åŒ– last_delivered_id å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª&lt;strong&gt;æ¶ˆè´¹ç»„&lt;/strong&gt; (Consumer Group) çš„çŠ¶æ€éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç›¸äº’ä¸å—å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€ä»½ Stream å†…éƒ¨çš„æ¶ˆæ¯ä¼šè¢«æ¯ä¸ªæ¶ˆè´¹ç»„éƒ½æ¶ˆè´¹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;åŒä¸€ä¸ªæ¶ˆè´¹ç»„ (Consumer Group) å¯ä»¥æŒ‚æ¥å¤šä¸ªæ¶ˆè´¹è€… (Consumer)ï¼Œè¿™äº›æ¶ˆè´¹è€…ä¹‹é—´æ˜¯ç«äº‰å…³ç³»ï¼Œä»»æ„ä¸€ä¸ªæ¶ˆè´¹è€…è¯»å–äº†æ¶ˆæ¯éƒ½ä¼šä½¿æ¸¸æ ‡ last_delivered_id å¾€å‰ç§»åŠ¨ã€‚æ¯ä¸ªæ¶ˆè´¹è€…è€…æœ‰ä¸€ä¸ªç»„å†…å”¯ä¸€åç§°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¶ˆè´¹è€…&lt;/strong&gt; (Consumer) å†…éƒ¨ä¼šæœ‰ä¸ªçŠ¶æ€å˜é‡ pending_idsï¼Œå®ƒè®°å½•äº†å½“å‰å·²ç»è¢«å®¢æˆ·ç«¯è¯»å–çš„æ¶ˆæ¯ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ ackã€‚å¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰ ackï¼Œè¿™ä¸ªå˜é‡é‡Œé¢çš„æ¶ˆæ¯ ID ä¼šè¶Šæ¥è¶Šå¤šï¼Œä¸€æ—¦æŸä¸ªæ¶ˆæ¯è¢« ackï¼Œå®ƒå°±å¼€å§‹å‡å°‘ã€‚è¿™ä¸ª pending_ids å˜é‡åœ¨ Redis å®˜æ–¹è¢«ç§°ä¹‹ä¸º PELï¼Œä¹Ÿå°±æ˜¯ Pending Entries Listï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„æ•°æ®ç»“æ„ï¼Œå®ƒç”¨æ¥ç¡®ä¿å®¢æˆ·ç«¯è‡³å°‘æ¶ˆè´¹äº†æ¶ˆæ¯ä¸€æ¬¡ï¼Œè€Œä¸ä¼šåœ¨ç½‘ç»œä¼ è¾“çš„ä¸­é€”ä¸¢å¤±äº†æ²¡å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¶ˆæ¯ IDï¼š&lt;/strong&gt; æ¶ˆæ¯ ID çš„å½¢å¼æ˜¯ timestampInMillis-sequenceï¼Œä¾‹å¦‚ 1527846880572-5ï¼Œå®ƒè¡¨ç¤ºå½“å‰çš„æ¶ˆæ¯åœ¨æ¯«ç±³æ—¶é—´æˆ³ 1527846880572 æ—¶äº§ç”Ÿï¼Œå¹¶ä¸”æ˜¯è¯¥æ¯«ç§’å†…äº§ç”Ÿçš„ç¬¬ 5 æ¡æ¶ˆæ¯ã€‚æ¶ˆæ¯ ID å¯ä»¥ç”±æœåŠ¡å™¨è‡ªåŠ¨ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ç”±å®¢æˆ·ç«¯è‡ªå·±æŒ‡å®šï¼Œä½†æ˜¯å½¢å¼å¿…é¡»æ˜¯æ•´æ•° - æ•´æ•°ï¼Œè€Œä¸”å¿…é¡»æ˜¯åé¢åŠ å…¥çš„æ¶ˆæ¯çš„ ID è¦å¤§äºå‰é¢çš„æ¶ˆæ¯ IDã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¶ˆæ¯å†…å®¹ï¼š&lt;/strong&gt; æ¶ˆæ¯å†…å®¹å°±æ˜¯é”®å€¼å¯¹ï¼Œå½¢å¦‚ hash ç»“æ„çš„é”®å€¼å¯¹ï¼Œè¿™æ²¡ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; XADD mystream * field1 value1 field2 value2 field3 value3&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1588491680862-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; XADD mystream * username lisi age &lt;span class=&#34;token number&#34;&gt;18&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1588491854070-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; xlen mystream&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; XADD mystream * username lisi age &lt;span class=&#34;token number&#34;&gt;18&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token string&#34;&gt;&#34;1588491861215-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; xrange mystream - + &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1588491680862-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1588491854070-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;username&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lisi&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;age&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;18&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1588491861215-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;username&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lisi&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;age&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;18&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; xdel mystream &lt;span class=&#34;token number&#34;&gt;1588491854070&lt;/span&gt;-0 &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; xrange mystream - + &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1588491680862-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value1&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value2&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;field3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;value3&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;1588491861215-0&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;username&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;lisi&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;age&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;      &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;18&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token number&#34;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; xlen mystream&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;integer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="Redis" scheme="https://shaogezhu.cn/tags/Redis/" />
        <updated>2021-10-11T13:45:48.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/10/a3c0f04e5e30/</id>
        <title>æ‰‹å†™åˆ†å¸ƒå¼é›ªèŠ±(Snowflake)ç®—æ³•ç”ŸæˆID</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/10/a3c0f04e5e30/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨å¤§å¤š MySQL æ•°æ®åº“ï¼Œç”Ÿæˆ ID çš„ç®—æ³•å°±æ˜¯ç”¨çš„&lt;span class=&#34;pink&#34;&gt; SnowFlake&lt;/span&gt;ï¼Œä¸‹é¢æˆ‘ä»¬äº†è§£ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„ç”ŸæˆåŸç†ï¼Œä»¥åŠæ˜¯å¦‚ä½•å·¥ä½œçš„ğŸ‘€&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;snowflakeç®—æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#snowflakeç®—æ³•&#34;&gt;#&lt;/a&gt; SnowFlake ç®—æ³•&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;SnowFlake æ˜¯ twitter å…¬å¸å†…éƒ¨åˆ†å¸ƒå¼é¡¹ç›®é‡‡ç”¨çš„ ID ç”Ÿæˆç®—æ³•ï¼Œå¼€æºåå¹¿å—å›½å†…å¤§å‚çš„å¥½è¯„ã€‚ç”±è¿™ç§ç®—æ³•ç”Ÿæˆçš„ IDï¼Œæˆ‘ä»¬å°±å«åš SnowFlakeIDã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SnowFlake ç®—æ³•ç”Ÿæˆ id çš„ç»“æœæ˜¯ä¸€ä¸ª 64bit å¤§å°çš„æ•´æ•°ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹å›¾ï¼š&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-10/sn1.png&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ†ä¸ºå››æ®µï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬ä¸€æ®µï¼š&lt;/strong&gt; 1 ä½ä¸ºæœªä½¿ç”¨ï¼Œæ°¸è¿œå›ºå®šä¸º 0ã€‚&lt;br /&gt;
ï¼ˆå› ä¸ºäºŒè¿›åˆ¶ä¸­æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ1 è¡¨ç¤ºè´Ÿæ•°ï¼Œ0 è¡¨ç¤ºæ­£æ•°ã€‚ç”Ÿæˆçš„ id ä¸€èˆ¬éƒ½æ˜¯ç”¨æ­£æ•´æ•°ï¼Œæ‰€ä»¥æœ€é«˜ä½å›ºå®šä¸º 0 ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬äºŒæ®µï¼š&lt;/strong&gt; 41 ä½ä¸ºæ¯«ç§’çº§æ—¶é—´ (41 ä½çš„é•¿åº¦å¯ä»¥ä½¿ç”¨ 69 å¹´)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬ä¸‰æ®µï¼š&lt;/strong&gt; 10 ä½ä¸º workerId (10 ä½çš„é•¿åº¦æœ€å¤šæ”¯æŒéƒ¨ç½² 1024 ä¸ªèŠ‚ç‚¹ï¼‰&lt;br /&gt;
(è¿™é‡Œçš„ 10 ä½åˆåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ† 5 ä½è¡¨ç¤ºæ•°æ®ä¸­å¿ƒ IDï¼ˆ0-31ï¼‰ç¬¬äºŒéƒ¨åˆ† 5 ä½è¡¨ç¤ºæœºå™¨ IDï¼ˆ0-31ï¼‰)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬å››æ®µï¼š&lt;/strong&gt; 12 ä½ä¸ºæ¯«ç§’å†…çš„è®¡æ•°ï¼ˆ12 ä½çš„è®¡æ•°é¡ºåºå·æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹æ¯æ¯«ç§’äº§ç”Ÿ 4096 ä¸ª ID åºå·ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç å®ç°ï¼šğŸ˜&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;HashSet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SnowFlake&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ—¶é—´ 41 ä½&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; lastTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ•°æ®ä¸­å¿ƒ ID 5 ä½ (é»˜è®¤ 0-31)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; datacenterId &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æœºæˆ¿æœºå™¨ ID 5 ä½ (é»˜è®¤ 0-31)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; workerId &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; workerIdShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// éšæœºæ•° 12 ä½ (é»˜è®¤ 0~4095)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt; random &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; randomShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// éšæœºæ•°çš„æœ€å¤§å€¼&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; maxRandom &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; randomShift&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SnowFlake&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SnowFlake&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; workerIdShift&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; datacenterIdShift&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;workerIdShift &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;||&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;||&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                workerIdShift &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;IllegalArgumentException&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;å‚æ•°ä¸åŒ¹é…&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;workerIdShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; workerIdShift&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; datacenterIdShift&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;randomShift &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;22&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; workerIdShift&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;maxRandom &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; randomShift&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// è·å–é›ªèŠ±çš„ ID&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; lastTime &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;workerIdShift &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; randomShift&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                workerId &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;datacenterIdShift &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; randomShift&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                datacenterId &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; randomShift &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                random&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// ç”Ÿæˆä¸€ä¸ªæ–°çš„ ID&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;nextId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; now &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœå½“å‰æ—¶é—´å’Œä¸Šä¸€æ¬¡æ—¶é—´ä¸åœ¨åŒä¸€æ¯«ç§’å†…ï¼Œç›´æ¥è¿”å›&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;now &lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; lastTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            lastTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; now&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            random&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;	&lt;span class=&#34;token comment&#34;&gt;// å°†æœ€åçš„éšæœºæ•°ï¼Œè¿›è¡Œ + 1 æ“ä½œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;random&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; maxRandom&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è‡ªé€‰ç­‰å¾…ä¸‹ä¸€æ¯«ç§’&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;now &lt;span class=&#34;token operator&#34;&gt;&amp;lt;=&lt;/span&gt; lastTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            now &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        lastTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; now&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        random&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;getId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;SnowFlake&lt;/span&gt; snowFlake &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;SnowFlake&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;HashSet&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt; set &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;HashSet&lt;/span&gt;&lt;span class=&#34;token generics&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            set&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;snowFlake&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;nextId&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;set&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;81&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;82&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;83&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ä»£ç ä¸­è·å– id çš„æ–¹æ³•åˆ©ç”¨&lt;strong&gt;ä½è¿ç®—&lt;/strong&gt;å®ç°&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-10/sn2.png&#34; alt=&#34;16312623841.png&#34; /&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight text&#34;&gt;&lt;figcaption data-lang=&#34;text&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;1  |                    41                        |  5  |   5  |     12      &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   0|0001100 10100010 10111110 10001001 01011100 00|00000|0 0000|0000 00000000 //41ä½çš„æ—¶é—´&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   0|000000â€­0 00000000 00000000 00000000 00000000 00|10001|0 0000|0000 00000000 //5ä½çš„æ•°æ®ä¸­å¿ƒID&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   0|0000000 00000000 00000000 00000000 00000000 00|00000|1 1001|0000 00000000 //5ä¸ºçš„æœºå™¨ID&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;or 0|0000000 00000000 00000000 00000000 00000000 00|00000|0 0000|â€­0000 00000000â€¬ //12ä½çš„sequence&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;------------------------------------------------------------------------------------------&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;   0|0001100 10100010 10111110 10001001 01011100 00|10001|1 1001|â€­0000 00000000â€¬ //ç»“æœï¼š910499571847892992&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;snowflakeä¼˜ç‚¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#snowflakeä¼˜ç‚¹&#34;&gt;#&lt;/a&gt; SnowFlake ä¼˜ç‚¹ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ‰€æœ‰ç”Ÿæˆçš„ id æŒ‰æ—¶é—´è¶‹åŠ¿é€’å¢&lt;/li&gt;
&lt;li&gt;æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”Ÿé‡å¤ idï¼ˆå› ä¸ºæœ‰ datacenterId å’Œ workerId æ¥åšåŒºåˆ†ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;snowflakeä¸è¶³&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#snowflakeä¸è¶³&#34;&gt;#&lt;/a&gt; SnowFlake ä¸è¶³ï¼š&lt;/h3&gt;
&lt;p&gt;ç”±äº SnowFlake å¼ºä¾èµ–æ—¶é—´æˆ³ï¼Œæ‰€ä»¥æ—¶é—´çš„å˜åŠ¨ä¼šé€ æˆ SnowFlake çš„ç®—æ³•äº§ç”Ÿé”™è¯¯ã€‚&lt;/p&gt;
&lt;br&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="æŠ€æœ¯å®è·µ" scheme="https://shaogezhu.cn/categories/java/practice/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="ç®—æ³•" scheme="https://shaogezhu.cn/tags/%E7%AE%97%E6%B3%95/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <updated>2021-10-02T12:45:48.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/9/fc647db813d3/</id>
        <title>å¸¸è§çš„é™æµç®—æ³•åˆ†æä»¥åŠæ‰‹å†™å®ç°ï¼ˆè®¡æ•°å™¨ã€æ¼æ–—ã€ä»¤ç‰Œæ¡¶ï¼‰</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/9/fc647db813d3/"/>
        <content type="html">&lt;h2 id=&#34;å¸¸è§çš„é™æµç®—æ³•åˆ†æ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¸¸è§çš„é™æµç®—æ³•åˆ†æ&#34;&gt;#&lt;/a&gt; å¸¸è§çš„é™æµç®—æ³•åˆ†æ&lt;/h2&gt;
&lt;div class=&#34;note primary&#34;&gt;
&lt;p&gt;é™æµåœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç»å¸¸è§åˆ°ï¼Œå¦‚&lt;strong&gt;ç«è½¦ç«™é—¨å£çš„æ æ†&lt;/strong&gt;ã€&lt;strong&gt;ä¸€äº›æ™¯ç‚¹çš„é—¨ç¥¨åªå‡ºå”®ä¸€å®šçš„æ•°é‡&lt;/strong&gt; ç­‰ç­‰ã€‚åœ¨æˆ‘ä»¬çš„å¼€å‘ä¸­ä¹Ÿç”¨åˆ°äº†è¿™ç§æ€æƒ³ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆè¦é™æµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸ºä»€ä¹ˆè¦é™æµ&#34;&gt;#&lt;/a&gt; ä¸ºä»€ä¹ˆè¦é™æµ&lt;/h3&gt;
&lt;p&gt;ğŸ«åœ¨ä¿è¯å¯ç”¨çš„æƒ…å†µä¸‹å°½å¯èƒ½å¤šå¢åŠ è¿›å…¥çš„äººæ•°ï¼Œå…¶ä½™çš„äººåœ¨æ’é˜Ÿç­‰å¾…ï¼Œæˆ–è€…è¿”å›å‹å¥½æç¤ºï¼Œä¿è¯é‡Œé¢çš„è¿›è¡Œç³»ç»Ÿçš„ç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œ &lt;strong&gt;&lt;font color=&#34;blue&#34;&gt;é˜²æ­¢ç³»ç»Ÿé›ªå´©&lt;/font&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é™æµç®—æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#é™æµç®—æ³•&#34;&gt;#&lt;/a&gt; é™æµç®—æ³•&lt;/h3&gt;
&lt;p&gt;ğŸŒ´ğŸŒ´é™æµç®—æ³•å¾ˆå¤šï¼Œå¸¸è§çš„æœ‰ä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ &lt;strong&gt;&lt;font color=&#34;purple&#34;&gt;è®¡æ•°å™¨ç®—æ³•&lt;/font&gt; &lt;strong&gt;ã€&lt;/strong&gt;&lt;font color=&#34;orange&#34;&gt;æ¼æ¡¶ç®—æ³•&lt;/font&gt;&lt;/strong&gt;ã€&lt;strong&gt;&lt;font color=&#34;green&#34;&gt;ä»¤ç‰Œæ¡¶ç®—æ³•&lt;/font&gt;&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ï¼ˆ1ï¼‰&lt;strong&gt;è®¡æ•°å™¨ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â Â Â Â Â Â Â Â Â Â åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰&lt;strong&gt;æ¼æ¡¶ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â Â Â Â Â Â Â Â Â Â æ¼æ¡¶å¤§å°å›ºå®šï¼Œå¤„ç†é€Ÿåº¦å›ºå®šï¼Œä½†è¯·æ±‚è¿›å…¥é€Ÿåº¦ä¸å›ºå®šï¼ˆåœ¨çªå‘æƒ…å†µè¯·æ±‚è¿‡å¤šæ—¶ï¼Œä¼šä¸¢å¼ƒè¿‡å¤šçš„è¯·æ±‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰&lt;strong&gt;ä»¤ç‰Œæ¡¶ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â Â Â Â Â Â Â Â Â Â ä»¤ç‰Œæ¡¶çš„å¤§å°å›ºå®šï¼Œä»¤ç‰Œçš„äº§ç”Ÿé€Ÿåº¦å›ºå®šï¼Œä½†æ˜¯æ¶ˆè€—ä»¤ç‰Œï¼ˆå³è¯·æ±‚ï¼‰é€Ÿåº¦ä¸å›ºå®šï¼ˆå¯ä»¥åº”å¯¹ä¸€äº›æŸäº›æ—¶é—´è¯·æ±‚è¿‡å¤šçš„æƒ…å†µï¼‰ï¼›æ¯ä¸ªè¯·æ±‚éƒ½ä¼šä»ä»¤ç‰Œæ¡¶ä¸­å–å‡ºä»¤ç‰Œï¼Œå¦‚æœæ²¡æœ‰ä»¤ç‰Œåˆ™ä¸¢å¼ƒè¯¥æ¬¡è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;è®¡æ•°å™¨é™æµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è®¡æ•°å™¨é™æµ&#34;&gt;#&lt;/a&gt; è®¡æ•°å™¨é™æµ&lt;/h3&gt;
&lt;p&gt;ğŸº&lt;strong&gt;åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªğŸŒ°, æ¯”å¦‚æˆ‘ä»¬è§„å®šå¯¹äº A æ¥å£ï¼Œæˆ‘ä»¬ 1 åˆ†é’Ÿçš„è®¿é—®æ¬¡æ•°ä¸èƒ½è¶…è¿‡ 100 æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š&lt;/p&gt;
&lt;p&gt;ğŸˆåœ¨ä¸€å¼€ å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ counterï¼Œæ¯å½“ä¸€ä¸ªè¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œcounter å°±åŠ  1ï¼Œå¦‚æœ counter çš„å€¼å¤§äº 100 å¹¶ä¸”è¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´è¿˜åœ¨ 1 åˆ†é’Ÿä¹‹å†…ï¼Œé‚£ä¹ˆè¯´æ˜è¯·æ±‚æ•°è¿‡å¤šï¼Œæ‹’ç»è®¿é—®ï¼›&lt;/p&gt;
&lt;p&gt;ğŸ¬å¦‚æœè¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´å¤§äº 1 åˆ†é’Ÿï¼Œä¸” counter çš„å€¼è¿˜åœ¨é™æµèŒƒå›´å†…ï¼Œé‚£ä¹ˆå°±é‡ç½® counter, å°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/333bdec3d3524f4c95172376841dd180.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16&#34; alt=&#34;[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-pkGvVRdd-1647523333397)(/upload/2021/09/image-0cbbc44ec76d446896e989962e8122e5.png)]&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç å®ç°ï¼š&lt;/strong&gt; ğŸ˜&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// è®¡æ•°å™¨ é™æµ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CounterLimiter&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// èµ·å§‹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; startTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ—¶é—´é—´éš” 1000ms&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; interval &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ¯ä¸ªæ—¶é—´é—´éš”å†…ï¼Œé™åˆ¶æ•°é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; limit &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// ç´¯åŠ å™¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt; accumulator &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;/**&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     */&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; nowTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nowTime &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; startTime &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; interval&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœè¿˜åœ¨ä¸Šä¸ªæ—¶é—´é—´éš”å†…&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; accumulator&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;count &lt;span class=&#34;token operator&#34;&gt;&amp;lt;=&lt;/span&gt; limit&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœä¸åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;CounterLimiter&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// é˜²æ­¢é‡å¤åˆå§‹åŒ–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nowTime &lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; startTime &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; interval&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    startTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nowTime&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    accumulator&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;// å†æ¬¡è¿›è¡Œåˆ¤æ–­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; count &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; accumulator&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;count &lt;span class=&#34;token operator&#34;&gt;&amp;lt;=&lt;/span&gt; limit&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt; pool &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newFixedThreadPool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt; limited &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; threads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åŒæ­¥å™¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt; countDownLatch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; start &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; threads&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            pool&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;submit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; flag &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;flag&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;81&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getAndIncrement&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;82&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;83&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;84&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;85&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;86&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;87&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;88&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;89&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;90&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;countDown&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;91&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;92&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;93&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;94&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;95&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;96&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;97&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;98&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; start&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000F&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;99&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¾“å‡ºç»Ÿè®¡ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;100&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;101&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token string&#34;&gt;&#34;,é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;102&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;103&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;s&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;104&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;105&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;106&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è®¡æ•°å™¨é™æµçš„ä¸è¶³ï¼š&lt;/strong&gt; ğŸŒ´&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç®—æ³•è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å­˜åœ¨&lt;strong&gt;ä¸´ç•Œé—®é¢˜&lt;/strong&gt;ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/e5b54ef9aa614eab9ada0ab8850d9b1b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16&#34; alt=&#34;[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-xUvgpono-1647523333398)(/upload/2021/09/image-d55d813bbcb544479109dd2248e90ff0.png)]&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ğŸ»ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ¶æ„ç”¨æˆ·ï¼Œä»–åœ¨ 0:59 æ—¶ï¼Œç¬é—´å‘é€äº† 100 ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸” 1:00 åˆç¬é—´å‘é€äº† 100 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆå…¶å®è¿™ä¸ªç”¨æˆ·åœ¨ 1 ç§’é‡Œé¢ï¼Œç¬é—´å‘é€äº† 200 ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ¦æˆ‘ä»¬åˆšæ‰è§„å®šçš„æ˜¯ 1 åˆ†é’Ÿæœ€å¤š 100 ä¸ªè¯·æ±‚ï¼ˆè§„åˆ’çš„ååé‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’é’Ÿæœ€å¤š 1.7 ä¸ªè¯·æ±‚ï¼Œç”¨æˆ·é€šè¿‡åœ¨æ—¶é—´çª—å£çš„é‡ç½®èŠ‚ç‚¹å¤„çªå‘è¯·æ±‚ï¼Œ å¯ä»¥ç¬é—´è¶…è¿‡æˆ‘ä»¬çš„é€Ÿç‡é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·æœ‰å¯èƒ½é€šè¿‡ç®—æ³•çš„è¿™ä¸ªæ¼æ´ï¼Œç¬é—´å‹å®æˆ‘ä»¬çš„åº”ç”¨ã€‚ğŸ™‡ğŸ»â€â™€ï¸&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span style=&#34;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;&#34;&gt;&lt;span style=&#34;font-size:14px;&#34;&gt;&lt;span style=&#34;font-family:Arial;line-height:26px;&#34;&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span style=&#34;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;&#34;&gt;&lt;span style=&#34;font-size:14px;&#34;&gt;&lt;span style=&#34;font-family:Arial;line-height:26px;&#34;&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ¼æ¡¶é™æµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ¼æ¡¶é™æµ&#34;&gt;#&lt;/a&gt; æ¼æ¡¶é™æµ&lt;/h3&gt;
&lt;p&gt;âœ¨æ¼æ¡¶ç®—æ³•é™æµçš„åŸºæœ¬åŸç†ä¸ºï¼š&lt;strong&gt;æ°´ï¼ˆå¯¹åº”è¯·æ±‚ï¼‰ä»è¿›æ°´å£è¿›å…¥åˆ°æ¼æ¡¶é‡Œï¼Œæ¼æ¡¶ä»¥ä¸€å®šçš„é€Ÿåº¦å‡ºæ°´ï¼ˆè¯·æ±‚æ”¾è¡Œï¼‰ï¼Œå½“æ°´æµå…¥é€Ÿåº¦è¿‡å¤§ï¼Œæ¡¶å†…çš„æ€»æ°´é‡å¤§äºæ¡¶å®¹é‡ä¼šç›´æ¥æº¢å‡ºï¼Œè¯·æ±‚è¢«æ‹’ç»ã€‚&lt;/strong&gt;&lt;br /&gt;
å¤§è‡´çš„æ¼æ¡¶é™æµè§„åˆ™å¦‚ä¸‹ï¼šğŸ“&lt;br /&gt;
ï¼ˆ1ï¼‰è¿›æ°´å£ï¼ˆå¯¹åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼‰ä»¥ä»»æ„é€Ÿç‡æµå…¥è¿›å…¥æ¼æ¡¶ã€‚&lt;br /&gt;
ï¼ˆ2ï¼‰æ¼æ¡¶çš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œå‡ºæ°´ï¼ˆæ”¾è¡Œï¼‰é€Ÿç‡ä¹Ÿæ˜¯å›ºå®šçš„ã€‚&lt;br /&gt;
ï¼ˆ3ï¼‰æ¼æ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œå¦‚æœå¤„ç†é€Ÿåº¦å¤ªæ…¢ï¼Œæ¡¶å†…æ°´é‡ä¼šè¶…å‡ºäº†æ¡¶çš„å®¹é‡ï¼Œåˆ™åé¢æµå…¥çš„æ°´æ»´ä¼šæº¢å‡ºï¼Œè¡¨ç¤ºè¯·æ±‚æ‹’ç»ã€‚&lt;br /&gt;
&lt;img data-src=&#34;https://img-blog.csdnimg.cn/27e69fa5f58e45128755cbabf27cc2ed.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16&#34; alt=&#34;[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-ohzhfhmz-1647523333399)(/upload/2021/09/image-afa56bce847f4d8b99e2dfd1eb3509aa.png)]&#34; /&gt;&lt;/p&gt;
&lt;p&gt;â­æ¼æ¡¶ç®—æ³•å…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥ç²—ç•¥çš„è®¤ä¸ºå°±æ˜¯æ³¨æ°´æ¼æ°´è¿‡ç¨‹ï¼Œå¾€æ¡¶ä¸­ä»¥ä»»æ„é€Ÿç‡æµå…¥æ°´ï¼Œä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œå½“æ°´è¶…è¿‡æ¡¶å®¹é‡ï¼ˆcapacityï¼‰åˆ™ä¸¢å¼ƒï¼Œå› ä¸ºæ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œä¿è¯äº†æ•´ä½“çš„é€Ÿç‡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œ&lt;br /&gt;
&lt;img data-src=&#34;https://img-blog.csdnimg.cn/ef3bb3929e4a4e44b34dce33187e672a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16&#34; alt=&#34;[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-hFtmsnIH-1647523333399)(/upload/2021/09/image-c7d684d693f74fa5bf4077febb8fccbc.png)]&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‰Šå³°ğŸ“ï¼š&lt;/strong&gt; æœ‰å¤§é‡æµé‡è¿›å…¥æ—¶ï¼Œä¼šå‘ç”Ÿæº¢å‡ºï¼Œä»è€Œé™æµä¿æŠ¤æœåŠ¡å¯ç”¨&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼“å†²ğŸ“ï¼š&lt;/strong&gt; ä¸è‡³äºç›´æ¥è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç¼“å†²å‹åŠ›&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç å®ç°ï¼š&lt;/strong&gt; ğŸ˜&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// æ¼æ–—é™æµ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;LeakBucketLimiter&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ¡¶çš„å¤§å°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; capacity &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æµå‡ºé€Ÿç‡ï¼Œæ¯ç§’ä¸¤ä¸ª&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; rate &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// å¼€å§‹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; startTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ¡¶ä¸­å‰©ä½™çš„æ°´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt; water &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;/**&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     */&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœæ¡¶çš„ä½™é‡é—® 0ï¼Œç›´æ¥æ”¾è¡Œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            startTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è®¡ç®—ä»å½“å‰æ—¶é—´åˆ°å¼€å§‹æ—¶é—´æµå‡ºçš„æ°´ï¼Œå’Œç°åœ¨æ¡¶ä¸­å‰©ä½™çš„æ°´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ¡¶ä¸­å‰©ä½™çš„æ°´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; startTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; rate&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// é˜²æ­¢å‡ºç° &amp; lt;0 çš„æƒ…å†µ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è®¾ç½®æ–°çš„å¼€å§‹æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        startTime &lt;span class=&#34;token operator&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; startTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// å¦‚æœå½“å‰æ°´å°äºå®¹é‡ï¼Œè¡¨ç¤ºå¯ä»¥æ”¾è¡Œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; capacity&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            water&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt; pool &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newFixedThreadPool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt; limited &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; threads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åŒæ­¥å™¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt; countDownLatch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; start &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; threads&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            pool&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;submit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; flag &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;flag&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getAndIncrement&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;countDown&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;81&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;82&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;83&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;84&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;85&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;86&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;87&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;88&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; start&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000F&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;89&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¾“å‡ºç»Ÿè®¡ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;90&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;91&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token string&#34;&gt;&#34;,é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;92&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;93&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;s&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;94&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;95&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;96&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;æ¼æ¡¶çš„ä¸è¶³ï¼š&lt;/strong&gt; ğŸ¤·â€â™€ï¸&lt;br /&gt;
æ¼æ¡¶çš„å‡ºæ°´é€Ÿåº¦å›ºå®šï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚æ”¾è¡Œé€Ÿåº¦æ˜¯å›ºå®šçš„ã€‚&lt;br /&gt;
æ¼æ¡¶å‡ºå£çš„é€Ÿåº¦å›ºå®šï¼Œä¸èƒ½çµæ´»çš„åº”å¯¹åç«¯èƒ½åŠ›æå‡ã€‚æ¯”å¦‚ï¼Œé€šè¿‡åŠ¨æ€æ‰©å®¹ï¼Œåç«¯æµé‡ä» 1000QPS æå‡åˆ° 1WQPSï¼Œæ¼æ¡¶æ²¡æœ‰åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span style=&#34;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;&#34;&gt;&lt;span style=&#34;font-size:14px;&#34;&gt;&lt;span style=&#34;font-family:Arial;line-height:26px;&#34;&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span style=&#34;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;&#34;&gt;&lt;span style=&#34;font-size:14px;&#34;&gt;&lt;span style=&#34;font-family:Arial;line-height:26px;&#34;&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä»¤ç‰Œæ¡¶é™æµ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä»¤ç‰Œæ¡¶é™æµ&#34;&gt;#&lt;/a&gt; ä»¤ç‰Œæ¡¶é™æµ&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ğŸ¬ä»¤ç‰Œæ¡¶ç®—æ³•ä¸­æ–°è¯·æ±‚åˆ°æ¥æ—¶ä¼šä»æ¡¶é‡Œæ‹¿èµ°ä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœæ¡¶å†…æ²¡æœ‰ä»¤ç‰Œå¯æ‹¿ï¼Œå°±æ‹’ç»æœåŠ¡ã€‚&lt;/strong&gt;  å½“ç„¶ï¼Œä»¤ç‰Œçš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸Šé™çš„ã€‚ä»¤ç‰Œçš„æ•°é‡ä¸æ—¶é—´å’Œå‘æ”¾é€Ÿç‡å¼ºç›¸å…³ï¼Œæ—¶é—´æµé€çš„æ—¶é—´è¶Šé•¿ï¼Œä¼šä¸æ–­å¾€æ¡¶é‡ŒåŠ å…¥è¶Šå¤šçš„ä»¤ç‰Œï¼Œå¦‚æœä»¤ç‰Œå‘æ”¾çš„é€Ÿåº¦æ¯”ç”³è¯·é€Ÿåº¦å¿«ï¼Œä»¤ç‰Œæ¡¶ä¼šæ”¾æ»¡ä»¤ç‰Œï¼Œç›´åˆ°ä»¤ç‰Œå æ»¡æ•´ä¸ªä»¤ç‰Œæ¡¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ç‰Œæ¡¶é™æµå¤§è‡´çš„è§„åˆ™å¦‚ä¸‹ï¼šğŸ™‡ğŸ»â€&lt;br /&gt;
ï¼ˆ1ï¼‰è¿›æ°´å£æŒ‰ç…§æŸä¸ªé€Ÿåº¦ï¼Œå‘æ¡¶ä¸­æ”¾å…¥ä»¤ç‰Œã€‚&lt;br /&gt;
ï¼ˆ2ï¼‰ä»¤ç‰Œçš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯æ”¾è¡Œçš„é€Ÿåº¦ä¸æ˜¯å›ºå®šçš„ï¼Œåªè¦æ¡¶ä¸­è¿˜æœ‰å‰©ä½™ä»¤ç‰Œï¼Œä¸€æ—¦è¯·æ±‚è¿‡æ¥å°±èƒ½ç”³è¯·æˆåŠŸï¼Œç„¶åæ”¾è¡Œã€‚&lt;br /&gt;
ï¼ˆ3ï¼‰å¦‚æœä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œæ…¢äºè¯·æ±‚åˆ°æ¥é€Ÿåº¦ï¼Œæ¡¶å†…å°±æ— ç‰Œå¯é¢†ï¼Œè¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œä»¤ç‰Œçš„å‘é€é€Ÿç‡å¯ä»¥è®¾ç½®ï¼Œä»è€Œå¯ä»¥å¯¹çªå‘çš„å‡ºå£æµé‡è¿›è¡Œæœ‰æ•ˆçš„åº”å¯¹ã€‚&lt;br /&gt;
&lt;img data-src=&#34;https://img-blog.csdnimg.cn/04bc89a81781443aa1e0bfb07260ab58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16&#34; alt=&#34;[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-OlS9VCnB-1647523333401)(/upload/2021/09/image-f5b402eae3b2409c8939b34d8be41f9c.png)]&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç å®ç°ï¼š&lt;/strong&gt; ğŸ˜&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption data-lang=&#34;java&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;token namespace&#34;&gt;java&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;util&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;concurrent&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;atomic&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// ä»¤ç‰Œæ¡¶&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;TokenBucketLimiter&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ¡¶çš„å®¹é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; capacity &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ”¾å…¥ä»¤ç‰Œçš„é€Ÿç‡ï¼Œæ¯ç§’ 2 ä¸ª&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; rate &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// ä¸Šæ¬¡æ”¾ç½®ä»¤ç‰Œçš„æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; lastTime &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æ¡¶ä¸­ä»¤ç‰Œçš„ä½™é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt; tokenNum &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicLong&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;/**&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;     */&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ›´æ–°æ¡¶ä¸­å‰©ä½™ä»¤ç‰Œçš„æ•°é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; now &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        tokenNum&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;addAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;now &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; lastTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; rate&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        tokenNum&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;capacity&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; tokenNum&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ›´æ–°æ—¶é—´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        lastTime &lt;span class=&#34;token operator&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;now &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; lastTime&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ¡¶ä¸­è¿˜æœ‰ä»¤ç‰Œå°±æ”¾è¡Œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenNum&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            tokenNum&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;decrementAndGet&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;// æµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; args&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;ExecutorService&lt;/span&gt; pool &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Executors&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;newFixedThreadPool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt; limited &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// çº¿ç¨‹æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; threads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// åŒæ­¥å™¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt; countDownLatch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;CountDownLatch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;long&lt;/span&gt; start &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; threads&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; i&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            pool&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;submit&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;int&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j &lt;span class=&#34;token operator&#34;&gt;&amp;lt;&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; j&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;boolean&lt;/span&gt; flag &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;tryAcquire&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;flag&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            &lt;span class=&#34;token comment&#34;&gt;// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                            limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;getAndIncrement&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                        &lt;span class=&#34;token class-name&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Exception&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                    e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token comment&#34;&gt;// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;countDown&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            countDownLatch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;InterruptedException&lt;/span&gt; e&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;printStackTrace&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; start&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000F&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;81&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;// è¾“å‡ºç»Ÿè®¡ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;82&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;83&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token string&#34;&gt;&#34;,é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;84&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; limited&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threads &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; turns&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;85&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token class-name&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; time &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;s&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;86&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;87&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;88&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;ä»¤ç‰Œæ¡¶çš„å¥½å¤„ï¼š&lt;/strong&gt; ğŸš€ğŸš€ğŸš€&lt;br /&gt;
ä»¤ç‰Œæ¡¶çš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯å¯ä»¥æ–¹ä¾¿åœ°åº”å¯¹ çªå‘å‡ºå£æµé‡ï¼ˆåç«¯èƒ½åŠ›çš„æå‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œå¯ä»¥æ”¹å˜ä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œç®—æ³•èƒ½æŒ‰ç…§æ–°çš„å‘é€é€Ÿç‡è°ƒå¤§ä»¤ç‰Œçš„å‘æ”¾æ•°é‡ï¼Œä½¿å¾—å‡ºå£çªå‘æµé‡èƒ½è¢«å¤„ç†ã€‚&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="æŠ€æœ¯å®è·µ" scheme="https://shaogezhu.cn/categories/java/practice/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <category term="é™æµç®—æ³•" scheme="https://shaogezhu.cn/tags/%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/" />
        <updated>2021-09-23T14:46:48.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/9/392314cccb3f/</id>
        <title>èŠèŠ Redis çš„ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/9/392314cccb3f/"/>
        <content type="html">&lt;h1 id=&#34;èŠèŠredisçš„ç¼“å­˜ç©¿é€-ç¼“å­˜å‡»ç©¿-ç¼“å­˜é›ªå´©&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#èŠèŠredisçš„ç¼“å­˜ç©¿é€-ç¼“å­˜å‡»ç©¿-ç¼“å­˜é›ªå´©&#34;&gt;#&lt;/a&gt; èŠèŠ Redis çš„ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©&lt;/h1&gt;
&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;Redis çš„ç¼“å­˜ç›¸å…³å†…å®¹ï¼Œé¢è¯•çš„æ—¶å€™å¯æ˜¯ç»å¸¸é‡åˆ°çš„ï¼Œä»Šå¤©æ€»ç»“ä¸€ä¸‹ï¼Œè¿™æ–¹é¢çš„çŸ¥è¯†&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;ç¼“å­˜ç©¿é€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜ç©¿é€&#34;&gt;#&lt;/a&gt; ç¼“å­˜ç©¿é€&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€&#34;&gt;#&lt;/a&gt; ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€&lt;/h3&gt;
&lt;p&gt;ğŸ‘€ç¼“å­˜ç©¿é€å°±æ˜¯å¤§é‡çš„è¯·æ±‚ key åœ¨ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œç›´æ¥è½åˆ°äº†æ•°æ®åº“ä¸Šã€‚æ¯”å¦‚æ”»å‡»è€…æ•…æ„åˆ¶é€ ç¼“å­˜ä¸­ä¸å­˜åœ¨çš„ keyï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œç©¿è¿‡ç¼“å­˜ï¼Œè½åœ¨äº†æ•°æ®åº“ä¸Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•&#34;&gt;#&lt;/a&gt; ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•&lt;/h3&gt;
&lt;p&gt;æœ€åŸºæœ¬çš„å°±æ˜¯â¾¸å…ˆåšå¥½å‚æ•°æ ¡éªŒï¼Œâ¼€äº›ä¸åˆæ³•çš„å‚æ•°è¯·æ±‚ç›´æ¥æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚â½å¦‚æŸ¥è¯¢çš„æ•°æ®åº“ id ä¸èƒ½â¼©äº 0ã€ä¼ â¼Šçš„é‚®ç®±æ ¼å¼ä¸å¯¹çš„æ—¶å€™ç›´æ¥è¿”å›é”™è¯¯æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¼“å­˜â½†æ•ˆ key&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€‹	å¦‚æœç¼“å­˜å’Œæ•°æ®åº“éƒ½æŸ¥ä¸åˆ°æŸä¸ª key çš„æ•°æ®å°±å†™â¼€ä¸ªåˆ° Redis ä¸­å»å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ä½†æ˜¯è¿™ç§â½…æ¡ˆå¹¶ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³æ­¤é—®é¢˜ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¸ƒéš†è¿‡æ»¤å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€‹	å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§å·§å¦™çš„æ•°æ®ç»“æ„ï¼Œæ˜¯æ¦‚ç‡å‹æ•°æ®åº“ã€‚æ˜¯ä¸€ä¸ª bit å‘é‡æˆ–è€…è¯´ bit æ•°ç»„ã€‚å®ƒæœ‰å¤šç§å“ˆå¸Œå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¸ƒéš†è¿‡æ»¤å™¨è¯´æŸä¸ªå…ƒç´ å­˜åœ¨ï¼Œå°æ¦‚ç‡ä¼šè¯¯åˆ¤ã€‚å¸ƒéš†è¿‡æ»¤å™¨è¯´æŸä¸ªå…ƒç´ ä¸åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ â¼€å®šä¸åœ¨ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç¼“å­˜å‡»ç©¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜å‡»ç©¿&#34;&gt;#&lt;/a&gt; ç¼“å­˜å‡»ç©¿&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿&#34;&gt;#&lt;/a&gt; ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿&lt;/h3&gt;
&lt;p&gt;ğŸ‘€ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ç¼“å­˜ä¸­çš„æŸä¸ª key çªç„¶å¤±æ•ˆï¼ˆä¸€èˆ¬æ˜¯ç¼“å­˜æ—¶é—´åˆ°æœŸï¼‰ï¼Œä½†æ˜¯è¿™æ˜¯çš„è¯·æ±‚ç‰¹åˆ«å¤šï¼Œç›´æ¥è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çš„å‹åŠ›ç¬é—´å¤§å¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•&#34;&gt;#&lt;/a&gt; ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚&lt;/li&gt;
&lt;li&gt;åŠ äº’æ–¥é”&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç¼“å­˜é›ªå´©&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜é›ªå´©&#34;&gt;#&lt;/a&gt; ç¼“å­˜é›ªå´©&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©&#34;&gt;#&lt;/a&gt; ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©&lt;/h3&gt;
&lt;p&gt;ğŸ‘€ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­çš„æ•°æ®åœ¨åŒä¸€æ—¶é—´å†…å¤§é¢ç§¯å¤±æ•ˆï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚è½åœ¨æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—å¤§é‡è¯·æ±‚ï¼Œå¦‚é›ªå´©ä¸€èˆ¬ï¼Œç»™æ•°æ®é€ æˆè¶…å¤§çš„å‹åŠ›ï¼Œå¯èƒ½å¯¼è‡´å®•æœºã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹â¼¦ ï¼šç§’æ€å¼€å§‹ 12 ä¸ªâ¼©æ—¶ä¹‹å‰ï¼Œæˆ‘ä»¬ç»Ÿâ¼€å­˜æ”¾äº†â¼€æ‰¹å•†å“åˆ° Redis ä¸­ï¼Œè®¾ç½®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ä¹Ÿæ˜¯ 12 ä¸ªâ¼©æ—¶ï¼Œé‚£ä¹ˆç§’æ€å¼€å§‹çš„æ—¶å€™ï¼Œè¿™äº›ç§’æ€çš„å•†å“çš„è®¿é—®ç›´æ¥å°±å¤±æ•ˆäº†ã€‚å¯¼è‡´çš„æƒ…å†µå°±æ˜¯ï¼Œç›¸åº”çš„è¯·æ±‚ç›´æ¥å°±è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå°±åƒé›ªå´©â¼€æ ·å¯æ€•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•&#34;&gt;#&lt;/a&gt; ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœç¼“å­˜æ•°æ®åº“æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²ï¼ŒRedis é›†ç¾¤ï¼Œå°†çƒ­ç‚¹æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒæå¾—ç¼“å­˜æ•°æ®åº“ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½®çƒ­ç‚¹æ•°æ®ç¼“å­˜æ°¸è¿œä¸è¿‡æœŸã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§&#34;&gt;#&lt;/a&gt; å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§&lt;/h3&gt;
&lt;p&gt;â­æœ€ç®€å•çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨æ›´æ–°æ•°æ®åº“æ—¶ï¼Œæ›´æ–°æˆåŠŸåç›´æ¥åˆ æ‰ç¼“å­˜ã€‚å³ &lt;strong&gt;Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ•°æ®åº“åˆ é™¤å¤±è´¥çš„ï¼Œå¯ä»¥å¢åŠ é‡è¯•æœºåˆ¶æˆ–è€…å°†ç¼“å­˜æ—¶é—´ç¼©çŸ­ã€‚&lt;/p&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="é¢è¯•" scheme="https://shaogezhu.cn/tags/%E9%9D%A2%E8%AF%95/" />
        <category term="Redis" scheme="https://shaogezhu.cn/tags/Redis/" />
        <updated>2021-09-15T13:12:45.000Z</updated>
    </entry>
    <entry>
        <id>https://shaogezhu.cn/2021/9/b35e5850bf12/</id>
        <title>ç½‘ç«™å‹åŠ›æµ‹è¯•å·¥å…·ä¹‹ab (ApacheBench) å’Œ Jmeter è¯¦è§£</title>
        <link rel="alternate" href="https://shaogezhu.cn/2021/9/b35e5850bf12/"/>
        <content type="html">&lt;div class=&#34;note info&#34;&gt;
&lt;p&gt;æˆ‘ä»¬å†™é¡¹ç›®çš„æ—¶å€™ç»å¸¸éœ€è¦æµ‹è¯•ï¼Œä¸ä»…éœ€è¦åŠŸèƒ½æµ‹è¯•è¿˜éœ€è¦å‹åŠ›æµ‹è¯•ã€‚æ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹å¤§å®¶ç»å¸¸ä½¿ç”¨çš„æµ‹è¯•å·¥å…·ã€‚åœ¨å­¦ä¹  DDoS çŸ¥è¯†çš„è¿‡ç¨‹ä¸­ï¼Œäº†è§£åˆ° ab è¿™ä¸ªæµ‹å‹å·¥å…·ï¼Œä¹‹å‰åœ¨å…¶ä»–åšå®¢ä¸Šä¹Ÿäº†è§£åˆ° jmeter çš„æµ‹å‹å·¥å…·ã€‚è¿™ä¸¤æ¬¾è½¯ä»¶éƒ½æ˜¯ Apache çš„å¼€æºé¡¹ç›®ï¼Œä¹Ÿæ˜¯ç›®å‰å¸¸ç”¨çš„ç½‘ç«™æµ‹å‹å·¥å…·ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;abå’Œjmeterçš„åŒºåˆ«&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#abå’Œjmeterçš„åŒºåˆ«&#34;&gt;#&lt;/a&gt; ab å’Œ jmeter çš„åŒºåˆ«&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;1. jmeter æ˜¯ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚å’Œè¿”å›ï¼›AB åªæ˜¯å‘å‡ºå»è¯·æ±‚&lt;br /&gt;
 2. ab æ˜¯ shell æ¨¡å¼ä¸‹è½»é‡çº§çš„æµ‹è¯•å·¥å…·ï¼Œjmeter åˆ™ä½œä¸ºæœ‰ GUI ç•Œé¢çš„æ›´é«˜çº§æµ‹è¯•å·¥å…·&lt;br /&gt;
 3. jmeter å¯ä»¥æä¾›æ›´åŠ è¯¦ç»†çš„ç»Ÿè®¡ç»“æœæ•°æ®ï¼Œæ¯”å¦‚æ¥å£é”™è¯¯ä¿¡æ¯ã€å•çº¿ç¨‹çš„è¯·æ±‚æ—¶é—´ç­‰ï¼Œè€Œ AB åˆ™ä¸æ”¯æŒ&lt;br /&gt;
 4. ab æ›´åŠ è½»é‡çº§ï¼Œè½¯ä»¶æ¶ˆè€—çš„èµ„æºå°‘ï¼Œä¸ä¼šå ç”¨å¤ªå¤šå†…å­˜å’Œ cpuï¼Œè€Œ jmeter æ¶ˆè€—èµ„æºæ¯”è¾ƒå¤š&lt;br /&gt;
 5. Jmeter å¯ä»¥åŠ¨æ€æŸ¥çœ‹ç»“æœï¼Œè€Œ ab ä¸å¯ä»¥ï¼Œåªæœ‰æ‰§è¡Œå®Œæ‰å‡ºç»“æœï¼ŒåŒæ—¶ Jmeter çš„ç»“æœæ›´åŠ å‡†ç¡®&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;abå¦‚ä½•ä½¿ç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#abå¦‚ä½•ä½¿ç”¨&#34;&gt;#&lt;/a&gt; ab å¦‚ä½•ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;ab æ˜¯ httpdï¼ˆä¹Ÿå« apacheï¼‰æºå¸¦çš„è½»é‡çº§æµ‹å‹å·¥å…·ï¼Œæˆ‘ä»¬è¦ä» apache çš„å®˜ç½‘ä¸Šä¸‹è½½ httpd&lt;/p&gt;
&lt;h3 id=&#34;ä¸‹è½½httpdapache&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸‹è½½httpdapache&#34;&gt;#&lt;/a&gt; ä¸‹è½½ httpdï¼ˆapacheï¼‰ğŸ«&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;linux ç‰ˆæœ¬ä¸‹è½½æ¯”è¾ƒå®¹æ˜“ï¼Œä»¥ windows ç‰ˆæœ¬ï¼Œapache 2.4 ä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®˜ç½‘ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9odHRwZC5hcGFjaGUub3JnLw==&#34;&gt;https://httpd.apache.org/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab1.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 ç‚¹å‡» download&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab2.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ­¤å¤„éšä¾¿é€‰ä¸€ä¸ªæä¾›å•†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab3.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;é€‰æ‹©ç‰ˆæœ¬ä¸‹è½½&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab4.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½å®Œä¹‹åè§£å‹&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨abå’Œabs&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä½¿ç”¨abå’Œabs&#34;&gt;#&lt;/a&gt; ä½¿ç”¨ ab å’Œ abs&lt;/h3&gt;
&lt;p&gt;è§£å‹åï¼Œåœ¨ bin ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå°å·¥å…· ab.exe å’Œ abs.exe ï¼Œåˆ†åˆ«ç”¨äº http å’Œ httpsã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab5.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹åå¯ä»¥æ‰“å¼€ cmd æˆ–è€… shellï¼Œç›´æ¥ä½¿ç”¨ ab å’Œ abs å·¥å…·&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ ab -help åˆ—å‡ºäº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„å‚æ•°&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab6.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœ€å¸¸ç”¨çš„æŒ‡ä»¤æ˜¯ ab -n 100 -c 10 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3Rlc3QuY29tLw==&#34;&gt;http://test.com/&lt;/span&gt; å…¶ä¸­ï¼n è¡¨ç¤ºè¯·æ±‚æ€»æ•°ï¼Œï¼c è¡¨ç¤ºå¹¶å‘æ•°&lt;/p&gt;
&lt;p&gt;å¯¹äº https åè®® ä½¿ç”¨ abs -n 100 -c 10 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly90ZXN0LmNvbS8=&#34;&gt;https://test.com/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä»¥å¯¹æˆ‘çš„ç½‘ç«™è¿›è¡Œæµ‹å‹ä¸ºä¾‹ï¼ˆåˆ«ä¹±ç”¨å•Šï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;æ­£åœ¨æµ‹å‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab7.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 è¿”å›çš„ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab8.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Server Software:&lt;/strong&gt; nginx/1.21.1 #è¢«æµ‹è¯•çš„ Web æœåŠ¡å™¨è½¯ä»¶åç§°ã€‚&lt;br /&gt;
&lt;strong&gt;Server Hostname:&lt;/strong&gt; &lt;a href=&#34;http://shaogezhu.cn/&#34;&gt;shaogezhu.cn/&lt;/a&gt; #è¯·æ±‚çš„ URL ä¸»æœºåã€‚&lt;br /&gt;
&lt;strong&gt;Server Port:&lt;/strong&gt; 443 #è¢«æµ‹è¯•çš„ Web æœåŠ¡å™¨è½¯ä»¶çš„ç›‘å¬ç«¯å£ã€‚&lt;br /&gt;
&lt;strong&gt;SSL/TLS Protocol:&lt;/strong&gt; TLSv1.2,ECDHE-RSA-AES256-GCM-SHA384,2048,256 Server Temp Key: X25519 253 bits TLS&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Server Name:&lt;/strong&gt; &lt;a href=&#34;http://shaogezhu.cn&#34;&gt;shaogezhu.cn&lt;/a&gt;&lt;br /&gt;
&lt;strong&gt;Document Path:&lt;/strong&gt; / #è¯·æ±‚çš„ URL ä¸­çš„æ ¹ç»å¯¹è·¯å¾„ï¼Œé€šè¿‡è¯¥æ–‡ä»¶çš„åç¼€åï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥äº†è§£è¯¥è¯·æ±‚çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Document Length:&lt;/strong&gt; 1270 bytes #è¡¨ç¤º HTTP å“åº”æ•°æ®çš„æ­£æ–‡é•¿åº¦ã€‚&lt;br /&gt;
&lt;strong&gt;Concurrency Level:&lt;/strong&gt; 10 #å¹¶å‘ç”¨æˆ·æ•°ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¾ç½®çš„å‚æ•°ä¹‹ä¸€ã€‚&lt;br /&gt;
&lt;strong&gt;Time taken for tests:&lt;/strong&gt; 27.378 seconds #æ‰€æœ‰è¿™äº›è¯·æ±‚è¢«å¤„ç†å®Œæˆæ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Complete requests:&lt;/strong&gt; 100 #æ€»è¯·æ±‚æ•°é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¾ç½®çš„å‚æ•°ä¹‹ä¸€ã€‚ Failed requests: 1 #å¤±è´¥çš„è¯·æ±‚æ•°é‡ï¼Œ (Connect: 1, Receive: 0, Length: 0, Exceptions: 0) Total transferred: 150400 bytes # æ‰€æœ‰è¯·æ±‚çš„å“åº”æ•°æ®é•¿åº¦æ€»å’Œï¼ŒåŒ…æ‹¬æ¯ä¸ª HTTP å“åº”æ•°æ®çš„å¤´ä¿¡æ¯å’Œæ­£æ–‡æ•°æ®çš„é•¿åº¦ã€‚æ³¨æ„è¿™é‡Œä¸åŒ…æ‹¬ HTTP è¯·æ±‚æ•°æ®çš„é•¿åº¦ï¼Œä»…ä»…ä¸º web æœåŠ¡å™¨æµå‘ç”¨æˆ· PC çš„åº”ç”¨å±‚æ•°æ®æ€»é•¿åº¦ HTML transferred: 127000 bytes #è¡¨ç¤ºæ‰€æœ‰è¯·æ±‚çš„å“åº”æ•°æ®ä¸­æ­£æ–‡æ•°æ®çš„æ€»å’Œï¼Œä¹Ÿå°±æ˜¯å‡å»äº† Total transferred ä¸­ HTTP å“åº”æ•°æ®ä¸­çš„å¤´ä¿¡æ¯çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Requests per second:&lt;/strong&gt; 3.65 [#/sec] (mean) #æ¯ç§’å¤šå°‘è¯·æ±‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Time per request:&lt;/strong&gt; 2737.802 [ms] (mean) #ç”¨æˆ·å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Time per request:&lt;/strong&gt; 273.780 [ms] (mean, across all concurrent requests) #æœåŠ¡å™¨å¹³å‡å¤„ç†æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨ååé‡çš„å€’æ•° Transfer rate: 5.36 [Kbytes/sec] received #è¡¨ç¤ºè¿™äº›è¯·æ±‚åœ¨å•ä½æ—¶é—´å†…ä»æœåŠ¡å™¨è·å–çš„æ•°æ®é•¿åº¦&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Percentage of the requests served within a certain time (ms)&lt;/strong&gt; #è¿™éƒ¨åˆ†æ•°æ®ç”¨äºæè¿°æ¯ä¸ªè¯·æ±‚å¤„ç†æ—¶é—´çš„åˆ†å¸ƒæƒ…å†µ 50% 584 66% 600 75% 624 80% 669 90% 862 95% 21606 98% 21623 99% 21626 100% 21626 (longest request)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ€é‡è¦çš„ä¸‰ä¸ªå‚æ•°ï¼š&lt;/strong&gt; â­&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Requests per secondï¼šååç‡ ï¼ŒæŒ‡çš„æ˜¯æŸä¸ªå¹¶å‘ç”¨æˆ·æ•°ä¸‹å•ä½æ—¶é—´å†…å¤„ç†çš„è¯·æ±‚æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Time per requestï¼šä¸Šé¢çš„æ˜¯ç”¨æˆ·å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Time per requestï¼šä¸‹é¢çš„æ˜¯æœåŠ¡å™¨å¹³å‡è¯·æ±‚å¤„ç†æ—¶é—´ æ˜¯ååç‡çš„å€’æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä½¿ç”¨jmeter&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä½¿ç”¨jmeter&#34;&gt;#&lt;/a&gt; ä½¿ç”¨ jmeter&lt;/h2&gt;
&lt;p&gt;JMeter æ˜¯ Apache ç»„ç»‡å¼€å‘çš„åŸºäº Java çš„å‹åŠ›æµ‹è¯•å·¥å…·ã€‚ç”¨äºå¯¹è½¯ä»¶åšå‹åŠ›æµ‹è¯•ï¼Œå®ƒæœ€åˆè¢«è®¾è®¡ç”¨äº Web åº”ç”¨æµ‹è¯•ï¼Œä½†åæ¥æ‰©å±•åˆ°å…¶ä»–æµ‹è¯•é¢†åŸŸã€‚ å®ƒå¯ä»¥ç”¨äºæµ‹è¯•é™æ€å’ŒåŠ¨æ€èµ„æºï¼Œä¾‹å¦‚é™æ€æ–‡ä»¶ã€Java å°æœåŠ¡ç¨‹åºã€CGI è„šæœ¬ã€Java å¯¹è±¡ã€æ•°æ®åº“ã€FTP æœåŠ¡å™¨ï¼Œ ç­‰ç­‰ã€‚JMeter è¿˜æ”¯æŒé€šè¿‡åˆ›å»ºå¸¦æœ‰æ–­è¨€çš„è„šæœ¬æ¥éªŒè¯ä½ çš„ç¨‹åºè¿”å›äº†ä½ æœŸæœ›çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æ¨èä¸€ä¸ª jmeter çš„ä½¿ç”¨æ•™ç¨‹ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5qbWV0ZXIuY29tLmNuL2NhdGVnb3J5L2ptZXRlci1ib29r&#34;&gt;http://www.jmeter.com.cn/category/jmeter-book&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸‹è½½&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä¸‹è½½&#34;&gt;#&lt;/a&gt; ä¸‹è½½&lt;/h3&gt;
&lt;p&gt;å› ä¸ºå®ƒæ˜¯åŸºäº java çš„ï¼Œä¸‹è½½å‰è¯·ç¡®ä¿ä½ æœ‰ jdkï¼ˆ8 ä»¥ä¸Šï¼‰çš„ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹è½½åœ°å€ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2ptZXRlci5hcGFjaGUub3JnL2Rvd25sb2FkX2ptZXRlci5jZ2k=&#34;&gt;http://jmeter.apache.org/download_jmeter.cgi&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€‰æ‹©å³ä¾§éœ€è¦ä¸‹è½½çš„å‹ç¼©åŒ…ç‰ˆæœ¬ï¼ˆæˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯ apache-jmeter-5.4.1.zipï¼‰ï¼Œä¸‹è½½å®Œæˆåè§£å‹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab9.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¯åŠ¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å¯åŠ¨&#34;&gt;#&lt;/a&gt; å¯åŠ¨&lt;/h3&gt;
&lt;p&gt;ğŸˆæˆ‘ä»¬åœ¨è§£å‹åçš„ bin ç›®å½•ä¸‹æ‰¾åˆ° jmeter.bat çš„æ‰¹å¤„ç†è„šæœ¬ï¼Œåªè¦æœ‰ jdk8 çš„ç³»ç»Ÿç¯å¢ƒï¼Œç‚¹å‡»å³å¯å¯åŠ¨ï¼Œå‡ºç°ä¸€ä¸ª cmd çª—å£å’Œ Jmeter çš„ GUI ç•Œé¢ï¼ˆåŸºäº Swingï¼‰ï¼Œæ³¨æ„ä¸è¦å…³é—­ cmd çª—å£ï¼Œä¸ç„¶ GUI çª—å£ä¹Ÿä¼šå…³é—­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab10.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 ä¹Ÿå¯ä»¥æŠŠ Jmeter æ”¾å…¥ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼Œå‘½ä»¤è¡Œä¸­è¾“å…¥ Jmeter å³å¯å¯åŠ¨ã€‚æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ä¸å¤šï¼Œå°±ä¸åšè®²è§£ï¼Œå¦‚æœæƒ³è¦äº†è§£è¯¦æƒ…ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢æä¾›çš„è¿æ¥ä¸­çš„ä½¿ç”¨æ•™ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä½¿ç”¨&#34;&gt;#&lt;/a&gt; ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;1. å³å‡»å·¦è¾¹çš„ Test Plan æ·»åŠ ä¸€ä¸ªçº¿ç¨‹ç»„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab11.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 åœ¨è¿™ä¸ªçº¿ç¨‹ç»„ä¸‹è¿™ä¸ªçº¿ç¨‹ç»„çš„çº¿ç¨‹æ•°ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ç”¨æˆ·æ•°ï¼Œå¾ªç¯æ¬¡æ•°æ¯ä¸ªå¹¶å‘ç”¨æˆ·çš„è¯·æ±‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å‚æ•° ramp-up period ç”¨äºå‘ŠçŸ¥ JMeter è¦åœ¨å¤šé•¿æ—¶é—´å†…å»ºç«‹å…¨éƒ¨çš„çº¿ç¨‹ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚å‡å¦‚è¯´ ramp-up period ä¸ºé›¶ï¼Œ JMeter å°†ç«‹å³å»ºç«‹æ‰€æœ‰çº¿ç¨‹ï¼Œå¹¶å‘è®¿é—®ï¼Œå‡è®¾ ramp-up period è®¾ç½®æˆ T ç§’ï¼Œ å…¨éƒ¨çº¿ç¨‹æ•°è®¾ç½®æˆ N ä¸ªï¼Œ JMeter å°†æ¯éš” T/N ç§’å»ºç«‹ä¸€ä¸ªçº¿ç¨‹&lt;/p&gt;
&lt;p&gt;ğŸ‘‰ğŸ» Loop Count æ˜¯å¾ªç¯æ¬¡æ•°ï¼Œ&lt;strong&gt;è¯·æ±‚æ€»æ•°é‡ = çº¿ç¨‹æ•° * å¾ªç¯æ¬¡æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab12.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;2. åœ¨è¿™ä¸ªçº¿ç¨‹ç»„ä¸‹å³é”®åœ¨ samplerï¼ˆå–æ ·å™¨ï¼‰é‡Œé¢é€‰æ‹© http è¯·æ±‚ï¼Œåˆ›å»º http è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab13.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 å¯ä»¥è®¾ç½® http è¯·æ±‚çš„åè®®ï¼Œå‚æ•°ï¼Œè·¯å¾„ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab14.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
3. åœ¨ HTTP è¯·æ±‚å³é”®é‡Œé¢é€‰æ‹©ç›‘å¬å™¨ä¸‹çš„èšåˆæŠ¥å‘Šï¼Œåˆ›å»ºä¸€ä¸ªèšåˆæŠ¥å‘Šï¼Œå¯ä»¥æŸ¥çœ‹è¿™æ¬¡æµ‹è¯•çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥æ·»åŠ ç»“æœæ ‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab15.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
4. ç‚¹å‡»å¯åŠ¨çš„å›¾æ ‡ï¼Œä¹‹åå†èšåˆæŠ¥å‘Šå’Œè§†å›¾ç»“æœæ ‘ä¸­æŸ¥çœ‹æœ¬æ¬¡æµ‹è¯•çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;èšåˆæŠ¥å‘Šå¯ä»¥æŸ¥çœ‹ç»Ÿè®¡æ•°æ®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab16.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®å«ä¹‰ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Labelï¼š&lt;/strong&gt; æ¯ä¸ª JMeter çš„ elementï¼ˆä¾‹å¦‚ HTTP Requestï¼‰éƒ½æœ‰ä¸€ä¸ª Name å±æ€§ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„å°±æ˜¯ Name å±æ€§çš„å€¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Samplesï¼š&lt;/strong&gt; è¡¨ç¤ºä½ è¿™æ¬¡æµ‹è¯•ä¸­ä¸€å…±å‘å‡ºäº†å¤šå°‘ä¸ªè¯·æ±‚ï¼Œå¦‚æœæ¨¡æ‹Ÿ 10 ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·è¿­ä»£ 10 æ¬¡ï¼Œé‚£ä¹ˆè¿™é‡Œæ˜¾ç¤º 100&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Averageï¼š&lt;/strong&gt; å¹³å‡å“åº”æ—¶é—´ â€”â€” é»˜è®¤æƒ…å†µä¸‹æ˜¯å•ä¸ª Request çš„å¹³å‡å“åº”æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Medianï¼š&lt;/strong&gt;  ä¸­ä½æ•°ï¼Œä¹Ÿå°±æ˜¯ 50 ï¼…ç”¨æˆ·çš„å“åº”æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;90% Lineï¼š&lt;/strong&gt;   90 ï¼…ç”¨æˆ·çš„å“åº”æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Minï¼š&lt;/strong&gt; æœ€å°å“åº”æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Maxï¼š&lt;/strong&gt;  æœ€å¤§å“åº”æ—¶é—´&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Error%ï¼š&lt;/strong&gt; æœ¬æ¬¡æµ‹è¯•ä¸­å‡ºç°é”™è¯¯çš„è¯·æ±‚çš„æ•°é‡ / è¯·æ±‚çš„æ€»æ•°&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Throughputï¼š&lt;/strong&gt; ååé‡ â€”â€” é»˜è®¤æƒ…å†µä¸‹è¡¨ç¤ºæ¯ç§’å®Œæˆçš„è¯·æ±‚æ•°&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;KB/Secï¼š&lt;/strong&gt; æ¯ç§’ä»æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°çš„æ•°æ®é‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç»“æœæ ‘å¯ä»¥æŸ¥çœ‹æ¯ä¸€ä¸ªè¯·æ±‚å’Œè¯·æ±‚è¿”å›çš„ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab17.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°ï¼Œè™½ç„¶è®¾ç½®ä¸ºäº† https å’Œ 443 ç«¯å£ï¼Œä½†æ˜¯ Jmeter è¿˜æ˜¯èµ°äº† httpï¼Œè€Œè¦è®© Jmeter ä½¿ç”¨ Https åè®®ï¼Œéœ€è¦æˆ‘ä»¬å¯¼å…¥ Https è¯ä¹¦ï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰å½•åˆ¶ Https å’Œæ‰‹åŠ¨é…ç½®è¯ä¹¦ä¸¤ç§åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;å½•åˆ¶ httpsï¼š&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼ Jmeter ä¼šä»£ç†æµè§ˆå™¨çš„è¯·æ±‚å’Œå“åº”ã€‚&lt;/p&gt;
&lt;p&gt;æ‰‹åŠ¨é…ç½®è¯ä¹¦ï¼š&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è¿™ç§åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;1ï¼‰ä¸‹è½½è¢«æµ‹ç½‘ç«™è¯ä¹¦å¯¼å…¥ Jmeter&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab18.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
&lt;img data-src=&#34;/assets/2021-9/ab19.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 ä½¿ç”¨ jdk è‡ªå¸¦çš„å·¥å…· keytool å°† cer æ ¼å¼çš„è¯ä¹¦è½¬æ¢ä¸º store æ ¼å¼&lt;/p&gt;
&lt;p&gt;å‘½ä»¤å¦‚ä¸‹ keytool -import -alias &amp;quot;test.store&amp;quot; -file &amp;quot;my.cer&amp;quot; -keystore test.store ä¸­é—´ä¼šè¦æ±‚è®¾ç½®å£ä»¤&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab20.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
 å† Jmeter ä¸­é€‰æ‹© SSL Manager å¯¼å…¥è¯ä¹¦&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/assets/2021-9/ab21.jpg&#34; alt=&#34;image.png&#34; /&gt;&lt;br /&gt;
2) ä¹‹åå³å¯ä½¿ç”¨ https åè®®&lt;/p&gt;
&lt;h2 id=&#34;æœ€å&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœ€å&#34;&gt;#&lt;/a&gt; æœ€å&lt;/h2&gt;
&lt;p&gt;è¡¥å…… ab å·¥å…·çš„æ‰€æœ‰å‚æ•°è§£é‡ŠğŸš€ğŸš€ğŸš€&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-n æµ‹è¯•ä¼šè¯ä¸­æ‰€æ‰§è¡Œçš„è¯·æ±‚ä¸ªæ•°ï¼Œé»˜è®¤ä»…æ‰§è¡Œä¸€ä¸ªè¯·æ±‚&lt;br /&gt;
 - c ä¸€æ¬¡äº§ç”Ÿçš„è¯·æ±‚ä¸ªæ•°ï¼Œå³åŒä¸€æ—¶é—´å‘å‡ºå¤šå°‘ä¸ªè¯·æ±‚ï¼Œé»˜è®¤ä¸ºä¸€æ¬¡ä¸€ä¸ª&lt;br /&gt;
 - t æµ‹è¯•æ‰€è¿›è¡Œçš„æœ€å¤§ç§’æ•°ï¼Œé»˜è®¤ä¸ºæ— æ—¶é—´é™åˆ¶.... å…¶å†…éƒ¨éšå«å€¼æ˜¯ [-n 50000], å®ƒå¯ä»¥ä½¿å¯¹æœåŠ¡å™¨çš„æµ‹è¯•é™åˆ¶åœ¨ä¸€ä¸ªå›ºå®šçš„æ€»æ—¶é—´ä»¥å†…&lt;br /&gt;
 - p åŒ…å«äº†éœ€è¦ POST çš„æ•°æ®çš„æ–‡ä»¶&lt;br /&gt;
 - T POST æ•°æ®æ‰€ä½¿ç”¨çš„ Content-type å¤´ä¿¡æ¯&lt;br /&gt;
 - v è®¾ç½®æ˜¾ç¤ºä¿¡æ¯çš„è¯¦ç»†ç¨‹åº¦&lt;br /&gt;
 - w ä»¥ HTML è¡¨æ ¼çš„å½¢å¼è¾“å‡ºç»“æœï¼Œé»˜è®¤æ˜¯ç™½è‰²èƒŒæ™¯çš„ä¸¤åˆ—å®½åº¦çš„ä¸€å¼ è¡¨&lt;br /&gt;
 - i ä»¥ HTML è¡¨æ ¼çš„å½¢å¼è¾“å‡ºç»“æœï¼Œé»˜è®¤æ˜¯ç™½è‰²èƒŒæ™¯çš„ä¸¤åˆ—å®½åº¦çš„ä¸€å¼ è¡¨&lt;br /&gt;
 - C å¯¹è¯·æ±‚é™„åŠ ä¸€ä¸ª Cookie è¡Œï¼Œå…¶å…¸å‹å½¢å¼æ˜¯ name=value çš„å‚æ•°å¯¹ï¼Œæ­¤å‚æ•°å¯ä»¥é‡å¤&lt;br /&gt;
 - H å¯¹è¯·æ±‚é™„åŠ é¢å¤–çš„å¤´ä¿¡æ¯ï¼Œæ­¤å‚æ•°çš„å…¸å‹å½¢å¼æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å¤´ä¿¡æ¯è¡Œï¼Œå…¶ä¸­åŒ…å«äº†ä»¥å†’å·åˆ†éš”çš„å­—æ®µå’Œå€¼çš„å¯¹ (å¦‚ &amp;quot;Accept-Encoding: zip/zop;8bit&amp;quot;)&lt;br /&gt;
-A HTTP éªŒè¯ï¼Œç”¨å†’å·ï¼šåˆ†éš”ä¼ é€’ç”¨æˆ·ååŠå¯†ç &lt;br /&gt;
 - P æ— è®ºæœåŠ¡å™¨æ˜¯å¦éœ€è¦ (å³æ˜¯å¦å‘é€äº† 401 è®¤è¯éœ€æ±‚ä»£ç ), æ­¤å­—ç¬¦ä¸²éƒ½ä¼šè¢«å‘é€&lt;br /&gt;
 - X å¯¹è¯·æ±‚ä½¿ç”¨ä»£ç†æœåŠ¡å™¨&lt;br /&gt;
 - V æ˜¾ç¤ºç‰ˆæœ¬å·å¹¶é€€å‡º&lt;br /&gt;
 - k å¯ç”¨ HTTP KeepAlive åŠŸèƒ½ï¼Œå³åœ¨ä¸€ä¸ª HTTP ä¼šè¯ä¸­æ‰§è¡Œå¤šä¸ªè¯·æ±‚ï¼Œé»˜è®¤ä¸ºä¸å¯ç”¨ KeepAlive åŠŸèƒ½&lt;br /&gt;
 - d ä¸æ˜¾ç¤º &amp;quot;percentage served within XX [ms] table&amp;quot; çš„æ¶ˆæ¯ (ä¸ºä»¥å‰çš„ç‰ˆæœ¬æä¾›æ”¯æŒ)&lt;br /&gt;
-S ä¸æ˜¾ç¤ºä¸­å€¼å’Œæ ‡å‡†èƒŒç¦»å€¼ï¼Œä¸”å‡å€¼å’Œä¸­å€¼ä¸ºæ ‡å‡†èƒŒç¦»å€¼çš„ 1 åˆ° 2 å€æ—¶ï¼Œä¹Ÿä¸æ˜¾ç¤ºè­¦å‘Šæˆ–å‡ºé”™ä¿¡æ¯ï¼Œé»˜è®¤ä¼šæ˜¾ç¤ºæœ€å°å€¼ / å‡å€¼ / æœ€å¤§å€¼ç­‰ (ä¸ºä»¥å‰çš„ç‰ˆæœ¬æä¾›æ”¯æŒ)&lt;br /&gt;
-g æŠŠæ‰€æœ‰æµ‹è¯•ç»“æœå†™å…¥ä¸€ä¸ª &#39;gnuplot&#39; æˆ–è€… TSV (ä»¥ Tab åˆ†éš”çš„) æ–‡ä»¶&lt;br /&gt;
 - e äº§ç”Ÿä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„ (CSV) æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¤„ç†æ¯ä¸ªç›¸åº”ç™¾åˆ†æ¯”çš„è¯·æ±‚æ‰€éœ€è¦ (ä» 1% åˆ° 100%) çš„ç›¸åº”ç™¾åˆ†æ¯”çš„ (ä»¥å¾®å¦™ä¸ºå•ä½) æ—¶é—´ -h æ˜¾ç¤ºä½¿ç”¨æ–¹æ³•&lt;br /&gt;
 - k å‘é€ keep-alive æŒ‡ä»¤åˆ°æœåŠ¡å™¨ç«¯&lt;/p&gt;
&lt;/blockquote&gt;
</content>
        <category term="Java" scheme="https://shaogezhu.cn/categories/java/" />
        <category term="å­¦ä¹ ç¬”è®°" scheme="https://shaogezhu.cn/categories/java/note/" />
        <category term="java" scheme="https://shaogezhu.cn/tags/java/" />
        <category term="æ•™ç¨‹" scheme="https://shaogezhu.cn/tags/%E6%95%99%E7%A8%8B/" />
        <category term="å‹æµ‹" scheme="https://shaogezhu.cn/tags/%E5%8E%8B%E6%B5%8B/" />
        <category term="å·¥å…·" scheme="https://shaogezhu.cn/tags/%E5%B7%A5%E5%85%B7/" />
        <updated>2021-09-03T12:46:25.000Z</updated>
    </entry>
</feed>
