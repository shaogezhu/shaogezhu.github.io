{
    "version": "https://jsonfeed.org/version/1",
    "title": "ç”°åŸ‚ã®æŠ€æœ¯åˆ†äº«",
    "subtitle": "å’Œä½ ä¸€èµ·é‡è§æ›´å¥½çš„è‡ªå·±",
    "icon": "https://shaogezhu.cn/images/favicon.ico",
    "description": "ä»åœ¨å¥”èµ´è¿œæ–¹è·¯ä¸Šçš„å°‘å¹´",
    "home_page_url": "https://shaogezhu.cn",
    "items": [
        {
            "id": "https://shaogezhu.cn/2022/8/9b38152aa2ec/",
            "url": "https://shaogezhu.cn/2022/8/9b38152aa2ec/",
            "title": "æ¨èå‡ ä¸ªæå‡Javaå¼€å‘æ•ˆç‡çš„â€œè½®å­â€",
            "date_published": "2022-08-21T09:31:06.000Z",
            "content_html": "<div class=\"note info\">\n<p>åœ¨ <code>java</code>  çš„åºå¤§ä½“ç³»ä¸­ï¼Œå…¶å®æœ‰å¾ˆå¤šä¸é”™çš„å°å·¥å…·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„ï¼š <code>è½®å­</code> ã€‚å¦‚æœåœ¨æˆ‘ä»¬çš„æ—¥å¸¸å·¥ä½œå½“ä¸­ï¼Œèƒ½å¤Ÿå°†è¿™äº›è½®å­ç”¨æˆ·ï¼Œå†é…åˆä¸€ä¸‹ <code>idea</code>  çš„å¿«æ·é”®ï¼Œå¯ä»¥æå¤§å¾—æå‡æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ğŸš€</p>\n<p>ä»Šå¤©æŠŠæˆ‘ä¸€äº›å‹ç®±åº•çš„å°å·¥å…·ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ğŸ“Œã€‚</p>\n</div>\n<br/>\n<h2 id=\"collections\"><a class=\"anchor\" href=\"#collections\">#</a> Collections</h2>\n<blockquote>\n<p>é¦–å…ˆå‡ºåœºçš„æ˜¯ <code>java.util</code>  åŒ…ä¸‹çš„ <code>Collections</code>  ç±»ï¼Œè¯¥ç±»ä¸»è¦ç”¨äºæ“ä½œé›†åˆæˆ–è€…è¿”å›é›†åˆï¼Œæˆ‘ä¸ªäººéå¸¸å–œæ¬¢ç”¨å®ƒã€‚</p>\n</blockquote>\n<h3 id=\"æ’åº\"><a class=\"anchor\" href=\"#æ’åº\">#</a> æ’åº</h3>\n<p>åœ¨å·¥ä½œä¸­ç»å¸¸æœ‰å¯¹é›†åˆæ’åºçš„éœ€æ±‚ã€‚</p>\n<p>çœ‹ä¸€ä¸‹ä½¿ç”¨ <code>Collections</code>  å·¥å…· æ˜¯å¦‚ä½•å®ç°<strong>å‡åº</strong>å’Œ<strong>é™åº</strong>çš„ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å‡åº</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// é™åº</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"è·å–æœ€å¤§æˆ–æœ€å°å€¼\"><a class=\"anchor\" href=\"#è·å–æœ€å¤§æˆ–æœ€å°å€¼\">#</a> è·å–æœ€å¤§æˆ–æœ€å°å€¼</h3>\n<p>æœ‰æ—¶å€™éœ€è¦æ‰¾å‡ºé›†åˆä¸­çš„ <code>æœ€å¤§å€¼</code> æˆ–è€… <code>æœ€å°å€¼</code> ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ <code>Collections</code>  çš„ <code>max</code>  å’Œ <code>min</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Integer</span> max <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–æœ€å¤§å€¼</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">Integer</span> min <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è·å–æœ€å°å€¼</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span></pre></td></tr></table></figure><h3 id=\"è½¬æ¢çº¿ç¨‹å®‰å…¨é›†åˆ\"><a class=\"anchor\" href=\"#è½¬æ¢çº¿ç¨‹å®‰å…¨é›†åˆ\">#</a> è½¬æ¢çº¿ç¨‹å®‰å…¨é›†åˆ</h3>\n<blockquote>\n<p>æˆ‘ä»¬çŸ¥é“ï¼Œ <code>java</code>  ä¸­çš„å¾ˆå¤šé›†åˆï¼Œæ¯”å¦‚ï¼š <code>ArrayList</code> ã€ <code>LinkedList</code> ã€ <code>HashMap</code> ã€ <code>HashSet</code>  ç­‰ï¼Œéƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p>\n<p>æ¢å¥è¯è¯´ï¼Œè¿™äº›é›†åˆåœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸­ï¼Œæ·»åŠ æ•°æ®ä¼šå‡ºç°å¼‚å¸¸ã€‚</p>\n</blockquote>\n<p>å¯ä»¥ç”¨ <code>Collections</code>  çš„ <code>synchronizedxxx</code>  æ–¹æ³•ï¼Œå°†è¿™äº›çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆï¼Œç›´æ¥è½¬æ¢æˆçº¿ç¨‹å®‰å…¨é›†åˆã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> integers <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">synchronizedList</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å°† ArrayList è½¬æ¢æˆçº¿ç¨‹å®‰å…¨é›†åˆ</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>integers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å®ƒçš„åº•å±‚ä¼šåˆ›å»º <code>SynchronizedRandomAccessList</code>  æˆ–è€… <code>SynchronizedList</code>  ç±»ï¼Œè¿™ä¸¤ä¸ªç±»çš„å¾ˆå¤šæ–¹æ³•éƒ½ä¼šç”¨ <code>synchronized</code>  åŠ é”ã€‚</p>\n<h3 id=\"è¿”å›ç©ºé›†åˆ\"><a class=\"anchor\" href=\"#è¿”å›ç©ºé›†åˆ\">#</a> è¿”å›ç©ºé›†åˆ</h3>\n<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬åœ¨åˆ¤ç©ºä¹‹åï¼Œéœ€è¦è¿”å›ç©ºé›†åˆï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>emptyList</code>  æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">fun</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>list <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">emptyList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// ä¸šåŠ¡å¤„ç†</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"äºŒåˆ†æŸ¥æ‰¾\"><a class=\"anchor\" href=\"#äºŒåˆ†æŸ¥æ‰¾\">#</a> äºŒåˆ†æŸ¥æ‰¾</h3>\n<p><code>binarySearch</code>  æ–¹æ³•æä¾›äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ <code>äºŒåˆ†æŸ¥æ‰¾</code> åŠŸèƒ½ï¼Œåªç”¨ä¼ å…¥æŒ‡å®šé›†åˆå’Œéœ€è¦æ‰¾åˆ°çš„ <code>key</code>  å³å¯ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">binarySearch</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// äºŒåˆ†æŸ¥æ‰¾</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">2</span></pre></td></tr></table></figure><h3 id=\"è½¬æ¢æˆä¸å¯ä¿®æ”¹é›†åˆ\"><a class=\"anchor\" href=\"#è½¬æ¢æˆä¸å¯ä¿®æ”¹é›†åˆ\">#</a> è½¬æ¢æˆä¸å¯ä¿®æ”¹é›†åˆ</h3>\n<p>ä¸ºäº†é˜²æ­¢åç»­çš„ç¨‹åºæŠŠæŸä¸ªé›†åˆçš„ç»“æœä¿®æ”¹äº†ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠæŸä¸ªé›†åˆå®šä¹‰æˆä¸å¯ä¿®æ”¹çš„ï¼Œä½¿ç”¨ Collections çš„ <code>unmodifiablexxx</code>  æ–¹æ³•å°±èƒ½è½»æ¾å®ç°ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> integers <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">unmodifiableList</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>integers<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>integers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Exception</span> in thread <span class=\"token string\">\"main\"</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>UnsupportedOperationException</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> at <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span>Collections</span>$<span class=\"token class-name\">UnmodifiableCollection</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span>java<span class=\"token operator\">:</span><span class=\"token number\">1055</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> at <span class=\"token class-name\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>sue<span class=\"token punctuation\">.</span>jump<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>test1<span class=\"token punctuation\">.</span></span>UtilTest</span><span class=\"token punctuation\">.</span><span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UtilTest</span><span class=\"token punctuation\">.</span>java<span class=\"token operator\">:</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å½“ç„¶ Collections å·¥å…·ç±»ä¸­è¿˜æœ‰å¾ˆå¤šå¸¸ç”¨çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ï¼Œéœ€è¦ä½ è‡ªå·±å»æ¢ç´¢ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz1.png\" alt=\"image.png\" /></p>\n<p><img data-src=\"/assets/2022-8/lz2.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"collectionutils\"><a class=\"anchor\" href=\"#collectionutils\">#</a> CollectionUtils</h2>\n<p>å¯¹é›†åˆæ“ä½œï¼Œé™¤äº†å‰é¢è¯´çš„ <code>Collections</code>  å·¥å…·ç±»ä¹‹åï¼Œ <code>CollectionUtils</code>  å·¥å…·ç±»ä¹Ÿéå¸¸å¸¸ç”¨ã€‚</p>\n<p>ç›®å‰æ¯”è¾ƒä¸»æµçš„æ˜¯ <code>spring</code>  çš„ <code>org.springframework.util</code>  åŒ…ä¸‹çš„ <code>CollectionUtils</code>  å·¥å…·ç±»ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz3.png\" alt=\"image.png\" /></p>\n<p>å’Œ <code>apache</code>  çš„ <code>org.apache.commons.collections</code>  åŒ…ä¸‹çš„ <code>CollectionUtils</code>  å·¥å…·ç±»ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz4.png\" alt=\"image.png\" /></p>\n<p><img data-src=\"/assets/2022-8/lz5.png\" alt=\"image.png\" /></p>\n<blockquote>\n<p>æˆ‘ä¸ªäººæ›´æ¨èä½¿ç”¨ <code>apache</code>  çš„åŒ…ä¸‹çš„ <code>CollectionUtils</code>  å·¥å…·ç±»ï¼Œå› ä¸ºå®ƒçš„å·¥å…·æ›´å¤šæ›´å…¨é¢ã€‚</p>\n</blockquote>\n<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œ <code>spring</code>  çš„ <code>CollectionUtils</code>  å·¥å…·ç±»æ²¡æœ‰åˆ¤æ–­é›†åˆä¸ä¸ºç©ºçš„æ–¹æ³•ã€‚è€Œ <code>apache</code>  çš„ <code>CollectionUtils</code>  å·¥å…·ç±»å´æœ‰ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬ä»¥ <code>apache</code>  çš„ <code>CollectionUtils</code>  å·¥å…·ç±»ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸‹å¸¸ç”¨æ–¹æ³•ã€‚</p>\n<h3 id=\"é›†åˆåˆ¤ç©º\"><a class=\"anchor\" href=\"#é›†åˆåˆ¤ç©º\">#</a> é›†åˆåˆ¤ç©º</h3>\n<p>é€šè¿‡ <code>CollectionUtils</code>  å·¥å…·ç±»çš„ <code>isEmpty</code>  æ–¹æ³•å¯ä»¥è½»æ¾åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºï¼Œ <code>isNotEmpty</code>  æ–¹æ³•åˆ¤æ–­é›†åˆä¸ä¸ºç©ºã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é›†åˆä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é›†åˆä¸ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"å¯¹ä¸¤ä¸ªé›†åˆè¿›è¡Œæ“ä½œ\"><a class=\"anchor\" href=\"#å¯¹ä¸¤ä¸ªé›†åˆè¿›è¡Œæ“ä½œ\">#</a> å¯¹ä¸¤ä¸ªé›†åˆè¿›è¡Œæ“ä½œ</h3>\n<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹å·²æœ‰çš„ä¸¤ä¸ªé›†åˆè¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚å–<strong>äº¤é›†</strong>æˆ–è€…<strong>å¹¶é›†</strong>ç­‰ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>list2<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>list2<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">// è·å–å¹¶é›†</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> unionList <span class=\"token operator\">=</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">union</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>unionList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// è·å–äº¤é›†</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> intersectionList <span class=\"token operator\">=</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">intersection</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>intersectionList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// è·å–äº¤é›†çš„è¡¥é›†</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> disjunctionList <span class=\"token operator\">=</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">disjunction</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>disjunctionList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">// è·å–å·®é›†</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> subtractList <span class=\"token operator\">=</span> <span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">subtract</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>subtractList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>è¯´å¥å®è¯ï¼Œå¯¹ä¸¤ä¸ªé›†åˆçš„æ“ä½œï¼Œåœ¨å®é™…å·¥ä½œä¸­ç”¨å¾—æŒºå¤šçš„ï¼Œç‰¹åˆ«æ˜¯å¾ˆå¤šæ‰¹é‡çš„åœºæ™¯ä¸­ã€‚ä»¥å‰æˆ‘ä»¬éœ€è¦å†™ä¸€å †ä»£ç ï¼Œä½†æ²¡æƒ³åˆ°æœ‰ç°æˆçš„ &quot;è½®å­&quot;ã€‚</p>\n<br/>\n<h2 id=\"lists\"><a class=\"anchor\" href=\"#lists\">#</a> Lists</h2>\n<p>å¦‚æœä½ å¼•å…¥ <code>com.google.guava</code>  çš„ pom æ–‡ä»¶ï¼Œä¼šè·å¾—å¾ˆå¤šå¥½ç”¨çš„å°å·¥å…·ã€‚è¿™é‡Œæ¨èä¸€æ¬¾ <code>com.google.common.collect</code>  åŒ…ä¸‹çš„é›†åˆå·¥å…·ï¼š <code>Lists</code> ã€‚</p>\n<blockquote>\n<p>å®ƒå®åœ¨å¤ªå¥½ç”¨äº†ï¼Œè®©æˆ‘çˆ±ä¸é‡Šæ‰‹ã€‚</p>\n</blockquote>\n<h3 id=\"åˆ›å»ºç©ºé›†åˆ\"><a class=\"anchor\" href=\"#åˆ›å»ºç©ºé›†åˆ\">#</a> åˆ›å»ºç©ºé›†åˆ</h3>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªç©ºé›†åˆã€‚è¿™æ—¶å¯ä»¥ç”¨ <code>Lists</code>  çš„ <code>newArrayList</code>  æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"å¿«é€Ÿåˆå§‹åŒ–é›†åˆ\"><a class=\"anchor\" href=\"#å¿«é€Ÿåˆå§‹åŒ–é›†åˆ\">#</a> å¿«é€Ÿåˆå§‹åŒ–é›†åˆ</h3>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³ç»™ä¸€ä¸ªé›†åˆä¸­åˆå§‹åŒ–ä¸€äº›å…ƒç´ ã€‚è¿™æ—¶å¯ä»¥ç”¨ <code>Lists</code>  çš„ <code>newArrayList</code>  æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"ç¬›å¡å°”ç§¯\"><a class=\"anchor\" href=\"#ç¬›å¡å°”ç§¯\">#</a> ç¬›å¡å°”ç§¯</h3>\n<p>å¦‚æœä½ æƒ³å°†ä¸¤ä¸ªé›†åˆåš <code>ç¬›å¡å°”ç§¯</code> ï¼Œ <code>Lists</code>  çš„ <code>cartesianProduct</code>  æ–¹æ³•å¯ä»¥å¸®ä½ å®ç°ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> productList <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">cartesianProduct</span><span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">,</span>list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>productList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"åˆ†é¡µæ‹†åˆ†\"><a class=\"anchor\" href=\"#åˆ†é¡µæ‹†åˆ†\">#</a> åˆ†é¡µ | æ‹†åˆ†</h3>\n<p>å¦‚æœä½ æƒ³å°†ä¸€ä¸ª <code>å¤§é›†åˆ</code> åˆ†æˆè‹¥å¹²ä¸ª <code>å°é›†åˆ</code> ï¼Œå¯ä»¥ä½¿ç”¨ <code>Lists</code>  çš„ <code>partition</code>  æ–¹æ³•ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> partitionList <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">partition</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>partitionList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ <code>list</code>  æœ‰ 5 æ¡æ•°æ®ï¼Œæˆ‘å°† list é›†åˆæŒ‰å¤§å°ä¸º 2ï¼Œåˆ†æˆäº† 3 é¡µï¼Œå³å˜æˆ 3 ä¸ªå°é›†åˆã€‚</p>\n<p>è¿™ä¸ªæ˜¯æˆ‘æœ€å–œæ¬¢çš„æ–¹æ³•ä¹‹ä¸€ï¼Œç»å¸¸åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>\n<blockquote>\n<p>æ¯”å¦‚æœ‰ä¸ªéœ€æ±‚ï¼šç°åœ¨æœ‰ 5000 ä¸ª idï¼Œéœ€è¦è°ƒç”¨æ‰¹é‡ç”¨æˆ·æŸ¥è¯¢æ¥å£ï¼ŒæŸ¥å‡ºç”¨æˆ·æ•°æ®ã€‚ä½†å¦‚æœä½ ç›´æ¥æŸ¥ 5000 ä¸ªç”¨æˆ·ï¼Œå•æ¬¡æ¥å£å“åº”æ—¶é—´å¯èƒ½ä¼šéå¸¸æ…¢ã€‚å¦‚æœæ”¹æˆåˆ†é¡µå¤„ç†ï¼Œæ¯æ¬¡åªæŸ¥ 500 ä¸ªç”¨æˆ·ï¼Œå¼‚æ­¥è°ƒç”¨ 10 æ¬¡æ¥å£ï¼Œå°±ä¸ä¼šæœ‰å•æ¬¡æ¥å£å“åº”æ…¢çš„é—®é¢˜ã€‚</p>\n</blockquote>\n<h3 id=\"æµå¤„ç†\"><a class=\"anchor\" href=\"#æµå¤„ç†\">#</a> æµå¤„ç†</h3>\n<p>å¦‚æœæˆ‘ä»¬æƒ³æŠŠæŸä¸ªé›†åˆè½¬æ¢æˆå¦å¤–ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥ä½¿ç”¨ Lists çš„ <code>transform</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> transformList <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">transform</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> x <span class=\"token operator\">-></span> x<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>transformList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å°†å°å†™å­—æ¯è½¬æ¢æˆäº†å¤§å†™å­—æ¯ã€‚</p>\n<h3 id=\"é¢ å€’é¡ºåº\"><a class=\"anchor\" href=\"#é¢ å€’é¡ºåº\">#</a> é¢ å€’é¡ºåº</h3>\n<p>Lists çš„æœ‰é¢ å€’é¡ºåºçš„æ–¹æ³• <code>reverse</code> ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> reverseList <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>reverseList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>list çš„åŸå§‹é¡ºåºæ˜¯ 3 1 2ï¼Œä½¿ç”¨ <code>reverse</code>  æ–¹æ³•é¢ å€’é¡ºåºä¹‹åï¼Œå˜æˆäº† 2 1 3ã€‚</p>\n<p>Lists è¿˜æœ‰å…¶ä»–çš„å¥½ç”¨çš„å·¥å…·ï¼Œæˆ‘åœ¨è¿™é‡Œåªæ˜¯æŠ›ç –å¼•ç‰ï¼Œæœ‰å…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz6.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"objects\"><a class=\"anchor\" href=\"#objects\">#</a> Objects</h2>\n<p>åœ¨ <code>jdk7</code>  ä¹‹åï¼Œæä¾›äº† <code>Objects</code>  å·¥å…·ç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ“ä½œå¯¹è±¡ã€‚</p>\n<h3 id=\"å¯¹è±¡åˆ¤ç©º\"><a class=\"anchor\" href=\"#å¯¹è±¡åˆ¤ç©º\">#</a> å¯¹è±¡åˆ¤ç©º</h3>\n<p>åœ¨ java ä¸­ä¸‡äº‹ä¸‡ç‰©çš†å¯¹è±¡ï¼Œå¯¹è±¡çš„åˆ¤ç©ºå¯ä»¥è¯´æ— å¤„ä¸åœ¨ã€‚ <code>Objects</code>  çš„ <code>isNull</code>  æ–¹æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼Œè€Œ <code>nonNull</code>  æ–¹æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ä¸ºç©ºã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Integer</span> integer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNull</span><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¯¹è±¡ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">nonNull</span><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å¯¹è±¡ä¸ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"å¯¹è±¡ä¸ºç©ºæŠ›å¼‚å¸¸\"><a class=\"anchor\" href=\"#å¯¹è±¡ä¸ºç©ºæŠ›å¼‚å¸¸\">#</a> å¯¹è±¡ä¸ºç©ºæŠ›å¼‚å¸¸</h3>\n<p>å¦‚æœæˆ‘ä»¬æƒ³åœ¨å¯¹è±¡ä¸ºç©ºæ—¶ï¼ŒæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>Objects</code>  çš„ <code>requireNonNull</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Integer</span> integer1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>integer1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>integer1<span class=\"token punctuation\">,</span> <span class=\"token string\">\"å‚æ•°ä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">requireNonNull</span><span class=\"token punctuation\">(</span>integer1<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token string\">\"å‚æ•°ä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰\"><a class=\"anchor\" href=\"#åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰\">#</a> åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰</h3>\n<p>æˆ‘ä»¬ç»å¸¸éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œ <code>Objects</code>  ç»™æˆ‘ä»¬æä¾›äº† <code>equals</code>  æ–¹æ³•ï¼Œèƒ½éå¸¸æ–¹ä¾¿çš„å®ç°ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Integer</span> integer1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Integer</span> integer2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>integer1<span class=\"token punctuation\">,</span> integer2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token boolean\">true</span></pre></td></tr></table></figure><p>ä½†ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æœ‰å‘ï¼Œæ¯”å¦‚ä¾‹å­æ”¹æˆï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Integer</span> integer1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Long</span> integer2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>integer1<span class=\"token punctuation\">,</span> integer2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token boolean\">false</span></pre></td></tr></table></figure><blockquote>\n<p>å‡ºç°è¿™ç§ç°è±¡çš„ä¸»è¦åŸå› æ˜¯ ä¸¤ç§æ•°æ®ç±»å‹ä¸ä¸€è‡´ï¼Œä¸€ç§æ˜¯ <code>Integer</code> ã€ä¸€ç§æ˜¯ <code>Long</code>  æ‰€ä»¥ä¸º falseã€‚</p>\n<p>æ›´å…·ä½“çš„å°±ä¸è¿‡å¤šè§£é‡Šï¼Œæœ‰å…´è¶£çš„å°ä¼™ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è¯¥æ–¹æ³•çš„æºç ï¼Œé‡Œé¢æœ‰éå¸¸è¯¦ç»†çš„ä»‹ç»ã€‚</p>\n</blockquote>\n<h3 id=\"è·å–å¯¹è±¡çš„hashcode\"><a class=\"anchor\" href=\"#è·å–å¯¹è±¡çš„hashcode\">#</a> è·å–å¯¹è±¡çš„ hashCode</h3>\n<p>å¦‚æœæˆ‘ä»¬æƒ³è·å–æŸä¸ªå¯¹è±¡çš„ <code>hashCode</code> ï¼Œå¯ä»¥ä½¿ç”¨ Objects çš„ <code>hashCode</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">96354</span></pre></td></tr></table></figure><p>Objects çš„å†…å®¹å…ˆä»‹ç»åˆ°è¿™é‡Œï¼Œæœ‰å…´è¶£çš„å°ä¼™ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢æ›´å¤šçš„æ–¹æ³•ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz7.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"booleanutils\"><a class=\"anchor\" href=\"#booleanutils\">#</a> BooleanUtils</h2>\n<blockquote>\n<p>åœ¨ <code>java</code>  ä¸­å¸ƒå°”å€¼ï¼Œéšå¤„å¯è§ã€‚</p>\n</blockquote>\n<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†å¸ƒå°”çš„åŒ…è£…ç±»ï¼š <code>Boolean</code> ï¼Œæ€»æ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦ï¼Œå› ä¸ºå®ƒæœ‰ä¸‰ç§å€¼ï¼š <code>null</code> ã€ <code>true</code> ã€ <code>false</code> ã€‚æˆ‘ä»¬åœ¨å¤„ç† Boolean å¯¹è±¡æ—¶ï¼Œéœ€è¦ç»å¸¸åˆ¤ç©ºã€‚</p>\n<p>ä½†å¦‚æœä½¿ç”¨ <code>BooleanUtils</code>  ç±»å¤„ç†å¸ƒå°”å€¼ï¼Œå°±æ–¹ä¾¿è®¸å¤šäº†ã€‚</p>\n<h3 id=\"åˆ¤æ–­trueæˆ–false\"><a class=\"anchor\" href=\"#åˆ¤æ–­trueæˆ–false\">#</a> åˆ¤æ–­ true æˆ– false</h3>\n<p>å¦‚æœä½ æƒ³åˆ¤æ–­æŸä¸ªå‚æ•°çš„å€¼æ˜¯ true æˆ– falseï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>isTrue</code>  æˆ– <code>isFalse</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isFalse</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­ä¸ä¸ºtrueæˆ–ä¸ä¸ºfalse\"><a class=\"anchor\" href=\"#åˆ¤æ–­ä¸ä¸ºtrueæˆ–ä¸ä¸ºfalse\">#</a> åˆ¤æ–­ä¸ä¸º true æˆ–ä¸ä¸º false</h3>\n<p>æœ‰æ—¶å€™ï¼Œéœ€è¦åˆ¤æ–­æŸä¸ªå‚æ•°ä¸ä¸º <code>true</code> ï¼Œå³æ˜¯ <code>null</code>  æˆ–è€… <code>false</code> ã€‚æˆ–è€…åˆ¤æ–­ä¸ä¸º <code>false</code> ï¼Œå³æ˜¯ <code>null</code>  æˆ–è€… <code>true</code> ã€‚</p>\n<p>å¯ä»¥ä½¿ç”¨ <code>isNotTrue</code>  æˆ– <code>isNotFalse</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotTrue</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotTrue</span><span class=\"token punctuation\">(</span>aBoolean1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotFalse</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotFalse</span><span class=\"token punctuation\">(</span>aBoolean1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//true</span></pre></td></tr></table></figure><h3 id=\"è½¬æ¢æˆæ•°å­—\"><a class=\"anchor\" href=\"#è½¬æ¢æˆæ•°å­—\">#</a> è½¬æ¢æˆæ•°å­—</h3>\n<p>å¦‚æœä½ æƒ³å°† <code>true</code>  è½¬æ¢æˆæ•°å­— 1ï¼Œ <code>false</code>  è½¬æ¢æˆæ•°å­— 0ï¼Œå¯ä»¥ä½¿ç”¨ <code>toInteger</code>  æ–¹æ³•ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toInteger</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toInteger</span><span class=\"token punctuation\">(</span>aBoolean1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">0</span></pre></td></tr></table></figure><h3 id=\"booleanè½¬æ¢æˆå¸ƒå°”å€¼\"><a class=\"anchor\" href=\"#booleanè½¬æ¢æˆå¸ƒå°”å€¼\">#</a> Boolean è½¬æ¢æˆå¸ƒå°”å€¼</h3>\n<p>æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦å°†åŒ…è£…ç±» <code>Boolean</code>  å¯¹è±¡ï¼Œè½¬æ¢æˆåŸå§‹çš„ <code>boolean</code>  å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>toBoolean</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Boolean</span> aBoolean1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBoolean</span><span class=\"token punctuation\">(</span>aBoolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBoolean</span><span class=\"token punctuation\">(</span>aBoolean1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BooleanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBooleanDefaultIfNull</span><span class=\"token punctuation\">(</span>aBoolean1<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æˆ‘ä»¬æ— éœ€é¢å¤–çš„åˆ¤ç©ºäº†ï¼Œè€Œä¸”è¿˜å¯ä»¥è®¾ç½® <code>Boolean</code>  å¯¹è±¡ä¸ºç©ºæ—¶è¿”å›çš„é»˜è®¤å€¼ã€‚</p>\n<p><code>BooleanUtils</code>  ç±»çš„æ–¹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å†…å®¹ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz8.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"stringutils\"><a class=\"anchor\" href=\"#stringutils\">#</a> StringUtils</h2>\n<p>å­—ç¬¦ä¸²ï¼ˆ <code>String</code> ï¼‰åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å·¥ä½œä¸­ï¼Œç”¨å¾—éå¸¸éå¸¸éå¸¸å¤šã€‚</p>\n<p>åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ç»å¸¸éœ€è¦å¯¹<strong>å­—ç¬¦ä¸²åˆ¤ç©ºï¼Œæˆªå–å­—ç¬¦ä¸²ã€è½¬æ¢å¤§å°å†™ã€åˆ†éš”å­—ç¬¦ä¸²ã€æ¯”è¾ƒå­—ç¬¦ä¸²ã€å»æ‰å¤šä½™ç©ºæ ¼ã€æ‹¼æ¥å­—ç¬¦ä¸²ã€ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</strong>ç­‰ç­‰ã€‚</p>\n<p>å¦‚æœåªç”¨ <code>String</code>  ç±»æä¾›çš„é‚£äº›æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹å†™å¤§é‡çš„é¢å¤–ä»£ç ï¼Œä¸ç„¶å®¹æ˜“å‡ºç°å„ç§å¼‚å¸¸ã€‚</p>\n<p>ç°åœ¨æœ‰ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼š <code>org.apache.commons.lang3</code>  åŒ…ä¸‹çš„ <code>StringUtils</code>  å·¥å…·ç±»ï¼Œç»™æˆ‘ä»¬æä¾›äº†éå¸¸ä¸°å¯Œçš„é€‰æ‹©ã€‚</p>\n<h3 id=\"å­—ç¬¦ä¸²åˆ¤ç©º\"><a class=\"anchor\" href=\"#å­—ç¬¦ä¸²åˆ¤ç©º\">#</a> å­—ç¬¦ä¸²åˆ¤ç©º</h3>\n<p>å…¶å®ç©ºå­—ç¬¦ä¸²ï¼Œä¸åªæ˜¯ null ä¸€ç§ï¼Œè¿˜æœ‰ &quot;&quot;ï¼Œ&quot; &quot;ï¼Œ&quot;null&quot; ç­‰ç­‰ï¼Œå¤šç§æƒ…å†µã€‚</p>\n<p><code>StringUtils</code>  ç»™æˆ‘ä»¬æä¾›äº†å¤šä¸ªåˆ¤ç©ºçš„é™æ€æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> str2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">String</span> str3 <span class=\"token operator\">=</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">String</span> str4 <span class=\"token operator\">=</span> <span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>str3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span>str4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=====\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>str3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>str4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=====\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlank</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlank</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlank</span><span class=\"token punctuation\">(</span>str3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isBlank</span><span class=\"token punctuation\">(</span>str4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=====\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotBlank</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotBlank</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotBlank</span><span class=\"token punctuation\">(</span>str3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotBlank</span><span class=\"token punctuation\">(</span>str4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr></table></figure><p>ç¤ºä¾‹ä¸­çš„ï¼š <code>isEmpty</code> ã€ <code>isNotEmpty</code> ã€ <code>isBlank</code>  å’Œ <code>isNotBlank</code> ï¼Œè¿™ 4 ä¸ªåˆ¤ç©ºæ–¹æ³•ä½ ä»¬å¯ä»¥æ ¹æ®å®é™…æƒ…å†µä½¿ç”¨ã€‚</p>\n<blockquote>\n<p>ä¼˜å…ˆæ¨èä½¿ç”¨ <code>isBlank</code>  å’Œ <code>isNotBlank</code>  æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¼šæŠŠ <code>&quot; &quot;</code>  ä¹Ÿè€ƒè™‘è¿›å»ã€‚</p>\n</blockquote>\n<h3 id=\"åˆ†éš”å­—ç¬¦ä¸²\"><a class=\"anchor\" href=\"#åˆ†éš”å­—ç¬¦ä¸²\">#</a> åˆ†éš”å­—ç¬¦ä¸²</h3>\n<p>åˆ†éš”å­—ç¬¦ä¸²æ˜¯å¸¸è§éœ€æ±‚ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ <code>String</code>  ç±»çš„ <code>split</code>  æ–¹æ³•ï¼Œå°±å¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">,</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">null</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Exception</span> in thread <span class=\"token string\">\"main\"</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>NullPointerException</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> at <span class=\"token class-name\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>sue<span class=\"token punctuation\">.</span>jump<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>test1<span class=\"token punctuation\">.</span></span>UtilTest</span><span class=\"token punctuation\">.</span><span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UtilTest</span><span class=\"token punctuation\">.</span>java<span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>StringUtils</code>  çš„ <code>split</code>  æ–¹æ³•ä¼šè¿”å› <code>null</code> ï¼Œè€Œä½¿ç”¨ <code>String</code>  çš„ <code>split</code>  æ–¹æ³•ä¼šæŠ¥æŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<h3 id=\"åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—\"><a class=\"anchor\" href=\"#åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—\">#</a> åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—</h3>\n<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œå¯ä»¥ä½¿ç”¨ <code>isNumeric</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str1 <span class=\"token operator\">=</span> <span class=\"token string\">\"123\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> str2 <span class=\"token operator\">=</span> <span class=\"token string\">\"123q\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">String</span> str3 <span class=\"token operator\">=</span> <span class=\"token string\">\"0.33\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNumeric</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//true</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNumeric</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNumeric</span><span class=\"token punctuation\">(</span>str3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//false</span></pre></td></tr></table></figure><h3 id=\"å°†é›†åˆæ‹¼æ¥æˆå­—ç¬¦ä¸²\"><a class=\"anchor\" href=\"#å°†é›†åˆæ‹¼æ¥æˆå­—ç¬¦ä¸²\">#</a> å°†é›†åˆæ‹¼æ¥æˆå­—ç¬¦ä¸²</h3>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†æŸä¸ªé›†åˆçš„å†…å®¹ï¼Œæ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åè¾“å‡ºï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ <code>join</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> list2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Lists</span><span class=\"token punctuation\">.</span><span class=\"token function\">newArrayList</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">,</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>c</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><p>å½“ç„¶è¿˜æœ‰å¾ˆå¤šå®ç”¨çš„æ–¹æ³•ï¼Œæˆ‘åœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz9.png\" alt=\"image.png\" /></p>\n<p><img data-src=\"/assets/2022-8/lz10.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"assert\"><a class=\"anchor\" href=\"#assert\">#</a> Assert</h2>\n<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­åšåˆ¤æ–­ï¼šå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™æŠ›å¼‚å¸¸ã€‚</p>\n<p>æœ‰æ²¡æœ‰ç»Ÿä¸€çš„å°è£…å‘¢ï¼Ÿ</p>\n<p>å…¶å® <code>spring</code>  ç»™æˆ‘ä»¬æä¾›äº† <code>Assert</code>  ç±»ï¼Œå®ƒè¡¨ç¤º <code>æ–­è¨€</code> ã€‚</p>\n<h3 id=\"æ–­è¨€å‚æ•°æ˜¯å¦ä¸ºç©º\"><a class=\"anchor\" href=\"#æ–­è¨€å‚æ•°æ˜¯å¦ä¸ºç©º\">#</a> æ–­è¨€å‚æ•°æ˜¯å¦ä¸ºç©º</h3>\n<p>æ–­è¨€ <code>å‚æ•°</code> æ˜¯å¦ç©ºï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ç›´æ¥æŠ›å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNull</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> <span class=\"token string\">\"strå¿…é¡»ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNull</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token string\">\"strå¿…é¡»ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">notNull</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> <span class=\"token string\">\"strä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¦‚æœä¸æ»¡è¶³æ¡ä»¶å°±ä¼šæŠ›å‡º <code>IllegalArgumentException</code>  å¼‚å¸¸ã€‚</p>\n<h3 id=\"æ–­è¨€é›†åˆæ˜¯å¦ä¸ºç©º\"><a class=\"anchor\" href=\"#æ–­è¨€é›†åˆæ˜¯å¦ä¸ºç©º\">#</a> æ–­è¨€é›†åˆæ˜¯å¦ä¸ºç©º</h3>\n<p>æ–­è¨€ <code>é›†åˆ</code> æ˜¯å¦ç©ºï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ç›´æ¥æŠ›å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">notEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> <span class=\"token string\">\"listä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">notEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token string\">\"listä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">notEmpty</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mapä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¦‚æœä¸æ»¡è¶³æ¡ä»¶å°±ä¼šæŠ›å‡º <code>IllegalArgumentException</code>  å¼‚å¸¸ã€‚</p>\n<h3 id=\"æ–­è¨€æ¡ä»¶æ˜¯å¦ä¸ºç©º\"><a class=\"anchor\" href=\"#æ–­è¨€æ¡ä»¶æ˜¯å¦ä¸ºç©º\">#</a> æ–­è¨€æ¡ä»¶æ˜¯å¦ä¸ºç©º</h3>\n<p>æ–­è¨€æ˜¯å¦æ»¡è¶³æŸä¸ª <code>æ¡ä»¶</code> ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ç›´æ¥æŠ›å¼‚å¸¸ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"listä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CollectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token string\">\"listä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å½“ç„¶ Assert ç±»è¿˜æœ‰ä¸€äº›å…¶ä»–çš„åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸å¤šä»‹ç»äº†ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz11.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"ioutils\"><a class=\"anchor\" href=\"#ioutils\">#</a> IOUtils</h2>\n<p><code>IO</code>  æµåœ¨æˆ‘ä»¬æ—¥å¸¸å·¥ä½œä¸­ä¹Ÿç”¨å¾—æ¯”è¾ƒå¤šï¼Œå°½ç®¡ java å·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„ <code>API</code> ã€‚</p>\n<p>ä½†æˆ‘ä»¬ä¸å¾—ä¸æ¯æ¬¡è¯»å–æ–‡ä»¶ï¼Œæˆ–è€…å†™å…¥æ–‡ä»¶ä¹‹åï¼Œå†™ä¸€äº›é‡å¤çš„çš„ä»£ç ã€‚æ‰‹åŠ¨åœ¨ <code>finally</code>  ä»£ç å—ä¸­å…³é—­æµï¼Œä¸ç„¶å¯èƒ½ä¼šé€ æˆ <code>å†…å­˜æº¢å‡º</code> ã€‚</p>\n<p>æœ‰ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼šå¦‚æœä½ ä½¿ç”¨ <code>org.apache.commons.io</code>  åŒ…ä¸‹çš„ <code>IOUtils</code>  ç±»ï¼Œä¼šèŠ‚çœå¤§é‡çš„æ—¶é—´ã€‚</p>\n<h3 id=\"è¯»å–æ–‡ä»¶\"><a class=\"anchor\" href=\"#è¯»å–æ–‡ä»¶\">#</a> è¯»å–æ–‡ä»¶</h3>\n<p>å¦‚æœä½ æƒ³å°†æŸä¸ª txt æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œè¯»å–åˆ°å­—ç¬¦ä¸²å½“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>IOUtils</code>  ç±»çš„ <code>toString</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token class-name\">IOUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/temp/a.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"å†™å…¥æ–‡ä»¶\"><a class=\"anchor\" href=\"#å†™å…¥æ–‡ä»¶\">#</a> å†™å…¥æ–‡ä»¶</h3>\n<p>å¦‚æœä½ æƒ³å°†æŸä¸ªå­—ç¬¦ä¸²çš„å†…å®¹ï¼Œå†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶å½“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>IOUtils</code>  ç±»çš„ <code>write</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"abcde\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">IOUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/temp/b.tx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"æ–‡ä»¶æ‹·è´\"><a class=\"anchor\" href=\"#æ–‡ä»¶æ‹·è´\">#</a> æ–‡ä»¶æ‹·è´</h3>\n<p>å¦‚æœä½ æƒ³å°†æŸä¸ªæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œéƒ½æ‹·è´åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å½“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>IOUtils</code>  ç±»çš„ <code>copy</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">IOUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/temp/a.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/temp/b.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"è¯»å–æ–‡ä»¶å†…å®¹åˆ°å­—èŠ‚æ•°ç»„\"><a class=\"anchor\" href=\"#è¯»å–æ–‡ä»¶å†…å®¹åˆ°å­—èŠ‚æ•°ç»„\">#</a> è¯»å–æ–‡ä»¶å†…å®¹åˆ°å­—èŠ‚æ•°ç»„</h3>\n<p>å¦‚æœä½ æƒ³å°†æŸä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¯»å–å­—èŠ‚æ•°ç»„ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>IOUtils</code>  ç±»çš„ <code>toByteArray</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token class-name\">IOUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toByteArray</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/temp/a.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>IOUtils ç±»éå¸¸å®ç”¨ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä»¬ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢å†…å®¹ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz12.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"mdc\"><a class=\"anchor\" href=\"#mdc\">#</a> MDC</h2>\n<p><code>MDC</code>  æ˜¯ <code>org.slf4j</code>  åŒ…ä¸‹çš„ä¸€ä¸ªç±»ï¼Œå®ƒçš„å…¨ç§°æ˜¯ <code>Mapped Diagnostic Context</code> ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„<strong>å­˜æ”¾è¯Šæ–­æ—¥å¿—çš„å®¹å™¨</strong>ã€‚</p>\n<p>MDC çš„åº•å±‚æ˜¯ç”¨äº† <code>ThreadLocal</code>  æ¥ä¿å­˜æ•°æ®çš„ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥ç”¨å®ƒä¼ é€’å‚æ•°ã€‚</p>\n<blockquote>\n<p>ä¾‹å¦‚ç°åœ¨æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼šæˆ‘ä»¬ä½¿ç”¨ <code>RestTemplate</code>  è°ƒç”¨è¿œç¨‹æ¥å£æ—¶ï¼Œæœ‰æ—¶éœ€è¦åœ¨ <code>header</code>  ä¸­ä¼ é€’ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼štraceIdï¼Œsource ç­‰ï¼Œä¾¿äºåœ¨æŸ¥è¯¢æ—¥å¿—æ—¶èƒ½å¤Ÿä¸²è”ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚é“¾è·¯ï¼Œå¿«é€Ÿå®šä½é—®é¢˜ã€‚</p>\n</blockquote>\n<p>è¿™ç§ä¸šåŠ¡åœºæ™¯å°±èƒ½é€šè¿‡ <code>ClientHttpRequestInterceptor</code>  æ¥å£å®ç°ï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p>\n<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œå®šä¹‰ä¸€ä¸ª <code>LogFilter</code>  æ‹¦æˆªæ‰€æœ‰æ¥å£è¯·æ±‚ï¼Œåœ¨ MDC ä¸­è®¾ç½® <code>traceId</code> ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LogFilter</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Filter</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FilterConfig</span> filterConfig<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doFilter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">FilterChain</span> chain<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token class-name\">MdcUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>UUID<span class=\"token punctuation\">.</span><span class=\"token function\">randomUUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è®°å½•è¯·æ±‚æ—¥å¿—\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        chain<span class=\"token punctuation\">.</span><span class=\"token function\">doFilter</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è®°å½•å“åº”æ—¥å¿—\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>ç¬¬äºŒæ­¥</strong>ï¼Œå®ç° <code>ClientHttpRequestInterceptor</code>  æ¥å£ï¼ŒMDC ä¸­è·å–å½“å‰è¯·æ±‚çš„ traceIdï¼Œç„¶åè®¾ç½®åˆ° <code>header</code>  ä¸­ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RestTemplateInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ClientHttpRequestInterceptor</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ClientHttpResponse</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> body<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ClientHttpRequestExecution</span> execution<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        request<span class=\"token punctuation\">.</span><span class=\"token function\">getHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"traceId\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MdcUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> execution<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼Œå®šä¹‰é…ç½®ç±»ï¼Œé…ç½®ä¸Šé¢å®šä¹‰çš„ <code>RestTemplateInterceptor</code>  ç±»ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RestTemplateConfiguration</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RestTemplate</span> <span class=\"token function\">restTemplate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">RestTemplate</span> restTemplate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestTemplate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">setInterceptors</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">singletonList</span><span class=\"token punctuation\">(</span><span class=\"token function\">restTemplateInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> restTemplate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RestTemplateInterceptor</span> <span class=\"token function\">restTemplateInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestTemplateInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å…¶ä¸­ <code>MdcUtil</code>  å…¶å®æ˜¯åˆ©ç”¨ <code>MDC</code>  å·¥å…·åœ¨ <code>ThreadLocal</code>  ä¸­å­˜å‚¨å’Œè·å– <code>traceId</code></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MdcUtil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> TRACE_ID <span class=\"token operator\">=</span> <span class=\"token string\">\"TRACE_ID\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> MDC<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>TRACE_ID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        MDC<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>TRACE_ID<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¸ªä¾‹å­ä¸­æ²¡æœ‰æ¼”ç¤º <code>MdcUtil</code>  ç±»çš„ <code>add</code>  æ–¹æ³•å…·ä½“è°ƒçš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>filter</code>  ä¸­æ‰§è¡Œæ¥å£æ–¹æ³•ä¹‹å‰ï¼Œç”Ÿæˆ <code>traceId</code> ï¼Œè°ƒç”¨ <code>MdcUtil</code>  ç±»çš„ <code>add</code>  æ–¹æ³•æ·»åŠ åˆ° <code>MDC</code>  ä¸­ï¼Œç„¶ååœ¨åŒä¸€ä¸ªè¯·æ±‚çš„å…¶ä»–åœ°æ–¹å°±èƒ½é€šè¿‡ <code>MdcUtil</code>  ç±»çš„ <code>get</code>  æ–¹æ³•è·å–åˆ°è¯¥ <code>traceId</code> ã€‚</p>\n<p>èƒ½ä½¿ç”¨ <code>MDC</code>  ä¿å­˜ <code>traceId</code>  ç­‰å‚æ•°çš„æ ¹æœ¬åŸå› æ˜¯ï¼Œç”¨æˆ·è¯·æ±‚åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œ <code>Tomcat</code>  ä¼šä»çº¿ç¨‹æ± ä¸­åˆ†é…ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†è¯¥è¯·æ±‚ã€‚</p>\n<p>é‚£ä¹ˆè¯¥è¯·æ±‚çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¿å­˜åˆ° <code>MDC</code>  çš„ <code>ThreadLocal</code>  ä¸­çš„å‚æ•°ï¼Œä¹Ÿæ˜¯è¯¥çº¿ç¨‹ç‹¬äº«çš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p>\n<br/>\n<h2 id=\"classutils\"><a class=\"anchor\" href=\"#classutils\">#</a> ClassUtils</h2>\n<p>spring çš„ <code>org.springframework.util</code>  åŒ…ä¸‹çš„ <code>ClassUtils</code>  ç±»ï¼Œå®ƒé‡Œé¢æœ‰å¾ˆå¤šè®©æˆ‘ä»¬æƒŠå–œçš„åŠŸèƒ½ã€‚</p>\n<p>å®ƒé‡Œé¢åŒ…å«äº†ç±»å’Œå¯¹è±¡ç›¸å…³çš„å¾ˆå¤šéå¸¸å®ç”¨çš„æ–¹æ³•ã€‚</p>\n<h3 id=\"è·å–å¯¹è±¡çš„æ‰€æœ‰æ¥å£\"><a class=\"anchor\" href=\"#è·å–å¯¹è±¡çš„æ‰€æœ‰æ¥å£\">#</a> è·å–å¯¹è±¡çš„æ‰€æœ‰æ¥å£</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰æ¥å£ï¼Œå¯ä»¥ä½¿ç”¨ <code>ClassUtils</code>  çš„ <code>getAllInterfaces</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> allInterfaces <span class=\"token operator\">=</span> <span class=\"token class-name\">ClassUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAllInterfaces</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"è·å–æŸä¸ªç±»çš„åŒ…å\"><a class=\"anchor\" href=\"#è·å–æŸä¸ªç±»çš„åŒ…å\">#</a> è·å–æŸä¸ªç±»çš„åŒ…å</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªç±»çš„åŒ…åï¼Œå¯ä»¥ä½¿ç”¨ <code>ClassUtils</code>  çš„ <code>getPackageName</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> packageName <span class=\"token operator\">=</span> <span class=\"token class-name\">ClassUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getPackageName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>packageName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å†…éƒ¨ç±»\"><a class=\"anchor\" href=\"#åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å†…éƒ¨ç±»\">#</a> åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å†…éƒ¨ç±»</h3>\n<p>å¦‚æœä½ æƒ³åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å†…éƒ¨ç±»ï¼Œå¯ä»¥ä½¿ç”¨ <code>ClassUtils</code>  çš„ <code>isInnerClass</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClassUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isInnerClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä»£ç†å¯¹è±¡\"><a class=\"anchor\" href=\"#åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä»£ç†å¯¹è±¡\">#</a> åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä»£ç†å¯¹è±¡</h3>\n<p>å¦‚æœä½ æƒ³åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä»£ç†å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>ClassUtils</code>  çš„ <code>isCglibProxy</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClassUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isCglibProxy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ClassUtils è¿˜æœ‰å¾ˆå¤šæœ‰ç”¨çš„æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢å†…å®¹ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz13.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"beanutils\"><a class=\"anchor\" href=\"#beanutils\">#</a> BeanUtils</h2>\n<p>spring ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>JavaBean</code>  çš„å·¥å…·ç±»ï¼Œå®ƒåœ¨ <code>org.springframework.beans</code>  åŒ…ä¸‹é¢ï¼Œå®ƒçš„åå­—å«åšï¼š <code>BeanUtils</code> ã€‚</p>\n<blockquote>\n<p>è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹è¿™ä¸ªå·¥å…·å¯ä»¥å¸¦ç»™æˆ‘ä»¬å“ªäº›æƒŠå–œã€‚</p>\n</blockquote>\n<h3 id=\"æ‹·è´å¯¹è±¡çš„å±æ€§\"><a class=\"anchor\" href=\"#æ‹·è´å¯¹è±¡çš„å±æ€§\">#</a> æ‹·è´å¯¹è±¡çš„å±æ€§</h3>\n<p>æ›¾å‡ ä½•æ—¶ï¼Œä½ æœ‰æ²¡æœ‰è¿™æ ·çš„éœ€æ±‚ï¼šæŠŠæŸä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œéƒ½æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚è¿™æ—¶å°±èƒ½ä½¿ç”¨ <code>BeanUtils</code>  çš„ <code>copyProperties</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span> user1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>user1<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>user1<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç”°åŸ‚ä¸Šçš„æ¢¦\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>user1<span class=\"token punctuation\">.</span><span class=\"token function\">setAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åŒ—äº¬\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">User</span> user2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">copyProperties</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">,</span> user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"å®ä¾‹åŒ–æŸä¸ªç±»\"><a class=\"anchor\" href=\"#å®ä¾‹åŒ–æŸä¸ªç±»\">#</a> å®ä¾‹åŒ–æŸä¸ªç±»</h3>\n<p>å¦‚æœä½ æƒ³é€šè¿‡åå°„å®ä¾‹åŒ–ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>BeanUtils</code>  çš„ <code>instantiateClass</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">instantiateClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"è·å–æŒ‡å®šç±»çš„æŒ‡å®šæ–¹æ³•\"><a class=\"anchor\" href=\"#è·å–æŒ‡å®šç±»çš„æŒ‡å®šæ–¹æ³•\">#</a> è·å–æŒ‡å®šç±»çš„æŒ‡å®šæ–¹æ³•</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªç±»çš„æŒ‡å®šæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>BeanUtils</code>  çš„ <code>findDeclaredMethod</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Method</span> declaredMethod <span class=\"token operator\">=</span> <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findDeclaredMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"getId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>declaredMethod<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"è·å–æŒ‡å®šæ–¹æ³•çš„å‚æ•°\"><a class=\"anchor\" href=\"#è·å–æŒ‡å®šæ–¹æ³•çš„å‚æ•°\">#</a> è·å–æŒ‡å®šæ–¹æ³•çš„å‚æ•°</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªæ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>BeanUtils</code>  çš„ <code>findPropertyForMethod</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Method</span> declaredMethod <span class=\"token operator\">=</span> <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findDeclaredMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"getId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">PropertyDescriptor</span> propertyForMethod <span class=\"token operator\">=</span> <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findPropertyForMethod</span><span class=\"token punctuation\">(</span>declaredMethod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>propertyForMethod<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¦‚æœä½ å¯¹ <code>BeanUtils</code>  æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢å†…å®¹ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz14.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"reflectionutils\"><a class=\"anchor\" href=\"#reflectionutils\">#</a> ReflectionUtils</h2>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ <code>åå°„</code> åŠŸèƒ½ï¼Œå¦‚æœä½¿ç”¨æœ€åŸå§‹çš„æ–¹æ³•æ¥å¼€å‘ï¼Œä»£ç é‡ä¼šéå¸¸å¤šï¼Œè€Œä¸”å¾ˆéº»çƒ¦ï¼Œå®ƒéœ€è¦å¤„ç†ä¸€å¤§å †å¼‚å¸¸ä»¥åŠè®¿é—®æƒé™ç­‰é—®é¢˜ã€‚</p>\n<p>å¥½æ¶ˆæ¯æ˜¯ spring ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>ReflectionUtils</code>  å·¥å…·ï¼Œå®ƒåœ¨ <code>org.springframework.util</code>  åŒ…ä¸‹é¢ã€‚</p>\n<h3 id=\"è·å–æ–¹æ³•\"><a class=\"anchor\" href=\"#è·å–æ–¹æ³•\">#</a> è·å–æ–¹æ³•</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªç±»çš„æŸä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>ReflectionUtils</code>  ç±»çš„ <code>findMethod</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Method</span> method <span class=\"token operator\">=</span> <span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"getId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"è·å–å­—æ®µ\"><a class=\"anchor\" href=\"#è·å–å­—æ®µ\">#</a> è·å–å­—æ®µ</h3>\n<p>å¦‚æœä½ æƒ³è·å–æŸä¸ªç±»çš„æŸä¸ªå­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ <code>ReflectionUtils</code>  ç±»çš„ <code>findField</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Field</span> field <span class=\"token operator\">=</span> <span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findField</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"æ‰§è¡Œæ–¹æ³•\"><a class=\"anchor\" href=\"#æ‰§è¡Œæ–¹æ³•\">#</a> æ‰§è¡Œæ–¹æ³•</h3>\n<p>å¦‚æœä½ æƒ³é€šè¿‡åå°„è°ƒç”¨æŸä¸ªæ–¹æ³•ï¼Œä¼ é€’å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ReflectionUtils</code>  ç±»çš„ <code>invokeMethod</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">,</span> springContextsUtil<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span>beanName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­å­—æ®µæ˜¯å¦å¸¸é‡\"><a class=\"anchor\" href=\"#åˆ¤æ–­å­—æ®µæ˜¯å¦å¸¸é‡\">#</a> åˆ¤æ–­å­—æ®µæ˜¯å¦å¸¸é‡</h3>\n<p>å¦‚æœä½ æƒ³åˆ¤æ–­æŸä¸ªå­—æ®µæ˜¯å¦å¸¸é‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>ReflectionUtils</code>  ç±»çš„ <code>isPublicStaticFinal</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Field</span> field <span class=\"token operator\">=</span> <span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findField</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isPublicStaticFinal</span><span class=\"token punctuation\">(</span>field<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆ¤æ–­æ˜¯å¦equalsæ–¹æ³•\"><a class=\"anchor\" href=\"#åˆ¤æ–­æ˜¯å¦equalsæ–¹æ³•\">#</a> åˆ¤æ–­æ˜¯å¦ equals æ–¹æ³•</h3>\n<p>å¦‚æœä½ æƒ³åˆ¤æ–­æŸä¸ªæ–¹æ³•æ˜¯å¦ <code>equals</code>  æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>ReflectionUtils</code>  ç±»çš„ <code>isEqualsMethod</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Method</span> method <span class=\"token operator\">=</span> <span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">findMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"getId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReflectionUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEqualsMethod</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å½“ç„¶è¿™ä¸ªç±»è¿˜æœ‰ä¸å°‘æœ‰è¶£çš„æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢å†…å®¹ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz15.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"base64utils\"><a class=\"anchor\" href=\"#base64utils\">#</a> Base64Utils</h2>\n<p>æœ‰æ—¶å€™ï¼Œä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œéœ€è¦å°†å‚æ•°åªç”¨ <code>base64</code>  ç¼–ç ã€‚</p>\n<p>è¿™æ—¶å°±èƒ½ç›´æ¥ä½¿ç”¨ <code>org.springframework.util</code>  åŒ…ä¸‹çš„ <code>Base64Utils</code>  å·¥å…·ç±»ã€‚</p>\n<p>å®ƒé‡Œé¢åŒ…å«ï¼š <code>encode</code>  å’Œ <code>decode</code>  æ–¹æ³•ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> encode <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Base64Utils</span><span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åŠ å¯†åï¼š\"</span> <span class=\"token operator\">+</span> encode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">String</span> decode <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Base64Utils</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>encode<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"utf8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è§£å¯†åï¼š\"</span> <span class=\"token operator\">+</span> decode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">UnsupportedEncodingException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>åŠ å¯†åï¼š<span class=\"token class-name\">YWJj</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>è§£å¯†åï¼šabc</pre></td></tr></table></figure><br/>\n<h2 id=\"standardcharsets\"><a class=\"anchor\" href=\"#standardcharsets\">#</a> StandardCharsets</h2>\n<p>æˆ‘ä»¬åœ¨åšå­—ç¬¦è½¬æ¢çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦æŒ‡å®šå­—ç¬¦ç¼–ç ï¼Œæ¯”å¦‚ï¼š <code>UTF-8</code> ã€ <code>ISO-8859-1</code>  ç­‰ç­‰ã€‚</p>\n<p>è¿™æ—¶å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>java.nio.charset</code>  åŒ…ä¸‹çš„ <code>StandardCharsets</code>  ç±»ä¸­é™æ€å˜é‡ã€‚</p>\n<p>ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">String</span> encode <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Base64Utils</span><span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åŠ å¯†åï¼š\"</span> <span class=\"token operator\">+</span> encode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">String</span> decode <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Base64Utils</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>encode<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span>UTF_8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è§£å¯†åï¼š\"</span> <span class=\"token operator\">+</span> decode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><br/>\n<h2 id=\"digestutils\"><a class=\"anchor\" href=\"#digestutils\">#</a> DigestUtils</h2>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œæ¯”å¦‚ï¼š <code>md5</code>  æˆ– <code>sha256</code> ã€‚</p>\n<p>å¯ä»¥ä½¿ç”¨ apache çš„ <code>org.apache.commons.codec.digest</code>  åŒ…ä¸‹çš„ <code>DigestUtils</code>  ç±»ã€‚</p>\n<h3 id=\"md5åŠ å¯†\"><a class=\"anchor\" href=\"#md5åŠ å¯†\">#</a> md5 åŠ å¯†</h3>\n<p>å¦‚æœä½ æƒ³å¯¹æ•°æ®è¿›è¡Œ md5 åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨ <code>DigestUtils</code>  çš„ <code>md5Hex</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> md5Hex <span class=\"token operator\">=</span> <span class=\"token class-name\">DigestUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">md5Hex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è‹ä¸‰è¯´æŠ€æœ¯\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>md5Hex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"sha256åŠ å¯†\"><a class=\"anchor\" href=\"#sha256åŠ å¯†\">#</a> sha256 åŠ å¯†</h3>\n<p>å¦‚æœä½ æƒ³å¯¹æ•°æ®è¿›è¡Œ sha256 åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨ <code>DigestUtils</code>  çš„ <code>sha256Hex</code>  æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> md5Hex <span class=\"token operator\">=</span> <span class=\"token class-name\">DigestUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">sha256Hex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è‹ä¸‰è¯´æŠ€æœ¯\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>md5Hex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å½“ç„¶è¿™ä¸ªå·¥å…·è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„åŠ å¯†æ–¹æ³•ï¼š</p>\n<p><img data-src=\"/assets/2022-8/lz16.png\" alt=\"image.png\" /></p>\n<br/>\n<h2 id=\"serializationutils\"><a class=\"anchor\" href=\"#serializationutils\">#</a> SerializationUtils</h2>\n<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•°æ®è¿›è¡Œ <code>åºåˆ—åŒ–</code> å’Œ <code>ååºåˆ—åŒ–</code> å¤„ç†ã€‚</p>\n<p>ä¼ ç»Ÿçš„åšæ³•æ˜¯æŸä¸ªç±»å®ç° <code>Serializable</code>  æ¥å£ï¼Œç„¶åé‡æ–°å®ƒçš„ <code>writeObject</code>  å’Œ <code>readObject</code>  æ–¹æ³•ã€‚</p>\n<p>ä½†å¦‚æœä½¿ç”¨ <code>org.springframework.util</code>  åŒ…ä¸‹çš„ <code>SerializationUtils</code>  å·¥å…·ç±»ï¼Œèƒ½æ›´è½»æ¾å®ç°åºåˆ—åŒ–å’Œååºåˆ—åŒ–åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> map <span class=\"token operator\">=</span> <span class=\"token class-name\">Maps</span><span class=\"token punctuation\">.</span><span class=\"token function\">newHashMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>map<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>map<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>map<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> serialize <span class=\"token operator\">=</span> <span class=\"token class-name\">SerializationUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">Object</span> deserialize <span class=\"token operator\">=</span> <span class=\"token class-name\">SerializationUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">deserialize</span><span class=\"token punctuation\">(</span>serialize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>deserialize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><br/>\n<h2 id=\"httpstatus\"><a class=\"anchor\" href=\"#httpstatus\">#</a> HttpStatus</h2>\n<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœ¨ä»£ç ä¸­å®šä¹‰ <code>http</code>  çš„è¿”å›ç ï¼Œæ¯”å¦‚ï¼šæ¥å£æ­£å¸¸è¿”å› 200ï¼Œå¼‚å¸¸è¿”å› 500ï¼Œæ¥å£æ‰¾ä¸åˆ°è¿”å› 404ï¼Œæ¥å£ä¸å¯ç”¨è¿”å› 502 ç­‰ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> SUCCESS_CODE <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> ERROR_CODE <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> NOT_FOUND_CODE <span class=\"token operator\">=</span> <span class=\"token number\">404</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å…¶å® <code>org.springframework.http</code>  åŒ…ä¸‹çš„ <code>HttpStatus</code>  æšä¸¾ï¼Œæˆ–è€… <code>org.apache.http</code>  åŒ…ä¸‹çš„ <code>HttpStatus</code>  æ¥å£ï¼Œå·²ç»æŠŠå¸¸ç”¨çš„ <code>http</code>  è¿”å›ç ç»™æˆ‘ä»¬å®šä¹‰å¥½äº†ï¼Œç›´æ¥æ‹¿æ¥ç”¨å°±å¯ä»¥äº†ï¼ŒçœŸçš„ä¸ç”¨å†é‡å¤å®šä¹‰äº†ã€‚</p>\n<p><img data-src=\"/assets/2022-8/lz17.png\" alt=\"image.png\" /></p>\n<p>å¥½äº†ï¼Œè¿™æ¬¡å°±åˆ†äº«åˆ°è¿™é‡Œã€‚</p>\n<p>å·¥ä½œå½“ä¸­è¿˜æœ‰å¾ˆå¤šå¥½ç”¨çš„å°å·¥å…·ï¼Œæˆ‘ä¼šç»§ç»­æ›´æ–°çš„ã€‚</p>\n<br/>\n",
            "tags": [
                "Java",
                "æŠ€æœ¯å®è·µ",
                "ç¬”è®°",
                "å·¥å…·",
                "è½®å­"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/8/b87af8545928/",
            "url": "https://shaogezhu.cn/2022/8/b87af8545928/",
            "title": "ä¸€ç¯‡æ–‡ç« æ•™ä½ è½»æ¾ä½¿ç”¨Fastjson",
            "date_published": "2022-08-14T14:17:06.000Z",
            "content_html": "<div class=\"note info\">\n<p>åœ¨å‰åç«¯æ•°æ®ä¼ è¾“äº¤äº’ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å­—ç¬¦ä¸² (String) ä¸ Jsonã€XML ç­‰æ ¼å¼ç›¸äº’è½¬æ¢ä¸è§£æï¼Œå…¶ä¸­ json ä»¥è·¨è¯­è¨€ï¼Œè·¨å‰åç«¯çš„ä¼˜ç‚¹åœ¨å¼€å‘ä¸­è¢«é¢‘ç¹ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯æ ‡å‡†çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸€ä¸‹å¸¸ç”¨çš„ Fastjsonã€‚</p>\n</div>\n<h1 id=\"fastjsonä»‹ç»\"><a class=\"anchor\" href=\"#fastjsonä»‹ç»\">#</a> Fastjson ä»‹ç»</h1>\n<h2 id=\"ç®€ä»‹\"><a class=\"anchor\" href=\"#ç®€ä»‹\">#</a> ç®€ä»‹</h2>\n<p>Fastjson æ˜¯é˜¿é‡Œå·´å·´å…¬å¸å¼€æºçš„ä¸€ä¸ª Java è¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½åŠŸèƒ½å®Œå–„çš„ JSON åº“ã€‚å®ƒé‡‡ç”¨ä¸€ç§ â€œ<strong>å‡å®šæœ‰åºå¿«é€ŸåŒ¹é…</strong>â€ çš„ç®—æ³•ï¼ŒæŠŠ JSON Parse çš„æ€§èƒ½æå‡åˆ°æè‡´ï¼Œæ˜¯ç›®å‰ Java è¯­è¨€ä¸­æœ€å¿«çš„ JSON åº“ï¼Œå¹¶ä¸”å®ƒä¸ä¾èµ–äºå…¶å®ƒä»»ä½•åº“ã€‚</p>\n<h2 id=\"ä¸»è¦ç‰¹ç‚¹\"><a class=\"anchor\" href=\"#ä¸»è¦ç‰¹ç‚¹\">#</a> ä¸»è¦ç‰¹ç‚¹ï¼š</h2>\n<ul>\n<li>å¿«é€Ÿ FAST (æ¯”å…¶å®ƒä»»ä½•åŸºäº Java çš„è§£æå™¨å’Œç”Ÿæˆå™¨æ›´å¿«ï¼ŒåŒ…æ‹¬ jacksonï¼‰</li>\n<li>å¼ºå¤§ï¼ˆæ”¯æŒæ™®é€š JDK ç±»åŒ…æ‹¬ä»»æ„ Java Bean Classã€Collectionã€Mapã€Date æˆ– enumï¼‰</li>\n<li>é›¶ä¾èµ–ï¼ˆæ²¡æœ‰ä¾èµ–å…¶å®ƒä»»ä½•ç±»åº“é™¤äº† JDKï¼‰</li>\n</ul>\n<h1 id=\"fastjsonä½¿ç”¨\"><a class=\"anchor\" href=\"#fastjsonä½¿ç”¨\">#</a> Fastjson ä½¿ç”¨</h1>\n<p>maven ä¾èµ–ï¼š</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.alibaba<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>fastjson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">&lt;!--ï¼ˆèµ·ç  1.2.67 ä»¥ä¸Šï¼‰å› ä¸ºè¿™ä¸ªç‰ˆæœ¬ä»¥ä¸‹å­˜åœ¨æ¼æ´ --></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>ç‰ˆæœ¬æ ¹æ®è‡ªå·±éœ€è¦<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>android ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.alibaba<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>fastjson<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>x.x.xx.android<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h1 id=\"åŸºæœ¬ç”¨æ³•\"><a class=\"anchor\" href=\"#åŸºæœ¬ç”¨æ³•\">#</a> åŸºæœ¬ç”¨æ³•</h1>\n<h2 id=\"json\"><a class=\"anchor\" href=\"#json\">#</a> JSON</h2>\n<p><code>fastjson</code>  æä¾›äº†  <code>JSON.parseObject()</code>  å’Œ  <code>JSON.toJSONString</code>  ä¸¤ä¸ªç›´æ¥ç”¨äºè§£æå’Œç”Ÿæˆçš„æ–¹æ³•ã€‚å‰è€…å®ç°äº†ååºåˆ—åŒ–ï¼Œåè€…å®ç°äº†åºåˆ—åŒ–ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> age<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> emailAddress<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// çœç•¥ getter/setter</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>ç”Ÿæˆ JSON æ ¼å¼å­—ç¬¦ä¸²ï¼š</strong><small>ï¼ˆObject to JSON-Stringï¼‰</small></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"æ€ªç›—tiangeng\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">String</span> jsonStr <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong>è§£æ JSON æ ¼å¼å­—ç¬¦ä¸²ï¼š</strong><small>ï¼ˆJSON-String to Objectï¼‰</small></p>\n<blockquote>\n<p><code>æ³¨æ„</code> ï¼Œéœ€è¦ User ç±»æœ‰æ— å‚çš„æ„é€ æ–¹æ³•ã€‚</p>\n</blockquote>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> jsonString <span class=\"token operator\">=</span> <span class=\"token string\">\"&#123;\\\"name\\\":\\\"æ€ªç›—tiangeng\\\",\\\"age\\\":23&#125;\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>jsonString<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"jsonobject\"><a class=\"anchor\" href=\"#jsonobject\">#</a> JSONObject</h2>\n<blockquote>\n<p>åœ¨  <code>Java</code>  ä¸­ï¼Œä¸€ä¸ª <code>Map&lt;String, Object&gt;</code>  å¯¹è±¡å¯ä»¥ç­‰ä»·æè¿°ä¸€ä¸ª <code> JavaBean</code> ã€‚ <code>Map</code>  ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œå¯¹åº” <code> JavaBean</code>  ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚é”®ä¸ºå±æ€§åï¼Œå€¼ä¸ºå±æ€§å€¼ã€‚</p>\n</blockquote>\n<p><code>JSONObject </code> å°±æ˜¯ <code>fastjson</code>  ä¸“é—¨æä¾›çš„ä¸€ä¸ªç”¨äºè¿™æ ·çš„ä½¿ç”¨åœºæ™¯çš„ <code> Map</code> ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JSONObject</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>fastJson</code>  æä¾›äº†  <code>JSON.parseObject()</code>  å°†  <code>JSON </code> æ ¼å¼å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª <code>JSONObject</code>  å¯¹è±¡ï¼ˆæœ¬è´¨ä¸Šï¼Œå°±æ˜¯è½¬æ¢æˆä¸€ä¸ª <code>Map</code> ï¼‰ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> jsonString <span class=\"token operator\">=</span> <span class=\"token string\">\"&#123;\\\"name\\\":\\\"æ€ªç›—tiangeng\\\",\\\"age\\\":23&#125;\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">JSONObject</span> map <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>jsonString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">String</span> val1 <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> val2 <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">getIntValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"age\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>å¯¹äºä¸åŒç±»å‹çš„å„ç§å±æ€§ï¼ŒJSONObject æä¾›äº†ä¸åŒçš„  <code>getXXX()</code>  æ–¹æ³•ä¸ä¹‹å¯¹åº”ã€‚</p>\n</blockquote>\n<h2 id=\"jsonarray\"><a class=\"anchor\" href=\"#jsonarray\">#</a> JSONArray</h2>\n<p>ååºåˆ—åŒ–æ•°ç»„å½¢å¼çš„  <code>JSON </code> æ ¼å¼å­—ç¬¦ä¸²çš„ç¬¬ä¸‰ç§æ–¹æ¡ˆæ˜¯åˆ©ç”¨  <code>fastJson </code> æä¾›çš„  <code>JSONArray</code>  ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JSONArray</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ä»å…¶å®šä¹‰çœ‹ï¼Œ <code>JSONArray </code> æœ¬è´¨ä¸Šä¹Ÿå°±æ˜¯ä¸€ä¸ª <code> List</code> ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ¡ˆæœ¬è´¨ä¸Šå’Œä¹‹å‰çš„ç¬¬äºŒç§æ–¹æ¡ˆæ²¡å¤ªå¤§åŒºåˆ«ã€‚</p>\n<p>åªä¸è¿‡å®ƒä¸éœ€è¦åœ¨æœ€å¼€å§‹æä¾›æ‰€è¦è½¬æ¢çš„ç±»å‹ï¼Œè€Œæ˜¯é€šè¿‡å„ç§  <code>getXXX()</code>  æ–¹æ³•åœ¨è·å–å€¼æ•°æ®æ—¶è¿›è¡Œè½¬æ¢ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">JSONArray</span> arr2 <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseArray</span><span class=\"token punctuation\">(</span>jsonStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> arr2<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>arr2<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"æ•°ç»„-é›†åˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–\"><a class=\"anchor\" href=\"#æ•°ç»„-é›†åˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–\">#</a> æ•°ç»„ã€é›†åˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h2>\n<p>æ•°ç»„çš„åºåˆ—åŒ–å¾ˆç®€å•ï¼Œä¸æ™®é€šå¯¹è±¡ç±»ä¼¼ï¼›</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> arr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tom\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"123@qq.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>arr<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jerry\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"456@qq.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>arr<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bean\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">String</span> jsonStr <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ•°ç»„çš„ååºåˆ—åŒ–ï¼Œæœ‰å‡ ç§æ–¹æ¡ˆï¼Œå…¶ä¸­ä¸€ç§æ–¹æ¡ˆä¸æ™®é€šå¯¹è±¡çš„ååºåˆ—åŒ–ç±»ä¼¼ï¼Œï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯å¡«å†™æ­£ç¡®çš„æ•°ç»„ç±»å‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> arr <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>jsonStr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user <span class=\"token operator\">:</span> arr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>é‰´äº  <code>List</code>  ä¸ æ•°ç»„ æœ‰æå¤§åœ°ç›¸ä¼¼æ€§ï¼Œå¦ä¸€ç§ååºåˆ—åŒ–æ•°ç»„å½¢å¼çš„ <code>JSON</code>  å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ˜¯ï¼Œå°†å…¶ååºåˆ—åŒ–ä¸ºå¯¹è±¡çš„é“¾è¡¨ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseArray</span><span class=\"token punctuation\">(</span>jsonStr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user <span class=\"token operator\">:</span> list<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"æ³›å‹-å’Œ-resetfull-api\"><a class=\"anchor\" href=\"#æ³›å‹-å’Œ-resetfull-api\">#</a> æ³›å‹ å’Œ RESETfull API</h2>\n<p>æ³›å‹çš„å¼•å…¥å¯ä»¥å‡å°‘æ— å…³çš„ä»£ç ï¼Œè¿™åœ¨ <code>resetful api</code>  è¿”å›æ•°æ®æ—¶åæ˜ å¾—æ›´ä¸ºæ¸…æ¥šï¼Œé€šå¸¸  <code>resetful api</code>  æ¥å£è¿”å›çš„ <code> JSON</code>  æ•°æ®ä¸ºï¼š</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">\"status\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"msg\"</span><span class=\"token operator\">:</span><span class=\"token string\">'...'</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"data\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">...</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">\"status\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"msg\"</span><span class=\"token operator\">:</span><span class=\"token string\">'...'</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"data\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><blockquote>\n<p><code>status</code>  è¡¨ç¤ºå“åº”çŠ¶æ€ç ï¼Œ <code>msg</code>  è¡¨ç¤ºçŠ¶æ€ç é…å¥—çš„ä¿¡æ¯ï¼Œè€Œ <code>data</code>  æ‰æ˜¯æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼šå“åº”çš„æ•°æ®ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒè¦ä¹ˆè¡¨ç¤ºè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¦ä¹ˆè¡¨ç¤ºè¿”å›ä¸€ä¸ªå¯¹è±¡çš„é›†åˆ<small>ï¼ˆæ•°ç»„æˆ– <code> List</code> ï¼‰</small>ã€‚</p>\n</blockquote>\n<p>åœ¨è¿™é‡Œä¼šæŠŠè¿™ä¸ªç»“æœå¯¹è±¡å®šä¹‰æˆæ³›å‹ç±»ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Result</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> code<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> message<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">T</span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¦åˆ™ï¼Œ <code>data </code> çš„ç±»å‹æ— ç©·æ— å°½ï¼Œä½ å°±éœ€è¦ä¸ºæ¯ä¸€ç§æƒ…å†µå®šä¹‰ä¸€ç§ <code> Result</code>  ç±»ã€‚</p>\n<p>é‚£ä¹ˆå¯¹äº  <code>data</code>  å­—æ®µï¼Œå½“ T æ˜¯ <code> User</code>  æ—¶åˆ™å¯ä»¥å†™ä¸º  <code>Result&lt;User&gt;</code> ï¼Œå½“æ˜¯ä¸ªåˆ—è¡¨çš„æ—¶å€™ä¸º  <code>Result&lt;List&lt;User&gt;&gt;</code> ï¼Œå…¶å®ƒç±»å‹åŒç†ï¼ˆ <code>Result&lt;XXX&gt;</code>  å’Œ  <code>Result&lt;List&lt;XXX&gt;&gt;</code> ï¼‰ã€‚</p>\n<p>å¯¹æ­¤ï¼Œ <code>Json</code>  å­—ç¬¦ä¸²è½¬å¯¹è±¡æ—¶ï¼Œä»£ç è‡ªç„¶å°±ç±»ä¼¼å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">JSONArray</span> list <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseArray</span><span class=\"token punctuation\">(</span>jsonStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Result</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Result</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"jsonfield-æ³¨è§£name-å±æ€§\"><a class=\"anchor\" href=\"#jsonfield-æ³¨è§£name-å±æ€§\">#</a> @JSONField æ³¨è§£ï¼šname å±æ€§</h2>\n<blockquote>\n<p>é»˜è®¤ / ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ <code>JSON</code>  å­—æ®µä¸­çš„åå­—å’Œç±»çš„å±æ€§åæ˜¯ä¸€è‡´çš„ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºæœ¬èº«é©¼å³°å‘½åæ³•ï¼ˆå¦‚ Javaï¼‰å’Œä¸‹åˆ’çº¿å‘½åæ³•ï¼ˆå¦‚ Cï¼‰æœ¬èº«å°±æ˜¯ä¸¤å¤§å‘½åè§„åˆ™ â€œæµæ´¾â€ã€‚</p>\n</blockquote>\n<p>å¯¹ç±»çš„å±æ€§ä½¿ç”¨  <code>@JSONField</code>  æ³¨è§£ï¼ˆåŠå…¶  <code>name</code>  å±æ€§ï¼‰ï¼Œå¯ä»¥é‡æ–°æŒ‡å®šä¸è¯¥å±æ€§å¯¹åº”çš„ <code>JSON</code>  å­—ç¬¦ä¸²ä¸­çš„åå­—ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"email_address\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> emailAddress</pre></td></tr></table></figure><p>ä½ ç”šè‡³å¯ä»¥é‡æ–°å‘½åä¸ºå¦ä¸€ä¸ªçœ‹èµ·æ¥æ¯«ä¸ç›¸å…³çš„åå­—ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"xxx\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> emailAddress<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">String</span> jsonString <span class=\"token operator\">=</span> <span class=\"token string\">\"&#123;\\\"name\\\":\\\"æ€ªç›—taingeng\\\",\\\"age\\\":23, \\\"email_address\\\":\\\"123456@qq.com\\\"&#125;\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> JSON<span class=\"token punctuation\">.</span><span class=\"token function\">parseObject</span><span class=\"token punctuation\">(</span>jsonString<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"jsonfield-æ³¨è§£serialzefeatures-å±æ€§\"><a class=\"anchor\" href=\"#jsonfield-æ³¨è§£serialzefeatures-å±æ€§\">#</a> @JSONField æ³¨è§£ï¼šserialzeFeatures å±æ€§</h2>\n<p>åœ¨å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆãƒ» <code>JSON</code>  æ ¼å¼å­—ç¬¦ä¸²æ—¶ï¼Œ <code>fastJson </code> ä¼šè‡ªåŠ¨å¿½ç•¥æ‰å…¶ä¸­å€¼ä¸º  <code>null</code>  çš„å±æ€§ï¼ŒåŠä¸åŒ…å«åœ¨ <code>JSON</code>  æ ¼å¼ä¸ºå­—ç¬¦ä¸²ä¸­ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>user<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tom\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// &#123;\"name\":\"tom\"&#125;</span></pre></td></tr></table></figure><p>æœ‰æ—¶ä½ éœ€è¦ä»¥æ›´å®Œå–„çš„å½¢å¼æ¥è¡¨è¾¾å‡ºè¿™ä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œå³ä¾¿å…¶å€¼ä¸º  <code>null</code>  ã€‚</p>\n<p>ä¸ºæ­¤ï¼Œ <code>fastJson</code>  é€šè¿‡  <code>@JSONField</code>  æ³¨è§£çš„  <code>serialzeFeatures</code>  å±æ€§å€¼è¿›è¡Œè®¾ç½®ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>serialzeFeatures<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">SerializerFeature<span class=\"token punctuation\">.</span>WriteNullNumberAsZero</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> age<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>serialzeFeatures<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">SerializerFeature<span class=\"token punctuation\">.</span>WriteMapNullValue</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> emailAddress<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>serialzeFeatures<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">SerializerFeature<span class=\"token punctuation\">.</span>WriteNullStringAsEmpty</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>user<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tom\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// &#123;\"age\":0,\"emailAddress\":null,\"list\":null,\"name\":\"tom\"&#125;</span></pre></td></tr></table></figure><h2 id=\"jsonfield-æ³¨è§£format-å±æ€§\"><a class=\"anchor\" href=\"#jsonfield-æ³¨è§£format-å±æ€§\">#</a> @JSONField æ³¨è§£ï¼šformat å±æ€§</h2>\n<p>å½“æ‰€éœ€è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å¯¹è±¡çš„å±æ€§æœ‰  <code>Date</code>  ç±»å‹æ—¶ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°  <code>Date</code>  ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼çš„æ ¼å¼é—®é¢˜ï¼Œä¸ºæ­¤  <code>@JSONField</code>  æ³¨è§£æä¾›äº†  <code>format</code>  å±æ€§ç”¨ä»¥è‡ªå®šä¹‰å…¶å­—ç¬¦ä¸²æ ¼å¼ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>format<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">Date</span> birthDate<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä½¿ç”¨ ISO-8601 æ—¥æœŸæ ¼å¼:</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@JSONField</span><span class=\"token punctuation\">(</span>serialzeFeatures<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">SerializerFeature<span class=\"token punctuation\">.</span>UseISO8601DateFormat</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">Date</span> birthDate<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ååºåˆ—åŒ–èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å¦‚ä¸‹æ—¥æœŸæ ¼å¼ï¼š</p>\n<ul>\n<li>ISO-8601 æ—¥æœŸæ ¼å¼</li>\n<li>yyyy-MM-dd</li>\n<li>yyyy-MM-dd HH:mm:ss</li>\n<li>yyyy-MM-dd HH:mm:ss.SSS</li>\n<li>æ¯«ç§’æ•°å­—</li>\n<li>æ¯«ç§’æ•°å­—å­—ç¬¦ä¸²</li>\n<li>.NET JSON æ—¥æœŸæ ¼å¼</li>\n<li>new Date(198293238)</li>\n</ul>\n<h2 id=\"jsonfield-æ³¨è§£serialize-å±æ€§\"><a class=\"anchor\" href=\"#jsonfield-æ³¨è§£serialize-å±æ€§\">#</a> @JSONField æ³¨è§£ï¼šserialize å±æ€§</h2>\n<p>æ ‡æ³¨äº†  <code>@JSONField(serialize=false)</code>  çš„å±æ€§åœ¨åºåˆ—åŒ–æˆ <code>JSON</code>  æ ¼å¼å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¢«  <code>fastJSON </code> å¿½ç•¥ã€‚æ— è®ºå…¶æ˜¯å¦æœ‰å€¼ã€‚</p>\n<h2 id=\"å¾ªç¯å¼•ç”¨\"><a class=\"anchor\" href=\"#å¾ªç¯å¼•ç”¨\">#</a> å¾ªç¯å¼•ç”¨</h2>\n<p><code>fastJson</code>  è‡ªåŠ¨è¯†åˆ«å¾ªç¯æ··ç”¨çš„é—®é¢˜ï¼Œå¹¶å°†å…¶æ›¿æ¢æˆ  <code>$ref</code>  å½¢å¼ã€‚è€Œæ˜¯ä¸æ˜¯  <code>StackOverflowError</code>  å¼‚å¸¸ã€‚</p>\n<blockquote>\n<p><code>$ref</code> ï¼š <code>..</code>  ä¸Šä¸€çº§</p>\n<p><code>$ref</code> ï¼š <code>@</code>  å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è‡ªå¼•ç”¨</p>\n<p><code>$ref</code> ï¼š <code>$</code>  æ ¹å¯¹è±¡</p>\n<p><code>$ref</code> ï¼š <code>$.children.0</code>  åŸºäºè·¯å¾„çš„å¼•ç”¨ï¼Œç›¸å½“äº  <code>root.getChildren().get(0)</code></p>\n</blockquote>\n<p>å¦‚æœç™¾åˆ†ç™¾è‚¯å®šæ‰€è¦åºåˆ—åŒ–çš„å¯¹è±¡ä¸å­˜åœ¨å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œå¯ä»¥åœ¨åºåˆ—åŒ–æ—¶å…³é—­è¯¥æ£€æµ‹åŠŸèƒ½ï¼ˆé»˜è®¤æ˜¯å¼€å¯çš„ï¼‰ã€‚</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>JSON<span class=\"token punctuation\">.</span><span class=\"token function\">toJSONString</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SerializerFeature<span class=\"token punctuation\">.</span>DisableCircularReferenceDetect</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "Java",
                "æŠ€æœ¯å®è·µ",
                "ç¬”è®°",
                "å®æˆ˜",
                "Fastjson"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/8/e92c6dc1ddaa/",
            "url": "https://shaogezhu.cn/2022/8/e92c6dc1ddaa/",
            "title": "ç³»ç»Ÿæ€»ç»“ï¼Œå¸¦ä½ å®ç°Linuxå‘½ä»¤è‡ªç”±",
            "date_published": "2022-08-06T18:56:48.000Z",
            "content_html": "<div class=\"note info\">\n<p>Linux çš„å­¦ä¹ å¯¹äºä¸€ä¸ªç¨‹åºå‘˜çš„é‡è¦æ€§æ˜¯ä¸è¨€è€Œå–»çš„ã€‚å‰ç«¯å¼€å‘ç›¸æ¯”åç«¯å¼€å‘ï¼Œæ¥è§¦  <code>Linux</code>  æœºä¼šç›¸å¯¹è¾ƒå°‘ï¼Œå› æ­¤å¾€å¾€å®¹æ˜“å¿½è§†å®ƒã€‚ä½†æ˜¯å­¦å¥½å®ƒå´æ˜¯ç¨‹åºå‘˜å¿…å¤‡ä¿®å…»ä¹‹ä¸€ã€‚ğŸ‘€</p>\n</div>\n<h1 id=\"linuxåŸºç¡€\"><a class=\"anchor\" href=\"#linuxåŸºç¡€\">#</a> Linux åŸºç¡€</h1>\n<h2 id=\"ä»€ä¹ˆæ˜¯linux\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯linux\">#</a> ä»€ä¹ˆæ˜¯ Linux</h2>\n<h3 id=\"linux-ç³»ç»Ÿå†…æ ¸ä¸-linux-å‘è¡Œå¥—ä»¶çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#linux-ç³»ç»Ÿå†…æ ¸ä¸-linux-å‘è¡Œå¥—ä»¶çš„åŒºåˆ«\">#</a> Linux ç³»ç»Ÿå†…æ ¸ä¸ Linux å‘è¡Œå¥—ä»¶çš„åŒºåˆ«</h3>\n<ul>\n<li><code>Linux</code>  ç³»ç»Ÿå†…æ ¸æŒ‡çš„æ˜¯ç”±  <code>Linus Torvalds</code>  è´Ÿè´£ç»´æŠ¤ï¼Œæä¾›ç¡¬ä»¶æŠ½è±¡å±‚ã€ç¡¬ç›˜åŠæ–‡ä»¶ç³»ç»Ÿæ§åˆ¶åŠå¤šä»»åŠ¡åŠŸèƒ½çš„ç³»ç»Ÿæ ¸å¿ƒç¨‹åºã€‚</li>\n<li><code>Linux</code>  å‘è¡Œå¥—ä»¶ç³»ç»Ÿæ˜¯æˆ‘ä»¬å¸¸è¯´çš„  <code>Linux</code>  æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå³æ˜¯ç”±  <code>Linux</code>  å†…æ ¸ä¸å„ç§å¸¸ç”¨è½¯ä»¶çš„é›†åˆäº§å“ã€‚</li>\n</ul>\n<p><strong><span class=\"blue\">æ€»ç»“ï¼šçœŸæ­£çš„  <code>Linux</code>  æŒ‡çš„æ˜¯ç³»ç»Ÿå†…æ ¸ï¼Œè€Œæˆ‘ä»¬å¸¸è¯´çš„  <code>Linux</code>  æŒ‡çš„æ˜¯ â€œå‘è¡Œç‰ˆå®Œæ•´çš„åŒ…å«ä¸€äº›åŸºç¡€è½¯ä»¶çš„æ“ä½œç³»ç»Ÿâ€ã€‚</span></strong></p>\n<h3 id=\"linux-å¯¹æ¯”-windows\"><a class=\"anchor\" href=\"#linux-å¯¹æ¯”-windows\">#</a> Linux å¯¹æ¯” Windows</h3>\n<ol>\n<li>ç¨³å®šä¸”æœ‰æ•ˆç‡ï¼›</li>\n<li>å…è´¹ï¼ˆæˆ–å°‘è®¸è´¹ç”¨ï¼‰ï¼›</li>\n<li>æ¼æ´å°‘ä¸”å¿«é€Ÿä¿®è¡¥ï¼›</li>\n<li>å¤šä»»åŠ¡å¤šç”¨æˆ·ï¼›</li>\n<li>æ›´åŠ å®‰å…¨çš„ç”¨æˆ·ä¸æ–‡ä»¶æƒé™ç­–ç•¥ï¼›</li>\n<li>é€‚åˆå°å†…æ ¸ç¨‹åºçš„åµŒå…¥ç³»ç»Ÿï¼›</li>\n<li>ç›¸å¯¹ä¸è€—èµ„æºã€‚</li>\n</ol>\n<h3 id=\"linux-ç³»ç»Ÿç§ç±»\"><a class=\"anchor\" href=\"#linux-ç³»ç»Ÿç§ç±»\">#</a> Linux ç³»ç»Ÿç§ç±»</h3>\n<ul>\n<li>çº¢å¸½ä¼ä¸šç‰ˆ  <code>Linux</code>  ï¼š  <code>RHEL</code>  æ˜¯å…¨ä¸–ç•Œå†…ä½¿ç”¨æœ€å¹¿æ³›çš„  <code>Linux</code>  ç³»ç»Ÿã€‚å®ƒå…·æœ‰æå¼ºçš„æ€§èƒ½ä¸ç¨³å®šæ€§ï¼Œæ˜¯ä¼—å¤šç”Ÿæˆç¯å¢ƒä¸­ä½¿ç”¨çš„ï¼ˆæ”¶è´¹çš„ï¼‰ç³»ç»Ÿã€‚</li>\n<li><code>Fedora</code>  ï¼šç”±çº¢å¸½å…¬å¸å‘å¸ƒçš„æ¡Œé¢ç‰ˆç³»ç»Ÿå¥—ä»¶ï¼Œç”¨æˆ·å¯ä»¥å…è´¹ä½“éªŒåˆ°æœ€æ–°çš„æŠ€æœ¯æˆ–å·¥å…·ï¼Œè¿™äº›æŠ€æœ¯æˆ–å·¥å…·åœ¨æˆç†Ÿåä¼šè¢«åŠ å…¥åˆ°  <code>RHEL</code>  ç³»ç»Ÿä¸­ï¼Œå› æ­¤  <code>Fedora</code>  ä¹Ÿæˆä¸º  <code>RHEL</code>  ç³»ç»Ÿçš„è¯•éªŒç‰ˆæœ¬ã€‚</li>\n<li><code>CentOS</code>  ï¼šé€šè¿‡æŠŠ  <code>RHEL</code>  ç³»ç»Ÿé‡æ–°ç¼–è¯‘å¹¶å‘å¸ƒç»™ç”¨æˆ·å…è´¹ä½¿ç”¨çš„  <code>Linux</code>  ç³»ç»Ÿï¼Œå…·æœ‰å¹¿æ³›çš„ä½¿ç”¨äººç¾¤ã€‚</li>\n<li><code>Deepin</code>  ï¼šä¸­å›½å‘è¡Œï¼Œå¯¹ä¼˜ç§€çš„å¼€æºæˆå“è¿›è¡Œé›†æˆå’Œé…ç½®ã€‚</li>\n<li><code>Debian</code>  ï¼šç¨³å®šæ€§ã€å®‰å…¨æ€§å¼ºï¼Œæä¾›äº†å…è´¹çš„åŸºç¡€æ”¯æŒï¼Œåœ¨å›½å¤–æ‹¥æœ‰å¾ˆé«˜çš„è®¤å¯åº¦å’Œä½¿ç”¨ç‡ã€‚</li>\n<li><code>Ubuntu</code>  ï¼šæ˜¯ä¸€æ¬¾æ´¾ç”Ÿè‡ª  <code>Debian</code>  çš„æ“ä½œç³»ç»Ÿï¼Œå¯¹æ–°æ¬¾ç¡¬ä»¶å…·æœ‰æå¼ºçš„å…¼å®¹èƒ½åŠ›ã€‚  <code>Ubuntu</code>  ä¸  <code>Fedora</code>  éƒ½æ˜¯æå…¶å‡ºè‰²çš„  <code>Linux</code>  æ¡Œé¢ç³»ç»Ÿï¼Œè€Œä¸”  <code>Ubuntu</code>  ä¹Ÿå¯ç”¨äºæœåŠ¡å™¨é¢†åŸŸã€‚</li>\n</ul>\n<h2 id=\"shell\"><a class=\"anchor\" href=\"#shell\">#</a> Shell</h2>\n<p><code>Shell</code>  è¿™ä¸ªå•è¯çš„åŸæ„æ˜¯ â€œå¤–å£³â€ï¼Œè·Ÿ  <code>kernel</code> ï¼ˆå†…æ ¸ï¼‰ç›¸å¯¹åº”ï¼Œæ¯”å–»å†…æ ¸å¤–é¢çš„ä¸€å±‚ï¼Œå³ç”¨æˆ·è·Ÿå†…æ ¸äº¤äº’çš„å¯¹è¯ç•Œé¢ã€‚</p>\n<ul>\n<li><code>Shell</code>  æ˜¯ä¸€ä¸ªç¨‹åºï¼Œæä¾›ä¸€ä¸ªä¸ç”¨æˆ·å¯¹è¯çš„ç¯å¢ƒã€‚è¿™ä¸ªç¯å¢ƒåªæœ‰ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦ï¼Œè®©ç”¨æˆ·ä»é”®ç›˜è¾“å…¥å‘½ä»¤ï¼Œæ‰€ä»¥åˆç§°ä¸ºå‘½ä»¤è¡Œç¯å¢ƒï¼ˆ  <code>command line interface</code>  ï¼Œç®€å†™ä¸º  <code>CLI</code>  ï¼‰ã€‚  <code>Shell</code>  æ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼Œå°†å‘½ä»¤é€å…¥æ“ä½œç³»ç»Ÿæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚</li>\n<li><code>Shell</code>  æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼Œè§£é‡Šç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ã€‚å®ƒæ”¯æŒå˜é‡ã€æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯æ“ä½œç­‰è¯­æ³•ï¼Œæ‰€ä»¥ç”¨æˆ·å¯ä»¥ç”¨  <code>Shell</code>  å‘½ä»¤å†™å‡ºå„ç§å°ç¨‹åºï¼Œåˆç§°ä¸º  <code>Shell</code>  è„šæœ¬ã€‚è¿™äº›è„šæœ¬éƒ½é€šè¿‡  <code>Shell</code>  çš„è§£é‡Šæ‰§è¡Œï¼Œè€Œä¸é€šè¿‡ç¼–è¯‘ã€‚</li>\n<li><code>Shell</code>  æ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œæä¾›äº†å„ç§å°å·¥å…·ï¼Œä¾›ç”¨æˆ·æ–¹ä¾¿åœ°ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚</li>\n</ul>\n<h3 id=\"shell-çš„ç§ç±»\"><a class=\"anchor\" href=\"#shell-çš„ç§ç±»\">#</a> Shell çš„ç§ç±»</h3>\n<p><code>Shell</code>  æœ‰å¾ˆå¤šç§ï¼Œåªè¦èƒ½ç»™ç”¨æˆ·æä¾›å‘½ä»¤è¡Œç¯å¢ƒçš„ç¨‹åºï¼Œéƒ½å¯ä»¥çœ‹ä½œæ˜¯  <code>Shell</code>  ã€‚</p>\n<p>å†å²ä¸Šï¼Œä¸»è¦çš„  <code>Shell</code>  æœ‰ä¸‹é¢è¿™äº›ï¼š</p>\n<ul>\n<li>Bourne Shellï¼ˆshï¼‰</li>\n<li>Bourne Again shellï¼ˆbashï¼‰</li>\n<li>C Shellï¼ˆcshï¼‰</li>\n<li>TENEX C Shellï¼ˆtcshï¼‰</li>\n<li>Korn shellï¼ˆkshï¼‰</li>\n<li>Z Shellï¼ˆzshï¼‰</li>\n<li>Friendly Interactive Shellï¼ˆfishï¼‰</li>\n</ul>\n<p>å…¶ä¸­  <code>Bash</code>  æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„  <code>Shell</code>  ã€‚  <code>MacOS</code>  ä¸­çš„é»˜è®¤  <code>Shell</code>  å°±æ˜¯  <code>Bash</code>  ã€‚</p>\n<p>é€šè¿‡æ‰§è¡Œ  <code>echo $SHELL</code>  å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°å½“å‰æ­£åœ¨ä½¿ç”¨çš„  <code>Shell</code>  ã€‚è¿˜å¯ä»¥é€šè¿‡  <code>cat /etc/shells</code>  æŸ¥çœ‹å½“å‰ç³»ç»Ÿå®‰è£…çš„æ‰€æœ‰  <code>Shell</code>  ç§ç±»ã€‚</p>\n<h2 id=\"å‘½ä»¤\"><a class=\"anchor\" href=\"#å‘½ä»¤\">#</a> å‘½ä»¤</h2>\n<h3 id=\"å‘½ä»¤æç¤ºç¬¦\"><a class=\"anchor\" href=\"#å‘½ä»¤æç¤ºç¬¦\">#</a> å‘½ä»¤æç¤ºç¬¦</h3>\n<p>è¿›å…¥å‘½ä»¤è¡Œç¯å¢ƒä»¥åï¼Œç”¨æˆ·ä¼šçœ‹åˆ°  <code>Shell</code>  çš„æç¤ºç¬¦ã€‚æç¤ºç¬¦å¾€å¾€æ˜¯ä¸€ä¸²å‰ç¼€ï¼Œæœ€åä»¥ä¸€ä¸ªç¾å…ƒç¬¦å·  <code>$</code>  ç»“å°¾ï¼Œç”¨æˆ·å¯ä»¥åœ¨è¿™ä¸ªç¬¦å·åé¢è¾“å…¥å„ç§å‘½ä»¤ã€‚</p>\n<p>æ‰§è¡Œä¸€ä¸ªç®€å•çš„å‘½ä»¤  <code>pwd</code>  ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@iZm5e8dsxce9ufaic7hi3uZ ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># pwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/root</pre></td></tr></table></figure><p>å‘½ä»¤è§£æï¼š</p>\n<ul>\n<li>\n<p><code>root</code> ï¼šè¡¨ç¤ºç”¨æˆ·åï¼›</p>\n</li>\n<li>\n<p><code>iZm5e8dsxce9ufaic7hi3uZ</code> ï¼šè¡¨ç¤ºä¸»æœºåï¼›</p>\n</li>\n<li>\n<p><code>~</code> ï¼šè¡¨ç¤ºç›®å‰æ‰€åœ¨ç›®å½•ä¸ºå®¶ç›®å½•ï¼Œå…¶ä¸­  <code>root</code>  ç”¨æˆ·çš„å®¶ç›®å½•æ˜¯  <code>/root</code>  æ™®é€šç”¨æˆ·çš„å®¶ç›®å½•åœ¨  <code>/home</code>  ä¸‹ï¼›</p>\n</li>\n<li>\n<p><code>#</code> ï¼šæŒ‡ç¤ºä½ æ‰€å…·æœ‰çš„æƒé™ï¼ˆ  <code>root</code>  ç”¨æˆ·ä¸º  <code>#</code>  ï¼Œæ™®é€šç”¨æˆ·ä¸º  <code>$</code>  ï¼‰ã€‚</p>\n</li>\n<li>\n<p>æ‰§è¡Œ  <code>whoami</code>  å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç”¨æˆ·åï¼›</p>\n</li>\n<li>\n<p>æ‰§è¡Œ  <code>hostname</code>  å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ä¸»æœºåï¼›</p>\n</li>\n</ul>\n<p>å…³äºå¦‚ä½•åˆ›å»ºã€åˆ‡æ¢ã€åˆ é™¤ç”¨æˆ·ï¼Œåœ¨åé¢çš„ç”¨æˆ·ä¸æƒé™ä¼šå…·ä½“è®²è§£ï¼Œè¿™é‡Œå…ˆä½¿ç”¨  <code>root</code>  ç”¨æˆ·è¿›è¡Œæ¼”ç¤ºã€‚</p>\n<blockquote>\n<p><code>root</code>  æ˜¯è¶…çº§ç”¨æˆ·ï¼Œå…·å¤‡æ“ä½œç³»ç»Ÿçš„ä¸€åˆ‡æƒé™ã€‚</p>\n</blockquote>\n<h3 id=\"å‘½ä»¤æ ¼å¼\"><a class=\"anchor\" href=\"#å‘½ä»¤æ ¼å¼\">#</a> å‘½ä»¤æ ¼å¼</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">command</span> parametersï¼ˆå‘½ä»¤ å‚æ•°ï¼‰</pre></td></tr></table></figure><h4 id=\"é•¿çŸ­å‚æ•°\"><a class=\"anchor\" href=\"#é•¿çŸ­å‚æ•°\">#</a> é•¿çŸ­å‚æ•°</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>å•ä¸ªå‚æ•°ï¼šls -aï¼ˆa æ˜¯è‹±æ–‡ all çš„ç¼©å†™ï¼Œè¡¨ç¤ºâ€œå…¨éƒ¨â€ï¼‰</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>å¤šä¸ªå‚æ•°ï¼šls -alï¼ˆå…¨éƒ¨æ–‡ä»¶ + åˆ—è¡¨å½¢å¼å±•ç¤ºï¼‰</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>å•ä¸ªé•¿å‚æ•°ï¼šls --all</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>å¤šä¸ªé•¿å‚æ•°ï¼šls --reverse --all</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>é•¿çŸ­æ··åˆå‚æ•°ï¼šls --all -l</pre></td></tr></table></figure><h4 id=\"å‚æ•°å€¼\"><a class=\"anchor\" href=\"#å‚æ•°å€¼\">#</a> å‚æ•°å€¼</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>çŸ­å‚æ•°ï¼šcommand -p <span class=\"token number\">10</span>ï¼ˆä¾‹å¦‚ï¼šssh root@121.42.11.34 -p <span class=\"token number\">22</span>ï¼‰</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>é•¿å‚æ•°ï¼šcommand --paramters<span class=\"token operator\">=</span><span class=\"token number\">10</span>ï¼ˆä¾‹å¦‚ï¼šssh root@121.42.11.34 --port<span class=\"token operator\">=</span><span class=\"token number\">22</span>ï¼‰</pre></td></tr></table></figure><h2 id=\"å¿«æ·æ–¹å¼\"><a class=\"anchor\" href=\"#å¿«æ·æ–¹å¼\">#</a> å¿«æ·æ–¹å¼</h2>\n<blockquote>\n<p>åœ¨å¼€å§‹ä½¿ç”¨ <code>Linux</code>  å‘½ä»¤ä¹‹å‰ï¼Œæœ‰è¿™ä¹ˆä¸€äº›å¿«æ·æ–¹å¼ï¼Œæ˜¯å¿…é¡»è¦æå‰æŒæ¡çš„ï¼Œå®ƒå°†è´¯ç©¿æ•´ä¸ª  <code>Linux</code>  ä½¿ç”¨ç”Ÿæ¶¯ã€‚</p>\n</blockquote>\n<ul>\n<li>é€šè¿‡ä¸Šä¸‹æ–¹å‘é”® â†‘ â†“ æ¥è°ƒå–è¿‡å¾€æ‰§è¡Œè¿‡çš„  <code>Linux</code>  å‘½ä»¤ï¼›</li>\n<li>å‘½ä»¤æˆ–å‚æ•°ä»…éœ€è¾“å…¥å‰å‡ ä½å°±å¯ä»¥ç”¨  <code>Tab</code>  é”®è¡¥å…¨ï¼›</li>\n<li><code>Ctrl + R</code>  ï¼šç”¨äºæŸ¥æ‰¾ä½¿ç”¨è¿‡çš„å‘½ä»¤ï¼ˆ <code>history</code>  å‘½ä»¤ç”¨äºåˆ—å‡ºä¹‹å‰ä½¿ç”¨è¿‡çš„æ‰€æœ‰å‘½ä»¤ï¼Œç„¶åè¾“å…¥  <code>!</code>  å‘½ä»¤åŠ ä¸Šç¼–å· (  <code>!2</code>  ) å°±å¯ä»¥ç›´æ¥æ‰§è¡Œè¯¥å†å²å‘½ä»¤ï¼‰ï¼›</li>\n<li><code>Ctrl + L</code> ï¼šæ¸…é™¤å±å¹•å¹¶å°†å½“å‰è¡Œç§»åˆ°é¡µé¢é¡¶éƒ¨ï¼›</li>\n<li><code>Ctrl + C</code> ï¼šä¸­æ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤ï¼›</li>\n<li><code>Ctrl + U</code> ï¼šä»å…‰æ ‡ä½ç½®å‰ªåˆ‡åˆ°è¡Œé¦–ï¼›</li>\n<li><code>Ctrl + K</code> ï¼šä»å…‰æ ‡ä½ç½®å‰ªåˆ‡åˆ°è¡Œå°¾ï¼›</li>\n<li><code>Ctrl + W</code> ï¼šå‰ªåˆ‡å…‰æ ‡å·¦ä¾§çš„ä¸€ä¸ªå•è¯ï¼›</li>\n<li><code>Ctrl + Y</code> ï¼šç²˜è´´  <code>Ctrl + U | K | Y</code>  å‰ªåˆ‡çš„å‘½ä»¤ï¼›</li>\n<li><code>Ctrl + A</code> ï¼šå…‰æ ‡è·³åˆ°å‘½ä»¤è¡Œçš„å¼€å¤´ï¼›</li>\n<li><code>Ctrl + E</code> ï¼šå…‰æ ‡è·³åˆ°å‘½ä»¤è¡Œçš„ç»“å°¾ï¼›</li>\n<li><code>Ctrl + D</code> ï¼šå…³é—­  <code>Shell</code>  ä¼šè¯ï¼›</li>\n</ul>\n<h2 id=\"æ–‡ä»¶å’Œç›®å½•\"><a class=\"anchor\" href=\"#æ–‡ä»¶å’Œç›®å½•\">#</a> æ–‡ä»¶å’Œç›®å½•</h2>\n<h3 id=\"æ–‡ä»¶çš„ç»„ç»‡\"><a class=\"anchor\" href=\"#æ–‡ä»¶çš„ç»„ç»‡\">#</a> æ–‡ä»¶çš„ç»„ç»‡</h3>\n<p><img data-src=\"/assets/2022-8/1.png\" alt=\"image.png\" /></p>\n<h3 id=\"æŸ¥çœ‹è·¯å¾„\"><a class=\"anchor\" href=\"#æŸ¥çœ‹è·¯å¾„\">#</a> æŸ¥çœ‹è·¯å¾„</h3>\n<h4 id=\"pwd\"><a class=\"anchor\" href=\"#pwd\">#</a> pwd</h4>\n<p>æ˜¾ç¤ºå½“å‰ç›®å½•çš„è·¯å¾„</p>\n<p><img data-src=\"/assets/2022-8/2.png\" alt=\"image.png\" /></p>\n<h4 id=\"which\"><a class=\"anchor\" href=\"#which\">#</a> which</h4>\n<p>æŸ¥çœ‹å‘½ä»¤çš„å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œ  <code>Linux</code>  ä¸‹ï¼Œæ¯ä¸€æ¡å‘½ä»¤å…¶å®éƒ½å¯¹åº”ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ï¼ŒæŒ‰å›è½¦çš„æ—¶å€™ï¼Œå°±æ˜¯æ‰§è¡Œäº†å¯¹åº”çš„é‚£ä¸ªç¨‹åºï¼Œ  <code>which</code>  å‘½ä»¤æœ¬èº«å¯¹åº”çš„ç¨‹åºä¹Ÿå­˜åœ¨äº  <code>Linux</code>  ä¸­ã€‚</p>\n<p>æ€»çš„æ¥è¯´ä¸€ä¸ªå‘½ä»¤å°±æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºã€‚</p>\n<p><img data-src=\"/assets/2022-8/3.png\" alt=\"image.png\" /></p>\n<h3 id=\"æµè§ˆå’Œåˆ‡æ¢ç›®å½•\"><a class=\"anchor\" href=\"#æµè§ˆå’Œåˆ‡æ¢ç›®å½•\">#</a> æµè§ˆå’Œåˆ‡æ¢ç›®å½•</h3>\n<h4 id=\"ls\"><a class=\"anchor\" href=\"#ls\">#</a> ls</h4>\n<p>åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•ï¼Œå®ƒæ˜¯  <code>Linux</code>  æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ã€‚</p>\n<p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-a</code>  æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åŒ…æ‹¬éšè—çš„</li>\n<li><code>-l</code>  æ˜¾ç¤ºè¯¦ç»†åˆ—è¡¨</li>\n<li><code>-h</code>  é€‚åˆäººç±»é˜…è¯»çš„</li>\n<li><code>-t</code>  æŒ‰æ–‡ä»¶æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹æ—¶é—´æ’åº</li>\n<li><code>-i</code>  æ˜¾ç¤ºæ–‡ä»¶çš„  <code>inode</code>  ï¼ˆ  <code>inode</code>  æ˜¯æ–‡ä»¶å†…å®¹çš„æ ‡è¯†ï¼‰</li>\n</ul>\n<p><img data-src=\"/assets/2022-8/4.png\" alt=\"image.png\" /></p>\n<h4 id=\"cd\"><a class=\"anchor\" href=\"#cd\">#</a> cd</h4>\n<p><code>cd</code>  æ˜¯è‹±è¯­  <code>change directory</code>  çš„ç¼©å†™ï¼Œè¡¨ç¤ºåˆ‡æ¢ç›®å½•ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /\t--<span class=\"token operator\">></span> è·³è½¬åˆ°æ ¹ç›®å½•</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> ~\t--<span class=\"token operator\">></span> è·³è½¬åˆ°å®¶ç›®å½•</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>\t--<span class=\"token operator\">></span> è·³è½¬åˆ°ä¸Šçº§ç›®å½•</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> ./home\t--<span class=\"token operator\">></span> è·³è½¬åˆ°å½“å‰ç›®å½•çš„homeç›®å½•ä¸‹</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /home/lion\t--<span class=\"token operator\">></span> è·³è½¬åˆ°æ ¹ç›®å½•ä¸‹çš„homeç›®å½•ä¸‹çš„lionç›®å½•</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">cd</span>\t--<span class=\"token operator\">></span> ä¸æ·»åŠ ä»»ä½•å‚æ•°ï¼Œä¹Ÿæ˜¯å›åˆ°å®¶ç›®å½•</pre></td></tr></table></figure><blockquote>\n<p>è¾“å…¥ <code>cd /ho</code>  + å•æ¬¡  <code>tab</code>  é”®ä¼šè‡ªåŠ¨è¡¥å…¨è·¯å¾„ + ä¸¤æ¬¡  <code>tab</code>  é”®ä¼šåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„ç›®å½•åˆ—è¡¨ã€‚</p>\n</blockquote>\n<h4 id=\"du\"><a class=\"anchor\" href=\"#du\">#</a> du</h4>\n<p>åˆ—ä¸¾ç›®å½•å¤§å°ä¿¡æ¯ã€‚</p>\n<p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-h</code>  é€‚åˆäººç±»é˜…è¯»çš„ï¼›</li>\n<li><code>-a</code>  åŒæ—¶åˆ—ä¸¾å‡ºç›®å½•ä¸‹æ–‡ä»¶çš„å¤§å°ä¿¡æ¯ï¼›</li>\n<li><code>-s</code>  åªæ˜¾ç¤ºæ€»è®¡å¤§å°ï¼Œä¸æ˜¾ç¤ºå…·ä½“ä¿¡æ¯ã€‚</li>\n</ul>\n<h3 id=\"æµè§ˆå’Œåˆ›å»ºæ–‡ä»¶\"><a class=\"anchor\" href=\"#æµè§ˆå’Œåˆ›å»ºæ–‡ä»¶\">#</a> æµè§ˆå’Œåˆ›å»ºæ–‡ä»¶</h3>\n<h4 id=\"cat\"><a class=\"anchor\" href=\"#cat\">#</a> cat</h4>\n<p>ä¸€æ¬¡æ€§æ˜¾ç¤ºæ–‡ä»¶æ‰€æœ‰å†…å®¹ï¼Œæ›´é€‚åˆæŸ¥çœ‹å°çš„æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> cloud-init.log</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-n</code>  æ˜¾ç¤ºè¡Œå·ã€‚</li>\n</ul>\n<h4 id=\"less\"><a class=\"anchor\" href=\"#less\">#</a> less</h4>\n<p>åˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œæ›´é€‚åˆæŸ¥çœ‹å¤§çš„æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">less</span> cloud-init.log</pre></td></tr></table></figure><p>ã€å¿«æ·æ“ä½œã€‘</p>\n<ul>\n<li>ç©ºæ ¼é”®ï¼šå‰è¿›ä¸€é¡µï¼ˆä¸€ä¸ªå±å¹•ï¼‰ï¼›</li>\n<li><code>b</code>  é”®ï¼šåé€€ä¸€é¡µï¼›</li>\n<li>å›è½¦é”®ï¼šå‰è¿›ä¸€è¡Œï¼›</li>\n<li><code>y</code>  é”®ï¼šåé€€ä¸€è¡Œï¼›</li>\n<li>ä¸Šä¸‹é”®ï¼šå›é€€æˆ–å‰è¿›ä¸€è¡Œï¼›</li>\n<li><code>d</code>  é”®ï¼šå‰è¿›åŠé¡µï¼›</li>\n<li><code>u</code>  é”®ï¼šåé€€åŠé¡µï¼›</li>\n<li><code>q</code>  é”®ï¼šåœæ­¢è¯»å–æ–‡ä»¶ï¼Œä¸­æ­¢  <code>less</code>  å‘½ä»¤ï¼›</li>\n<li><code>=</code>  é”®ï¼šæ˜¾ç¤ºå½“å‰é¡µé¢çš„å†…å®¹æ˜¯æ–‡ä»¶ä¸­çš„ç¬¬å‡ è¡Œåˆ°ç¬¬å‡ è¡Œä»¥åŠä¸€äº›å…¶å®ƒå…³äºæœ¬é¡µå†…å®¹çš„è¯¦ç»†ä¿¡æ¯ï¼›</li>\n<li><code>h</code>  é”®ï¼šæ˜¾ç¤ºå¸®åŠ©æ–‡æ¡£ï¼›</li>\n<li><code>/</code>  é”®ï¼šè¿›å…¥æœç´¢æ¨¡å¼åï¼ŒæŒ‰  <code>n</code>  é”®è·³åˆ°ä¸€ä¸ªç¬¦åˆé¡¹ç›®ï¼ŒæŒ‰  <code>N</code>  é”®è·³åˆ°ä¸Šä¸€ä¸ªç¬¦åˆé¡¹ç›®ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚</li>\n</ul>\n<h4 id=\"head\"><a class=\"anchor\" href=\"#head\">#</a> head</h4>\n<p>æ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´å‡ è¡Œï¼ˆé»˜è®¤æ˜¯ 10 è¡Œï¼‰</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> cloud-init.log</pre></td></tr></table></figure><p>ã€å‚æ•°ã€‘</p>\n<ul>\n<li><code>-n</code>  æŒ‡å®šè¡Œæ•°  <code>head cloud-init.log -n 2</code></li>\n</ul>\n<h4 id=\"tail\"><a class=\"anchor\" href=\"#tail\">#</a> tail</h4>\n<p>æ˜¾ç¤ºæ–‡ä»¶çš„ç»“å°¾å‡ è¡Œï¼ˆé»˜è®¤æ˜¯ 10 è¡Œï¼‰</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tail</span> cloud-init.log</pre></td></tr></table></figure><p>ã€å‚æ•°ã€‘</p>\n<ul>\n<li><code>-n</code>  æŒ‡å®šè¡Œæ•°  <code>tail cloud-init.log -n 2</code></li>\n<li><code>-f</code>  ä¼šæ¯è¿‡ 1 ç§’æ£€æŸ¥ä¸‹æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ–°å†…å®¹ï¼Œä¹Ÿå¯ä»¥ç”¨  <code>-s</code>  å‚æ•°æŒ‡å®šé—´éš”æ—¶é—´  <code>tail -f -s 4 xxx.log</code></li>\n</ul>\n<h4 id=\"touch\"><a class=\"anchor\" href=\"#touch\">#</a> touch</h4>\n<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">touch</span> new_file</pre></td></tr></table></figure><h4 id=\"mkdir\"><a class=\"anchor\" href=\"#mkdir\">#</a> mkdir</h4>\n<p>åˆ›å»ºä¸€ä¸ªç›®å½•</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> new_folder</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-p</code>  é€’å½’çš„åˆ›å»ºç›®å½•ç»“æ„  <code>mkdir -p one/two/three</code></li>\n</ul>\n<h3 id=\"æ–‡ä»¶çš„å¤åˆ¶å’Œç§»åŠ¨\"><a class=\"anchor\" href=\"#æ–‡ä»¶çš„å¤åˆ¶å’Œç§»åŠ¨\">#</a> æ–‡ä»¶çš„å¤åˆ¶å’Œç§»åŠ¨</h3>\n<h4 id=\"cp\"><a class=\"anchor\" href=\"#cp\">#</a> cp</h4>\n<p>æ‹·è´æ–‡ä»¶å’Œç›®å½•</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cp</span> <span class=\"token function\">file</span> file_copy\t--<span class=\"token operator\">></span> <span class=\"token function\">file</span> æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œfile_copy æ˜¯æ‹·è´å‡ºæ¥çš„æ–‡ä»¶</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> <span class=\"token function\">file</span> one\t--<span class=\"token operator\">></span> æŠŠ <span class=\"token function\">file</span> æ–‡ä»¶æ‹·è´åˆ° one ç›®å½•ä¸‹ï¼Œå¹¶ä¸”æ–‡ä»¶åä¾ç„¶ä¸º <span class=\"token function\">file</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cp</span> <span class=\"token function\">file</span> one/file_copy\t--<span class=\"token operator\">></span> æŠŠ <span class=\"token function\">file</span> æ–‡ä»¶æ‹·è´åˆ° one ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸ºfile_copy</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> *.txt folder\t--<span class=\"token operator\">></span> æŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰ txt æ–‡ä»¶æ‹·è´åˆ° folder ç›®å½•ä¸‹</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-r</code>  é€’å½’çš„æ‹·è´ï¼Œå¸¸ç”¨æ¥æ‹·è´ä¸€æ•´ä¸ªç›®å½•</li>\n</ul>\n<h4 id=\"mv\"><a class=\"anchor\" href=\"#mv\">#</a> mv</h4>\n<p>ç§»åŠ¨ï¼ˆé‡å‘½åï¼‰æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸ cp å‘½ä»¤ç”¨æ³•ç›¸ä¼¼ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mv</span> <span class=\"token function\">file</span> one\t--<span class=\"token operator\">></span> å°† <span class=\"token function\">file</span> æ–‡ä»¶ç§»åŠ¨åˆ° one ç›®å½•ä¸‹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> new_folder one\t--<span class=\"token operator\">></span> å°† new_folder æ–‡ä»¶å¤¹ç§»åŠ¨åˆ°oneç›®å½•ä¸‹</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mv</span> *.txt folder\t--<span class=\"token operator\">></span> æŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰ txt æ–‡ä»¶ç§»åŠ¨åˆ° folder ç›®å½•ä¸‹</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">mv</span> <span class=\"token function\">file</span> new_file\t--<span class=\"token operator\">></span> <span class=\"token function\">file</span> æ–‡ä»¶é‡å‘½åä¸º new_file</pre></td></tr></table></figure><h3 id=\"æ–‡ä»¶çš„åˆ é™¤å’Œé“¾æ¥\"><a class=\"anchor\" href=\"#æ–‡ä»¶çš„åˆ é™¤å’Œé“¾æ¥\">#</a> æ–‡ä»¶çš„åˆ é™¤å’Œé“¾æ¥</h3>\n<h4 id=\"rm\"><a class=\"anchor\" href=\"#rm\">#</a> rm</h4>\n<p>åˆ é™¤æ–‡ä»¶å’Œç›®å½•ï¼Œç”±äº  <code>Linux</code>  ä¸‹æ²¡æœ‰å›æ”¶ç«™ï¼Œä¸€æ—¦åˆ é™¤éå¸¸éš¾æ¢å¤ï¼Œå› æ­¤éœ€è¦è°¨æ…æ“ä½œ</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rm</span> new_file \t--<span class=\"token operator\">></span> åˆ é™¤ new_file æ–‡ä»¶</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rm</span> f1 f2 f3 \t--<span class=\"token operator\">></span> åŒæ—¶åˆ é™¤ f1 f2 f3 <span class=\"token number\">3</span>ä¸ªæ–‡ä»¶</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-i</code>  å‘ç”¨æˆ·ç¡®è®¤æ˜¯å¦åˆ é™¤ï¼›</li>\n<li><code>-f</code>  æ–‡ä»¶å¼ºåˆ¶åˆ é™¤ï¼›</li>\n<li><code>-r</code>  é€’å½’åˆ é™¤æ–‡ä»¶å¤¹ï¼Œè‘—åçš„åˆ é™¤æ“ä½œ  <code>rm -rf</code>  ã€‚</li>\n</ul>\n<h4 id=\"ln\"><a class=\"anchor\" href=\"#ln\">#</a> ln</h4>\n<p>è‹±æ–‡  <code>Link</code>  çš„ç¼©å†™ï¼Œè¡¨ç¤ºåˆ›å»ºé“¾æ¥ã€‚</p>\n<p>å­¦ä¹ åˆ›å»ºé“¾æ¥ä¹‹å‰ï¼Œé¦–å…ˆè¦ç†è§£é“¾æ¥æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹  <code>Linux</code>  çš„æ–‡ä»¶æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼š</p>\n<p><code>Linux</code>  æ–‡ä»¶çš„å­˜å‚¨æ–¹å¼åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†ï¼Œæ–‡ä»¶åã€æ–‡ä»¶å†…å®¹ä»¥åŠæƒé™ï¼Œå…¶ä¸­æ–‡ä»¶åçš„åˆ—è¡¨æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜çš„å…¶å®ƒåœ°æ–¹å’Œæ–‡ä»¶å†…å®¹æ˜¯åˆ†å¼€å­˜æ”¾çš„ï¼Œæ¯ä¸ªæ–‡ä»¶åé€šè¿‡  <code>inode</code>  æ ‡è¯†ç»‘å®šåˆ°æ–‡ä»¶å†…å®¹ã€‚</p>\n<blockquote>\n<p>Linux ä¸‹æœ‰ä¸¤ç§é“¾æ¥ç±»å‹ï¼š<strong>ç¡¬é“¾æ¥</strong>å’Œ<strong>è½¯é“¾æ¥</strong>ã€‚</p>\n</blockquote>\n<h5 id=\"ç¡¬é“¾æ¥\"><a class=\"anchor\" href=\"#ç¡¬é“¾æ¥\">#</a> ç¡¬é“¾æ¥</h5>\n<p>ä½¿é“¾æ¥çš„ä¸¤ä¸ªæ–‡ä»¶å…±äº«åŒæ ·æ–‡ä»¶å†…å®¹ï¼Œå°±æ˜¯åŒæ ·çš„  <code>inode</code>  ï¼Œä¸€æ—¦æ–‡ä»¶ 1 å’Œæ–‡ä»¶ 2 ä¹‹é—´æœ‰äº†ç¡¬é“¾æ¥ï¼Œé‚£ä¹ˆä¿®æ”¹ä»»ä½•ä¸€ä¸ªæ–‡ä»¶ï¼Œä¿®æ”¹çš„éƒ½æ˜¯åŒä¸€å—å†…å®¹ï¼Œå®ƒçš„ç¼ºç‚¹æ˜¯ï¼Œåªèƒ½åˆ›å»ºæŒ‡å‘æ–‡ä»¶çš„ç¡¬é“¾æ¥ï¼Œä¸èƒ½åˆ›å»ºæŒ‡å‘ç›®å½•çš„ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ï¼Œä½†æ¯”è¾ƒå¤æ‚ï¼‰è€Œè½¯é“¾æ¥éƒ½å¯ä»¥ï¼Œå› æ­¤è½¯é“¾æ¥ä½¿ç”¨æ›´åŠ å¹¿æ³›ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ln</span> file1 file2 \t--<span class=\"token operator\">></span> åˆ›å»º file2 ä¸º file1 çš„ç¡¬é“¾æ¥</pre></td></tr></table></figure><p><img data-src=\"/assets/2022-8/5.png\" alt=\"image.png\" /></p>\n<blockquote>\n<p>å¦‚æœæˆ‘ä»¬ç”¨  <code>rm file1</code>  æ¥åˆ é™¤  <code>file1</code>  ï¼Œå¯¹  <code>file2</code>  æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œå¯¹äºç¡¬é“¾æ¥æ¥è¯´ï¼Œåˆ é™¤ä»»æ„ä¸€æ–¹çš„æ–‡ä»¶ï¼Œå…±åŒæŒ‡å‘çš„æ–‡ä»¶å†…å®¹å¹¶ä¸ä¼šä»ç¡¬ç›˜ä¸Šåˆ é™¤ã€‚åªæœ‰åŒæ—¶åˆ é™¤äº†  <code>file1</code>  ä¸  <code>file2</code>  åï¼Œå®ƒä»¬å…±åŒæŒ‡å‘çš„æ–‡ä»¶å†…å®¹æ‰ä¼šæ¶ˆå¤±ã€‚</p>\n</blockquote>\n<h5 id=\"è½¯é“¾æ¥\"><a class=\"anchor\" href=\"#è½¯é“¾æ¥\">#</a> è½¯é“¾æ¥</h5>\n<p>è½¯é“¾æ¥å°±ç±»ä¼¼  <code>windows</code>  ä¸‹å¿«æ·æ–¹å¼ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ln</span> -s file1 file2</pre></td></tr></table></figure><p><img data-src=\"/assets/2022-8/6.png\" alt=\"image.png\" /></p>\n<p>æ‰§è¡Œ  <code>ls -l</code>  å‘½åæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶çš„å…·ä½“ä¿¡æ¯</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>total <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>-rw-r--r-- <span class=\"token number\">1</span> root root <span class=\"token number\">0</span> Jan <span class=\"token number\">14</span> 06:29 file1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">5</span> Jan <span class=\"token number\">14</span> 06:42 file2 -<span class=\"token operator\">></span> file1  <span class=\"token comment\"># è¡¨ç¤º file2 æŒ‡å‘ file1</span></pre></td></tr></table></figure><blockquote>\n<p>å…¶å®  <code>file2</code>  åªæ˜¯  <code>file1</code>  çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œå®ƒæŒ‡å‘çš„æ˜¯  <code>file1</code>  ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ˜¯  <code>file1</code>  çš„å†…å®¹ï¼Œä½†å…¶å®  <code>file2</code>  çš„  <code>inode</code>  ä¸  <code>file1</code>  å¹¶ä¸ç›¸åŒã€‚å¦‚æœæˆ‘ä»¬åˆ é™¤äº†  <code>file2</code>  çš„è¯ï¼Œ  <code>file1</code>  æ˜¯ä¸ä¼šå—å½±å“çš„ï¼Œä½†å¦‚æœåˆ é™¤  <code>file1</code>  çš„è¯ï¼Œ  <code>file2</code>  å°±ä¼šå˜æˆæ­»é“¾æ¥ï¼Œå› ä¸ºæŒ‡å‘çš„æ–‡ä»¶ä¸è§äº†ã€‚</p>\n</blockquote>\n<h2 id=\"ç”¨æˆ·ä¸æƒé™\"><a class=\"anchor\" href=\"#ç”¨æˆ·ä¸æƒé™\">#</a> ç”¨æˆ·ä¸æƒé™</h2>\n<h3 id=\"ç”¨æˆ·\"><a class=\"anchor\" href=\"#ç”¨æˆ·\">#</a> ç”¨æˆ·</h3>\n<p><code>Linux</code>  æ˜¯ä¸€ä¸ªå¤šç”¨æˆ·çš„æ“ä½œç³»ç»Ÿã€‚åœ¨  <code>Linux</code>  ä¸­ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ— æ•°ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯è¿™äº›ç”¨æˆ·æ˜¯è¢«åˆ’åˆ†åˆ°ä¸åŒçš„ç¾¤ç»„é‡Œé¢çš„ï¼Œæœ‰ä¸€ä¸ªç”¨æˆ·ï¼Œåå«  <code>root</code>  ï¼Œæ˜¯ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ç”¨æˆ·ï¼Œå®ƒæ˜¯è¶…çº§ç”¨æˆ·ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™ã€‚</p>\n<p><img data-src=\"/assets/2022-8/7.png\" alt=\"image.png\" /></p>\n<p>è‡ªå·±åˆ›å»ºçš„ç”¨æˆ·æ˜¯æœ‰é™æƒé™çš„ç”¨æˆ·ï¼Œè¿™æ ·å¤§å¤§æé«˜äº†  <code>Linux</code>  ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œæœ‰æ•ˆé˜²æ­¢è¯¯æ“ä½œæˆ–æ˜¯ç—…æ¯’æ”»å‡»ï¼Œä½†æ˜¯æˆ‘ä»¬æ‰§è¡Œçš„æŸäº›å‘½ä»¤éœ€è¦æ›´é«˜æƒé™æ—¶å¯ä»¥ä½¿ç”¨  <code>sudo</code>  å‘½ä»¤ã€‚</p>\n<h4 id=\"sudo\"><a class=\"anchor\" href=\"#sudo\">#</a> sudo</h4>\n<p>ä»¥  <code>root</code>  èº«ä»½è¿è¡Œå‘½ä»¤</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">date</span>  --<span class=\"token operator\">></span> å½“ç„¶æŸ¥çœ‹æ—¥æœŸæ˜¯ä¸éœ€è¦sudoçš„è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œsudo å®Œä¹‹åä¸€èˆ¬è¿˜éœ€è¦è¾“å…¥ç”¨æˆ·å¯†ç çš„</pre></td></tr></table></figure><h4 id=\"useradd-passwd\"><a class=\"anchor\" href=\"#useradd-passwd\">#</a> useradd + passwd</h4>\n<ul>\n<li><code>useradd</code>  æ·»åŠ æ–°ç”¨æˆ·</li>\n<li><code>passwd</code>  ä¿®æ”¹ç”¨æˆ·å¯†ç </li>\n</ul>\n<p>è¿™ä¸¤ä¸ªå‘½ä»¤éœ€è¦  <code>root</code>  ç”¨æˆ·æƒé™</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">useradd</span> lion\t--<span class=\"token operator\">></span> æ·»åŠ ä¸€ä¸ªlionç”¨æˆ·ï¼Œæ·»åŠ å®Œä¹‹ååœ¨ /home è·¯å¾„ä¸‹å¯ä»¥æŸ¥çœ‹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">passwd</span> lion\t--<span class=\"token operator\">></span> ä¿®æ”¹lionç”¨æˆ·çš„å¯†ç </pre></td></tr></table></figure><h4 id=\"userdel\"><a class=\"anchor\" href=\"#userdel\">#</a> userdel</h4>\n<p>åˆ é™¤ç”¨æˆ·ï¼Œéœ€è¦  <code>root</code>  ç”¨æˆ·æƒé™</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">userdel</span> lion\t--<span class=\"token operator\">></span> åªä¼šåˆ é™¤ç”¨æˆ·åï¼Œä¸ä¼šä»/homeä¸­åˆ é™¤å¯¹åº”æ–‡ä»¶å¤¹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">userdel</span> lion -r\t--<span class=\"token operator\">></span> ä¼šåŒæ—¶åˆ é™¤/homeä¸‹çš„å¯¹åº”æ–‡ä»¶å¤¹</pre></td></tr></table></figure><h4 id=\"su\"><a class=\"anchor\" href=\"#su\">#</a> su</h4>\n<p>åˆ‡æ¢ç”¨æˆ·ï¼Œéœ€è¦  <code>root</code>  ç”¨æˆ·æƒé™</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">su</span>\t--<span class=\"token operator\">></span> åˆ‡æ¢ä¸ºrootç”¨æˆ·ï¼ˆexit å‘½ä»¤æˆ– CTRL + D å¿«æ·é”®éƒ½å¯ä»¥ä½¿æ™®é€šç”¨æˆ·åˆ‡æ¢ä¸º root ç”¨æˆ·ï¼‰</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">su</span> lion\t--<span class=\"token operator\">></span> åˆ‡æ¢ä¸ºæ™®é€šç”¨æˆ·</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">su</span> -\t--<span class=\"token operator\">></span> åˆ‡æ¢ä¸ºrootç”¨æˆ·</pre></td></tr></table></figure><h3 id=\"ç¾¤ç»„çš„ç®¡ç†\"><a class=\"anchor\" href=\"#ç¾¤ç»„çš„ç®¡ç†\">#</a> ç¾¤ç»„çš„ç®¡ç†</h3>\n<p><code>Linux</code>  ä¸­æ¯ä¸ªç”¨æˆ·éƒ½å±äºä¸€ä¸ªç‰¹å®šçš„ç¾¤ç»„ï¼Œå¦‚æœä½ ä¸è®¾ç½®ç”¨æˆ·çš„ç¾¤ç»„ï¼Œé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªå’Œå®ƒçš„ç”¨æˆ·åä¸€æ ·çš„ç¾¤ç»„ï¼Œå¹¶ä¸”æŠŠç”¨æˆ·åˆ’å½’åˆ°è¿™ä¸ªç¾¤ç»„ã€‚</p>\n<h4 id=\"groupadd\"><a class=\"anchor\" href=\"#groupadd\">#</a> groupadd</h4>\n<p>åˆ›å»ºç¾¤ç»„ï¼Œç”¨æ³•å’Œ  <code>useradd</code>  ç±»ä¼¼ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">groupadd</span> friends</pre></td></tr></table></figure><h4 id=\"groupdel\"><a class=\"anchor\" href=\"#groupdel\">#</a> groupdel</h4>\n<p>åˆ é™¤ä¸€ä¸ªå·²å­˜åœ¨çš„ç¾¤ç»„</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">groupdel</span> foo \t--<span class=\"token operator\">></span> åˆ é™¤fooç¾¤ç»„</pre></td></tr></table></figure><h4 id=\"groups\"><a class=\"anchor\" href=\"#groups\">#</a> groups</h4>\n<p>æŸ¥çœ‹ç”¨æˆ·æ‰€åœ¨ç¾¤ç»„</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">groups</span> lion \t--<span class=\"token operator\">></span> æŸ¥çœ‹ lion ç”¨æˆ·æ‰€åœ¨çš„ç¾¤ç»„</pre></td></tr></table></figure><h4 id=\"usermod\"><a class=\"anchor\" href=\"#usermod\">#</a> usermod</h4>\n<p>ç”¨äºä¿®æ”¹ç”¨æˆ·çš„è´¦æˆ·ã€‚</p>\n<p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-l</code>  å¯¹ç”¨æˆ·é‡å‘½åã€‚éœ€è¦æ³¨æ„çš„æ˜¯  <code>/home</code>  ä¸­çš„ç”¨æˆ·å®¶ç›®å½•çš„åå­—ä¸ä¼šæ”¹å˜ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</li>\n<li><code>-g</code>  ä¿®æ”¹ç”¨æˆ·æ‰€åœ¨çš„ç¾¤ç»„ï¼Œä¾‹å¦‚  <code>usermod -g friends lion </code>  ä¿®æ”¹  <code>lion</code>  ç”¨æˆ·çš„ç¾¤ç»„ä¸º  <code>friends</code>  ã€‚</li>\n<li><code>-G</code>  ä¸€æ¬¡æ€§è®©ç”¨æˆ·æ·»åŠ å¤šä¸ªç¾¤ç»„ï¼Œä¾‹å¦‚  <code>usermod -G friends,foo,bar lion</code>  ã€‚</li>\n<li><code>-a</code>   <code>-G</code>  ä¼šè®©ä½ ç¦»å¼€åŸå…ˆçš„ç¾¤ç»„ï¼Œå¦‚æœä½ ä¸æƒ³è¿™æ ·åšçš„è¯ï¼Œå°±å¾—å†æ·»åŠ   <code>-a</code>  å‚æ•°ï¼Œæ„å‘³ç€  <code>append</code>  è¿½åŠ çš„æ„æ€ã€‚</li>\n</ul>\n<h4 id=\"chgrp\"><a class=\"anchor\" href=\"#chgrp\">#</a> chgrp</h4>\n<p>ç”¨äºä¿®æ”¹æ–‡ä»¶çš„ç¾¤ç»„ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chgrp</span> bar file.txt\t--<span class=\"token operator\">></span> file.txtæ–‡ä»¶çš„ç¾¤ç»„ä¿®æ”¹ä¸ºbar</pre></td></tr></table></figure><h4 id=\"chown\"><a class=\"anchor\" href=\"#chown\">#</a> chown</h4>\n<p>æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œéœ€è¦  <code>root</code>  èº«ä»½æ‰èƒ½è¿è¡Œã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chown</span> lion file.txt\t--<span class=\"token operator\">></span> æŠŠå…¶å®ƒç”¨æˆ·åˆ›å»ºçš„file.txtè½¬è®©ç»™lionç”¨æˆ·</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">chown</span> lion:bar file.txt\t--<span class=\"token operator\">></span> æŠŠfile.txtçš„ç”¨æˆ·æ”¹ä¸ºlionï¼Œç¾¤ç»„æ”¹ä¸ºbar</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-R</code>  é€’å½’è®¾ç½®å­ç›®å½•å’Œå­æ–‡ä»¶ï¼Œ  <code>chown -R lion:lion /home/frank</code>  æŠŠ  <code>frank</code>  æ–‡ä»¶å¤¹çš„ç”¨æˆ·å’Œç¾¤ç»„éƒ½æ”¹ä¸º  <code>lion</code>  ã€‚</li>\n</ul>\n<h3 id=\"æ–‡ä»¶æƒé™ç®¡ç†\"><a class=\"anchor\" href=\"#æ–‡ä»¶æƒé™ç®¡ç†\">#</a> æ–‡ä»¶æƒé™ç®¡ç†</h3>\n<h4 id=\"chmod\"><a class=\"anchor\" href=\"#chmod\">#</a> chmod</h4>\n<p>ä¿®æ”¹è®¿é—®æƒé™ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">740</span> file.txt</pre></td></tr></table></figure><p>ã€å¸¸ç”¨å‚æ•°ã€‘</p>\n<ul>\n<li><code>-R</code>  å¯ä»¥é€’å½’åœ°ä¿®æ”¹æ–‡ä»¶è®¿é—®æƒé™ï¼Œä¾‹å¦‚  <code>chmod -R 777 /home/lion</code></li>\n</ul>\n<p>ä¿®æ”¹æƒé™çš„ç¡®ç®€å•ï¼Œä½†æ˜¯ç†è§£å…¶æ·±å±‚æ¬¡çš„æ„ä¹‰æ‰æ˜¯æ›´åŠ é‡è¦çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ç³»ç»Ÿçš„äº†è§£  <code>Linux</code>  çš„æ–‡ä»¶æƒé™ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -l</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>drwxr-xr-x <span class=\"token number\">5</span> root root <span class=\"token number\">4096</span> Apr <span class=\"token number\">13</span>  <span class=\"token number\">2020</span> climb</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root    <span class=\"token number\">7</span> Jan <span class=\"token number\">14</span> 06:41 hello2.c -<span class=\"token operator\">></span> hello.c</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>-rw-r--r-- <span class=\"token number\">1</span> root root  <span class=\"token number\">149</span> Jan <span class=\"token number\">13</span> 06:14 hello.c</pre></td></tr></table></figure><p>å…¶ä¸­  <code>drwxr-xr-x</code>  è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¥è§£è¯»å®ƒå…·ä½“ä»£è¡¨ä»€ä¹ˆï¼Ÿ</p>\n<ul>\n<li><code>d</code>  ï¼šè¡¨ç¤ºç›®å½•ï¼Œå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªç›®å½•ï¼Œæ™®é€šæ–‡ä»¶æ˜¯  <code>-</code>  ï¼Œé“¾æ¥æ˜¯  <code>l</code>  ã€‚</li>\n<li><code>r</code>  ï¼š  <code>read</code>  è¡¨ç¤ºæ–‡ä»¶å¯è¯»ã€‚</li>\n<li><code>w</code>  ï¼š  <code>write</code>  è¡¨ç¤ºæ–‡ä»¶å¯å†™ï¼Œä¸€èˆ¬æœ‰å†™çš„æƒé™ï¼Œå°±æœ‰åˆ é™¤çš„æƒé™ã€‚</li>\n<li><code>x</code>  ï¼š  <code>execute</code>  è¡¨ç¤ºæ–‡ä»¶å¯æ‰§è¡Œã€‚</li>\n<li><code>-</code>  ï¼šè¡¨ç¤ºæ²¡æœ‰ç›¸åº”æƒé™ã€‚</li>\n</ul>\n<p>æƒé™çš„æ•´ä½“æ˜¯æŒ‰ç”¨æˆ·æ¥åˆ’åˆ†çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img data-src=\"/assets/2022-8/8.png\" alt=\"image.png\" /></p>\n<p>ç°åœ¨å†æ¥ç†è§£è¿™å¥æƒé™  <code>drwxr-xr-x</code>  çš„æ„æ€ï¼š</p>\n<ul>\n<li>å®ƒæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼›</li>\n<li>å®ƒçš„æ‰€æœ‰è€…å…·æœ‰ï¼šè¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼›</li>\n<li>å®ƒçš„ç¾¤ç»„ç”¨æˆ·å…·æœ‰ï¼šè¯»ã€æ‰§è¡Œçš„æƒé™ï¼Œæ²¡æœ‰å†™çš„æƒé™ï¼›</li>\n<li>å®ƒçš„å…¶å®ƒç”¨æˆ·å…·æœ‰ï¼šè¯»ã€æ‰§è¡Œçš„æƒé™ï¼Œæ²¡æœ‰å†™çš„æƒé™ã€‚</li>\n</ul>\n<p>ç°åœ¨ç†è§£äº†æƒé™ï¼Œæˆ‘ä»¬ä½¿ç”¨  <code>chmod</code>  æ¥å°è¯•ä¿®æ”¹æƒé™ã€‚  <code>chmod</code>  å®ƒä¸éœ€è¦æ˜¯  <code>root</code>  ç”¨æˆ·æ‰èƒ½è¿è¡Œçš„ï¼Œåªè¦ä½ æ˜¯æ­¤æ–‡ä»¶æ‰€æœ‰è€…ï¼Œå°±å¯ä»¥ç”¨  <code>chmod</code>  æ¥ä¿®æ”¹æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚</p>\n<h5 id=\"æ•°å­—åˆ†é…æƒé™\"><a class=\"anchor\" href=\"#æ•°å­—åˆ†é…æƒé™\">#</a> æ•°å­—åˆ†é…æƒé™</h5>\n<table>\n<thead>\n<tr>\n<th>æƒé™</th>\n<th>æ•°å­—</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>r</td>\n<td>4</td>\n</tr>\n<tr>\n<td>w</td>\n<td>2</td>\n</tr>\n<tr>\n<td>x</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n<p>å› æ­¤è¦æ”¹å˜æƒé™ï¼Œåªè¦åšä¸€äº›ç®€å•çš„åŠ æ³•å°±è¡Œï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">640</span> hello.c </pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># åˆ†æ</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">6</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span> + <span class=\"token number\">2</span> + <span class=\"token number\">0</span> è¡¨ç¤ºæ‰€æœ‰è€…å…·æœ‰ rw æƒé™</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span> + <span class=\"token number\">0</span> + <span class=\"token number\">0</span> è¡¨ç¤ºç¾¤ç»„ç”¨æˆ·å…·æœ‰ r æƒé™</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span> + <span class=\"token number\">0</span> + <span class=\"token number\">0</span> è¡¨ç¤ºå…¶å®ƒç”¨æˆ·æ²¡æœ‰æƒé™</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>å¯¹åº”æ–‡å­—æƒé™ä¸ºï¼š-rw-r-----</pre></td></tr></table></figure><h5 id=\"ç”¨å­—æ¯æ¥åˆ†é…æƒé™\"><a class=\"anchor\" href=\"#ç”¨å­—æ¯æ¥åˆ†é…æƒé™\">#</a> ç”¨å­—æ¯æ¥åˆ†é…æƒé™</h5>\n<ul>\n<li><code>u</code>  ï¼š  <code>user</code>  çš„ç¼©å†™ï¼Œç”¨æˆ·çš„æ„æ€ï¼Œè¡¨ç¤ºæ‰€æœ‰è€…ã€‚</li>\n<li><code>g</code>  ï¼š  <code>group</code>  çš„ç¼©å†™ï¼Œç¾¤ç»„çš„æ„æ€ï¼Œè¡¨ç¤ºç¾¤ç»„ç”¨æˆ·ã€‚</li>\n<li><code>o</code>  ï¼š  <code>other</code>  çš„ç¼©å†™ï¼Œå…¶å®ƒçš„æ„æ€ï¼Œè¡¨ç¤ºå…¶å®ƒç”¨æˆ·ã€‚</li>\n<li><code>a</code>  ï¼š  <code>all</code>  çš„ç¼©å†™ï¼Œæ‰€æœ‰çš„æ„æ€ï¼Œè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·ã€‚</li>\n<li><code>+</code>  ï¼šåŠ å·ï¼Œè¡¨ç¤ºæ·»åŠ æƒé™ã€‚</li>\n<li><code>-</code>  ï¼šå‡å·ï¼Œè¡¨ç¤ºå»é™¤æƒé™ã€‚</li>\n<li><code>=</code>  ï¼šç­‰äºå·ï¼Œè¡¨ç¤ºåˆ†é…æƒé™ã€‚</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> u+rx <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„æ‰€æœ‰è€…å¢åŠ è¯»å’Œè¿è¡Œçš„æƒé™</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">chmod</span> g+r <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„ç¾¤ç»„ç”¨æˆ·å¢åŠ è¯»çš„æƒé™</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">chmod</span> o-r <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„å…¶å®ƒç”¨æˆ·ç§»é™¤è¯»çš„æƒé™</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">chmod</span> g+r o-r <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„ç¾¤ç»„ç”¨æˆ·å¢åŠ è¯»çš„æƒé™ï¼Œå…¶å®ƒç”¨æˆ·ç§»é™¤è¯»çš„æƒé™</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">chmod</span> go-r <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„ç¾¤ç»„å’Œå…¶ä»–ç”¨æˆ·ç§»é™¤è¯»çš„æƒé™</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">chmod</span> +x <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„æ‰€æœ‰ç”¨æˆ·å¢åŠ è¿è¡Œçš„æƒé™</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token assign-left variable\">u</span><span class=\"token operator\">=</span>rwx,g<span class=\"token operator\">=</span>r,o<span class=\"token operator\">=</span>- <span class=\"token function\">file</span>\t--<span class=\"token operator\">></span> æ–‡ä»¶fileçš„æ‰€æœ‰è€…åˆ†é…è¯»å†™å’Œæ‰§è¡Œçš„æƒé™ï¼Œç¾¤ç»„å…¶å®ƒç”¨æˆ·åˆ†é…è¯»çš„æƒé™ï¼Œå…¶ä»–ç”¨æˆ·æ²¡æœ‰ä»»ä½•æƒé™</pre></td></tr></table></figure><h2 id=\"æŸ¥æ‰¾æ–‡ä»¶\"><a class=\"anchor\" href=\"#æŸ¥æ‰¾æ–‡ä»¶\">#</a> æŸ¥æ‰¾æ–‡ä»¶</h2>\n<h3 id=\"locate\"><a class=\"anchor\" href=\"#locate\">#</a> locate</h3>\n<p>æœç´¢åŒ…å«å…³é”®å­—çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚åæ¥éœ€è¦æŸ¥æ‰¾çš„æ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>\n<h4 id=\"å®‰è£…-locate\"><a class=\"anchor\" href=\"#å®‰è£…-locate\">#</a> å®‰è£… locate</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum -y <span class=\"token function\">install</span> mlocate\t--<span class=\"token operator\">></span> å®‰è£…åŒ…</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>updatedb\t--<span class=\"token operator\">></span> æ›´æ–°æ•°æ®åº“</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">locate</span> file.txt</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">locate</span> fil*.txt</pre></td></tr></table></figure><blockquote>\n<p><code>locate</code>  å‘½ä»¤ä¼šå»æ–‡ä»¶æ•°æ®åº“ä¸­æŸ¥æ‰¾å‘½ä»¤ï¼Œè€Œä¸æ˜¯å…¨ç£ç›˜æŸ¥æ‰¾ï¼Œå› æ­¤åˆšåˆ›å»ºçš„æ–‡ä»¶å¹¶ä¸ä¼šæ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥æ— æ³•è¢«æŸ¥æ‰¾åˆ°ï¼Œå¯ä»¥æ‰§è¡Œ  <code>updatedb</code>  å‘½ä»¤å»æ›´æ–°æ•°æ®åº“ã€‚</p>\n</blockquote>\n<h3 id=\"find\"><a class=\"anchor\" href=\"#find\">#</a> find</h3>\n<p>ç”¨äºæŸ¥æ‰¾æ–‡ä»¶ï¼Œå®ƒä¼šå»éå†ä½ çš„å®é™…ç¡¬ç›˜è¿›è¡ŒæŸ¥æ‰¾ï¼Œè€Œä¸”å®ƒå…è®¸æˆ‘ä»¬å¯¹æ¯ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶è¿›è¡Œåç»­æ“ä½œï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token operator\">&lt;</span>ä½•å¤„<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>ä½•ç‰©<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>åšä»€ä¹ˆ<span class=\"token operator\">></span></pre></td></tr></table></figure><ul>\n<li>ä½•å¤„ï¼šæŒ‡å®šåœ¨å“ªä¸ªç›®å½•æŸ¥æ‰¾ï¼Œæ­¤ç›®å½•çš„æ‰€æœ‰å­ç›®å½•ä¹Ÿä¼šè¢«æŸ¥æ‰¾ã€‚</li>\n<li>ä½•ç‰©ï¼šæŸ¥æ‰¾ä»€ä¹ˆï¼Œå¯ä»¥æ ¹æ®æ–‡ä»¶çš„åå­—æ¥æŸ¥æ‰¾ï¼Œä¹Ÿå¯ä»¥æ ¹æ®å…¶å¤§å°æ¥æŸ¥æ‰¾ï¼Œè¿˜å¯ä»¥æ ¹æ®å…¶æœ€è¿‘è®¿é—®æ—¶é—´æ¥æŸ¥æ‰¾ã€‚</li>\n<li>åšä»€ä¹ˆï¼šæ‰¾åˆ°æ–‡ä»¶åï¼Œå¯ä»¥è¿›è¡Œåç»­å¤„ç†ï¼Œå¦‚æœä¸æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œ  <code>find</code>  å‘½ä»¤åªä¼šæ˜¾ç¤ºæ‰¾åˆ°çš„æ–‡ä»¶ã€‚</li>\n</ul>\n<h4 id=\"æ ¹æ®æ–‡ä»¶åæŸ¥æ‰¾\"><a class=\"anchor\" href=\"#æ ¹æ®æ–‡ä»¶åæŸ¥æ‰¾\">#</a> æ ¹æ®æ–‡ä»¶åæŸ¥æ‰¾</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"file.txt\"</span>\t--<span class=\"token operator\">></span> å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•ä¸‹é€šè¿‡åç§°æŸ¥æ‰¾æ–‡ä»¶</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> -name <span class=\"token string\">\"syslog\"</span>\t--<span class=\"token operator\">></span> å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•ä¸‹é€šè¿‡åç§°æŸ¥æ‰¾æ–‡ä»¶</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">find</span> / -name <span class=\"token string\">\"syslog\"</span>\t--<span class=\"token operator\">></span> æ•´ä¸ªç¡¬ç›˜ä¸‹æŸ¥æ‰¾syslog</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">find</span> /var/log -name <span class=\"token string\">\"syslog\"</span>\t--<span class=\"token operator\">></span> åœ¨æŒ‡å®šçš„ç›®å½•/var/logä¸‹æŸ¥æ‰¾syslogæ–‡ä»¶</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">find</span> /var/log -name <span class=\"token string\">\"syslog*\"</span>\t--<span class=\"token operator\">></span> æŸ¥æ‰¾syslog1ã€syslog2 <span class=\"token punctuation\">..</span>. ç­‰æ–‡ä»¶ï¼Œé€šé…ç¬¦è¡¨ç¤ºæ‰€æœ‰</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">find</span> /var/log -name <span class=\"token string\">\"*syslog*\"</span>\t--<span class=\"token operator\">></span> æŸ¥æ‰¾åŒ…å«syslogçš„æ–‡ä»¶</pre></td></tr></table></figure><blockquote>\n<p><code>find</code>  å‘½ä»¤åªä¼šæŸ¥æ‰¾å®Œå…¨ç¬¦åˆ â€œä½•ç‰©â€ å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œè€Œ  <code>locate</code>  ä¼šæŸ¥æ‰¾æ‰€æœ‰åŒ…å«å…³é”®å­—çš„æ–‡ä»¶ã€‚</p>\n</blockquote>\n<h4 id=\"æ ¹æ®æ–‡ä»¶å¤§å°æŸ¥æ‰¾\"><a class=\"anchor\" href=\"#æ ¹æ®æ–‡ä»¶å¤§å°æŸ¥æ‰¾\">#</a> æ ¹æ®æ–‡ä»¶å¤§å°æŸ¥æ‰¾</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> /var -size +10M\t--<span class=\"token operator\">></span> /var ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶å¤§å°è¶…è¿‡ 10M çš„æ–‡ä»¶</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> /var -size -50k\t--<span class=\"token operator\">></span> /var ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶å¤§å°å°äº 50k çš„æ–‡ä»¶</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">find</span> /var -size +1G\t--<span class=\"token operator\">></span> /var ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶å¤§å°æŸ¥è¿‡ 1G çš„æ–‡ä»¶</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">find</span> /var -size 1M\t--<span class=\"token operator\">></span> /var ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶å¤§å°ç­‰äº 1M çš„æ–‡ä»¶</pre></td></tr></table></figure><h4 id=\"æ ¹æ®æ–‡ä»¶æœ€è¿‘è®¿é—®æ—¶é—´æŸ¥æ‰¾\"><a class=\"anchor\" href=\"#æ ¹æ®æ–‡ä»¶æœ€è¿‘è®¿é—®æ—¶é—´æŸ¥æ‰¾\">#</a> æ ¹æ®æ–‡ä»¶æœ€è¿‘è®¿é—®æ—¶é—´æŸ¥æ‰¾</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"*.txt\"</span> -atime -7 \t--<span class=\"token operator\">></span> è¿‘ <span class=\"token number\">7</span>å¤©å†…è®¿é—®è¿‡çš„.txtç»“å°¾çš„æ–‡ä»¶</pre></td></tr></table></figure><h4 id=\"ä»…æŸ¥æ‰¾ç›®å½•æˆ–æ–‡ä»¶\"><a class=\"anchor\" href=\"#ä»…æŸ¥æ‰¾ç›®å½•æˆ–æ–‡ä»¶\">#</a> ä»…æŸ¥æ‰¾ç›®å½•æˆ–æ–‡ä»¶</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> -name <span class=\"token string\">\"file\"</span> -type f \t--<span class=\"token operator\">></span> åªæŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„fileæ–‡ä»¶</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> -name <span class=\"token string\">\"file\"</span> -type d \t--<span class=\"token operator\">></span> åªæŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„fileç›®å½•</pre></td></tr></table></figure><h4 id=\"æ“ä½œæŸ¥æ‰¾ç»“æœ\"><a class=\"anchor\" href=\"#æ“ä½œæŸ¥æ‰¾ç»“æœ\">#</a> æ“ä½œæŸ¥æ‰¾ç»“æœ</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"*.txt\"</span> -printf <span class=\"token string\">\"%p - %u<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span>\t--<span class=\"token operator\">></span> æ‰¾å‡ºæ‰€æœ‰åç¼€ä¸ºtxtçš„æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§ %p - %u<span class=\"token punctuation\">\\</span>n æ ¼å¼æ‰“å°ï¼Œå…¶ä¸­%p<span class=\"token operator\">=</span>æ–‡ä»¶åï¼Œ%u<span class=\"token operator\">=</span>æ–‡ä»¶æ‰€æœ‰è€…</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"*.jpg\"</span> -delete\t--<span class=\"token operator\">></span> åˆ é™¤å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•ä¸‹æ‰€æœ‰.jpgä¸ºåç¼€çš„æ–‡ä»¶ï¼Œä¸ä¼šæœ‰åˆ é™¤æç¤ºï¼Œå› æ­¤è¦æ…ç”¨</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"*.c\"</span> -exec <span class=\"token function\">chmod</span> <span class=\"token number\">600</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span>\t--<span class=\"token operator\">></span> å¯¹æ¯ä¸ª.cç»“å°¾çš„æ–‡ä»¶ï¼Œéƒ½è¿›è¡Œ -exec å‚æ•°æŒ‡å®šçš„æ“ä½œï¼Œ<span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span> ä¼šè¢«æŸ¥æ‰¾åˆ°çš„æ–‡ä»¶æ›¿ä»£ï¼Œ<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span> æ˜¯å¿…é¡»çš„ç»“å°¾</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">find</span> -name <span class=\"token string\">\"*.c\"</span> -ok <span class=\"token function\">chmod</span> <span class=\"token number\">600</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span>\t--<span class=\"token operator\">></span> å’Œä¸Šé¢çš„åŠŸèƒ½ä¸€ç›´ï¼Œä¼šå¤šä¸€ä¸ªç¡®è®¤æç¤º</pre></td></tr></table></figure><h2 id=\"è½¯ä»¶ä»“åº“\"><a class=\"anchor\" href=\"#è½¯ä»¶ä»“åº“\">#</a> è½¯ä»¶ä»“åº“</h2>\n<p><code>Linux</code>  ä¸‹è½¯ä»¶æ˜¯ä»¥åŒ…çš„å½¢å¼å­˜åœ¨ï¼Œä¸€ä¸ªè½¯ä»¶åŒ…å…¶å®å°±æ˜¯è½¯ä»¶çš„æ‰€æœ‰æ–‡ä»¶çš„å‹ç¼©åŒ…ï¼Œæ˜¯äºŒè¿›åˆ¶çš„å½¢å¼ï¼ŒåŒ…å«äº†å®‰è£…è½¯ä»¶çš„æ‰€æœ‰æŒ‡ä»¤ã€‚  <code>Red Hat</code>  å®¶æ—çš„è½¯ä»¶åŒ…åç¼€åä¸€èˆ¬ä¸º  <code>.rpm</code>  ï¼Œ  <code>Debian</code>  å®¶æ—çš„è½¯ä»¶åŒ…åç¼€æ˜¯  <code>.deb</code>  ã€‚</p>\n<p><code>Linux</code>  çš„åŒ…éƒ½å­˜åœ¨ä¸€ä¸ªä»“åº“ï¼Œå«åšè½¯ä»¶ä»“åº“ï¼Œå®ƒå¯ä»¥ä½¿ç”¨  <code>yum</code>  æ¥ç®¡ç†è½¯ä»¶åŒ…ï¼Œ  <code>yum</code>  æ˜¯  <code>CentOS</code>  ä¸­é»˜è®¤çš„åŒ…ç®¡ç†å·¥å…·ï¼Œé€‚ç”¨äº  <code>Red Hat</code>  ä¸€æ—ã€‚å¯ä»¥ç†è§£æˆ  <code>Node.js</code>  çš„  <code>npm</code>  ã€‚</p>\n<h3 id=\"yum-å¸¸ç”¨å‘½ä»¤\"><a class=\"anchor\" href=\"#yum-å¸¸ç”¨å‘½ä»¤\">#</a> yum å¸¸ç”¨å‘½ä»¤</h3>\n<ul>\n<li><code>yum update | yum upgrade</code>  æ›´æ–°è½¯ä»¶åŒ…</li>\n<li><code>yum search xxx</code>  æœç´¢ç›¸åº”çš„è½¯ä»¶åŒ…</li>\n<li><code>yum install xxx</code>  å®‰è£…è½¯ä»¶åŒ…</li>\n<li><code>yum remove xxx</code>  åˆ é™¤è½¯ä»¶åŒ…</li>\n</ul>\n<h3 id=\"åˆ‡æ¢-centos-è½¯ä»¶æº\"><a class=\"anchor\" href=\"#åˆ‡æ¢-centos-è½¯ä»¶æº\">#</a> åˆ‡æ¢ CentOS è½¯ä»¶æº</h3>\n<p>æœ‰æ—¶å€™  <code>CentOS</code>  é»˜è®¤çš„  <code>yum</code>  æºä¸ä¸€å®šæ˜¯å›½å†…é•œåƒï¼Œå¯¼è‡´  <code>yum</code>  åœ¨çº¿å®‰è£…åŠæ›´æ–°é€Ÿåº¦ä¸æ˜¯å¾ˆç†æƒ³ã€‚è¿™æ—¶å€™éœ€è¦å°†  <code>yum</code>  æºè®¾ç½®ä¸ºå›½å†…é•œåƒç«™ç‚¹ã€‚å›½å†…ä¸»è¦å¼€æºçš„é•œåƒç«™ç‚¹æ˜¯ç½‘æ˜“å’Œé˜¿é‡Œäº‘ã€‚</p>\n<ol>\n<li>é¦–å…ˆå¤‡ä»½ç³»ç»Ÿè‡ªå¸¦  <code>yum</code>  æºé…ç½®æ–‡ä»¶  <code>mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</code></li>\n<li>ä¸‹è½½é˜¿é‡Œäº‘çš„  <code>yum</code>  æºé…ç½®æ–‡ä»¶åˆ°  <code>/etc/yum.repos.d/CentOS7</code></li>\n</ol>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</pre></td></tr></table></figure><ol start=\"3\">\n<li>ç”Ÿæˆç¼“å­˜</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum makecache</pre></td></tr></table></figure><h1 id=\"linux-è¿›é˜¶\"><a class=\"anchor\" href=\"#linux-è¿›é˜¶\">#</a> Linux è¿›é˜¶</h1>\n<h2 id=\"æ–‡æœ¬æ“ä½œ\"><a class=\"anchor\" href=\"#æ–‡æœ¬æ“ä½œ\">#</a> æ–‡æœ¬æ“ä½œ</h2>\n<h3 id=\"grep\"><a class=\"anchor\" href=\"#grep\">#</a> grep</h3>\n<p>å…¨å±€æœç´¢ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”æ‰“å°åˆ°å±å¹•ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œåœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾å…³é”®å­—ï¼Œå¹¶æ˜¾ç¤ºå…³é”®å­—æ‰€åœ¨è¡Œã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> text <span class=\"token function\">file</span> <span class=\"token comment\"># text ä»£è¡¨è¦æœç´¢çš„æ–‡æœ¬ï¼Œfile ä»£è¡¨ä¾›æœç´¢çš„æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># å®ä¾‹</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># grep path /etc/profile</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function-name function\">pathmunge</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    pathmunge /usr/sbin</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    pathmunge /usr/local/sbin</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    pathmunge /usr/local/sbin after</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    pathmunge /usr/sbin after</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token builtin class-name\">unset</span> -f pathmunge</pre></td></tr></table></figure><h4 id=\"å¸¸ç”¨å‚æ•°\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-i</code>  å¿½ç•¥å¤§å°å†™ï¼Œ  <code>grep -i path /etc/profile</code></li>\n<li><code>-n</code>  æ˜¾ç¤ºè¡Œå·ï¼Œ <code>grep -n path /etc/profile</code></li>\n<li><code>-v</code>  åªæ˜¾ç¤ºæœç´¢æ–‡æœ¬ä¸åœ¨çš„é‚£äº›è¡Œï¼Œ <code>grep -v path /etc/profile</code></li>\n<li><code>-r</code>  é€’å½’æŸ¥æ‰¾ï¼Œ  <code>grep -r hello /etc</code>  ï¼ŒLinux ä¸­è¿˜æœ‰ä¸€ä¸ª rgrep å‘½ä»¤ï¼Œä½œç”¨ç›¸å½“äº  <code>grep -r</code></li>\n</ul>\n<h4 id=\"é«˜çº§ç”¨æ³•\"><a class=\"anchor\" href=\"#é«˜çº§ç”¨æ³•\">#</a> é«˜çº§ç”¨æ³•</h4>\n<p><code>grep</code>  å¯ä»¥é…åˆæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">grep</span> -E path /etc/profile --<span class=\"token operator\">></span> å®Œå…¨åŒ¹é…path</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">grep</span> -E ^path /etc/profile --<span class=\"token operator\">></span> åŒ¹é…pathå¼€å¤´çš„å­—ç¬¦ä¸²</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">grep</span> -E <span class=\"token punctuation\">[</span>Pp<span class=\"token punctuation\">]</span>ath /etc/profile --<span class=\"token operator\">></span> åŒ¹é…pathæˆ–Path</pre></td></tr></table></figure><h3 id=\"sort\"><a class=\"anchor\" href=\"#sort\">#</a> sort</h3>\n<p>å¯¹æ–‡ä»¶çš„è¡Œè¿›è¡Œæ’åºã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•-2\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•-2\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sort</span> name.txt <span class=\"token comment\"># å¯¹ name.txt æ–‡ä»¶è¿›è¡Œæ’åº</span></pre></td></tr></table></figure><h4 id=\"å®ä¾‹ç”¨æ³•\"><a class=\"anchor\" href=\"#å®ä¾‹ç”¨æ³•\">#</a> å®ä¾‹ç”¨æ³•</h4>\n<p>ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶  <code>name.txt</code>  ï¼Œæ”¾å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight tex\"><figcaption data-lang=\"TeX\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Christopher</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Shawn</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Ted</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Rock</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Noah</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Zachary</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Bella</pre></td></tr></table></figure><p>æ‰§è¡Œ  <code>sort name.txt</code>  å‘½ä»¤ï¼Œä¼šå¯¹æ–‡æœ¬å†…å®¹è¿›è¡Œæ’åºã€‚</p>\n<h4 id=\"å¸¸ç”¨å‚æ•°-2\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-2\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-o</code>  å°†æ’åºåçš„æ–‡ä»¶å†™å…¥æ–°æ–‡ä»¶ï¼Œ  <code>sort -o name_sorted.txt name.txt</code>  ï¼›</li>\n<li><code>-r</code>  å€’åºæ’åºï¼Œ  <code>sort -r name.txt</code>  ï¼›</li>\n<li><code>-R</code>  éšæœºæ’åºï¼Œ  <code>sort -R name.txt</code>  ï¼›</li>\n<li><code>-n</code>  å¯¹æ•°å­—è¿›è¡Œæ’åºï¼Œé»˜è®¤æ˜¯æŠŠæ•°å­—è¯†åˆ«æˆå­—ç¬¦ä¸²çš„ï¼Œå› æ­¤ 138 ä¼šæ’åœ¨ 25 å‰é¢ï¼Œå¦‚æœæ·»åŠ äº†  <code>-n</code>  æ•°å­—æ’åºçš„è¯ï¼Œåˆ™ 25 ä¼šåœ¨ 138 å‰é¢ã€‚</li>\n</ul>\n<h3 id=\"wc\"><a class=\"anchor\" href=\"#wc\">#</a> wc</h3>\n<p><code>word count</code>  çš„ç¼©å†™ï¼Œç”¨äºæ–‡ä»¶çš„ç»Ÿè®¡ã€‚å®ƒå¯ä»¥ç»Ÿè®¡å•è¯æ•°ç›®ã€è¡Œæ•°ã€å­—ç¬¦æ•°ï¼Œå­—èŠ‚æ•°ç­‰ã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•-3\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•-3\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wc</span> name.txt <span class=\"token comment\"># ç»Ÿè®¡ name.txt</span></pre></td></tr></table></figure><h4 id=\"å®ä¾‹ç”¨æ³•-2\"><a class=\"anchor\" href=\"#å®ä¾‹ç”¨æ³•-2\">#</a> å®ä¾‹ç”¨æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># wc name.txt </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">13</span> <span class=\"token number\">13</span> <span class=\"token number\">91</span> name.txt</pre></td></tr></table></figure><ul>\n<li>ç¬¬ä¸€ä¸ª 13ï¼Œè¡¨ç¤ºè¡Œæ•°ï¼›</li>\n<li>ç¬¬äºŒä¸ª 13ï¼Œè¡¨ç¤ºå•è¯æ•°ï¼›</li>\n<li>ç¬¬ä¸‰ä¸ª 91ï¼Œè¡¨ç¤ºå­—èŠ‚æ•°ã€‚</li>\n</ul>\n<h4 id=\"å¸¸ç”¨å‚æ•°-3\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-3\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-l</code>  åªç»Ÿè®¡è¡Œæ•°ï¼Œ  <code>wc -l name.txt</code>  ï¼›</li>\n<li><code>-w</code>  åªç»Ÿè®¡å•è¯æ•°ï¼Œ  <code>wc -w name.txt</code>  ï¼›</li>\n<li><code>-c</code>  åªç»Ÿè®¡å­—èŠ‚æ•°ï¼Œ  <code>wc -c name.txt</code>  ï¼›</li>\n<li><code>-m</code>  åªç»Ÿè®¡å­—ç¬¦æ•°ï¼Œ  <code>wc -m name.txt</code>  ã€‚</li>\n</ul>\n<h3 id=\"uniq\"><a class=\"anchor\" href=\"#uniq\">#</a> uniq</h3>\n<p>åˆ é™¤æ–‡ä»¶ä¸­çš„é‡å¤å†…å®¹ã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•-4\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•-4\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uniq</span> name.txt <span class=\"token comment\"># å»é™¤ name.txt é‡å¤çš„è¡Œæ•°ï¼Œå¹¶æ‰“å°åˆ°å±å¹•ä¸Š</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">uniq</span> name.txt uniq_name.txt <span class=\"token comment\"># æŠŠå»é™¤é‡å¤åçš„æ–‡ä»¶ä¿å­˜ä¸º uniq_name.txt</span></pre></td></tr></table></figure><blockquote>\n<p>å®ƒåªèƒ½å»é™¤è¿ç»­é‡å¤çš„è¡Œæ•°ã€‚</p>\n</blockquote>\n<h4 id=\"å¸¸ç”¨å‚æ•°-4\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-4\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-c</code>  ç»Ÿè®¡é‡å¤è¡Œæ•°ï¼Œ  <code>uniq -c name.txt</code>  ï¼›</li>\n<li><code>-d</code>  åªæ˜¾ç¤ºé‡å¤çš„è¡Œæ•°ï¼Œ  <code>uniq -d name.txt</code>  ã€‚</li>\n</ul>\n<h3 id=\"cut\"><a class=\"anchor\" href=\"#cut\">#</a> cut</h3>\n<p>å‰ªåˆ‡æ–‡ä»¶çš„ä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•-5\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•-5\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cut</span> -c <span class=\"token number\">2</span>-4 name.txt <span class=\"token comment\"># å‰ªåˆ‡æ¯ä¸€è¡Œç¬¬äºŒåˆ°ç¬¬å››ä¸ªå­—ç¬¦</span></pre></td></tr></table></figure><h4 id=\"å¸¸ç”¨å‚æ•°-5\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-5\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-d</code>  ç”¨äºæŒ‡å®šç”¨ä»€ä¹ˆåˆ†éš”ç¬¦ï¼ˆæ¯”å¦‚é€—å·ã€åˆ†å·ã€åŒå¼•å·ç­‰ç­‰ï¼‰  <code>cut -d , name.txt</code>  ï¼›</li>\n<li><code>-f</code>  è¡¨ç¤ºå‰ªåˆ‡ä¸‹ç”¨åˆ†éš”ç¬¦åˆ†å‰²çš„å“ªä¸€å—æˆ–å“ªå‡ å—åŒºåŸŸï¼Œ  <code>cut -d , -f 1 name.txt</code>  ã€‚</li>\n</ul>\n<h2 id=\"é‡å®šå‘-ç®¡é“-æµ\"><a class=\"anchor\" href=\"#é‡å®šå‘-ç®¡é“-æµ\">#</a> é‡å®šå‘ ç®¡é“ æµ</h2>\n<p>åœ¨  <code>Linux</code>  ä¸­ä¸€ä¸ªå‘½ä»¤çš„å»å‘å¯ä»¥æœ‰ 3 ä¸ªåœ°æ–¹ï¼šç»ˆç«¯ã€æ–‡ä»¶ã€ä½œä¸ºå¦å¤–ä¸€ä¸ªå‘½ä»¤çš„å…¥å‚ã€‚</p>\n<p><img data-src=\"/assets/2022-8/9.png\" alt=\"image.png\" /></p>\n<p>å‘½ä»¤ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡é”®ç›˜è¾“å…¥ï¼Œç„¶åè¾“å‡ºåˆ°ç»ˆç«¯ã€æ–‡ä»¶ç­‰åœ°æ–¹ï¼Œå®ƒçš„æ ‡å‡†ç”¨è¯­æ˜¯  <code>stdin</code>  ã€  <code>stdout</code>  ä»¥åŠ  <code>stderr</code>  ã€‚</p>\n<ul>\n<li>æ ‡å‡†è¾“å…¥  <code>stdin</code>  ï¼Œç»ˆç«¯æ¥æ”¶é”®ç›˜è¾“å…¥çš„å‘½ä»¤ï¼Œä¼šäº§ç”Ÿä¸¤ç§è¾“å‡ºï¼›</li>\n<li>æ ‡å‡†è¾“å‡º  <code>stdout</code>  ï¼Œç»ˆç«¯è¾“å‡ºçš„ä¿¡æ¯ï¼ˆä¸åŒ…å«é”™è¯¯ä¿¡æ¯ï¼‰ï¼›</li>\n<li>æ ‡å‡†é”™è¯¯è¾“å‡º  <code>stderr</code>  ï¼Œç»ˆç«¯è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯ã€‚</li>\n</ul>\n<p><img data-src=\"/assets/2022-8/10.png\" alt=\"image.png\" /></p>\n<h3 id=\"é‡å®šå‘\"><a class=\"anchor\" href=\"#é‡å®šå‘\">#</a> é‡å®šå‘</h3>\n<p>æŠŠæœ¬æ¥è¦æ˜¾ç¤ºåœ¨ç»ˆç«¯çš„å‘½ä»¤ç»“æœï¼Œè¾“é€åˆ°åˆ«çš„åœ°æ–¹ï¼ˆåˆ°æ–‡ä»¶ä¸­æˆ–è€…ä½œä¸ºå…¶ä»–å‘½ä»¤çš„è¾“å…¥ï¼‰ã€‚</p>\n<h4 id=\"è¾“å‡ºé‡å®šå‘\"><a class=\"anchor\" href=\"#è¾“å‡ºé‡å®šå‘\">#</a> è¾“å‡ºé‡å®šå‘  <code>&gt;</code></h4>\n<p><code>&gt;</code>  è¡¨ç¤ºé‡å®šå‘åˆ°æ–°çš„æ–‡ä»¶ï¼Œ  <code>cut -d , -f 1 notes.csv &gt; name.csv</code>  ï¼Œå®ƒè¡¨ç¤ºé€šè¿‡é€—å·å‰ªåˆ‡  <code>notes.csv</code>  æ–‡ä»¶ï¼ˆå‰ªåˆ‡å®Œæœ‰ 3 ä¸ªéƒ¨åˆ†ï¼‰è·å–ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼Œé‡å®šå‘åˆ°  <code>name.csv</code>  æ–‡ä»¶ã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œç†è§£å®ƒçš„ä½¿ç”¨ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶  <code>notes.csv</code>  ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Mark1,951/100,å¾ˆä¸é”™1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Mark2,952/100,å¾ˆä¸é”™2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Mark3,953/100,å¾ˆä¸é”™3</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Mark4,954/100,å¾ˆä¸é”™4</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Mark5,955/100,å¾ˆä¸é”™5</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Mark6,956/100,å¾ˆä¸é”™6</pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤ï¼š  <code>cut -d , -f 1 notes.csv &gt; name.csv</code>  æœ€åè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight tex\"><figcaption data-lang=\"TeX\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Mark1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Mark2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Mark3</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Mark4</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Mark5</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Mark6</pre></td></tr></table></figure><blockquote>\n<p>ä½¿ç”¨  <code>&gt;</code>  è¦æ³¨æ„ï¼Œå¦‚æœè¾“å‡ºçš„æ–‡ä»¶ä¸å­˜åœ¨å®ƒä¼šæ–°å»ºä¸€ä¸ªï¼Œå¦‚æœè¾“å‡ºçš„æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šè¦†ç›–ã€‚å› æ­¤æ‰§è¡Œè¿™ä¸ªæ“ä½œè¦éå¸¸å°å¿ƒï¼Œä»¥å…è¦†ç›–å…¶å®ƒé‡è¦æ–‡ä»¶ã€‚</p>\n</blockquote>\n<h4 id=\"è¾“å‡ºé‡å®šå‘-2\"><a class=\"anchor\" href=\"#è¾“å‡ºé‡å®šå‘-2\">#</a> è¾“å‡ºé‡å®šå‘  <code>&gt;&gt;</code></h4>\n<p>è¡¨ç¤ºé‡å®šå‘åˆ°æ–‡ä»¶æœ«å°¾ï¼Œå› æ­¤å®ƒä¸ä¼šåƒ  <code>&gt;</code>  å‘½ä»¤è¿™ä¹ˆå±é™©ï¼Œå®ƒæ˜¯è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ï¼ˆå½“ç„¶å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šè¢«åˆ›å»ºï¼‰ã€‚</p>\n<p>å†æ¬¡æ‰§è¡Œ  <code>cut -d , -f 1 notes.csv &gt;&gt; name.csv</code>  ï¼Œåˆ™ä¼šæŠŠåå­—è¿½åŠ åˆ°  <code>name.csv</code>  é‡Œé¢ã€‚</p>\n<pre><code>Mark1\nMark2\nMark3\nMark4\nMark5\nMark6\nMark1\nMark2\nMark3\nMark4\nMark5\nMark6\n</code></pre>\n<p>æˆ‘ä»¬å¹³æ—¶è¯»çš„  <code>log</code>  æ—¥å¿—æ–‡ä»¶å…¶å®éƒ½æ˜¯ç”¨è¿™ä¸ªå‘½ä»¤è¾“å‡ºçš„ã€‚</p>\n<h4 id=\"è¾“å‡ºé‡å®šå‘-2\"><a class=\"anchor\" href=\"#è¾“å‡ºé‡å®šå‘-2\">#</a> è¾“å‡ºé‡å®šå‘  <code>2&gt;</code></h4>\n<p>æ ‡å‡†é”™è¯¯è¾“å‡º</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> not_exist_file.csv <span class=\"token operator\">></span> res.txt <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span> errors.log</pre></td></tr></table></figure><ul>\n<li>å½“æˆ‘ä»¬  <code>cat</code>  ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šæŠŠæ–‡ä»¶å†…å®¹æ‰“å°åˆ°å±å¹•ä¸Šï¼Œè¿™ä¸ªæ˜¯æ ‡å‡†è¾“å‡ºï¼›</li>\n<li>å½“ä½¿ç”¨äº†  <code>&gt; res.txt</code>  æ—¶ï¼Œåˆ™ä¸ä¼šæ‰“å°åˆ°å±å¹•ï¼Œä¼šæŠŠæ ‡å‡†è¾“å‡ºå†™å…¥æ–‡ä»¶  <code>res.txt</code>  æ–‡ä»¶ä¸­ï¼›</li>\n<li><code>2&gt; errors.log</code>  å½“å‘ç”Ÿé”™è¯¯æ—¶ä¼šå†™å…¥  <code>errors.log</code>  æ–‡ä»¶ä¸­ã€‚</li>\n</ul>\n<h4 id=\"è¾“å‡ºé‡å®šå‘-2-2\"><a class=\"anchor\" href=\"#è¾“å‡ºé‡å®šå‘-2-2\">#</a> è¾“å‡ºé‡å®šå‘  <code>2&gt;&gt;</code></h4>\n<p>æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ï¼‰åŒ  <code>&gt;&gt;</code>  ç›¸ä¼¼ã€‚</p>\n<h4 id=\"è¾“å‡ºé‡å®šå‘-21\"><a class=\"anchor\" href=\"#è¾“å‡ºé‡å®šå‘-21\">#</a> è¾“å‡ºé‡å®šå‘  <code>2&gt;&amp;1</code></h4>\n<p>æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘éƒ½ä¸€ä¸ªåœ°æ–¹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> not_exist_file.csv <span class=\"token operator\">></span> res.txt <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>  <span class=\"token comment\"># è¦†ç›–è¾“å‡º</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cat</span> not_exist_file.csv <span class=\"token operator\">>></span> res.txt <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span> <span class=\"token comment\"># è¿½åŠ è¾“å‡º</span></pre></td></tr></table></figure><p>ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¥è§¦çš„å‘½ä»¤çš„è¾“å…¥éƒ½æ¥è‡ªå‘½ä»¤çš„å‚æ•°ï¼Œå…¶å®å‘½ä»¤çš„è¾“å…¥è¿˜å¯ä»¥æ¥è‡ªæ–‡ä»¶æˆ–è€…é”®ç›˜çš„è¾“å…¥ã€‚</p>\n<p><img data-src=\"/assets/2022-8/11.png\" alt=\"image.png\" /></p>\n<h4 id=\"è¾“å…¥é‡å®šå‘\"><a class=\"anchor\" href=\"#è¾“å…¥é‡å®šå‘\">#</a> è¾“å…¥é‡å®šå‘  <code>&lt;</code></h4>\n<p><code>&lt;</code>  ç¬¦å·ç”¨äºæŒ‡å®šå‘½ä»¤çš„è¾“å…¥ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token operator\">&lt;</span> name.csv <span class=\"token comment\"># æŒ‡å®šå‘½ä»¤çš„è¾“å…¥ä¸º name.csv</span></pre></td></tr></table></figure><p>è™½ç„¶å®ƒçš„è¿è¡Œç»“æœä¸  <code>cat name.csv</code>  ä¸€æ ·ï¼Œä½†æ˜¯å®ƒä»¬çš„åŸç†å´å®Œå…¨ä¸åŒã€‚</p>\n<ul>\n<li><code>cat name.csv</code>  è¡¨ç¤º  <code>cat</code>  å‘½ä»¤æ¥æ”¶çš„è¾“å…¥æ˜¯  <code>notes.csv</code>  æ–‡ä»¶åï¼Œé‚£ä¹ˆè¦å…ˆæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åæ‰“å°å‡ºæ–‡ä»¶å†…å®¹ã€‚</li>\n<li><code>cat &lt; name.csv</code>  è¡¨ç¤º  <code>cat</code>  å‘½ä»¤æ¥æ”¶çš„è¾“å…¥ç›´æ¥æ˜¯  <code>notes.csv</code>  è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œ  <code>cat</code>  å‘½ä»¤åªè´Ÿè´£å°†å…¶å†…å®¹æ‰“å°ï¼Œæ‰“å¼€æ–‡ä»¶å¹¶å°†æ–‡ä»¶å†…å®¹ä¼ é€’ç»™  <code>cat</code>  å‘½ä»¤çš„å·¥ä½œåˆ™äº¤ç»™ç»ˆç«¯å®Œæˆã€‚</li>\n</ul>\n<h4 id=\"è¾“å…¥é‡å®šå‘-2\"><a class=\"anchor\" href=\"#è¾“å…¥é‡å®šå‘-2\">#</a> è¾“å…¥é‡å®šå‘  <code>&lt;&lt;</code></h4>\n<p>å°†é”®ç›˜çš„è¾“å…¥é‡å®šå‘ä¸ºæŸä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sort</span> -n <span class=\"token operator\">&lt;&lt;</span> END <span class=\"token comment\"># è¾“å…¥è¿™ä¸ªå‘½ä»¤ä¹‹åï¼ŒæŒ‰ä¸‹å›è½¦ï¼Œç»ˆç«¯å°±è¿›å…¥é”®ç›˜è¾“å…¥æ¨¡å¼ï¼Œå…¶ä¸­ END ä¸ºç»“æŸå‘½ä»¤ï¼ˆè¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰ï¼‰</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wc</span> -m <span class=\"token operator\">&lt;&lt;</span> END <span class=\"token comment\"># ç»Ÿè®¡è¾“å…¥çš„å•è¯</span></pre></td></tr></table></figure><h3 id=\"ç®¡é“\"><a class=\"anchor\" href=\"#ç®¡é“\">#</a> ç®¡é“  <code>|</code></h3>\n<p>æŠŠä¸¤ä¸ªå‘½ä»¤è¿èµ·æ¥ä½¿ç”¨ï¼Œä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºå¦å¤–ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œè‹±æ–‡æ˜¯  <code>pipeline</code>  ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸ªä¸ªæ°´ç®¡è¿æ¥èµ·æ¥ï¼Œç®¡é“ç®—æ˜¯é‡å®šå‘æµçš„ä¸€ç§ã€‚</p>\n<p><img data-src=\"/assets/2022-8/12.png\" alt=\"image.png\" /></p>\n<p>ä¸¾å‡ ä¸ªå®é™…ç”¨æ³•æ¡ˆä¾‹ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cut</span> -d , -f <span class=\"token number\">1</span> name.csv <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token operator\">></span> sorted_name.txt </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># ç¬¬ä¸€æ­¥è·å–åˆ°çš„ name åˆ—è¡¨ï¼Œé€šè¿‡ç®¡é“ç¬¦å†è¿›è¡Œæ’åºï¼Œæœ€åè¾“å‡ºåˆ° sorted_name.txt</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">du</span> <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> -nr <span class=\"token operator\">|</span> <span class=\"token function\">head</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># du è¡¨ç¤ºåˆ—ä¸¾ç›®å½•å¤§å°ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># sort è¿›è¡Œæ’åºï¼Œ-n è¡¨ç¤ºæŒ‰æ•°å­—æ’åºï¼Œ-r è¡¨ç¤ºå€’åº</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># head å‰ 10 è¡Œæ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">grep</span> log -Ir /var/log <span class=\"token operator\">|</span> <span class=\"token function\">cut</span> -d <span class=\"token builtin class-name\">:</span> -f <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> <span class=\"token operator\">|</span> <span class=\"token function\">uniq</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># grep log -Ir /var/log è¡¨ç¤ºåœ¨ log æ–‡ä»¶å¤¹ä¸‹æœç´¢ /var/log æ–‡æœ¬ï¼Œ-r è¡¨ç¤ºé€’å½’ï¼Œ-I ç”¨äºæ’é™¤äºŒè¿›åˆ¶æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># cut -d : -f 1 è¡¨ç¤ºé€šè¿‡å†’å·è¿›è¡Œå‰ªåˆ‡ï¼Œè·å–å‰ªåˆ‡çš„ç¬¬ä¸€éƒ¨åˆ†</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># sort è¿›è¡Œæ’åº</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># uniq è¿›è¡Œå»é‡</span></pre></td></tr></table></figure><h3 id=\"æµ\"><a class=\"anchor\" href=\"#æµ\">#</a> æµ</h3>\n<p>æµå¹¶éä¸€ä¸ªå‘½ä»¤ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæµ  <code>stream</code>  çš„å«ä¹‰æ˜¯æ¯”è¾ƒéš¾ç†è§£çš„ï¼Œè®°ä½ä¸€ç‚¹å³å¯ï¼š<strong>æµå°±æ˜¯è¯»ä¸€ç‚¹æ•°æ®ï¼Œå¤„ç†ä¸€ç‚¹ç‚¹æ•°æ®ã€‚å…¶ä¸­æ•°æ®ä¸€èˆ¬å°±æ˜¯äºŒè¿›åˆ¶æ ¼å¼ã€‚</strong> ä¸Šé¢æåŠçš„é‡å®šå‘æˆ–ç®¡é“ï¼Œå°±æ˜¯æŠŠæ•°æ®å½“åšæµå»è¿è½¬çš„ã€‚</p>\n<blockquote>\n<p>åˆ°æ­¤æˆ‘ä»¬å°±æ¥è§¦äº†ï¼Œæµã€é‡å®šå‘ã€ç®¡é“ç­‰  <code>Linux</code>  é«˜çº§æ¦‚å¿µåŠæŒ‡ä»¤ã€‚å…¶å®ä½ ä¼šå‘ç°å…³äºæµå’Œç®¡é“åœ¨å…¶å®ƒè¯­è¨€ä¸­ä¹Ÿæœ‰å¹¿æ³›çš„åº”ç”¨ã€‚  <code>Angular</code>  ä¸­çš„æ¨¡æ¿è¯­æ³•ä¸­å¯ä»¥ä½¿ç”¨ç®¡é“ã€‚  <code>Node.js</code>  ä¸­ä¹Ÿæœ‰  <code>stream</code>  æµçš„æ¦‚å¿µã€‚</p>\n</blockquote>\n<h2 id=\"æŸ¥çœ‹è¿›ç¨‹\"><a class=\"anchor\" href=\"#æŸ¥çœ‹è¿›ç¨‹\">#</a> æŸ¥çœ‹è¿›ç¨‹</h2>\n<p>åœ¨  <code>Windows</code>  ä¸­é€šè¿‡  <code>Ctrl + Alt + Delete</code>  å¿«æ·é”®æŸ¥çœ‹è½¯ä»¶è¿›ç¨‹ã€‚</p>\n<h3 id=\"w\"><a class=\"anchor\" href=\"#w\">#</a> w</h3>\n<p>å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿäº†è§£ç³»ç»Ÿä¸­ç›®å‰æœ‰å“ªäº›ç”¨æˆ·ç™»å½•ç€ï¼Œä»¥åŠä»–ä»¬åœ¨å¹²ä»€ä¹ˆã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># w</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> 06:31:53 up <span class=\"token number\">25</span> days,  <span class=\"token number\">9</span>:53,  <span class=\"token number\">1</span> user,  load average: <span class=\"token number\">0.00</span>, <span class=\"token number\">0.01</span>, <span class=\"token number\">0.05</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token environment constant\">USER</span>     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>root     pts/0    <span class=\"token number\">118.31</span>.243.53    05:56    <span class=\"token number\">1</span>.00s  <span class=\"token number\">0</span>.02s  <span class=\"token number\">0</span>.00s w</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>06:31:53ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>up <span class=\"token number\">25</span> days, <span class=\"token number\">9</span>:53ï¼šè¡¨ç¤ºç³»ç»Ÿå·²ç»æ­£å¸¸è¿è¡Œäº†â€œ25å¤©9å°æ—¶53åˆ†é’Ÿâ€</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">1</span> userï¼šè¡¨ç¤ºä¸€ä¸ªç”¨æˆ·</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>load average: <span class=\"token number\">0.00</span>, <span class=\"token number\">0.01</span>, <span class=\"token number\">0.05</span>ï¼šè¡¨ç¤ºç³»ç»Ÿçš„è´Ÿè½½ï¼Œ3ä¸ªå€¼åˆ†åˆ«è¡¨ç¤ºâ€œ1åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½â€ï¼Œâ€œ5åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½â€ï¼Œâ€œ15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½â€</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token environment constant\">USER</span>ï¼šè¡¨ç¤ºç™»å½•çš„ç”¨äº</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> TTYï¼šç™»å½•çš„ç»ˆç«¯åç§°ä¸ºpts/0</pre></td></tr><tr><td data-num=\"13\"></td><td><pre> FROMï¼šè¿æ¥åˆ°æœåŠ¡å™¨çš„ipåœ°å€</pre></td></tr><tr><td data-num=\"14\"></td><td><pre> LOGIN@ï¼šç™»å½•æ—¶é—´</pre></td></tr><tr><td data-num=\"15\"></td><td><pre> IDLEï¼šç”¨æˆ·æœ‰å¤šä¹…æ²¡æœ‰æ´»è·ƒäº†</pre></td></tr><tr><td data-num=\"16\"></td><td><pre> JCPUï¼šè¯¥ç»ˆç«¯æ‰€æœ‰ç›¸å…³çš„è¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´ï¼Œæ¯å½“è¿›ç¨‹ç»“æŸå°±åœæ­¢è®¡æ—¶ï¼Œå¼€å§‹æ–°çš„è¿›ç¨‹åˆ™ä¼šé‡æ–°è®¡æ—¶</pre></td></tr><tr><td data-num=\"17\"></td><td><pre> PCPUï¼šè¡¨ç¤º CPU æ‰§è¡Œå½“å‰ç¨‹åºæ‰€æ¶ˆè€—çš„æ—¶é—´ï¼Œå½“å‰è¿›ç¨‹å°±æ˜¯åœ¨ WHAT åˆ—é‡Œæ˜¾ç¤ºçš„ç¨‹åº</pre></td></tr><tr><td data-num=\"18\"></td><td><pre> WHATï¼šè¡¨ç¤ºå½“ä¸‹ç”¨æˆ·æ­£è¿è¡Œçš„ç¨‹åºæ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œæˆ‘è¿è¡Œçš„æ˜¯ w</pre></td></tr></table></figure><h3 id=\"ps\"><a class=\"anchor\" href=\"#ps\">#</a> ps</h3>\n<p>ç”¨äºæ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­çš„è¿›ç¨‹ï¼Œ  <code>ps</code>  å‘½ä»¤æ˜¾ç¤ºçš„è¿›ç¨‹åˆ—è¡¨ä¸ä¼šéšæ—¶é—´è€Œæ›´æ–°ï¼Œæ˜¯é™æ€çš„ï¼Œæ˜¯è¿è¡Œ  <code>ps</code>  å‘½ä»¤é‚£ä¸ªæ—¶åˆ»çš„çŠ¶æ€æˆ–è€…è¯´æ˜¯ä¸€ä¸ªè¿›ç¨‹å¿«ç…§ã€‚</p>\n<h4 id=\"åŸºç¡€è¯­æ³•-6\"><a class=\"anchor\" href=\"#åŸºç¡€è¯­æ³•-6\">#</a> åŸºç¡€è¯­æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ps</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  PID TTY          TIME CMD</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token number\">1793</span> pts/0    00:00:00 <span class=\"token function\">bash</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token number\">4756</span> pts/0    00:00:00 <span class=\"token function\">ps</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre> PIDï¼šè¿›ç¨‹å·ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å”¯ä¸€çš„è¿›ç¨‹å·</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> TTYï¼šè¿›ç¨‹è¿è¡Œæ‰€åœ¨çš„ç»ˆç«¯</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> TIMEï¼šè¿›ç¨‹è¿è¡Œæ—¶é—´</pre></td></tr><tr><td data-num=\"9\"></td><td><pre> CMDï¼šäº§ç”Ÿè¿™ä¸ªè¿›ç¨‹çš„ç¨‹åºåï¼Œå¦‚æœåœ¨è¿›ç¨‹åˆ—è¡¨ä¸­çœ‹åˆ°æœ‰å¥½å‡ è¡Œéƒ½æ˜¯åŒæ ·çš„ç¨‹åºåï¼Œé‚£ä¹ˆå°±æ˜¯åŒæ ·çš„ç¨‹åºäº§ç”Ÿäº†ä¸æ­¢ä¸€ä¸ªè¿›ç¨‹</pre></td></tr></table></figure><h4 id=\"å¸¸ç”¨å‚æ•°-6\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-6\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-ef</code>  åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹ï¼›</li>\n<li><code>-efH</code>  ä»¥ä¹”æœ¨çŠ¶åˆ—ä¸¾å‡ºæ‰€æœ‰è¿›ç¨‹ï¼›</li>\n<li><code>-u</code>  åˆ—å‡ºæ­¤ç”¨æˆ·è¿è¡Œçš„è¿›ç¨‹ï¼›</li>\n<li><code>-aux</code>  é€šè¿‡  <code>CPU</code>  å’Œå†…å­˜ä½¿ç”¨æ¥è¿‡æ»¤è¿›ç¨‹  <code>ps -aux | less</code>  ;</li>\n<li><code>-aux --sort -pcpu</code>  æŒ‰  <code>CPU</code>  ä½¿ç”¨é™åºæ’åˆ—ï¼Œ  <code>-aux --sort -pmem</code>  è¡¨ç¤ºæŒ‰å†…å­˜ä½¿ç”¨é™åºæ’åˆ—ï¼›</li>\n<li><code>-axjf</code>  ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºè¿›ç¨‹ï¼Œ  <code>ps -axjf</code>  å®ƒå’Œ  <code>pstree</code>  æ•ˆæœç±»ä¼¼ã€‚</li>\n</ul>\n<h3 id=\"top\"><a class=\"anchor\" href=\"#top\">#</a> top</h3>\n<p>è·å–è¿›ç¨‹çš„åŠ¨æ€åˆ—è¡¨ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">top</span> - 07:20:07 up <span class=\"token number\">25</span> days, <span class=\"token number\">10</span>:41,  <span class=\"token number\">1</span> user,  load average: <span class=\"token number\">0.30</span>, <span class=\"token number\">0.10</span>, <span class=\"token number\">0.07</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Tasks:  <span class=\"token number\">67</span> total,   <span class=\"token number\">1</span> running,  <span class=\"token number\">66</span> sleeping,   <span class=\"token number\">0</span> stopped,   <span class=\"token number\">0</span> zombie</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>%Cpu<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>:  <span class=\"token number\">0.7</span> us,  <span class=\"token number\">0.3</span> sy,  <span class=\"token number\">0.0</span> ni, <span class=\"token number\">99.0</span> id,  <span class=\"token number\">0.0</span> wa,  <span class=\"token number\">0.0</span> hi,  <span class=\"token number\">0.0</span> si,  <span class=\"token number\">0.0</span> st</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>KiB Mem <span class=\"token builtin class-name\">:</span>  <span class=\"token number\">1882072</span> total,   <span class=\"token number\">552148</span> free,   <span class=\"token number\">101048</span> used,  <span class=\"token number\">1228876</span> buff/cache</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>KiB Swap:        <span class=\"token number\">0</span> total,        <span class=\"token number\">0</span> free,        <span class=\"token number\">0</span> used.  <span class=\"token number\">1594080</span> avail Mem </pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  PID <span class=\"token environment constant\">USER</span>      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                                                                       </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token number\">956</span> root      <span class=\"token number\">10</span> -10  <span class=\"token number\">133964</span>  <span class=\"token number\">15848</span>  <span class=\"token number\">10240</span> S  <span class=\"token number\">0.7</span>  <span class=\"token number\">0.8</span> <span class=\"token number\">263</span>:13.01 AliYunDun                                                                                                     </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token number\">1</span> root      <span class=\"token number\">20</span>   <span class=\"token number\">0</span>   <span class=\"token number\">51644</span>   <span class=\"token number\">3664</span>   <span class=\"token number\">2400</span> S  <span class=\"token number\">0.0</span>  <span class=\"token number\">0.2</span>   <span class=\"token number\">3</span>:23.63 systemd                                                                                                       </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token number\">2</span> root      <span class=\"token number\">20</span>   <span class=\"token number\">0</span>       <span class=\"token number\">0</span>      <span class=\"token number\">0</span>      <span class=\"token number\">0</span> S  <span class=\"token number\">0.0</span>  <span class=\"token number\">0.0</span>   <span class=\"token number\">0</span>:00.05 kthreadd                                                                                                      </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token number\">4</span> root       <span class=\"token number\">0</span> -20       <span class=\"token number\">0</span>      <span class=\"token number\">0</span>      <span class=\"token number\">0</span> S  <span class=\"token number\">0.0</span>  <span class=\"token number\">0.0</span>   <span class=\"token number\">0</span>:00.00 kworker/0:0H</pre></td></tr></table></figure><ul>\n<li><code>top - 07:20:07 up 25 days, 10:41,  1 user,  load average: 0.30, 0.10, 0.07</code>  ç›¸å½“  <code>w</code>  å‘½ä»¤çš„ç¬¬ä¸€è¡Œçš„ä¿¡æ¯ã€‚</li>\n<li>å±•ç¤ºçš„è¿™äº›è¿›ç¨‹æ˜¯æŒ‰ç…§ä½¿ç”¨å¤„ç†å™¨  <code>%CPU</code>  çš„ä½¿ç”¨ç‡æ¥æ’åºçš„ã€‚</li>\n</ul>\n<h3 id=\"kill\"><a class=\"anchor\" href=\"#kill\">#</a> kill</h3>\n<p>ç»“æŸä¸€ä¸ªè¿›ç¨‹ï¼Œ  <code>kill + PID</code>  ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">kill</span> <span class=\"token number\">956</span> <span class=\"token comment\"># ç»“æŸè¿›ç¨‹å·ä¸º 956 çš„è¿›ç¨‹</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">kill</span> <span class=\"token number\">956</span> <span class=\"token number\">957</span> <span class=\"token comment\"># ç»“æŸå¤šä¸ªè¿›ç¨‹</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">kill</span> -9 <span class=\"token number\">7291</span> <span class=\"token comment\"># å¼ºåˆ¶ç»“æŸè¿›ç¨‹</span></pre></td></tr></table></figure><h2 id=\"ç®¡ç†è¿›ç¨‹\"><a class=\"anchor\" href=\"#ç®¡ç†è¿›ç¨‹\">#</a> ç®¡ç†è¿›ç¨‹</h2>\n<h3 id=\"è¿›ç¨‹çŠ¶æ€\"><a class=\"anchor\" href=\"#è¿›ç¨‹çŠ¶æ€\">#</a> è¿›ç¨‹çŠ¶æ€</h3>\n<p>ä¸»è¦æ˜¯åˆ‡æ¢è¿›ç¨‹çš„çŠ¶æ€ã€‚æˆ‘ä»¬å…ˆäº†è§£ä¸‹  <code>Linux</code>  ä¸‹è¿›ç¨‹çš„äº”ç§çŠ¶æ€ï¼š</p>\n<ol>\n<li>çŠ¶æ€ç   <code>R</code>  ï¼šè¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ï¼›</li>\n<li>çŠ¶æ€ç   <code>S</code>  ï¼šè¡¨ç¤ºä¸­æ–­ï¼ˆä¼‘çœ ä¸­ï¼Œå—é˜»ï¼Œå½“æŸä¸ªæ¡ä»¶å½¢æˆåæˆ–æ¥å—åˆ°ä¿¡å·æ—¶ï¼Œåˆ™è„±ç¦»è¯¥çŠ¶æ€ï¼‰ï¼›</li>\n<li>çŠ¶æ€ç   <code>D</code>  ï¼šè¡¨ç¤ºä¸å¯ä¸­æ–­ï¼ˆè¿›ç¨‹ä¸å“åº”ç³»ç»Ÿå¼‚æ­¥ä¿¡å·ï¼Œå³ä½¿ç”¨ kill å‘½ä»¤ä¹Ÿä¸èƒ½ä½¿å…¶ä¸­æ–­ï¼‰ï¼›</li>\n<li>çŠ¶æ€ç   <code>Z</code>  ï¼šè¡¨ç¤ºåƒµæ­»ï¼ˆè¿›ç¨‹å·²ç»ˆæ­¢ï¼Œä½†è¿›ç¨‹æè¿°ç¬¦ä¾ç„¶å­˜åœ¨ï¼Œç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨  <code>wait4()</code>  ç³»ç»Ÿå‡½æ•°åå°†è¿›ç¨‹é‡Šæ”¾ï¼‰ï¼›</li>\n<li>çŠ¶æ€ç   <code>T</code>  ï¼šè¡¨ç¤ºåœæ­¢ï¼ˆè¿›ç¨‹æ”¶åˆ°  <code>SIGSTOP</code>  ã€  <code>SIGSTP</code>  ã€  <code>SIGTIN</code>  ã€  <code>SIGTOU</code>  ç­‰åœæ­¢ä¿¡å·ååœæ­¢è¿è¡Œï¼‰ã€‚</li>\n</ol>\n<h3 id=\"å‰å°è¿›ç¨‹-åå°è¿›ç¨‹\"><a class=\"anchor\" href=\"#å‰å°è¿›ç¨‹-åå°è¿›ç¨‹\">#</a> å‰å°è¿›ç¨‹ &amp; åå°è¿›ç¨‹</h3>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ·åˆ›å»ºçš„è¿›ç¨‹éƒ½æ˜¯å‰å°è¿›ç¨‹ï¼Œå‰å°è¿›ç¨‹ä»é”®ç›˜è¯»å–æ•°æ®ï¼Œå¹¶æŠŠå¤„ç†ç»“æœè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨ã€‚ä¾‹å¦‚è¿è¡Œ  <code>top</code>  å‘½ä»¤ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸€ç›´è¿è¡Œçš„å‰å°è¿›ç¨‹ã€‚</p>\n<p>åå°è¿›ç¨‹çš„ä¼˜ç‚¹æ˜¯ä¸å¿…ç­‰å¾…ç¨‹åºè¿è¡Œç»“æŸï¼Œå°±å¯ä»¥è¾“å…¥å…¶å®ƒå‘½ä»¤ã€‚åœ¨éœ€è¦æ‰§è¡Œçš„å‘½ä»¤åé¢æ·»åŠ   <code>&amp;</code>  ç¬¦å·ï¼Œå°±è¡¨ç¤ºå¯åŠ¨ä¸€ä¸ªåå°è¿›ç¨‹ã€‚</p>\n<h3 id=\"\"><a class=\"anchor\" href=\"#\">#</a> &amp;</h3>\n<p>å¯åŠ¨åå°è¿›ç¨‹ï¼Œå®ƒçš„ç¼ºç‚¹æ˜¯åå°è¿›ç¨‹ä¸ç»ˆç«¯ç›¸å…³è”ï¼Œä¸€æ—¦å…³é—­ç»ˆç«¯ï¼Œè¿›ç¨‹å°±è‡ªåŠ¨ç»“æŸäº†ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cp</span> name.csv name-copy.csv <span class=\"token operator\">&amp;</span></pre></td></tr></table></figure><h3 id=\"nohup\"><a class=\"anchor\" href=\"#nohup\">#</a> nohup</h3>\n<p>ä½¿è¿›ç¨‹ä¸å—æŒ‚æ–­ï¼ˆå…³é—­ç»ˆç«¯ç­‰åŠ¨ä½œï¼‰çš„å½±å“ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nohup</span> <span class=\"token function\">cp</span> name.csv name-copy.csv</pre></td></tr></table></figure><p><code>nohup</code>  å‘½ä»¤ä¹Ÿå¯ä»¥å’Œ  <code>&amp;</code>  ç»“åˆä½¿ç”¨ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">nohup</span> <span class=\"token function\">cp</span> name.csv name-copy.csv <span class=\"token operator\">&amp;</span></pre></td></tr></table></figure><h3 id=\"bg\"><a class=\"anchor\" href=\"#bg\">#</a> bg</h3>\n<p>ä½¿ä¸€ä¸ª â€œåå°æš‚åœè¿è¡Œâ€ çš„è¿›ç¨‹ï¼ŒçŠ¶æ€æ”¹ä¸º â€œåå°è¿è¡Œâ€ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">bg</span> %1 <span class=\"token comment\"># ä¸åŠ ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œbg å‘½ä»¤ä¼šé»˜è®¤ä½œç”¨äºæœ€è¿‘çš„ä¸€ä¸ªåå°è¿›ç¨‹ï¼Œå¦‚æœæ·»åŠ å‚æ•°åˆ™ä¼šä½œç”¨äºæŒ‡å®šæ ‡å·çš„è¿›ç¨‹</span></pre></td></tr></table></figure><p>å®é™…æ¡ˆä¾‹ 1ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>. æ‰§è¡Œ <span class=\"token function\">grep</span> -r <span class=\"token string\">\"log\"</span> / <span class=\"token operator\">></span> grep_log <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span> å‘½ä»¤å¯åŠ¨ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œå¹¶ä¸”å¿˜è®°æ·»åŠ  <span class=\"token operator\">&amp;</span> ç¬¦å·</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">2</span>. ctrl + z ä½¿è¿›ç¨‹çŠ¶æ€è½¬ä¸ºåå°æš‚åœ</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">3</span>. æ‰§è¡Œ <span class=\"token function\">bg</span> å°†å‘½ä»¤è½¬ä¸ºåå°è¿è¡Œ</pre></td></tr></table></figure><p>å®é™…æ¡ˆä¾‹ 2ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>å‰ç«¯å¼€å‘æ—¶æˆ‘ä»¬ç»å¸¸ä¼šæ‰§è¡Œ <span class=\"token function\">yarn</span> start å¯åŠ¨é¡¹ç›®</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>æ­¤æ—¶æˆ‘ä»¬æ‰§è¡Œ ctrl + z å…ˆä½¿å…¶æš‚åœ</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ç„¶åæ‰§è¡Œ <span class=\"token function\">bg</span> ä½¿å…¶è½¬ä¸ºåå°è¿è¡Œ</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>è¿™æ ·å½“å‰ç»ˆç«¯å°±ç©ºé—²å‡ºæ¥å¯ä»¥å¹²å…¶å®ƒäº‹æƒ…äº†ï¼Œå¦‚æœæƒ³è¦å”¤é†’å®ƒå°±ä½¿ç”¨ <span class=\"token function\">fg</span> å‘½ä»¤å³å¯ï¼ˆåé¢ä¼šè®²ï¼‰</pre></td></tr></table></figure><h3 id=\"jobs\"><a class=\"anchor\" href=\"#jobs\">#</a> jobs</h3>\n<p>æ˜¾ç¤ºå½“å‰ç»ˆç«¯åå°è¿›ç¨‹çŠ¶æ€ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># jobs</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>+  Stopped                 <span class=\"token function\">top</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>-  Running                 <span class=\"token function\">grep</span> --color<span class=\"token operator\">=</span>auto -r <span class=\"token string\">\"log\"</span> / <span class=\"token operator\">></span> grep_log <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span> <span class=\"token operator\">&amp;</span></pre></td></tr></table></figure><h3 id=\"fg\"><a class=\"anchor\" href=\"#fg\">#</a> fg</h3>\n<p><code>fg</code>  ä½¿è¿›ç¨‹è½¬ä¸ºå‰å°è¿è¡Œï¼Œç”¨æ³•å’Œ  <code>bg</code>  å‘½ä»¤ç±»ä¼¼ã€‚</p>\n<p>æˆ‘ä»¬ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºå‰åå°è¿›ç¨‹åˆ‡æ¢ï¼š</p>\n<p><img data-src=\"/assets/2022-8/13.png\" alt=\"image.png\" /></p>\n<blockquote>\n<p>æˆ‘ä»¬å¯ä»¥ä½¿ç¨‹åºåœ¨åå°è¿è¡Œï¼Œæˆä¸ºåå°è¿›ç¨‹ï¼Œè¿™æ ·åœ¨å½“å‰ç»ˆç«¯ä¸­æˆ‘ä»¬å°±å¯ä»¥åšå…¶ä»–äº‹æƒ…äº†ï¼Œè€Œä¸å¿…ç­‰å¾…æ­¤è¿›ç¨‹è¿è¡Œç»“æŸã€‚</p>\n</blockquote>\n<h2 id=\"å®ˆæŠ¤è¿›ç¨‹\"><a class=\"anchor\" href=\"#å®ˆæŠ¤è¿›ç¨‹\">#</a> å®ˆæŠ¤è¿›ç¨‹</h2>\n<p>ä¸€ä¸ªè¿è¡Œèµ·æ¥çš„ç¨‹åºè¢«ç§°ä¸ºè¿›ç¨‹ã€‚åœ¨  <code>Linux</code>  ä¸­æœ‰äº›è¿›ç¨‹æ˜¯ç‰¹æ®Šçš„ï¼Œå®ƒä¸ä¸ä»»ä½•è¿›ç¨‹å…³è”ï¼Œä¸è®ºç”¨æˆ·çš„èº«ä»½å¦‚ä½•ï¼Œéƒ½åœ¨åå°è¿è¡Œï¼Œè¿™äº›è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯  <code>PID</code>  ä¸º 1 çš„è¿›ç¨‹ï¼Œ  <code>PID</code>  ä¸º 1 çš„è¿›ç¨‹åªåœ¨ç³»ç»Ÿå…³é—­æ—¶æ‰ä¼šè¢«é”€æ¯ã€‚å®ƒä»¬ä¼šåœ¨åå°ä¸€ç›´è¿è¡Œç­‰å¾…åˆ†é…å·¥ä½œã€‚æˆ‘ä»¬å°†è¿™ç±»è¿›ç¨‹ç§°ä¹‹ä¸ºå®ˆæŠ¤è¿›ç¨‹  <code>daemon</code>  ã€‚</p>\n<p>å®ˆæŠ¤è¿›ç¨‹çš„åå­—é€šå¸¸ä¼šåœ¨æœ€åæœ‰ä¸€ä¸ª  <code>d</code>  ï¼Œè¡¨ç¤º  <code>daemon</code>  å®ˆæŠ¤çš„æ„æ€ï¼Œä¾‹å¦‚  <code>systemd</code>  ã€ <code>httpd</code>  ã€‚</p>\n<h3 id=\"systemd\"><a class=\"anchor\" href=\"#systemd\">#</a> systemd</h3>\n<p><code>systemd</code>  æ˜¯ä¸€ä¸ª  <code>Linux</code>  ç³»ç»ŸåŸºç¡€ç»„ä»¶çš„é›†åˆï¼Œæä¾›äº†ä¸€ä¸ªç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ï¼Œè¿è¡Œä¸º  <code>PID 1</code>  å¹¶è´Ÿè´£å¯åŠ¨å…¶å®ƒç¨‹åºã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ps -aux</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token environment constant\">USER</span>       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root         <span class=\"token number\">1</span>  <span class=\"token number\">0.0</span>  <span class=\"token number\">0.2</span>  <span class=\"token number\">51648</span>  <span class=\"token number\">3852</span> ?        Ss   Feb01   <span class=\"token number\">1</span>:50 /usr/lib/systemd/systemd --switched-root --system --deserialize <span class=\"token number\">22</span></pre></td></tr></table></figure><blockquote>\n<p>é€šè¿‡å‘½ä»¤ä¹Ÿå¯ä»¥çœ‹åˆ°  <code>PID</code>  ä¸º 1 çš„è¿›ç¨‹å°±æ˜¯  <code>systemd</code>  çš„ç³»ç»Ÿè¿›ç¨‹ã€‚</p>\n</blockquote>\n<p><code>systemd</code>  å¸¸ç”¨å‘½ä»¤ï¼ˆå®ƒæ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆï¼‰ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl start nginx <span class=\"token comment\"># å¯åŠ¨æœåŠ¡</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl stop nginx <span class=\"token comment\"># åœæ­¢æœåŠ¡</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl restart nginx <span class=\"token comment\"># é‡å¯æœåŠ¡</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl status nginx <span class=\"token comment\"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>systemctl reload nginx <span class=\"token comment\"># é‡è½½é…ç½®æ–‡ä»¶ (ä¸åœæ­¢æœåŠ¡çš„æƒ…å†µ)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> nginx <span class=\"token comment\"># å¼€æœºè‡ªåŠ¨å¯åŠ¨æœåŠ¡</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>systemctl disable nginx <span class=\"token comment\"># å¼€æœºä¸è‡ªåŠ¨å¯åŠ¨æœåŠ¡</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>systemctl is-enabled nginx <span class=\"token comment\"># æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¼€æœºè‡ªåŠ¨å¯åŠ¨</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>systemctl list-unit-files --type<span class=\"token operator\">=</span>service <span class=\"token comment\"># æŸ¥çœ‹å„ä¸ªçº§åˆ«ä¸‹æœåŠ¡çš„å¯åŠ¨å’Œç¦ç”¨æƒ…å†µ</span></pre></td></tr></table></figure><h2 id=\"æ–‡ä»¶å‹ç¼©è§£å‹\"><a class=\"anchor\" href=\"#æ–‡ä»¶å‹ç¼©è§£å‹\">#</a> æ–‡ä»¶å‹ç¼©è§£å‹</h2>\n<ul>\n<li>æ‰“åŒ…ï¼šæ˜¯å°†å¤šä¸ªæ–‡ä»¶å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼Œå®ƒçš„å­¦åå«å­˜æ¡£ã€å½’æ¡£ã€‚</li>\n<li>å‹ç¼©ï¼šæ˜¯å°†ä¸€ä¸ªå¤§æ–‡ä»¶ï¼ˆé€šå¸¸æŒ‡å½’æ¡£ï¼‰å‹ç¼©å˜æˆä¸€ä¸ªå°æ–‡ä»¶ã€‚</li>\n</ul>\n<p>æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨  <code>tar</code>  å°†å¤šä¸ªæ–‡ä»¶å½’æ¡£ä¸ºä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼Œç§°ä¸º  <code>archive</code>  ã€‚ ç„¶åç”¨  <code>gzip</code>  æˆ–  <code>bzip2</code>  å‘½ä»¤å°†  <code>archive</code>  å‹ç¼©ä¸ºæ›´å°çš„æ–‡ä»¶ã€‚</p>\n<p><img data-src=\"/assets/2022-8/14.png\" alt=\"image.png\" /></p>\n<h3 id=\"tar\"><a class=\"anchor\" href=\"#tar\">#</a> tar</h3>\n<p>åˆ›å»ºä¸€ä¸ª  <code>tar</code>  å½’æ¡£ã€‚</p>\n<h4 id=\"åŸºç¡€ç”¨æ³•\"><a class=\"anchor\" href=\"#åŸºç¡€ç”¨æ³•\">#</a> åŸºç¡€ç”¨æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -cvf sort.tar sort/ <span class=\"token comment\"># å°† sort æ–‡ä»¶å¤¹å½’æ¡£ä¸º sort.tar</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> -cvf archive.tar file1 file2 file3 <span class=\"token comment\"># å°† file1 file2 file3 å½’æ¡£ä¸º archive.tar</span></pre></td></tr></table></figure><h4 id=\"å¸¸ç”¨å‚æ•°-7\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-7\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-cvf</code>  è¡¨ç¤º  <code>create</code> ï¼ˆåˆ›å»ºï¼‰+  <code>verbose</code> ï¼ˆç»†èŠ‚ï¼‰+  <code>file</code> ï¼ˆæ–‡ä»¶ï¼‰ï¼Œåˆ›å»ºå½’æ¡£æ–‡ä»¶å¹¶æ˜¾ç¤ºæ“ä½œç»†èŠ‚ï¼›</li>\n<li><code>-tf</code>  æ˜¾ç¤ºå½’æ¡£é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸è§£å¼€å½’æ¡£ï¼›</li>\n<li><code>-rvf</code>  è¿½åŠ æ–‡ä»¶åˆ°å½’æ¡£ï¼Œ  <code>tar -rvf archive.tar file.txt</code>  ï¼›</li>\n<li><code>-xvf</code>  è§£å¼€å½’æ¡£ï¼Œ  <code>tar -xvf archive.tar</code>  ã€‚</li>\n</ul>\n<h3 id=\"gzip-gunzip\"><a class=\"anchor\" href=\"#gzip-gunzip\">#</a> gzip / gunzip</h3>\n<p>â€œå‹ç¼© / è§£å‹â€ å½’æ¡£ï¼Œé»˜è®¤ç”¨  <code>gzip</code>  å‘½ä»¤ï¼Œå‹ç¼©åçš„æ–‡ä»¶åç¼€åä¸º  <code>.tar.gz</code>  ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">gzip</span> archive.tar <span class=\"token comment\"># å‹ç¼©</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gunzip archive.tar.gz <span class=\"token comment\"># è§£å‹</span></pre></td></tr></table></figure><h3 id=\"tar-å½’æ¡£å‹ç¼©\"><a class=\"anchor\" href=\"#tar-å½’æ¡£å‹ç¼©\">#</a> tar å½’æ¡£ + å‹ç¼©</h3>\n<p>å¯ä»¥ç”¨  <code>tar</code>  å‘½ä»¤åŒæ—¶å®Œæˆå½’æ¡£å’Œå‹ç¼©çš„æ“ä½œï¼Œå°±æ˜¯ç»™  <code>tar</code>  å‘½ä»¤å¤šåŠ ä¸€ä¸ªé€‰é¡¹å‚æ•°ï¼Œä½¿ä¹‹å®Œæˆå½’æ¡£æ“ä½œåï¼Œè¿˜æ˜¯è°ƒç”¨  <code>gzip</code>  æˆ–  <code>bzip2</code>  å‘½ä»¤æ¥å®Œæˆå‹ç¼©æ“ä½œã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zcvf archive.tar.gz archive/ <span class=\"token comment\"># å°† archive æ–‡ä»¶å¤¹å½’æ¡£å¹¶å‹ç¼©</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> -zxvf archive.tar.gz <span class=\"token comment\"># å°† archive.tar.gz å½’æ¡£å‹ç¼©æ–‡ä»¶è§£å‹</span></pre></td></tr></table></figure><h3 id=\"zcat-zless-zmore\"><a class=\"anchor\" href=\"#zcat-zless-zmore\">#</a> zcatã€zlessã€zmore</h3>\n<p>ä¹‹å‰è®²è¿‡ä½¿ç”¨  <code>cat less more</code>  å¯ä»¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œä½†æ˜¯å‹ç¼©æ–‡ä»¶çš„å†…å®¹æ˜¯ä¸èƒ½ä½¿ç”¨è¿™äº›å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹çš„ï¼Œè€Œè¦ä½¿ç”¨  <code>zcatã€zlessã€zmore</code>  è¿›è¡ŒæŸ¥çœ‹ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>zcat archive.tar.gz</pre></td></tr></table></figure><h3 id=\"zipunzip\"><a class=\"anchor\" href=\"#zipunzip\">#</a> zip/unzip</h3>\n<p>â€œå‹ç¼© / è§£å‹â€  <code>zip</code>  æ–‡ä»¶ï¼ˆ  <code>zip</code>  å‹ç¼©æ–‡ä»¶ä¸€èˆ¬æ¥è‡ª  <code>windows</code>  æ“ä½œç³»ç»Ÿï¼‰ã€‚</p>\n<h4 id=\"å‘½ä»¤å®‰è£…\"><a class=\"anchor\" href=\"#å‘½ä»¤å®‰è£…\">#</a> å‘½ä»¤å®‰è£…</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># Red Hat ä¸€æ—ä¸­çš„å®‰è£…æ–¹å¼</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token function\">zip</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token function\">unzip</span></pre></td></tr></table></figure><h4 id=\"åŸºç¡€ç”¨æ³•-2\"><a class=\"anchor\" href=\"#åŸºç¡€ç”¨æ³•-2\">#</a> åŸºç¡€ç”¨æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">unzip</span> archive.zip <span class=\"token comment\"># è§£å‹ .zip æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">unzip</span> -l archive.zip <span class=\"token comment\"># ä¸è§£å¼€ .zip æ–‡ä»¶ï¼Œåªçœ‹å…¶ä¸­å†…å®¹</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">zip</span> -r sort.zip sort/ <span class=\"token comment\"># å°† sort æ–‡ä»¶å¤¹å‹ç¼©ä¸º sort.zipï¼Œå…¶ä¸­ - r è¡¨ç¤ºé€’å½’</span></pre></td></tr></table></figure><h2 id=\"ç¼–è¯‘å®‰è£…è½¯ä»¶\"><a class=\"anchor\" href=\"#ç¼–è¯‘å®‰è£…è½¯ä»¶\">#</a> ç¼–è¯‘å®‰è£…è½¯ä»¶</h2>\n<p>ä¹‹å‰æˆ‘ä»¬å­¦ä¼šäº†ä½¿ç”¨  <code>yum</code>  å‘½ä»¤è¿›è¡Œè½¯ä»¶å®‰è£…ï¼Œå¦‚æœç¢°åˆ°  <code>yum</code>  ä»“åº“ä¸­æ²¡æœ‰çš„è½¯ä»¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¼šæ›´é«˜çº§çš„è½¯ä»¶å®‰è£… â€œæºç ç¼–è¯‘å®‰è£…â€ã€‚</p>\n<h3 id=\"ç¼–è¯‘å®‰è£…\"><a class=\"anchor\" href=\"#ç¼–è¯‘å®‰è£…\">#</a> ç¼–è¯‘å®‰è£…</h3>\n<p>ç®€å•æ¥è¯´ï¼Œç¼–è¯‘å°±æ˜¯å°†ç¨‹åºçš„æºä»£ç è½¬æ¢æˆå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ã€‚å¤§å¤šæ•°  <code>Linux</code>  çš„ç¨‹åºéƒ½æ˜¯å¼€æ”¾æºç çš„ï¼Œå¯ä»¥ç¼–è¯‘æˆé€‚åˆæˆ‘ä»¬çš„ç”µè„‘å’Œæ“çºµç³»ç»Ÿå±æ€§çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>\n<p>åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>ä¸‹è½½æºä»£ç </li>\n<li>è§£å‹å‹ç¼©åŒ…</li>\n<li>é…ç½®</li>\n<li>ç¼–è¯‘</li>\n<li>å®‰è£…</li>\n</ol>\n<h4 id=\"å®é™…æ¡ˆä¾‹\"><a class=\"anchor\" href=\"#å®é™…æ¡ˆä¾‹\">#</a> å®é™…æ¡ˆä¾‹</h4>\n<h5 id=\"1-ä¸‹è½½\"><a class=\"anchor\" href=\"#1-ä¸‹è½½\">#</a> 1ã€ä¸‹è½½</h5>\n<p>æˆ‘ä»¬æ¥ç¼–è¯‘å®‰è£…  <code>htop</code>  è½¯ä»¶ï¼Œé¦–å…ˆåœ¨å®ƒçš„å®˜ç½‘ä¸‹è½½æºç ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iaW50cmF5LmNvbS9odG9wL3NvdXJjZS9odG9wI2ZpbGVz\">bintray.com/htop/sourceâ€¦</span></p>\n<p>ä¸‹è½½å¥½çš„æºç åœ¨æœ¬æœºç”µè„‘ä¸Šä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åŒæ­¥åˆ°æœåŠ¡å™¨ä¸Šï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> æ–‡ä»¶å ç”¨æˆ·å@æœåŠ¡å™¨ip:ç›®æ ‡è·¯å¾„</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">scp</span> ~/Desktop/htop-3.0.0.tar.gz root@121.42.11.34:.</pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨  <code>wegt</code>  è¿›è¡Œä¸‹è½½ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>wegt+ä¸‹è½½åœ°å€</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>wegt https://bintray.com/htop/source/download_file?file_path<span class=\"token operator\">=</span>htop-3.0.0.tar.gz</pre></td></tr></table></figure><h5 id=\"2-è§£å‹æ–‡ä»¶\"><a class=\"anchor\" href=\"#2-è§£å‹æ–‡ä»¶\">#</a> 2ã€è§£å‹æ–‡ä»¶</h5>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf htop-3.0.0.tar.gz <span class=\"token comment\"># è§£å‹</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> htop-3.0.0 <span class=\"token comment\"># è¿›å…¥ç›®å½•</span></pre></td></tr></table></figure><h5 id=\"3-é…ç½®\"><a class=\"anchor\" href=\"#3-é…ç½®\">#</a> 3ã€é…ç½®</h5>\n<p>æ‰§è¡Œ  <code>./configure</code>  ï¼Œå®ƒä¼šåˆ†æä½ çš„ç”µè„‘å»ç¡®è®¤ç¼–è¯‘æ‰€éœ€çš„å·¥å…·æ˜¯å¦éƒ½å·²ç»å®‰è£…äº†ã€‚</p>\n<h5 id=\"4-ç¼–è¯‘\"><a class=\"anchor\" href=\"#4-ç¼–è¯‘\">#</a> 4ã€ç¼–è¯‘</h5>\n<p>æ‰§è¡Œ  <code>make</code>  å‘½ä»¤</p>\n<h5 id=\"5-å®‰è£…\"><a class=\"anchor\" href=\"#5-å®‰è£…\">#</a> 5ã€å®‰è£…</h5>\n<p>æ‰§è¡Œ  <code>make install</code>  å‘½ä»¤ï¼Œå®‰è£…å®Œæˆåæ‰§è¡Œ  <code>ls /usr/local/bin/</code>  æŸ¥çœ‹æ˜¯å¦æœ‰  <code>htop</code>  å‘½ä»¤ã€‚å¦‚æœæœ‰å°±å¯ä»¥æ‰§è¡Œ  <code>htop</code>  å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹äº†ã€‚</p>\n<h2 id=\"ç½‘ç»œ\"><a class=\"anchor\" href=\"#ç½‘ç»œ\">#</a> ç½‘ç»œ</h2>\n<h3 id=\"ifconfig\"><a class=\"anchor\" href=\"#ifconfig\">#</a> ifconfig</h3>\n<p>æŸ¥çœ‹  <code>ip</code>  ç½‘ç»œç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœå‘½ä»¤ä¸å­˜åœ¨çš„è¯ï¼Œ æ‰§è¡Œå‘½ä»¤  <code>yum install net-tools</code>  å®‰è£…ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ifconfig</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>eth0: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">416</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class=\"token operator\">></span>  mtu <span class=\"token number\">1500</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        inet <span class=\"token number\">172.31</span>.24.78  netmask <span class=\"token number\">255.255</span>.240.0  broadcast <span class=\"token number\">172.31</span>.31.255</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        ether 00:16:3e:04:9c:cd  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Ethernet<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        RX packets <span class=\"token number\">1592318</span>  bytes <span class=\"token number\">183722250</span> <span class=\"token punctuation\">(</span><span class=\"token number\">175.2</span> MiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        TX packets <span class=\"token number\">1539361</span>  bytes <span class=\"token number\">154044090</span> <span class=\"token punctuation\">(</span><span class=\"token number\">146.9</span> MiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>lo: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class=\"token operator\">></span>  mtu <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        inet <span class=\"token number\">127.0</span>.0.1  netmask <span class=\"token number\">255.0</span>.0.0</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        loop  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Local Loopback<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        RX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        TX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr></table></figure><p>å‚æ•°è§£æï¼š</p>\n<ul>\n<li><code>eth0</code>  å¯¹åº”æœ‰çº¿è¿æ¥ï¼ˆå¯¹åº”ä½ çš„æœ‰çº¿ç½‘å¡ï¼‰ï¼Œå°±æ˜¯ç”¨ç½‘çº¿æ¥è¿æ¥çš„ä¸Šç½‘ã€‚  <code>eth</code>  æ˜¯  <code>Ethernet</code>  çš„ç¼©å†™ï¼Œè¡¨ç¤º â€œä»¥å¤ªç½‘â€ã€‚æœ‰äº›ç”µè„‘å¯èƒ½åŒæ—¶æœ‰å¥½å‡ æ¡ç½‘çº¿è¿ç€ï¼Œä¾‹å¦‚æœåŠ¡å™¨ï¼Œé‚£ä¹ˆé™¤äº†  <code>eht0</code>  ï¼Œä½ è¿˜ä¼šçœ‹åˆ°  <code>eth1</code>  ã€  <code>eth2</code>  ç­‰ã€‚</li>\n<li><code>lo</code>  è¡¨ç¤ºæœ¬åœ°å›ç¯ï¼ˆ  <code>Local Loopback</code>  çš„ç¼©å†™ï¼Œå¯¹åº”ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼‰å¯ä»¥çœ‹åˆ°å®ƒçš„  <code>ip</code>  åœ°å€æ˜¯  <code>127.0.0.1</code>  ã€‚æ¯å°ç”µè„‘éƒ½åº”è¯¥æœ‰è¿™ä¸ªæ¥å£ï¼Œå› ä¸ºå®ƒå¯¹åº”ç€ â€œè¿å‘è‡ªå·±çš„é“¾æ¥â€ã€‚è¿™ä¹Ÿæ˜¯è¢«ç§°ä¹‹ä¸º â€œæœ¬åœ°å›ç¯â€ çš„åŸå› ã€‚æ‰€æœ‰ç»ç”±è¿™ä¸ªæ¥å£å‘é€çš„ä¸œè¥¿éƒ½ä¼šå›åˆ°ä½ è‡ªå·±çš„ç”µè„‘ã€‚çœ‹èµ·æ¥å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä½†æœ‰æ—¶ä¸ºäº†æŸäº›ç¼˜æ•…ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥è‡ªå·±ã€‚ä¾‹å¦‚ç”¨æ¥æµ‹è¯•ä¸€ä¸ªç½‘ç»œç¨‹åºï¼Œä½†åˆä¸æƒ³è®©å±€åŸŸç½‘æˆ–å¤–ç½‘çš„ç”¨æˆ·æŸ¥çœ‹ï¼Œåªèƒ½åœ¨æ­¤å°ä¸»æœºä¸Šè¿è¡Œå’ŒæŸ¥çœ‹æ‰€æœ‰çš„ç½‘ç»œæ¥å£ã€‚ä¾‹å¦‚åœ¨æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªå‰ç«¯å·¥ç¨‹æ—¶ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥  <code>127.0.0.1:3000</code>  å¯åŠ¨é¡¹ç›®å°±èƒ½æŸ¥çœ‹åˆ°è‡ªå·±çš„  <code>web</code>  ç½‘ç«™ï¼Œå¹¶ä¸”å®ƒåªæœ‰ä½ èƒ½çœ‹åˆ°ã€‚</li>\n<li><code>wlan0</code>  è¡¨ç¤ºæ— çº¿å±€åŸŸç½‘ï¼ˆä¸Šé¢æ¡ˆä¾‹å¹¶æœªå±•ç¤ºï¼‰ã€‚</li>\n</ul>\n<h3 id=\"host\"><a class=\"anchor\" href=\"#host\">#</a> host</h3>\n<p><code>ip</code>  åœ°å€å’Œä¸»æœºåçš„äº’ç›¸è½¬æ¢ã€‚</p>\n<h4 id=\"è½¯ä»¶å®‰è£…\"><a class=\"anchor\" href=\"#è½¯ä»¶å®‰è£…\">#</a> è½¯ä»¶å®‰è£…</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> bind-utils</pre></td></tr></table></figure><h4 id=\"åŸºç¡€ç”¨æ³•-3\"><a class=\"anchor\" href=\"#åŸºç¡€ç”¨æ³•-3\">#</a> åŸºç¡€ç”¨æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># host github.com</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>baidu.com has address <span class=\"token number\">13.229</span>.188.59</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@lion ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># host 13.229.188.59</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">59.188</span>.229.13.in-addr.arpa domain name pointer ec2-13-229-188-59.ap-southeast-1.compute.amazonaws.com.</pre></td></tr></table></figure><h3 id=\"ssh-è¿æ¥è¿œç¨‹æœåŠ¡å™¨\"><a class=\"anchor\" href=\"#ssh-è¿æ¥è¿œç¨‹æœåŠ¡å™¨\">#</a> ssh è¿æ¥è¿œç¨‹æœåŠ¡å™¨</h3>\n<p>é€šè¿‡éå¯¹ç§°åŠ å¯†ä»¥åŠå¯¹ç§°åŠ å¯†çš„æ–¹å¼ï¼ˆåŒ  <code>HTTPS</code>  å®‰å…¨è¿æ¥åŸç†ç›¸ä¼¼ï¼‰è¿æ¥åˆ°è¿œç«¯æœåŠ¡å™¨ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> ç”¨æˆ·@ip:port</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">1</span>ã€ssh root@172.20.10.1:22 <span class=\"token comment\"># ç«¯å£å·å¯ä»¥çœç•¥ä¸å†™ï¼Œé»˜è®¤æ˜¯ 22 ç«¯å£</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span>ã€è¾“å…¥è¿æ¥å¯†ç åå°±å¯ä»¥æ“ä½œè¿œç«¯æœåŠ¡å™¨äº†</pre></td></tr></table></figure><h4 id=\"é…ç½®-ssh\"><a class=\"anchor\" href=\"#é…ç½®-ssh\">#</a> é…ç½® ssh</h4>\n<p><code>config</code>  æ–‡ä»¶å¯ä»¥é…ç½®  <code>ssh</code>  ï¼Œæ–¹ä¾¿æ‰¹é‡ç®¡ç†å¤šä¸ª  <code>ssh</code>  è¿æ¥ã€‚</p>\n<p>é…ç½®æ–‡ä»¶åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼š</p>\n<ul>\n<li>å…¨å±€  <code>ssh</code>  æœåŠ¡ç«¯çš„é…ç½®ï¼š  <code>/etc/ssh/sshd_config</code>  ï¼›</li>\n<li>å…¨å±€  <code>ssh</code>  å®¢æˆ·ç«¯çš„é…ç½®ï¼š  <code>/etc/ssh/ssh_config</code> ï¼ˆå¾ˆå°‘ä¿®æ”¹ï¼‰ï¼›</li>\n<li>å½“å‰ç”¨æˆ·  <code>ssh</code>  å®¢æˆ·ç«¯çš„é…ç½®ï¼š  <code>~/.ssh/config</code>  ã€‚</li>\n</ul>\n<p>ã€æœåŠ¡ç«¯  <code>config</code>  æ–‡ä»¶çš„å¸¸ç”¨é…ç½®å‚æ•°ã€‘</p>\n<table>\n<thead>\n<tr>\n<th>æœåŠ¡ç«¯ config å‚æ•°</th>\n<th>ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Port</td>\n<td>sshd æœåŠ¡ç«¯å£å·ï¼ˆé»˜è®¤æ˜¯ 22ï¼‰</td>\n</tr>\n<tr>\n<td>PermitRootLogin</td>\n<td>æ˜¯å¦å…è®¸ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ï¼ˆé»˜è®¤æ˜¯å¯ä»¥ï¼‰</td>\n</tr>\n<tr>\n<td>PasswordAuthentication</td>\n<td>æ˜¯å¦å…è®¸å¯†ç éªŒè¯ç™»å½•ï¼ˆé»˜è®¤æ˜¯å¯ä»¥ï¼‰</td>\n</tr>\n<tr>\n<td>PubkeyAuthentication</td>\n<td>æ˜¯å¦å…è®¸å…¬é’¥éªŒè¯ç™»å½•ï¼ˆé»˜è®¤æ˜¯å¯ä»¥ï¼‰</td>\n</tr>\n<tr>\n<td>PermitEmptyPasswords</td>\n<td>æ˜¯å¦å…è®¸ç©ºå¯†ç ç™»å½•ï¼ˆä¸å®‰å…¨ï¼Œé»˜è®¤ä¸å¯ä»¥ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>ä¿®æ”¹å®ŒæœåŠ¡ç«¯é…ç½®æ–‡ä»¶éœ€è¦é‡å¯æœåŠ¡  <code>systemctl restart sshd</code></p>\n</blockquote>\n<p>ã€å®¢æˆ·ç«¯  <code>config</code>  æ–‡ä»¶çš„å¸¸ç”¨é…ç½®å‚æ•°ã€‘</p>\n<table>\n<thead>\n<tr>\n<th>å®¢æˆ·ç«¯ config å‚æ•°</th>\n<th>ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Host</td>\n<td>åˆ«å</td>\n</tr>\n<tr>\n<td>HostName</td>\n<td>è¿œç¨‹ä¸»æœºåï¼ˆæˆ– IP åœ°å€ï¼‰</td>\n</tr>\n<tr>\n<td>Port</td>\n<td>è¿æ¥åˆ°è¿œç¨‹ä¸»æœºçš„ç«¯å£</td>\n</tr>\n<tr>\n<td>User</td>\n<td>ç”¨æˆ·å</td>\n</tr>\n</tbody>\n</table>\n<p>é…ç½®å½“å‰ç”¨æˆ·çš„  <code>config</code>  ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># åˆ›å»º config</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> ~/.ssh/config</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># å¡«å†™ä¸€ä¸‹å†…å®¹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Host lion <span class=\"token comment\"># åˆ«å</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tHostName <span class=\"token number\">172</span>.x.x.x <span class=\"token comment\"># ip åœ°å€</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  Port <span class=\"token number\">22</span> <span class=\"token comment\"># ç«¯å£</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  User root <span class=\"token comment\"># ç”¨æˆ·</span></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®å®Œæˆåï¼Œä¸‹æ¬¡ç™»å½•æ—¶ï¼Œå¯ä»¥è¿™æ ·ç™»å½•  <code>ssh lion</code>  ä¼šè‡ªåŠ¨è¯†åˆ«ä¸º  <code>root</code>  ç”¨æˆ·ã€‚</p>\n<blockquote>\n<p>è¿™æ®µé…ç½®ä¸æ˜¯åœ¨æœåŠ¡å™¨ä¸Šï¼Œè€Œæ˜¯ä½ è‡ªå·±çš„æœºå™¨ä¸Šï¼Œå®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ªåˆ«åã€‚</p>\n</blockquote>\n<h4 id=\"å…å¯†ç™»å½•\"><a class=\"anchor\" href=\"#å…å¯†ç™»å½•\">#</a> å…å¯†ç™»å½•</h4>\n<p><code>ssh</code>  ç™»å½•åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯åŸºäºå£ä»¤ï¼ˆè´¦å·å¯†ç ï¼‰ï¼Œå¦å¤–ä¸€ç§æ˜¯åŸºäºå¯†é’¥çš„æ–¹å¼ã€‚</p>\n<p>åŸºäºå£ä»¤ï¼Œå°±æ˜¯æ¯æ¬¡ç™»å½•è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œæ˜¾ç„¶è¿™æ ·åšæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œä»Šå¤©ä¸»è¦çœ‹ä¸€ä¸‹å¦‚ä½•åŸºäºå¯†é’¥å®ç°å…å¯†ç™»å½•ã€‚</p>\n<h5 id=\"åŸºäºå¯†é’¥éªŒè¯åŸç†\"><a class=\"anchor\" href=\"#åŸºäºå¯†é’¥éªŒè¯åŸç†\">#</a> åŸºäºå¯†é’¥éªŒè¯åŸç†</h5>\n<p>å®¢æˆ·æœºç”Ÿæˆå¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼ŒæŠŠå…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ¯æ¬¡ç™»å½•ä¼šä¸æœåŠ¡å™¨çš„å…¬é’¥è¿›è¡Œæ¯”è¾ƒï¼Œè¿™ç§éªŒè¯ç™»å½•çš„æ–¹æ³•æ›´åŠ å®‰å…¨ï¼Œä¹Ÿè¢«ç§°ä¸º â€œå…¬é’¥éªŒè¯ç™»å½•â€ã€‚</p>\n<h5 id=\"å…·ä½“å®ç°æ­¥éª¤\"><a class=\"anchor\" href=\"#å…·ä½“å®ç°æ­¥éª¤\">#</a> å…·ä½“å®ç°æ­¥éª¤</h5>\n<p>1ã€åœ¨å®¢æˆ·æœºä¸­ç”Ÿæˆå¯†é’¥å¯¹ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰  <code>ssh-keygen</code> ï¼ˆé»˜è®¤ä½¿ç”¨ RSA éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼‰</p>\n<p>è¿è¡Œå®Œ  <code>ssh-keygen</code>  ä¼šåœ¨  <code>~/.ssh/</code>  ç›®å½•ä¸‹ï¼Œç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š</p>\n<ul>\n<li><code>id_rsa.pub</code>  ï¼šå…¬é’¥</li>\n<li><code>id_rsa</code>  ï¼šç§é’¥</li>\n</ul>\n<p>2ã€æŠŠå®¢æˆ·æœºçš„å…¬é’¥ä¼ é€åˆ°æœåŠ¡</p>\n<p>æ‰§è¡Œ  <code>ssh-copy-id root@172.x.x.x</code> ï¼ˆ <code>ssh-copy-id</code>  å®ƒä¼šæŠŠå®¢æˆ·æœºçš„å…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨  <code>~/.ssh/authorized_keys</code>  çš„æ–‡ä»¶ä¸­ï¼‰ã€‚</p>\n<p>æ‰§è¡Œå®Œæˆåï¼Œè¿è¡Œ  <code>ssh root@172.x.x.x</code>  å°±å¯ä»¥å®ç°å…å¯†ç™»å½•æœåŠ¡å™¨äº†ã€‚</p>\n<p>é…åˆä¸Šé¢è®¾ç½®å¥½çš„åˆ«åï¼Œç›´æ¥æ‰§è¡Œ  <code>ssh lion</code>  å°±å¯ä»¥ç™»å½•ï¼Œæ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿ã€‚</p>\n<h3 id=\"wget\"><a class=\"anchor\" href=\"#wget\">#</a> wget</h3>\n<p>å¯ä»¥ä½¿æˆ‘ä»¬ç›´æ¥ä»ç»ˆç«¯æ§åˆ¶å°ä¸‹è½½æ–‡ä»¶ï¼Œåªéœ€è¦ç»™å‡ºæ–‡ä»¶çš„ HTTP æˆ– FTP åœ°å€ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> <span class=\"token punctuation\">[</span>å‚æ•°<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>URLåœ°å€<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wget</span> http://www.minjieren.com/wordpress-3.1-zh_CN.zip</pre></td></tr></table></figure><p><code>wget</code>  éå¸¸ç¨³å®šï¼Œå¦‚æœæ˜¯ç”±äºç½‘ç»œåŸå› ä¸‹è½½å¤±è´¥ï¼Œ  <code>wget</code>  ä¼šä¸æ–­å°è¯•ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæ¯•ã€‚</p>\n<h4 id=\"å¸¸ç”¨å‚æ•°-8\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-8\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-c</code>  ç»§ç»­ä¸­æ–­çš„ä¸‹è½½ã€‚</li>\n</ul>\n<h2 id=\"å¤‡ä»½\"><a class=\"anchor\" href=\"#å¤‡ä»½\">#</a> å¤‡ä»½</h2>\n<h3 id=\"scp\"><a class=\"anchor\" href=\"#scp\">#</a> scp</h3>\n<p>å®ƒæ˜¯  <code>Secure Copy</code>  çš„ç¼©å†™ï¼Œè¡¨ç¤ºå®‰å…¨æ‹·è´ã€‚  <code>scp</code>  å¯ä»¥ä½¿æˆ‘ä»¬é€šè¿‡ç½‘ç»œï¼ŒæŠŠæ–‡ä»¶ä»ä¸€å°ç”µè„‘æ‹·è´åˆ°å¦ä¸€å°ç”µè„‘ã€‚</p>\n<p><code>scp</code>  æ˜¯åŸºäº  <code>ssh</code>  çš„åŸç†æ¥è¿ä½œçš„ï¼Œ  <code>ssh</code>  ä¼šåœ¨ä¸¤å°é€šè¿‡ç½‘ç»œè¿æ¥çš„ç”µè„‘ä¹‹é—´åˆ›å»ºä¸€æ¡å®‰å…¨é€šä¿¡çš„ç®¡é“ï¼Œ  <code>scp</code>  å°±åˆ©ç”¨è¿™æ¡ç®¡é“å®‰å…¨åœ°æ‹·è´æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> source_file destination_file <span class=\"token comment\"># source_file è¡¨ç¤ºæºæ–‡ä»¶ï¼Œdestination_file è¡¨ç¤ºç›®æ ‡æ–‡ä»¶</span></pre></td></tr></table></figure><p>å…¶ä¸­  <code>source_file</code>  å’Œ  <code>destination_file</code>  éƒ½å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š  <code>user@ip:file_name</code>  ï¼Œ  <code>user</code>  æ˜¯ç™»å½•åï¼Œ  <code>ip</code>  æ˜¯åŸŸåæˆ–  <code>ip</code>  åœ°å€ã€‚  <code>file_name</code>  æ˜¯æ–‡ä»¶è·¯å¾„ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">scp</span> file.txt root@192.168.1.5:/root <span class=\"token comment\"># è¡¨ç¤ºæŠŠæˆ‘çš„ç”µè„‘ä¸­å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ file.txt æ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹ç”µè„‘</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">scp</span> root@192.168.1.5:/root/file.txt file.txt <span class=\"token comment\"># è¡¨ç¤ºæŠŠè¿œç¨‹ç”µè„‘ä¸Šçš„ file.txt æ–‡ä»¶æ‹·è´åˆ°æœ¬æœº</span></pre></td></tr></table></figure><h3 id=\"rsync\"><a class=\"anchor\" href=\"#rsync\">#</a> rsync</h3>\n<p><code>rsync</code>  å‘½ä»¤ä¸»è¦ç”¨äºè¿œç¨‹åŒæ­¥æ–‡ä»¶ã€‚å®ƒå¯ä»¥åŒæ­¥ä¸¤ä¸ªç›®å½•ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å¦å¤„äºåŒä¸€å°ç”µè„‘ã€‚å®ƒåº”è¯¥æ˜¯æœ€å¸¸ç”¨äº â€œå¢é‡å¤‡ä»½â€ çš„å‘½ä»¤äº†ã€‚å®ƒå°±æ˜¯æ™ºèƒ½ç‰ˆçš„  <code>scp</code>  å‘½ä»¤ã€‚</p>\n<h4 id=\"è½¯ä»¶å®‰è£…-2\"><a class=\"anchor\" href=\"#è½¯ä»¶å®‰è£…-2\">#</a> è½¯ä»¶å®‰è£…</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token function\">rsync</span></pre></td></tr></table></figure><h4 id=\"åŸºç¡€ç”¨æ³•-4\"><a class=\"anchor\" href=\"#åŸºç¡€ç”¨æ³•-4\">#</a> åŸºç¡€ç”¨æ³•</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rsync</span> -arv Images/ backups/ <span class=\"token comment\"># å°† Images ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤‡ä»½åˆ° backups ç›®å½•ä¸‹</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rsync</span> -arv Images/ root@192.x.x.x:backups/ <span class=\"token comment\"># åŒæ­¥åˆ°æœåŠ¡å™¨çš„ backups ç›®å½•ä¸‹</span></pre></td></tr></table></figure><h4 id=\"å¸¸ç”¨å‚æ•°-9\"><a class=\"anchor\" href=\"#å¸¸ç”¨å‚æ•°-9\">#</a> å¸¸ç”¨å‚æ•°</h4>\n<ul>\n<li><code>-a</code>  ä¿ç•™æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™ï¼Œä¿®æ”¹æ—¥æœŸç­‰ï¼›</li>\n<li><code>-r</code>  é€’å½’è°ƒç”¨ï¼Œè¡¨ç¤ºå­ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ä¹Ÿéƒ½åŒ…æ‹¬ï¼›</li>\n<li><code>-v</code>  å†—ä½™æ¨¡å¼ï¼Œè¾“å‡ºè¯¦ç»†æ“ä½œä¿¡æ¯ã€‚</li>\n</ul>\n<p>é»˜è®¤åœ°ï¼Œ  <code>rsync</code>  åœ¨åŒæ­¥æ—¶å¹¶ä¸ä¼šåˆ é™¤ç›®æ ‡ç›®å½•çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ä½ åœ¨æºç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ç”¨  <code>rsync</code>  åŒæ­¥æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šåˆ é™¤åŒæ­¥ç›®å½•ä¸­çš„ç›¸åŒæ–‡ä»¶ã€‚å¦‚æœå‘åˆ é™¤ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼š  <code>rsync -arv --delete Images/ backups/</code>  ã€‚</p>\n<h2 id=\"ç³»ç»Ÿ\"><a class=\"anchor\" href=\"#ç³»ç»Ÿ\">#</a> ç³»ç»Ÿ</h2>\n<h3 id=\"halt\"><a class=\"anchor\" href=\"#halt\">#</a> halt</h3>\n<p>å…³é—­ç³»ç»Ÿï¼Œéœ€è¦  <code>root</code>  èº«ä»½ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">halt</span></pre></td></tr></table></figure><h3 id=\"reboot\"><a class=\"anchor\" href=\"#reboot\">#</a> reboot</h3>\n<p>é‡å¯ç³»ç»Ÿï¼Œéœ€è¦  <code>root</code>  èº«ä»½ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">reboot</span></pre></td></tr></table></figure><h3 id=\"poweroff\"><a class=\"anchor\" href=\"#poweroff\">#</a> poweroff</h3>\n<p>ç›´æ¥è¿è¡Œå³å¯å…³æœºï¼Œä¸éœ€è¦  <code>root</code>  èº«ä»½ã€‚</p>\n<h1 id=\"vim-ç¼–è¾‘å™¨\"><a class=\"anchor\" href=\"#vim-ç¼–è¾‘å™¨\">#</a> Vim ç¼–è¾‘å™¨</h1>\n<h2 id=\"vim-æ˜¯ä»€ä¹ˆ\"><a class=\"anchor\" href=\"#vim-æ˜¯ä»€ä¹ˆ\">#</a> Vim æ˜¯ä»€ä¹ˆï¼Ÿ</h2>\n<p><code>Vim</code>  æ˜¯ä»  <code>vi</code>  å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚å…¶ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚å’Œ  <code>Emacs</code>  å¹¶åˆ—æˆä¸ºç±»  <code>Unix</code>  ç³»ç»Ÿç”¨æˆ·æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨ã€‚</p>\n<h2 id=\"vim-å¸¸ç”¨æ¨¡å¼\"><a class=\"anchor\" href=\"#vim-å¸¸ç”¨æ¨¡å¼\">#</a> Vim å¸¸ç”¨æ¨¡å¼</h2>\n<ul>\n<li>äº¤äº’æ¨¡å¼</li>\n<li>æ’å…¥æ¨¡å¼</li>\n<li>å‘½ä»¤æ¨¡å¼</li>\n<li>å¯è§†æ¨¡å¼</li>\n</ul>\n<h3 id=\"äº¤äº’æ¨¡å¼\"><a class=\"anchor\" href=\"#äº¤äº’æ¨¡å¼\">#</a> äº¤äº’æ¨¡å¼</h3>\n<p>ä¹Ÿæˆä¸ºæ­£å¸¸æ¨¡å¼ï¼Œè¿™æ˜¯  <code>Vim</code>  çš„é»˜è®¤æ¨¡å¼ï¼Œæ¯æ¬¡è¿è¡Œ  <code>Vim</code>  ç¨‹åºçš„æ—¶å€™ï¼Œå°±ä¼šè¿›å…¥è¿™ä¸ªæ¨¡å¼ã€‚</p>\n<p>ä¾‹å¦‚æ‰§è¡Œ  <code>vim name.txt</code>  åˆ™ä¼šè¿›å…¥äº¤äº’æ¨¡å¼ã€‚</p>\n<p>äº¤äº’æ¨¡å¼ç‰¹å¾ï¼š</p>\n<ul>\n<li>åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œä½ ä¸èƒ½è¾“å…¥æ–‡æœ¬ï¼›</li>\n<li>å®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨æ–‡æœ¬é—´ç§»åŠ¨ï¼Œåˆ é™¤ä¸€è¡Œæ–‡æœ¬ï¼Œå¤åˆ¶é»è´´æ–‡æœ¬ï¼Œè·³è½¬åˆ°æŒ‡å®šè¡Œï¼Œæ’¤é”€æ“ä½œï¼Œç­‰ç­‰ã€‚</li>\n</ul>\n<h3 id=\"æ’å…¥æ¨¡å¼\"><a class=\"anchor\" href=\"#æ’å…¥æ¨¡å¼\">#</a> æ’å…¥æ¨¡å¼</h3>\n<p>è¿™ä¸ªæ¨¡å¼æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„æ–‡æœ¬ç¼–è¾‘å™¨çš„æ¨¡å¼ï¼Œå°±æ˜¯å¯ä»¥è¾“å…¥ä»»ä½•ä½ æƒ³è¾“å…¥çš„å†…å®¹ã€‚è¿›å…¥è¿™ä¸ªæ¨¡å¼æœ‰å‡ ç§æ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯æŒ‰å­—æ¯é”®  <code>i</code>  ï¼ˆ  <code>iã€Iã€aã€Aã€oã€O</code>  éƒ½å¯ä»¥è¿›å…¥æ’å…¥æ¨¡å¼ï¼Œåªæ˜¯æ‰€å¤„çš„ä½ç½®ä¸åŒï¼‰ï¼Œé€€å‡ºè¿™ç§æ¨¡å¼ï¼Œåªéœ€è¦æŒ‰ä¸‹  <code>Esc</code>  é”®ã€‚</p>\n<ul>\n<li><code>i, I</code>  è¿›å…¥è¾“å…¥æ¨¡å¼  <code>Insert mode</code>  ï¼š  <code>i</code>  ä¸º â€œä»ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„è¾“å…¥â€ï¼Œ  <code>I</code>  ä¸º â€œåœ¨ç›®å‰æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºæ ¼ç¬¦å¤„å¼€å§‹è¾“å…¥â€ï¼›</li>\n<li><code>a, A</code>  è¿›å…¥è¾“å…¥æ¨¡å¼  <code>Insert mode</code>  ï¼š  <code>a</code>  ä¸º â€œä»ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥â€ï¼Œ  <code>A</code>  ä¸º â€œä»å…‰æ ‡æ‰€åœ¨è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥â€ï¼›</li>\n<li><code>o, O</code>  è¿›å…¥è¾“å…¥æ¨¡å¼  <code>Insert mode</code>  ï¼š  <code>o</code>  ä¸º â€œåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡Œâ€ï¼›  <code>O</code>  ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„çš„ä¸Šä¸€è¡Œè¾“å…¥æ–°çš„ä¸€è¡Œã€‚</li>\n</ul>\n<h3 id=\"å‘½ä»¤æ¨¡å¼\"><a class=\"anchor\" href=\"#å‘½ä»¤æ¨¡å¼\">#</a> å‘½ä»¤æ¨¡å¼</h3>\n<blockquote>\n<p>å‘½ä»¤æ¨¡å¼ä¹Ÿç§°ä¸ºåº•çº¿å‘½ä»¤æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹å¯ä»¥è¿è¡Œä¸€äº›å‘½ä»¤ä¾‹å¦‚ â€œé€€å‡ºâ€ï¼Œâ€œä¿å­˜â€ï¼Œç­‰åŠ¨ä½œã€‚<br />\nä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ¨¡å¼æ¥æ¿€æ´»ä¸€äº›  <code>Vim</code>  é…ç½®ï¼Œä¾‹å¦‚è¯­æ³•é«˜äº®ï¼Œæ˜¾ç¤ºè¡Œå·ï¼Œç­‰ã€‚ç”šè‡³è¿˜å¯ä»¥å‘é€ä¸€äº›å‘½ä»¤ç»™ç»ˆç«¯å‘½ä»¤è¡Œï¼Œä¾‹å¦‚  <code>lsã€cp</code>  ã€‚</p>\n</blockquote>\n<p>ä¸ºäº†è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œé¦–å…ˆè¦è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œå†æŒ‰ä¸‹å†’å·é”®ã€‚<br />\nç”¨ä¸€å¼ å›¾è¡¨ç¤ºä¸‰ç§æ¨¡å¼å¦‚ä½•åˆ‡æ¢ï¼š</p>\n<p><img data-src=\"/assets/2022-8/15.png\" alt=\"image.png\" /></p>\n<h2 id=\"åŸºæœ¬æ“ä½œ\"><a class=\"anchor\" href=\"#åŸºæœ¬æ“ä½œ\">#</a> åŸºæœ¬æ“ä½œ</h2>\n<h3 id=\"æ‰“å¼€-vim\"><a class=\"anchor\" href=\"#æ‰“å¼€-vim\">#</a> æ‰“å¼€ Vim</h3>\n<p>åœ¨ç»ˆç«¯å‘½ä»¤è¡Œä¸­è¾“å…¥  <code>vim</code>  å›è½¦å  <code>Vim</code>  å°±ä¼šè¢«è¿è¡Œèµ·æ¥ï¼Œä¹Ÿå¯ä»¥ç”¨  <code>Vim</code>  æ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œåªéœ€è¦åœ¨  <code>vim</code>  åé¢å†åŠ æ–‡ä»¶åã€‚å¦‚  <code>vim file.name</code>  ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šè¢«åˆ›å»ºã€‚</p>\n<h3 id=\"æ’å…¥\"><a class=\"anchor\" href=\"#æ’å…¥\">#</a> æ’å…¥</h3>\n<p>è¿›å…¥æ–‡ä»¶ä¹‹åï¼Œæ­¤æ—¶å¤„äºäº¤äº’æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡è¾“å…¥  <code>i</code>  è¿›å…¥æ’å…¥æ¨¡å¼ã€‚</p>\n<h3 id=\"ç§»åŠ¨\"><a class=\"anchor\" href=\"#ç§»åŠ¨\">#</a> ç§»åŠ¨</h3>\n<p>åœ¨  <code>Vim</code>  çš„äº¤äº’æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–‡æœ¬ä¸­ç§»åŠ¨å…‰æ ‡ã€‚</p>\n<ul>\n<li><code>h</code>  å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</li>\n<li><code>j</code>  å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</li>\n<li><code>k</code>  å‘ä¸Šç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</li>\n<li><code>i</code>  å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</li>\n</ul>\n<blockquote>\n<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å››ä¸ªæ–¹å‘é”®è¿›è¡Œç§»åŠ¨ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p>\n</blockquote>\n<h3 id=\"è·³è‡³è¡Œé¦–å’Œè¡Œæœ«\"><a class=\"anchor\" href=\"#è·³è‡³è¡Œé¦–å’Œè¡Œæœ«\">#</a> è·³è‡³è¡Œé¦–å’Œè¡Œæœ«</h3>\n<ul>\n<li>è¡Œé¦–ï¼šåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œä¸ºäº†å°†å…‰æ ‡å®šä½åˆ°ä¸€è¡Œçš„å¼€å§‹ä½ç½®ï¼Œåªéœ€è¦æŒ‰ä¸‹æ•°å­—é”®  <code>0</code>  å³å¯ï¼Œé”®ç›˜ä¸Šçš„  <code>Home</code>  é”®ä¹Ÿæœ‰ç›¸åŒæ•ˆæœã€‚</li>\n<li>è¡Œæœ«ï¼šåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œä¸ºäº†å°†å…‰æ ‡å®šä½åˆ°ä¸€è¡Œçš„æœ«å°¾ï¼Œåªéœ€è¦æŒ‰ä¸‹ç¾å…ƒç¬¦å·é”®  <code>$</code>  å³å¯ï¼Œé”®ç›˜ä¸Šçš„  <code>End</code>  é”®ä¹Ÿæœ‰ç›¸åŒæ•ˆæœã€‚</li>\n</ul>\n<h3 id=\"æŒ‰å•è¯ç§»åŠ¨\"><a class=\"anchor\" href=\"#æŒ‰å•è¯ç§»åŠ¨\">#</a> æŒ‰å•è¯ç§»åŠ¨</h3>\n<p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼ŒæŒ‰å­—æ¯é”®  <code>w</code>  å¯ä»¥ä¸€ä¸ªå•è¯ä¸€ä¸ªå•è¯çš„ç§»åŠ¨ã€‚</p>\n<h3 id=\"é€€å‡ºæ–‡ä»¶\"><a class=\"anchor\" href=\"#é€€å‡ºæ–‡ä»¶\">#</a> é€€å‡ºæ–‡ä»¶</h3>\n<p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼ŒæŒ‰ä¸‹å†’å·é”®  <code>:</code>  è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œå†æŒ‰ä¸‹  <code>q</code>  é”®ï¼Œå°±å¯ä»¥é€€å‡ºäº†ã€‚</p>\n<p>å¦‚æœåœ¨é€€å‡ºä¹‹å‰åˆä¿®æ”¹äº†æ–‡ä»¶ï¼Œå°±ç›´æ¥æƒ³ç”¨  <code>:q</code>  é€€å‡º  <code>Vim</code>  ï¼Œé‚£ä¹ˆ  <code>Vim</code>  ä¼šæ˜¾ç¤ºä¸€ä¸ªçº¢å­—æ ‡æ˜é”™è¯¯ä¿¡æ¯ã€‚æ­¤æ—¶æˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p>\n<ol>\n<li>ä¿å­˜å¹¶é€€å‡º  <code>:wq</code>  æˆ–  <code>:x</code>  ï¼›</li>\n<li>ä¸ä¿å­˜ä¸”é€€å‡º  <code>:q!</code>  ã€‚</li>\n</ol>\n<h2 id=\"æ ‡å‡†æ“ä½œ\"><a class=\"anchor\" href=\"#æ ‡å‡†æ“ä½œ\">#</a> æ ‡å‡†æ“ä½œ</h2>\n<h3 id=\"åˆ é™¤å­—ç¬¦\"><a class=\"anchor\" href=\"#åˆ é™¤å­—ç¬¦\">#</a> åˆ é™¤å­—ç¬¦</h3>\n<p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡å®šä½åˆ°ä¸€ä¸ªä½ æƒ³è¦åˆ é™¤çš„å­—ç¬¦ä¸Šï¼ŒæŒ‰ä¸‹å­—æ¯é”®  <code>x</code>  ä½ ä¼šå‘ç°è¿™ä¸ªå­—ç¬¦è¢«åˆ é™¤äº†ã€‚<br />\nä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå­—ç¬¦ï¼Œåªéœ€è¦åœ¨æŒ‰  <code>x</code>  é”®ä¹‹å‰è¾“å…¥æ•°å­—å³å¯ã€‚</p>\n<h3 id=\"åˆ é™¤å‰ªåˆ‡å•è¯è¡Œ\"><a class=\"anchor\" href=\"#åˆ é™¤å‰ªåˆ‡å•è¯è¡Œ\">#</a> åˆ é™¤ï¼ˆå‰ªåˆ‡ï¼‰å•è¯ï¼Œè¡Œ</h3>\n<ul>\n<li>åˆ é™¤ä¸€è¡Œï¼šè¿æŒ‰ä¸¤æ¬¡  <code>d</code>  æ¥åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œã€‚</li>\n<li>åˆ é™¤å¤šè¡Œï¼šä¾‹å¦‚å…ˆè¾“å…¥æ•°å­—  <code>2</code>  ï¼Œå†æŒ‰ä¸‹  <code>dd</code>  ï¼Œå°±ä¼šåˆ é™¤ä»å…‰æ ‡æ‰€åœ¨è¡Œå¼€å§‹çš„ä¸¤è¡Œã€‚</li>\n<li>åˆ é™¤ä¸€ä¸ªå•è¯ï¼šå°†å…‰æ ‡ç½®äºä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å¤„ï¼Œç„¶åæŒ‰ä¸‹  <code>dw</code>  ã€‚</li>\n<li>åˆ é™¤å¤šä¸ªå•è¯ï¼šä¾‹å¦‚å…ˆæŒ‰æ•°å­—é”®  <code>2</code>  å†æŒ‰  <code>dw</code>  å°±å¯ä»¥åˆ é™¤ä¸¤ä¸ªå•è¯äº†ã€‚</li>\n<li>ä»å…‰æ ‡æ‰€åœ¨ä½ç½®åˆ é™¤è‡³è¡Œé¦–ï¼š  <code>d0</code>  ã€‚</li>\n<li>ä»å…‰æ ‡æ‰€åœ¨ä½ç½®åˆ é™¤è‡³è¡Œæœ«ï¼š  <code>d$</code>  ã€‚</li>\n</ul>\n<h3 id=\"å¤åˆ¶å•è¯è¡Œ\"><a class=\"anchor\" href=\"#å¤åˆ¶å•è¯è¡Œ\">#</a> å¤åˆ¶å•è¯ï¼Œè¡Œ</h3>\n<ul>\n<li>å¤åˆ¶è¡Œï¼šæŒ‰ä¸¤æ¬¡  <code>y</code>  ä¼šæŠŠå…‰æ ‡æ‰€åœ¨è¡Œå¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œå’Œ  <code>dd</code>  ç±»ä¼¼ï¼Œ  <code>dd</code>  ç”¨äº â€œå‰ªåˆ‡â€ å…‰æ ‡æ‰€åœ¨è¡Œã€‚</li>\n<li>å¤åˆ¶å•è¯ï¼š  <code>yw</code>  ä¼šå¤åˆ¶ä¸€ä¸ªå•è¯ã€‚</li>\n<li>å¤åˆ¶åˆ°è¡Œæœ«ï¼š  <code>y$</code>  æ˜¯å¤åˆ¶ä»å…‰æ ‡æ‰€åœ¨å¤„åˆ°è¡Œæœ«çš„æ‰€æœ‰å­—ç¬¦ã€‚</li>\n<li>å¤åˆ¶åˆ°è¡Œé¦–ï¼š  <code>y0</code>  æ˜¯å¤åˆ¶å…‰æ ‡æ‰€åœ¨å¤„åˆ°è¡Œé¦–çš„æ‰€æœ‰å­—ç¬¦ã€‚</li>\n</ul>\n<h3 id=\"ç²˜è´´\"><a class=\"anchor\" href=\"#ç²˜è´´\">#</a> ç²˜è´´</h3>\n<p>å¦‚æœä¹‹å‰ç”¨  <code>dd</code>  æˆ–è€…  <code>yy</code>  å‰ªåˆ‡å¤åˆ¶è¿‡æ¥çš„ï¼Œå¯ä»¥ä½¿ç”¨  <code>p</code>  æ¥ç²˜è´´ã€‚åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨  <code>æ•°å­—+p</code>  æ¥è¡¨ç¤ºå¤åˆ¶å¤šæ¬¡ã€‚</p>\n<h3 id=\"æ›¿æ¢ä¸€ä¸ªå­—ç¬¦\"><a class=\"anchor\" href=\"#æ›¿æ¢ä¸€ä¸ªå­—ç¬¦\">#</a> æ›¿æ¢ä¸€ä¸ªå­—ç¬¦</h3>\n<p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡ç½®äºæƒ³è¦æ›¿æ¢çš„å­—ç¬¦ä¸Šã€‚æŒ‰ä¸‹  <code>r</code>  é”®ï¼Œæ¥ç€è¾“å…¥ä½ è¦æ›¿æ¢çš„å­—ç¬¦å³å¯ã€‚</p>\n<h3 id=\"æ’¤é”€æ“ä½œ\"><a class=\"anchor\" href=\"#æ’¤é”€æ“ä½œ\">#</a> æ’¤é”€æ“ä½œ</h3>\n<p>å¦‚æœè¦æ’¤é”€æœ€è¿‘çš„ä¿®æ”¹ï¼Œåªéœ€è¦æŒ‰ä¸‹  <code>u</code>  é”®ï¼Œå¦‚æœæƒ³è¦æ’¤é”€æœ€è¿‘å››æ¬¡ä¿®æ”¹ï¼Œå¯ä»¥æŒ‰ä¸‹ 4ï¼Œå†æŒ‰ä¸‹  <code>u</code>  ã€‚</p>\n<h3 id=\"é‡åš\"><a class=\"anchor\" href=\"#é‡åš\">#</a> é‡åš</h3>\n<p>å–æ¶ˆæ’¤é”€ï¼Œä¹Ÿå°±æ˜¯é‡åšä¹‹å‰çš„ä¿®æ”¹ä½¿ç”¨  <code>ctrl + r</code>  ã€‚</p>\n<h3 id=\"è·³è½¬åˆ°æŒ‡å®šè¡Œ\"><a class=\"anchor\" href=\"#è·³è½¬åˆ°æŒ‡å®šè¡Œ\">#</a> è·³è½¬åˆ°æŒ‡å®šè¡Œ</h3>\n<p><code>Vim</code>  ç¼–è¾‘çš„æ–‡ä»¶ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªè¡Œå·ï¼Œè¡Œå·ä» 1 å¼€å§‹ï¼Œé€ä¸€é€’å¢ã€‚</p>\n<p>è¡Œå·é»˜è®¤æ˜¯ä¸æ˜¾ç¤ºï¼Œå¦‚æœéœ€è¦å®ƒæ˜¾ç¤ºçš„è¯ï¼Œå¯ä»¥è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œç„¶åè¾“å…¥  <code>set nu</code>  ï¼Œå¦‚æœè¦éšè—è¡Œå·çš„è¯ï¼Œä½¿ç”¨  <code>set nonu</code>  ã€‚</p>\n<ul>\n<li>è·³è½¬åˆ°æŒ‡å®šè¡Œï¼š  <code>æ•°å­—+gg</code>  ï¼Œä¾‹å¦‚  <code>7gg</code>  ï¼Œè¡¨ç¤ºè·³è½¬åˆ°ç¬¬ 7 è¡Œã€‚</li>\n<li>è¦è·³è½¬åˆ°æœ€åä¸€è¡Œï¼ŒæŒ‰ä¸‹  <code>G</code>  ã€‚</li>\n<li>è¦è·³è½¬åˆ°ç¬¬ä¸€è¡Œï¼ŒæŒ‰ä¸‹  <code>gg</code>  ã€‚</li>\n</ul>\n<h2 id=\"é«˜çº§æ“ä½œ\"><a class=\"anchor\" href=\"#é«˜çº§æ“ä½œ\">#</a> é«˜çº§æ“ä½œ</h2>\n<h3 id=\"æŸ¥æ‰¾\"><a class=\"anchor\" href=\"#æŸ¥æ‰¾\">#</a> æŸ¥æ‰¾</h3>\n<p>å¤„äºäº¤äº’æ¨¡å¼ä¸‹ï¼ŒæŒ‰ä¸‹  <code>/</code>  é”®ï¼Œé‚£ä¹ˆå°±è¿›å…¥æŸ¥æ‰¾æ¨¡å¼ï¼Œè¾“å…¥ä½ è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ï¼Œç„¶åæŒ‰ä¸‹å›è½¦ã€‚å…‰æ ‡å°±ä¼šè·³è½¬åˆ°æ–‡ä»¶ä¸­ä¸‹ä¸€ä¸ªæŸ¥æ‰¾åˆ°çš„åŒ¹é…å¤„ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šæ˜¾ç¤º  <code>&quot;pattern not found&quot;</code>  ã€‚</p>\n<ul>\n<li><code>n</code>  è·³è½¬åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹ï¼›</li>\n<li><code>N</code>  è·³è½¬åˆ°ä¸Šä¸€ä¸ªåŒ¹é…é¡¹ã€‚</li>\n</ul>\n<blockquote>\n<p>ç”¨æ–œæ æ¥è¿›è¡Œçš„æŸ¥æ‰¾æ˜¯ä»å½“å‰å…‰æ ‡å¤„å¼€å§‹å‘æ–‡ä»¶å°¾æœç´¢ï¼Œå¦‚æœä½ è¦ä»å½“å‰å…‰æ ‡å¤„å¼€å§‹ï¼Œå‘æ–‡ä»¶å¤´æœç´¢åˆ™ä½¿ç”¨  <code>?</code>  ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å…ˆæŒ‰ä¸‹  <code>gg</code>  è·³è½¬åˆ°ç¬¬ä¸€è¡Œåœ¨è¿›è¡Œå…¨æ–‡æœç´¢ã€‚</p>\n</blockquote>\n<h3 id=\"æŸ¥æ‰¾å¹¶æ›¿æ¢\"><a class=\"anchor\" href=\"#æŸ¥æ‰¾å¹¶æ›¿æ¢\">#</a> æŸ¥æ‰¾å¹¶æ›¿æ¢</h3>\n<p>æ›¿æ¢å…‰æ ‡æ‰€åœ¨è¡Œç¬¬ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># è¯­æ³•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:s/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># å®ä¾‹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>:s/one/two</pre></td></tr></table></figure><p>æ›¿æ¢å…‰æ ‡æ‰€åœ¨è¡Œæ‰€æœ‰æ—§å­—ç¬¦ä¸²ä¸ºæ–°å­—ç¬¦ä¸²ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># è¯­æ³•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:s/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g</pre></td></tr></table></figure><p>æ›¿æ¢ç¬¬å‡ è¡Œåˆ°ç¬¬å‡ è¡Œä¸­æ‰€æœ‰å­—ç¬¦ä¸²ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># è¯­æ³•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:n,m s/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># å®ä¾‹</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>:2,4 s/one/two/g</pre></td></tr></table></figure><p>æœ€å¸¸ç”¨çš„å°±æ˜¯å…¨æ–‡æ›¿æ¢äº†ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># è¯­æ³•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:%s/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g</pre></td></tr></table></figure><h3 id=\"åˆå¹¶æ–‡ä»¶\"><a class=\"anchor\" href=\"#åˆå¹¶æ–‡ä»¶\">#</a> åˆå¹¶æ–‡ä»¶</h3>\n<p>å¯ä»¥ç”¨å†’å·  <code>+r</code>  (  <code>:r</code>  ) å®ç°åœ¨å…‰æ ‡å¤„æ’å…¥ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>:r filename <span class=\"token comment\"># å¯ä»¥ç”¨ Tab é”®æ¥è‡ªåŠ¨è¡¥å…¨å¦å¤–ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„</span></pre></td></tr></table></figure><h3 id=\"åˆ†å±\"><a class=\"anchor\" href=\"#åˆ†å±\">#</a> åˆ†å±</h3>\n<p><code>Vim</code>  æœ‰ä¸€ä¸ªç‰¹åˆ«ä¾¿æ·çš„åŠŸèƒ½é‚£å°±æ˜¯åˆ†å±ï¼Œå¯ä»¥åŒæ—¶æ‰“å¼€å¥½å‡ ä¸ªæ–‡ä»¶ï¼Œåˆ†å±ä¹‹åï¼Œå±å¹•æ¯ä¸€å—è¢«ç§°ä¸ºä¸€ä¸ª  <code>viewport</code>  ï¼Œè¡¨ç¤º â€œè§†å£â€ã€‚</p>\n<ul>\n<li>æ¨ªå‘åˆ†å±  <code>:sp æ–‡ä»¶å</code></li>\n<li>å‚ç›´åˆ†å±  <code>:vsp æ–‡ä»¶å</code></li>\n</ul>\n<h4 id=\"åˆ†å±æ¨¡å¼ä¸‹çš„å¿«æ·é”®\"><a class=\"anchor\" href=\"#åˆ†å±æ¨¡å¼ä¸‹çš„å¿«æ·é”®\">#</a> åˆ†å±æ¨¡å¼ä¸‹çš„å¿«æ·é”®</h4>\n<ul>\n<li><code>Ctrl + w</code>  å†åŠ   <code>Ctrl + w</code>  ï¼Œè¡¨ç¤ºä»ä¸€ä¸ª  <code>viewport</code>  ç§»åŠ¨å…‰æ ‡åˆ°å¦å¤–ä¸€ä¸ª  <code>viewport</code>  ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ  â€œæ–¹å‘é”®â€ï¼Œå°±å¯ä»¥ç§»åŠ¨åˆ°è¿™ä¸ªæ–¹å‘æ‰€å¤„çš„ä¸‹ä¸€ä¸ªè§†å£äº†ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>+</code>  å·ï¼Œè¡¨ç¤ºæ‰©å¤§å½“å‰è§†å£ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>-</code>  å·ï¼Œè¡¨ç¤ºç¼©å°å½“å‰è§†å£ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>=</code>  å·ï¼Œè¡¨ç¤ºå¹³å‡å½“å‰è§†å£ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>r</code>  é”®ï¼Œä¼šåå‘è°ƒæ¢è§†å£ä½ç½®ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>q</code>  é”®ï¼Œä¼šå…³é—­å½“å‰è§†å£ï¼›</li>\n<li><code>Ctrl + w</code>  å†åŠ   <code>o</code>  é”®ï¼Œä¼šå…³é—­é™¤å½“å‰è§†å£ä»¥å¤–çš„æ‰€æœ‰è§†å£ï¼›</li>\n</ul>\n<h3 id=\"è¿è¡Œå¤–éƒ¨å‘½ä»¤\"><a class=\"anchor\" href=\"#è¿è¡Œå¤–éƒ¨å‘½ä»¤\">#</a> è¿è¡Œå¤–éƒ¨å‘½ä»¤  <code>:!</code></h3>\n<p>åœ¨  <code>Vim</code>  ä¸­å¯ä»¥è¿è¡Œä¸€äº›ç»ˆç«¯å‘½ä»¤ï¼Œåªè¦å…ˆè¾“å…¥  <code>:!</code>  ï¼Œç„¶åæ¥å‘½ä»¤åç§°ã€‚</p>\n<p>ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">:</span><span class=\"token operator\">!</span>ls # åœ¨Vimä¸­æ‰“å¼€çš„æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è¿è¡Œlså‘½ä»¤</pre></td></tr></table></figure><h3 id=\"å¯è§†æ¨¡å¼\"><a class=\"anchor\" href=\"#å¯è§†æ¨¡å¼\">#</a> å¯è§†æ¨¡å¼</h3>\n<p>å‰é¢åªè®²äº†  <code>Vim</code>  çš„ä¸‰ç§æ¨¡å¼ï¼Œå…¶å®è¿˜æœ‰ä¸€ç§æ¨¡å¼å«åšå¯è§†æ¨¡å¼ã€‚</p>\n<p>è¿›å…¥å®ƒçš„ä¸‰ç§æ–¹å¼ï¼ˆéƒ½æ˜¯ä»äº¤äº’æ¨¡å¼å¼€å§‹ï¼‰ï¼š</p>\n<ul>\n<li><code>v</code>  å­—ç¬¦å¯è§†æ¨¡å¼ï¼Œè¿›å…¥åé…åˆæ–¹å‘é”®é€‰ä¸­å­—ç¬¦åï¼Œç„¶åå†æŒ‰  <code>d</code>  é”®å¯ä»¥åˆ é™¤é€‰ä¸­ã€‚</li>\n<li><code>V</code>  è¡Œå¯è§†æ¨¡å¼ï¼Œè¿›å…¥åå…‰æ ‡æ‰€åœ¨è¡Œé»˜è®¤è¢«é€‰ä¸­ï¼Œç„¶åå†æŒ‰  <code>d</code>  é”®å¯ä»¥åˆ é™¤æ‰€åœ¨è¡Œã€‚</li>\n<li><code>Ctrl + v</code>  å—å¯è§†æ¨¡å¼ï¼Œå®ƒæ˜¯å¯è§†æ¨¡å¼æœ€æœ‰ç”¨çš„åŠŸèƒ½äº†ï¼Œé…åˆ  <code>d</code>  å’Œ  <code>I</code>  é”®å¯ä»¥å®ç°åˆ é™¤é€‰ä¸­çš„å†…å®¹å’Œæ’å…¥å†…å®¹ã€‚</li>\n</ul>\n<p>åŒæ—¶é€‰ä¸­å¤šè¡Œï¼Œå¹¶åœ¨é€‰ä¸­è¡Œå¤´éƒ¨æ’å…¥å†…å®¹çš„å…·ä½“æ“ä½œæ­¥éª¤ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>. ctrl + <span class=\"token function\">v</span> è¿›å…¥å—å¯è§†æ¨¡å¼</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">2</span>. ä½¿ç”¨æ–¹å‘é”®è¿›è¡Œé€‰ä¸­ï¼ˆä¸Šä¸‹å·¦å³ï¼‰å‡è®¾é€‰ä¸­5è¡Œ</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">3</span>. è¾“å…¥ I é”®è¿›è¡Œå¤šè¡ŒåŒæ—¶æ’å…¥æ“ä½œ</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">4</span>. æ’å…¥å®Œæˆåè¿ç»­æŒ‰ä¸¤ä¸‹ esc é”®ï¼Œå®ç°å¤šè¡ŒåŒæ—¶æ’å…¥ç›¸åŒå­—ç¬¦</pre></td></tr></table></figure><p>è¿›å…¥å¯è§†æ¨¡å¼ä¹‹åçš„æ“ä½œé”®ï¼š</p>\n<ul>\n<li><code>d</code>  é”®ï¼Œè¡¨ç¤ºåˆ é™¤é€‰ä¸­ï¼›</li>\n<li><code>I</code>  é”®ï¼Œè¡¨ç¤ºåœ¨é€‰ä¸­ä¹‹å‰æ’å…¥ï¼›</li>\n<li><code>u</code>  é”®ï¼Œè¡¨ç¤ºé€‰ä¸­å˜ä¸ºå°å†™ï¼›</li>\n<li><code>U</code>  é”®ï¼Œè¡¨ç¤ºé€‰ä¸­å˜ä¸ºå¤§å†™ï¼›</li>\n</ul>\n<h2 id=\"vim-é…ç½®\"><a class=\"anchor\" href=\"#vim-é…ç½®\">#</a> Vim é…ç½®</h2>\n<h3 id=\"é€‰é¡¹å‚æ•°\"><a class=\"anchor\" href=\"#é€‰é¡¹å‚æ•°\">#</a> é€‰é¡¹å‚æ•°</h3>\n<p>åœ¨  <code>Vim</code>  è¢«å¯åŠ¨åï¼Œå¯ä»¥è¿è¡Œä¸€äº›æŒ‡ä»¤æ¥æ¿€æ´»ä¸€äº›é€‰é¡¹å‚æ•°ï¼Œä½†æ˜¯è¿™äº›é€‰é¡¹å‚æ•°çš„é…ç½®åœ¨é€€å‡º  <code>Vim</code>  æ—¶ä¼šè¢«å¿˜è®°ï¼Œä¾‹å¦‚å‰é¢è®²è§£çš„æ¿€æ´»è¡Œå·ã€‚å¦‚æœå¸Œæœ›æ‰€åœ¨çš„é…ç½®æ˜¯æ°¸ä¹…æ€§çš„ï¼Œé‚£ä¹ˆéœ€è¦åœ¨å®¶ç›®å½•ï¼ˆ  <code>cd ~</code>  ï¼‰åˆ›å»ºä¸€ä¸ª  <code>Vim</code>  çš„é…ç½®æ–‡ä»¶  <code>.vimrc</code>  ã€‚</p>\n<h3 id=\"vimrc\"><a class=\"anchor\" href=\"#vimrc\">#</a> .vimrc</h3>\n<pre><code class=\"language-å¤åˆ¶ä»£ç \">set number &quot; æ˜¾ç¤ºè¡Œå·\nsyntax on &quot; æ¿€æ´»è¯­æ³•é«˜äº®\nset showcmd &quot; å®æ—¶çœ‹åˆ°è¾“å…¥çš„å‘½ä»¤\nset ignorecase &quot; æœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™\nset mouse=a &quot; æ¿€æ´»é¼ æ ‡ï¼Œç”¨é¼ æ ‡é€‰ä¸­æ—¶ç›¸å½“äºè¿›å…¥å¯è§†æ¨¡å¼\n</code></pre>\n<p><code>Vim</code>  é…ç½®éå¸¸ä¸°å¯Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ªæ€§åŒ–é…ç½®æŠŠ  <code>Vim</code>  æ‰“é€ æˆå±äºè‡ªå·±çš„  <code>IDE</code>  ç­‰ç­‰ã€‚åœ¨  <code>github</code>  ä¸Šä¹Ÿå¯ä»¥æœç´¢åˆ°ä¸€äº›å¼ºå¤§çš„  <code>Vim</code>  é…ç½®æ–‡ä»¶ã€‚</p>\n<h1 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h1>\n<p>ç›¸ä¿¡é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œå¤§å®¶åº”è¯¥ä¼šå¯¹  <code>Linux</code>  æœ‰ä¸€ä¸ªæ›´åŠ å…¨é¢çš„è®¤è¯†ã€‚</p>\n",
            "tags": [
                "Java",
                "æŠ€æœ¯å®è·µ",
                "é¢è¯•",
                "ç¬”è®°",
                "Linux"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/4/7889e7e4c198/",
            "url": "https://shaogezhu.cn/2022/4/7889e7e4c198/",
            "title": "Mybatis-Pluså¸¸ç”¨æ–¹æ³•æ€»ç»“",
            "date_published": "2022-04-10T12:02:00.000Z",
            "content_html": "<div class=\"note info\">\n<p>âœ¨mybatis-plus æ˜¯ç°åœ¨æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ’ä»¶ï¼Œæå¤§çš„æé«˜äº†æˆ‘ä»¬å¼€å‘çš„æ•ˆç‡ã€‚è¿™ç¯‡æ–‡ç« å°±æ€»ç»“ä¸€ä¸‹ï¼Œmybatis-plus çš„åŸºç¡€æ“ä½œã€‚</p>\n</div>\n<br>\n<h2 id=\"å¸¸ç”¨æ³¨è§£\"><a class=\"anchor\" href=\"#å¸¸ç”¨æ³¨è§£\">#</a> å¸¸ç”¨æ³¨è§£</h2>\n<h3 id=\"tablename\"><a class=\"anchor\" href=\"#tablename\">#</a> @TableName</h3>\n<p>è¿™ä¸ªæ³¨è§£ç”¨åœ¨ç±»ä¸Šï¼Œå£°æ˜å½“å‰ç±»å…³è”çš„è¡¨åç§°ï¼Œå¯ä»¥é…ç½®ä¸‹åˆ—å±æ€§ï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å±æ€§</th>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å¿…é¡»æŒ‡å®š</th>\n<th style=\"text-align:center\">é»˜è®¤å€¼</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">value</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td>è¡¨å</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">schema</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td>schema</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">keepGlobalPrefix</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">false</td>\n<td>æ˜¯å¦ä¿æŒä½¿ç”¨å…¨å±€çš„ tablePrefix çš„å€¼ (å¦‚æœè®¾ç½®äº†å…¨å±€ tablePrefix ä¸”è‡ªè¡Œè®¾ç½®äº† value çš„å€¼)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">resultMap</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td>xml ä¸­ resultMap çš„ id</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">autoResultMap</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">false</td>\n<td>æ˜¯å¦è‡ªåŠ¨æ„å»º resultMap å¹¶ä½¿ç”¨ (å¦‚æœè®¾ç½® resultMap åˆ™ä¸ä¼šè¿›è¡Œ resultMap çš„è‡ªåŠ¨æ„å»ºå¹¶æ³¨å…¥)</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"tableid\"><a class=\"anchor\" href=\"#tableid\">#</a> @TableId</h3>\n<ul>\n<li>æè¿°ï¼šä¸»é”®æ³¨è§£</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å±æ€§</th>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å¿…é¡»æŒ‡å®š</th>\n<th style=\"text-align:center\">é»˜è®¤å€¼</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">value</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">ä¸»é”®å­—æ®µå</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">type</td>\n<td style=\"text-align:center\">Enum</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">IdType.NONE</td>\n<td style=\"text-align:center\">ä¸»é”®ç±»å‹ï¼Œé€šè¿‡ IdType æšä¸¾æŒ‡å®š</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>IdType çš„æšä¸¾é¡¹ï¼š</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å€¼</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">AUTO</td>\n<td style=\"text-align:center\">æ•°æ®åº“ ID è‡ªå¢</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">NONE</td>\n<td style=\"text-align:center\">æ— çŠ¶æ€ï¼Œè¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹ (æ³¨è§£é‡Œç­‰äºè·Ÿéšå…¨å±€ï¼Œå…¨å±€é‡Œçº¦ç­‰äº INPUT)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">INPUT</td>\n<td style=\"text-align:center\">insert å‰è‡ªè¡Œ set ä¸»é”®å€¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ASSIGN_ID</td>\n<td style=\"text-align:center\">åˆ†é… ID (ä¸»é”®ç±»å‹ä¸º Number (Long å’Œ Integer) æˆ– String)(since 3.3.0), ä½¿ç”¨æ¥å£ <code>IdentifierGenerator</code>  çš„æ–¹æ³• <code>nextId</code>  (é»˜è®¤å®ç°ç±»ä¸º <code>DefaultIdentifierGenerator</code>  é›ªèŠ±ç®—æ³•)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ASSIGN_UUID</td>\n<td style=\"text-align:center\">åˆ†é… UUID, ä¸»é”®ç±»å‹ä¸º String (since 3.3.0), ä½¿ç”¨æ¥å£ <code>IdentifierGenerator</code>  çš„æ–¹æ³• <code>nextUUID</code>  (é»˜è®¤ default æ–¹æ³•)</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"tablefield\"><a class=\"anchor\" href=\"#tablefield\">#</a> @TableField</h3>\n<ul>\n<li>æè¿°ï¼šå­—æ®µæ³¨è§£ (éä¸»é”®)</li>\n<li>å±æ€§ï¼š</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å±æ€§</th>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å¿…é¡»æŒ‡å®š</th>\n<th style=\"text-align:center\">é»˜è®¤å€¼</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">value</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">å­—æ®µå</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">el</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">æ˜ å°„ä¸ºåŸç”Ÿ  <code>#&#123; ... &#125;</code>  é€»è¾‘ï¼Œç›¸å½“äºå†™åœ¨ xml é‡Œçš„  <code>#&#123; ... &#125;</code>  éƒ¨åˆ†</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">exist</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">true</td>\n<td style=\"text-align:center\">æ˜¯å¦ä¸ºæ•°æ®åº“è¡¨å­—æ®µ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">condition</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">å­—æ®µ  <code>where</code>  å®ä½“æŸ¥è¯¢æ¯”è¾ƒæ¡ä»¶ï¼Œæœ‰å€¼è®¾ç½®åˆ™æŒ‰è®¾ç½®çš„å€¼ä¸ºå‡†ï¼Œæ²¡æœ‰åˆ™ä¸ºé»˜è®¤å…¨å±€çš„  <code>%s=#&#123;%s&#125;</code> ,<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2Jhb21pZG91L215YmF0aXMtcGx1cy9ibG9iLzMuMC9teWJhdGlzLXBsdXMtYW5ub3RhdGlvbi9zcmMvbWFpbi9qYXZhL2NvbS9iYW9taWRvdS9teWJhdGlzcGx1cy9hbm5vdGF0aW9uL1NxbENvbmRpdGlvbi5qYXZh\"> å‚è€ƒ</span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">update</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">å­—æ®µ  <code>update set</code>  éƒ¨åˆ†æ³¨å…¥ï¼Œä¾‹å¦‚ï¼šupdate=&quot;% s+1&quot;ï¼šè¡¨ç¤ºæ›´æ–°æ—¶ä¼š set version=version+1 (è¯¥å±æ€§ä¼˜å…ˆçº§é«˜äº  <code>el</code>  å±æ€§)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">insertStrategy</td>\n<td style=\"text-align:center\">Enum</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">DEFAULT</td>\n<td style=\"text-align:center\">ä¸¾ä¾‹ï¼šNOT_NULL:  <code>insert into table_a(column) values (#&#123;columnProperty&#125;)</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">updateStrategy</td>\n<td style=\"text-align:center\">Enum</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">DEFAULT</td>\n<td style=\"text-align:center\">ä¸¾ä¾‹ï¼šIGNORED:  <code>update table_a set column=#&#123;columnProperty&#125;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">whereStrategy</td>\n<td style=\"text-align:center\">Enum</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">DEFAULT</td>\n<td style=\"text-align:center\">ä¸¾ä¾‹ï¼šNOT_EMPTY:  <code>where column=#&#123;columnProperty&#125;</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">fill</td>\n<td style=\"text-align:center\">Enum</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">FieldFill.DEFAULT</td>\n<td style=\"text-align:center\">å­—æ®µè‡ªåŠ¨å¡«å……ç­–ç•¥</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">select</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">true</td>\n<td style=\"text-align:center\">æ˜¯å¦è¿›è¡Œ select æŸ¥è¯¢</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">keepGlobalFormat</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">æ˜¯å¦ä¿æŒä½¿ç”¨å…¨å±€çš„ format è¿›è¡Œå¤„ç†</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">jdbcType</td>\n<td style=\"text-align:center\">JdbcType</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">JdbcType.UNDEFINED</td>\n<td style=\"text-align:center\">JDBC ç±»å‹ (è¯¥é»˜è®¤å€¼ä¸ä»£è¡¨ä¼šæŒ‰ç…§è¯¥å€¼ç”Ÿæ•ˆ)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">typeHandler</td>\n<td style=\"text-align:center\">Class&lt;? extends TypeHandler&gt;</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">UnknownTypeHandler.class</td>\n<td style=\"text-align:center\">ç±»å‹å¤„ç†å™¨ (è¯¥é»˜è®¤å€¼ä¸ä»£è¡¨ä¼šæŒ‰ç…§è¯¥å€¼ç”Ÿæ•ˆ)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">numericScale</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">å¦</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">æŒ‡å®šå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h2 id=\"basemapperçš„crud\"><a class=\"anchor\" href=\"#basemapperçš„crud\">#</a> BaseMapper çš„ CRUD</h2>\n<p>åœ¨ MybatisPlus ä¸­ï¼ŒBaseMapper ä¸­å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„ CRUD æ–¹æ³•ï¼Œå½“æˆ‘ä»¬è‡ªå®šä¹‰çš„ Mapper æ¥å£ç»§æ‰¿ BaseMapper åå³å¯æ‹¥æœ‰äº†è¿™äº›æ–¹æ³•ã€‚</p>\n<br>\n<h3 id=\"æ–°å¢\"><a class=\"anchor\" href=\"#æ–°å¢\">#</a> æ–°å¢</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ’å…¥ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"åˆ é™¤\"><a class=\"anchor\" href=\"#åˆ é™¤\">#</a> åˆ é™¤</h3>\n<h4 id=\"æ–¹æ³•\"><a class=\"anchor\" href=\"#æ–¹æ³•\">#</a> æ–¹æ³•ï¼š</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® entity æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// åˆ é™¤ï¼ˆæ ¹æ® ID æ‰¹é‡åˆ é™¤ï¼‰</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">deleteBatchIds</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>COLLECTION<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> idList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID åˆ é™¤</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">deleteById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Serializable</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ ¹æ® columnMap æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">deleteByMap</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>COLUMN_MAP<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> columnMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"\"><a class=\"anchor\" href=\"#\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC5iYW9taWRvdS5jb20vZ3VpZGUvY3J1ZC1pbnRlcmZhY2UuaHRtbCMlRTUlOEYlODIlRTYlOTUlQjAlRTglQUYlQjQlRTYlOTglOEUtMTA=\">#</span>å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">wrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±»ï¼ˆå¯ä»¥ä¸º nullï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection&lt;? extends Serializable&gt;</td>\n<td style=\"text-align:center\">idList</td>\n<td style=\"text-align:center\">ä¸»é”® ID åˆ—è¡¨ (ä¸èƒ½ä¸º null ä»¥åŠ empty)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Serializable</td>\n<td style=\"text-align:center\">id</td>\n<td style=\"text-align:center\">ä¸»é”® ID</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Map&lt;String, Object&gt;</td>\n<td style=\"text-align:center\">columnMap</td>\n<td style=\"text-align:center\">è¡¨å­—æ®µ map å¯¹è±¡</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"ä¿®æ”¹\"><a class=\"anchor\" href=\"#ä¿®æ”¹\">#</a> ä¿®æ”¹</h3>\n<h4 id=\"æ–¹æ³•-2\"><a class=\"anchor\" href=\"#æ–¹æ³•-2\">#</a> æ–¹æ³•ï¼š</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® whereEntity æ¡ä»¶ï¼Œæ›´æ–°è®°å½•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>ENTITY<span class=\"token punctuation\">)</span> <span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> updateWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID ä¿®æ”¹</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">updateById</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>ENTITY<span class=\"token punctuation\">)</span> <span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°\"><a class=\"anchor\" href=\"#å‚æ•°\">#</a> å‚æ•°ï¼š</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡ (set æ¡ä»¶å€¼ï¼Œå¯ä¸º null)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">updateWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±»ï¼ˆå¯ä»¥ä¸º null, é‡Œé¢çš„ entity ç”¨äºç”Ÿæˆ where è¯­å¥ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<br>\n<br>\n<h3 id=\"æŸ¥è¯¢å•ä¸ª\"><a class=\"anchor\" href=\"#æŸ¥è¯¢å•ä¸ª\">#</a> æŸ¥è¯¢å•ä¸ª</h3>\n<h4 id=\"æ–¹æ³•åˆ—è¡¨\"><a class=\"anchor\" href=\"#æ–¹æ³•åˆ—è¡¨\">#</a> æ–¹æ³•åˆ—è¡¨:</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID æŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">T</span> <span class=\"token function\">selectById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Serializable</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">T</span> <span class=\"token function\">selectOne</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-2\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-2\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Serializable</td>\n<td style=\"text-align:center\">id</td>\n<td style=\"text-align:center\">ä¸»é”® ID</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±»ï¼ˆå¯ä»¥ä¸º nullï¼‰</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"æŸ¥è¯¢é›†åˆ\"><a class=\"anchor\" href=\"#æŸ¥è¯¢é›†åˆ\">#</a> æŸ¥è¯¢é›†åˆ</h3>\n<h4 id=\"æ–¹æ³•åˆ—è¡¨-2\"><a class=\"anchor\" href=\"#æ–¹æ³•åˆ—è¡¨-2\">#</a> æ–¹æ³•åˆ—è¡¨ï¼š</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢ï¼ˆæ ¹æ® ID æ‰¹é‡æŸ¥è¯¢ï¼‰</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectBatchIds</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>COLLECTION<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> idList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectList</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢ï¼ˆæ ¹æ® columnMap æ¡ä»¶ï¼‰</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectByMap</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>COLUMN_MAP<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> columnMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectMaps</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ã€‚æ³¨æ„ï¼š åªè¿”å›ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectObjs</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"ç¤ºä¾‹\"><a class=\"anchor\" href=\"#ç¤ºä¾‹\">#</a> ç¤ºä¾‹ï¼š</h4>\n<p>1ï¼‰æ ¹æ® id é›†åˆæŸ¥è¯¢ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testQueryByIdList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// æ ¹æ® ID æŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> userMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectBatchIds</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">asList</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2L</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">::</span><span class=\"token function\">println</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>2ï¼‰æ ¹æ® wrapper æŸ¥è¯¢ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testQueryByWrapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// å®šä¹‰ wrapper</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// æ¨¡ç³Š</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">like</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"o\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// èŒƒå›´</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">le</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"age\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// æ’åº</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">orderByAsc</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"age\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// æŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> userMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectList</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">::</span><span class=\"token function\">println</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ sqlï¼š</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SELECT</span> id<span class=\"token punctuation\">,</span>name<span class=\"token punctuation\">,</span>email<span class=\"token punctuation\">,</span>age <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">LIKE</span> ? <span class=\"token operator\">AND</span> age <span class=\"token operator\">&lt;=</span> ?<span class=\"token punctuation\">)</span> <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> age <span class=\"token keyword\">ASC</span></pre></td></tr></table></figure><br>\n<h3 id=\"åˆ†é¡µæŸ¥è¯¢\"><a class=\"anchor\" href=\"#åˆ†é¡µæŸ¥è¯¢\">#</a> åˆ†é¡µæŸ¥è¯¢</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectPage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectMapsPage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢æ€»è®°å½•æ•°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">Integer</span> <span class=\"token function\">selectCount</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Constants</span><span class=\"token punctuation\">.</span>WRAPPER<span class=\"token punctuation\">)</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>åˆ†é¡µæŸ¥è¯¢éœ€è¦å¼•å…¥é¢å¤–çš„æ’ä»¶æ‰èƒ½ç”Ÿæ•ˆã€‚</p>\n</div>\n<h4 id=\"å¼•å…¥åˆ†é¡µæ’ä»¶\"><a class=\"anchor\" href=\"#å¼•å…¥åˆ†é¡µæ’ä»¶\">#</a> å¼•å…¥åˆ†é¡µæ’ä»¶</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DbType</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MybatisPlusInterceptor</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span>inner<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PaginationInnerInterceptor</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MybatisConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     * æ³¨å†Œ mybatis plus çš„åˆ†é¡µæ’ä»¶</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MybatisPlusInterceptor</span> <span class=\"token function\">paginationInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">MybatisPlusInterceptor</span> interceptor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MybatisPlusInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">PaginationInnerInterceptor</span> paginationInnerInterceptor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PaginationInnerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// æ•°æ®åº“ç±»å‹</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setDbType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DbType</span><span class=\"token punctuation\">.</span>MYSQL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// æº¢å‡ºæ€»é¡µæ•°åæ˜¯è¿›è¡Œå¤„ç† (é»˜è®¤æ˜¯å¦)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setOverflow</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤ 500 æ¡ï¼Œ-1 ä¸å—é™åˆ¶</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setMaxLimit</span><span class=\"token punctuation\">(</span><span class=\"token number\">500L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">addInnerInterceptor</span><span class=\"token punctuation\">(</span>paginationInnerInterceptor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> interceptor<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"æµ‹è¯•åˆ†é¡µ\"><a class=\"anchor\" href=\"#æµ‹è¯•åˆ†é¡µ\">#</a> æµ‹è¯•åˆ†é¡µ</h4>\n<p>ä»£ç ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Test</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testPageQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// åˆ†é¡µæ¡ä»¶</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// å½“å‰é¡µ</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    page<span class=\"token punctuation\">.</span><span class=\"token function\">setCurrent</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">// æ¯é¡µå¤§å°</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    page<span class=\"token punctuation\">.</span><span class=\"token function\">setSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// åˆ†é¡µæŸ¥è¯¢ï¼Œç»“æœä¼šæ”¾åˆ° Page&lt;User > ä¸­ï¼Œå› æ­¤æ— éœ€è¿”å›</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    userMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectPage</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// æ€»æ¡æ•°</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">long</span> total <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getTotal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"total = \"</span> <span class=\"token operator\">+</span> total<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token comment\">// æ€»é¡µæ•°</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">long</span> pages <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pages = \"</span> <span class=\"token operator\">+</span> pages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token comment\">// å½“å‰é¡µç»“æœ</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> list <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">getRecords</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">::</span><span class=\"token function\">println</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><br><br></p>\n<h2 id=\"iserviceçš„crud\"><a class=\"anchor\" href=\"#iserviceçš„crud\">#</a> IService çš„ CRUD</h2>\n<blockquote>\n<p>MybatisPlus é™¤äº†æä¾› BaseMapperï¼Œè¿˜æä¾›äº†é€šç”¨çš„ Service æ¥å£ï¼š <code>IService</code></p>\n</blockquote>\n<br>\n<h3 id=\"æ–°å¢-2\"><a class=\"anchor\" href=\"#æ–°å¢-2\">#</a> æ–°å¢</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ’å…¥ä¸€æ¡è®°å½•ï¼ˆé€‰æ‹©å­—æ®µï¼Œç­–ç•¥æ’å…¥ï¼‰</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ’å…¥ï¼ˆæ‰¹é‡ï¼‰</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveBatch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ’å…¥ï¼ˆæ‰¹é‡ï¼‰</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveBatch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> batchSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-3\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-3\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection<T></td>\n<td style=\"text-align:center\">entityList</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡é›†åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">batchSize</td>\n<td style=\"text-align:center\">æ’å…¥æ‰¹æ¬¡æ•°é‡</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"saveorupdate\"><a class=\"anchor\" href=\"#saveorupdate\">#</a> SaveOrUpdate</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// TableId æ³¨è§£å­˜åœ¨æ›´æ–°è®°å½•ï¼Œå¦æ’å…¥ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveOrUpdate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® updateWrapper å°è¯•æ›´æ–°ï¼Œå¦ç»§ç»­æ‰§è¡Œ saveOrUpdate (T) æ–¹æ³•</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveOrUpdate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> updateWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ‰¹é‡ä¿®æ”¹æ’å…¥</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveOrUpdateBatch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ‰¹é‡ä¿®æ”¹æ’å…¥</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">saveOrUpdateBatch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> batchSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-4\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-4\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">updateWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» UpdateWrapper</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection<T></td>\n<td style=\"text-align:center\">entityList</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡é›†åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">batchSize</td>\n<td style=\"text-align:center\">æ’å…¥æ‰¹æ¬¡æ•°é‡</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"åˆ é™¤-2\"><a class=\"anchor\" href=\"#åˆ é™¤-2\">#</a> åˆ é™¤</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® entity æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID åˆ é™¤</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">removeById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Serializable</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ ¹æ® columnMap æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">removeByMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> columnMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// åˆ é™¤ï¼ˆæ ¹æ® ID æ‰¹é‡åˆ é™¤ï¼‰</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">removeByIds</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> idList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-5\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-5\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“åŒ…è£…ç±» QueryWrapper</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Serializable</td>\n<td style=\"text-align:center\">id</td>\n<td style=\"text-align:center\">ä¸»é”® ID</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Map&lt;String, Object&gt;</td>\n<td style=\"text-align:center\">columnMap</td>\n<td style=\"text-align:center\">è¡¨å­—æ®µ map å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection&lt;? extends Serializable&gt;</td>\n<td style=\"text-align:center\">idList</td>\n<td style=\"text-align:center\">ä¸»é”® ID åˆ—è¡¨</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"ä¿®æ”¹-2\"><a class=\"anchor\" href=\"#ä¿®æ”¹-2\">#</a> ä¿®æ”¹</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® UpdateWrapper æ¡ä»¶ï¼Œæ›´æ–°è®°å½• éœ€è¦è®¾ç½® sqlset</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> updateWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® whereEntity æ¡ä»¶ï¼Œæ›´æ–°è®°å½•</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> updateWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID é€‰æ‹©ä¿®æ”¹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">updateById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> entity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID æ‰¹é‡æ›´æ–°</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">updateBatchById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID æ‰¹é‡æ›´æ–°</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">boolean</span> <span class=\"token function\">updateBatchById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> entityList<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> batchSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-6\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-6\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">updateWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» UpdateWrapper</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection<T></td>\n<td style=\"text-align:center\">entityList</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡é›†åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">batchSize</td>\n<td style=\"text-align:center\">æ›´æ–°æ‰¹æ¬¡æ•°é‡</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"æŸ¥è¯¢å•ä¸ª-2\"><a class=\"anchor\" href=\"#æŸ¥è¯¢å•ä¸ª-2\">#</a> æŸ¥è¯¢å•ä¸ª</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ ¹æ® ID æŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">T</span> <span class=\"token function\">getById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Serializable</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapperï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•ã€‚ç»“æœé›†ï¼Œå¦‚æœæ˜¯å¤šä¸ªä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéšæœºå–ä¸€æ¡åŠ ä¸Šé™åˆ¶æ¡ä»¶ wrapper.last (\"LIMIT 1\")</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">T</span> <span class=\"token function\">getOne</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapperï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">T</span> <span class=\"token function\">getOne</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> throwEx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapperï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapperï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">V</span> <span class=\"token function\">getObj</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Function</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">super</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> mapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-7\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-7\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Serializable</td>\n<td style=\"text-align:center\">id</td>\n<td style=\"text-align:center\">ä¸»é”® ID</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» QueryWrapper</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">throwEx</td>\n<td style=\"text-align:center\">æœ‰å¤šä¸ª result æ˜¯å¦æŠ›å‡ºå¼‚å¸¸</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">T</td>\n<td style=\"text-align:center\">entity</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Function&lt;? super Object, V&gt;</td>\n<td style=\"text-align:center\">mapper</td>\n<td style=\"text-align:center\">è½¬æ¢å‡½æ•°</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"æŸ¥è¯¢å¤šä¸ª\"><a class=\"anchor\" href=\"#æŸ¥è¯¢å¤šä¸ª\">#</a> æŸ¥è¯¢å¤šä¸ª</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢æ‰€æœ‰</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢ï¼ˆæ ¹æ® ID æ‰¹é‡æŸ¥è¯¢ï¼‰</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listByIds</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">></span></span> idList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢ï¼ˆæ ¹æ® columnMap æ¡ä»¶ï¼‰</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listByMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> columnMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢æ‰€æœ‰åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listMaps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listMaps</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listObjs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listObjs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Function</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">super</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> mapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listObjs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listObjs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Function</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">super</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> mapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-8\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-8\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» QueryWrapper</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Collection&lt;? extends Serializable&gt;</td>\n<td style=\"text-align:center\">idList</td>\n<td style=\"text-align:center\">ä¸»é”® ID åˆ—è¡¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Map&lt;?String, Object&gt;</td>\n<td style=\"text-align:center\">columnMap</td>\n<td style=\"text-align:center\">è¡¨å­—æ®µ map å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Function&lt;? super Object, V&gt;</td>\n<td style=\"text-align:center\">mapper</td>\n<td style=\"text-align:center\">è½¬æ¢å‡½æ•°</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"åˆ†é¡µæŸ¥è¯¢-2\"><a class=\"anchor\" href=\"#åˆ†é¡µæŸ¥è¯¢-2\">#</a> åˆ†é¡µæŸ¥è¯¢</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æ— æ¡ä»¶ç¿»é¡µæŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">page</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// ç¿»é¡µæŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">page</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// æ— æ¡ä»¶ç¿»é¡µæŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">pageMaps</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// ç¿»é¡µæŸ¥è¯¢</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">pageMaps</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IPage</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> page<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-9\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-9\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">IPage<T></td>\n<td style=\"text-align:center\">page</td>\n<td style=\"text-align:center\">ç¿»é¡µå¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» QueryWrapper</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"æŸ¥è¯¢æ•°é‡\"><a class=\"anchor\" href=\"#æŸ¥è¯¢æ•°é‡\">#</a> æŸ¥è¯¢æ•°é‡</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// æŸ¥è¯¢æ€»è®°å½•æ•°</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢æ€»è®°å½•æ•°</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Wrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"å‚æ•°è¯´æ˜-10\"><a class=\"anchor\" href=\"#å‚æ•°è¯´æ˜-10\">#</a> å‚æ•°è¯´æ˜</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">å‚æ•°å</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Wrapper<T></td>\n<td style=\"text-align:center\">queryWrapper</td>\n<td style=\"text-align:center\">å®ä½“å¯¹è±¡å°è£…æ“ä½œç±» QueryWrapper</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h3 id=\"é“¾å¼æŸ¥è¯¢\"><a class=\"anchor\" href=\"#é“¾å¼æŸ¥è¯¢\">#</a> é“¾å¼æŸ¥è¯¢</h3>\n<h4 id=\"query\"><a class=\"anchor\" href=\"#query\">#</a> query</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// é“¾å¼æŸ¥è¯¢ æ™®é€š</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">QueryChainWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// é“¾å¼æŸ¥è¯¢ lambda å¼ã€‚æ³¨æ„ï¼šä¸æ”¯æŒ Kotlin</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">LambdaQueryChainWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">lambdaQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// ç¤ºä¾‹ï¼š</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"column\"</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">one</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">lambdaQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Entity</span><span class=\"token operator\">::</span><span class=\"token function\">getId</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><br>\n<br>\n<h2 id=\"å¼•å…¥mybatis-plus\"><a class=\"anchor\" href=\"#å¼•å…¥mybatis-plus\">#</a> å¼•å…¥ mybatis-plus</h2>\n<br>\n<h3 id=\"ä¾èµ–\"><a class=\"anchor\" href=\"#ä¾èµ–\">#</a> ä¾èµ–</h3>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!--mybatis plus--></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.baomidou<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mybatis-plus-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><br>\n<h3 id=\"å¢åŠ æ‰«æè·¯å¾„\"><a class=\"anchor\" href=\"#å¢åŠ æ‰«æè·¯å¾„\">#</a> å¢åŠ æ‰«æè·¯å¾„</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@MapperScan</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.lemon.goods\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@SpringBootApplication</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GoodsApplication</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GoodsApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><br>\n<h3 id=\"å…¨å±€é…ç½®\"><a class=\"anchor\" href=\"#å…¨å±€é…ç½®\">#</a> å…¨å±€é…ç½®</h3>\n<p>ç„¶ååœ¨ <code>ly-item-service</code>  çš„ <code>application.yml</code>  æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">mybatis-plus</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">type-aliases-package</span><span class=\"token punctuation\">:</span> com.leyou.item.entity <span class=\"token comment\"># åˆ«åæ‰«æåŒ…</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mapper-locations</span><span class=\"token punctuation\">:</span> <span class=\"token key atrule\">classpath*</span><span class=\"token punctuation\">:</span> mappers/<span class=\"token important\">*.xml</span> <span class=\"token comment\"># mapper çš„ xml æ–‡ä»¶åœ°å€</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">global-config</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">db-config</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token key atrule\">id-type</span><span class=\"token punctuation\">:</span> auto <span class=\"token comment\"># id é»˜è®¤ä¸ºè‡ªå¢é•¿</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token key atrule\">update-strategy</span><span class=\"token punctuation\">:</span> NOT_EMPTY <span class=\"token comment\"># æ›´æ–°æ—¶ï¼Œåªæ›´æ–°éç©ºå­—æ®µ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">insert-strategy</span><span class=\"token punctuation\">:</span> NOT_EMPTY <span class=\"token comment\"># æ–°å¢æ—¶ï¼Œåªæ–°å¢éç©ºå­—æ®µ</span></pre></td></tr></table></figure><br>\n<h3 id=\"å¼•å…¥åˆ†é¡µæ’ä»¶-2\"><a class=\"anchor\" href=\"#å¼•å…¥åˆ†é¡µæ’ä»¶-2\">#</a> å¼•å…¥åˆ†é¡µæ’ä»¶</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DbType</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MybatisPlusInterceptor</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span>inner<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PaginationInnerInterceptor</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MybatisConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     * æ³¨å†Œ mybatis plus çš„åˆ†é¡µæ’ä»¶</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MybatisPlusInterceptor</span> <span class=\"token function\">paginationInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">MybatisPlusInterceptor</span> interceptor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MybatisPlusInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">PaginationInnerInterceptor</span> paginationInnerInterceptor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PaginationInnerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// æ•°æ®åº“ç±»å‹</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setDbType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DbType</span><span class=\"token punctuation\">.</span>MYSQL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// æº¢å‡ºæ€»é¡µæ•°åæ˜¯è¿›è¡Œå¤„ç† (é»˜è®¤æ˜¯å¦)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setOverflow</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤ 500 æ¡ï¼Œ-1 ä¸å—é™åˆ¶</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        paginationInnerInterceptor<span class=\"token punctuation\">.</span><span class=\"token function\">setMaxLimit</span><span class=\"token punctuation\">(</span><span class=\"token number\">500L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">addInnerInterceptor</span><span class=\"token punctuation\">(</span>paginationInnerInterceptor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> interceptor<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><br>\n<h3 id=\"ä½¿ç”¨\"><a class=\"anchor\" href=\"#ä½¿ç”¨\">#</a> ä½¿ç”¨</h3>\n<h4 id=\"service\"><a class=\"anchor\" href=\"#service\">#</a> Service</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">CategoryService</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">IService</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Category</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"serviceimpl\"><a class=\"anchor\" href=\"#serviceimpl\">#</a> ServiceImpl</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Service</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CategoryServiceImpl</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ServiceImpl</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CategoryMapper</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Category</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">CategoryService</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"mapper\"><a class=\"anchor\" href=\"#mapper\">#</a> Mapper</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">CategoryMapper</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Category</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "MySQL",
                "æ•°æ®åº“",
                "mybatis-plus"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/3/ead1dab4ce75/",
            "url": "https://shaogezhu.cn/2022/3/ead1dab4ce75/",
            "title": "JVMåƒåœ¾æ”¶é›†-ZGCçš„æŸ“è‰²æŒ‡é’ˆ",
            "date_published": "2022-03-19T17:25:23.000Z",
            "content_html": "<div class=\"note info\">\n<p>JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šæŸ“è‰²æŒ‡é’ˆ</p>\n</div>\n<h2 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€ï¼š</h2>\n<p>ğŸ¥‚ä»‹ç»æŸ“è‰²æŒ‡é’ˆä¹‹å‰ï¼Œå¤§å®¶å…ˆå›é¡¾ä»¥ä¸‹ä¸Šä¸€ç¯‡æ–‡ç«  <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc2hhb2dlemh1LmNuLzIwMjIvMy8zYTY4MTg5MmY5MGMv\">ã€ŠJVM åƒåœ¾æ”¶é›† - ä¸‰è‰²æ ‡è®°ã€‹</span> ï¼Œå¤§éƒ¨åˆ†è¿½è¸ªå¼åƒåœ¾æ”¶é›†å™¨åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µéƒ½é‡‡ç”¨äº†ä¸‰è‰²æ ‡è®°æŠ€æœ¯ã€‚ä½†ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚ï¼šZGC æ”¶é›†å™¨æœ‰ä¸€ä¸ªæ ‡å¿—æ€§çš„è®¾è®¡ï¼Œå°±æ˜¯é‡‡ç”¨äº†<font color=\"blue\"><strong>æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯</strong></font>(Colored Pointerï¼Œå…¶ä»–ç±»ä¼¼çš„æŠ€æœ¯ä¸­å¯èƒ½å°†å®ƒç§°ä¸º Tag Pointer æˆ–è€… Version Pointer)ã€‚ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹æŸ“è‰²æŒ‡é’ˆã€‚</p>\n<h2 id=\"åº”ç”¨åœºæ™¯\"><a class=\"anchor\" href=\"#åº”ç”¨åœºæ™¯\">#</a> åº”ç”¨åœºæ™¯</h2>\n<p>ğŸŒ´ğŸŒ´ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬è¦<strong>åœ¨å¯¹è±¡ä¸Šå­˜å‚¨ä¸€äº›é¢å¤–çš„ã€åªä¾›æ”¶é›†å™¨æˆ–è€…è™šæ‹Ÿæœºæœ¬èº«ä½¿ç”¨çš„æ•°æ®</strong>ï¼Œé€šå¸¸ä¼šåœ¨å¯¹è±¡å¤´ä¸­å¢åŠ é¢å¤–çš„å­˜å‚¨å­—æ®µï¼Œå¦‚å¯¹è±¡çš„å“ˆå¸Œç ã€åˆ†ä»£å¹´é¾„ã€é”è®°å½•ç­‰å°±æ˜¯è¿™æ ·å­˜å‚¨çš„ã€‚æ¯”å¦‚ 64 ä½çš„ JVMï¼Œå¯¹è±¡å¤´çš„ Mark Word ä¸­ä¿å­˜çš„ä¿¡æ¯å¦‚ä¸‹å›¾ï¼š</p>\n<p><img data-src=\"/assets/2022-3/jm1.png\" alt=\"image.png\" /></p>\n<p>ğŸˆè¿™ç§è®°å½•æ–¹å¼åœ¨<font color=\"purple\"><strong>æœ‰å¯¹è±¡è®¿é—®çš„åœºæ™¯ä¸‹</strong></font>æ˜¯å¾ˆè‡ªç„¶æµç•…çš„ï¼Œä¸ä¼šæœ‰ä»€ä¹ˆé¢å¤–è´Ÿæ‹…ã€‚ä½†å¦‚æœæœ‰ä¸€äº›å¯¹è±¡æ ¹æœ¬å°±ä¸ä¼šå»è®¿é—®å®ƒï¼Œä½†åˆå¸Œæœ›å¾—çŸ¥è¯¥å¯¹è±¡çš„æŸäº›ä¿¡æ¯çš„åœºæ™¯å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬å°±æœ‰è¿™æ ·çš„åœºæ™¯ â€”â€” è¿½è¸ªå¼æ”¶é›†ç®—æ³•çš„æ ‡è®°é˜¶æ®µå°±å¯èƒ½å­˜åœ¨<font color=\"green\"><strong>åªè·ŸæŒ‡é’ˆæ‰“äº¤é“è€Œä¸å¿…æ¶‰åŠæŒ‡é’ˆæ‰€å¼•ç”¨çš„å¯¹è±¡æœ¬èº«</strong></font>çš„åœºæ™¯ã€‚</p>\n<p>ğŸŒ°ä¾‹å¦‚ å¯¹è±¡æ ‡è®°çš„è¿‡ç¨‹ä¸­éœ€è¦ç»™å¯¹è±¡æ‰“ä¸Šä¸‰è‰²æ ‡è®°ï¼Œè¿™äº›æ ‡è®°æœ¬è´¨ä¸Šå°±<strong>åªå’Œå¯¹è±¡çš„å¼•ç”¨æœ‰å…³ï¼Œè€Œä¸å¯¹è±¡æœ¬èº«æ— å…³</strong> â€”â€” æŸä¸ªå¯¹è±¡åªæœ‰å®ƒçš„å¼•ç”¨å…³ç³»èƒ½å†³å®šå®ƒå­˜æ´»ä¸å¦ï¼Œå¯¹è±¡ä¸Šå…¶ä»–æ‰€æœ‰çš„å±æ€§éƒ½ä¸èƒ½å¤Ÿå½±å“å®ƒçš„å­˜æ´»åˆ¤å®šç»“æœã€‚</p>\n<p>ğŸ‘©HotSpot è™šæ‹Ÿæœºçš„å‡ ç§æ”¶é›†å™¨æœ‰ä¸åŒçš„æ ‡è®°å®ç°æ–¹æ¡ˆï¼š</p>\n<ul>\n<li>ğŸ“ æŠŠæ ‡è®°ç›´æ¥è®°å½•åœ¨å¯¹è±¡å¤´ä¸Š (Serial æ”¶é›†å™¨ï¼‰</li>\n<li>ğŸ“ æŠŠæ ‡è®°è®°å½•åœ¨ä¸å¯¹è±¡ç›¸äº’ç‹¬ç«‹çš„æ•°æ®ç»“æ„ä¸Š (G1ã€Shenandoah ä½¿ç”¨äº†ä¸€ç§ç›¸å½“äºå †å†…å­˜çš„ 1/64 å¤§å°çš„ï¼Œç§°ä¸º BitMap çš„ç»“æ„æ¥è®°å½•æ ‡è®°ä¿¡æ¯ï¼‰</li>\n<li>ğŸ“ ZGC çš„æŸ“è‰²æŒ‡é’ˆ<strong>ç›´æ¥æŠŠæ ‡è®°ä¿¡æ¯è®°åœ¨å¼•ç”¨å¯¹è±¡çš„æŒ‡é’ˆä¸Š</strong>ï¼ˆè¿™ä¸ªæ—¶å€™ï¼Œä¸å…¶è¯´å¯è¾¾æ€§åˆ†ææ˜¯éå†å¯¹è±¡å›¾æ¥æ ‡è®°å¯¹è±¡ï¼Œè¿˜ä¸å¦‚è¯´æ˜¯éå† â€œå¼•ç”¨å›¾â€ æ¥æ ‡è®° â€œå¼•ç”¨â€ äº†ã€‚ï¼‰</li>\n</ul>\n<br>\n<h2 id=\"æŸ“è‰²æŒ‡é’ˆ\"><a class=\"anchor\" href=\"#æŸ“è‰²æŒ‡é’ˆ\">#</a> æŸ“è‰²æŒ‡é’ˆ</h2>\n<p>âœ¨<font color=\"purple\"><strong>æŸ“è‰²æŒ‡é’ˆæ˜¯ä¸€ç§ç›´æ¥å°†å°‘é‡é¢å¤–çš„ä¿¡æ¯å­˜å‚¨åœ¨æŒ‡é’ˆä¸Šçš„æŠ€æœ¯</strong></font>ã€‚åœ¨ 64 ä½ Linux ä¸­ï¼Œå¯¹è±¡æŒ‡é’ˆæ˜¯ 64 ä½ï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img data-src=\"/assets/2022-3/jm2.png\" alt=\"image.png\" /></p>\n<p>ğŸ‘‰ğŸ»åœ¨è¿™ä¸ª 64 ä½çš„æŒ‡é’ˆä¸Šï¼Œé«˜ 18 ä½éƒ½æ˜¯ 0ï¼Œæš‚æ—¶ä¸ç”¨æ¥å¯»å€ã€‚å‰©ä½™çš„ 46 ä½æŒ‡é’ˆæ‰€èƒ½æ”¯æŒå†…å­˜å¯ä»¥è¾¾åˆ° 64TBÂ , è¿™å¯ä»¥æ»¡è¶³å¤šæ•°å¤§å‹æœåŠ¡å™¨çš„éœ€è¦äº†ã€‚ä¸è¿‡ ZGC å¹¶æ²¡æœ‰æŠŠ 46Â ä½éƒ½ç”¨æ¥ä¿å­˜å¯¹è±¡ä¿¡æ¯ï¼Œè€Œæ˜¯ç”¨é«˜ 4 ä½ä¿å­˜äº†å››ä¸ªæ ‡å¿—ä½ï¼Œå¯¼è‡´ ZGC å¯ä»¥ç®¡ç†çš„æœ€å¤§å†…å­˜ä¸è¶…è¿‡ 4Â TB ã€‚</p>\n<p>â­â­é€šè¿‡è¿™å››ä¸ªæ ‡å¿—ä½ï¼ŒJVM å¯ä»¥<strong>ä»æŒ‡é’ˆä¸Šç›´æ¥çœ‹åˆ°</strong>å¯¹è±¡çš„ä¸‰è‰²æ ‡è®°çŠ¶æ€ï¼ˆMarked0ã€Marked1ï¼‰ã€æ˜¯å¦è¿›å…¥äº†é‡åˆ†é…é›†ï¼ˆRemappedï¼‰ã€æ˜¯å¦éœ€è¦é€šè¿‡ finalize æ–¹æ³•æ¥è®¿é—®åˆ°ï¼ˆFinalizableï¼‰ç­‰ä¿¡æ¯ã€‚</p>\n<p><strong>æ— éœ€è¿›è¡Œå¯¹è±¡è®¿é—®å°±å¯ä»¥è·å¾— GC ä¿¡æ¯ï¼Œè¿™å¤§å¤§æé«˜äº† GC æ•ˆç‡ã€‚</strong> ğŸš€ğŸš€ğŸš€</p>\n<p>ğŸºå¯ä»¥çœ‹åˆ°æŸ“è‰²æŒ‡é’ˆçš„ä¼˜ç‚¹å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚ä¸è¿‡ï¼Œè¦ä½¿ç”¨æŸ“è‰²æŒ‡é’ˆæœ‰ä¸€ä¸ªå¿…é¡»è§£å†³çš„<font color=\"orange\"><strong>å‰ç½®é—®é¢˜</strong></font>ï¼šJava è™šæ‹Ÿæœºä½œä¸ºä¸€ä¸ªæ™®æ™®é€šé€šçš„è¿›ç¨‹ï¼Œè¿™æ ·éšæ„é‡æ–°å®šä¹‰å†…å­˜ä¸­æŸäº›æŒ‡é’ˆçš„å…¶ä¸­å‡ ä½ï¼Œæ“ä½œç³»ç»Ÿæ˜¯å¦æ”¯æŒï¼Ÿå¤„ç†å™¨æ˜¯å¦æ”¯æŒï¼ŸğŸ¤·â€</p>\n<p>ğŸ‘©ğŸ»â€ç¨‹åºä»£ç æœ€ç»ˆéƒ½è¦è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤æµäº¤ä»˜ç»™å¤„ç†å™¨å»æ‰§è¡Œï¼Œå¤„ç†å™¨å¯ä¸ä¼šç®¡æŒ‡ä»¤æµä¸­çš„æŒ‡é’ˆå“ªéƒ¨åˆ†å­˜çš„æ˜¯æ ‡å¿—ä½ï¼Œå“ªéƒ¨åˆ†æ‰æ˜¯çœŸæ­£çš„å¯»å€åœ°å€ï¼Œåªä¼šæŠŠæ•´ä¸ªæŒ‡é’ˆéƒ½è§†ä½œä¸€ä¸ªå†…å­˜åœ°å€æ¥å¯¹å¾…ã€‚</p>\n<p>ğŸˆåœ¨æˆ‘ä»¬å¸¸ç”¨çš„ x86-64 å¹³å°ä¸Šæ˜¯ä¸æ”¯æŒé‡æ–°å®šä¹‰æœºå™¨æŒ‡ä»¤çš„ï¼ŒZGC è®¾è®¡è€…ä»¬å°±é‡‡ç”¨äº†<strong>è™šæ‹Ÿå†…å­˜æ˜ å°„æŠ€æœ¯</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>\n<br>\n<h2 id=\"è™šæ‹Ÿå†…å­˜æ˜ å°„\"><a class=\"anchor\" href=\"#è™šæ‹Ÿå†…å­˜æ˜ å°„\">#</a> è™šæ‹Ÿå†…å­˜æ˜ å°„</h2>\n<p>ğŸ¬åœ¨ x86 å¹³å°ä¸Šï¼Œå¤„ç†å™¨ä¼šä½¿ç”¨åˆ†é¡µç®¡ç†æœºåˆ¶æŠŠ<font color=\"blue\"><strong>çº¿æ€§åœ°å€ç©ºé—´</strong></font>å’Œ<font color=\"orange\"><strong>ç‰©ç†åœ°å€ç©ºé—´</strong></font>åˆ†åˆ«åˆ’åˆ†ä¸ºå¤§å°ç›¸åŒçš„å—ï¼Œè¿™æ ·çš„å†…å­˜å—è¢«ç§°ä¸º **â€œé¡µâ€(Page)**ã€‚é€šè¿‡åœ¨çº¿æ€§è™šæ‹Ÿç©ºé—´çš„é¡µä¸ç‰©ç†åœ°å€ç©ºé—´çš„é¡µä¹‹é—´å»ºç«‹çš„æ˜ å°„è¡¨ï¼Œåˆ†é¡µç®¡ç†æœºåˆ¶ä¼šè¿›è¡Œçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€ç©ºé—´çš„æ˜ å°„ï¼Œå®Œæˆçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ã€‚<br />\n<br><br />\nâœ¨ç®€å•çš„ç†è§£ä¸ºï¼š<strong>ç”¨ mmap æŠŠä¸åŒçš„è™šæ‹Ÿå†…å­˜åœ°å€æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†å†…å­˜åœ°å€ä¸Šã€‚</strong> å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img data-src=\"/assets/2022-3/jm3.png\" alt=\"image.png\" /></p>\n<p>ğŸ‹ZGC ä¸ºäº†è§£å†³ä¸Šé¢çš„å¯»å€åœ°å€é—®é¢˜ï¼Œä½¿ç”¨äº†è™šæ‹Ÿå†…å­˜æ˜ å°„æŠ€æœ¯ï¼Œ<strong>æŠŠåŒä¸€å—å„¿ç‰©ç†å†…å­˜æ˜ å°„ä¸º Marked0ã€Marked1 å’Œ Remapped ä¸‰ä¸ªè™šæ‹Ÿå†…å­˜</strong>ã€‚</p>\n<p>ğŸ¹å½“åº”ç”¨ç¨‹åºåˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šåœ¨å †ä¸Šç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œè¿™æ—¶Â ZGCÂ ä¼šä¸ºè¿™ä¸ªå¯¹è±¡åœ¨ Marked0ã€Marked1 å’Œ Remapped è¿™ä¸‰ä¸ªè§†å›¾ç©ºé—´åˆ†åˆ«ç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œè¿™ä¸‰ä¸ªè™šæ‹Ÿåœ°å€æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†åœ°å€ã€‚</p>\n<p>ğŸ¦<font color=\"green\"><strong>Marked0ã€Marked1 å’Œ Remapped è¿™ä¸‰ä¸ªè™šæ‹Ÿå†…å­˜ä½œä¸º ZGC çš„ä¸‰ä¸ªè§†å›¾ç©ºé—´</strong></font>ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹å†…åªèƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆã€‚ZGC å°±æ˜¯é€šè¿‡è¿™ä¸‰ä¸ªè§†å›¾ç©ºé—´çš„åˆ‡æ¢ï¼Œæ¥å®Œæˆå¹¶å‘çš„åƒåœ¾å›æ”¶ã€‚</p>\n<p>ğŸ™‡å¥½äº†å…³äºæŸ“è‰²æŒ‡é’ˆçš„å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰ä»€ä¹ˆç–‘é—®æ¬¢è¿è¯„è®ºåŒºè®¨è®ºã€‚<br />\n<br></p>\n<p><strong>PSï¼š</strong> åœ¨ JDK 15 ä¸­ ï¼Œå·²ç»å¯ä»¥é€šè¿‡æŒ‡ä»¤Â â€“XX:+UseZGC æ¥å¯ç”¨é‡‡ç”¨æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯çš„ ZGC æ”¶é›†å™¨äº†ã€‚<br />\nğŸš€ğŸš€ğŸš€</p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "JVM",
                "java",
                "åƒåœ¾å›æ”¶"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/3/24dc16aab990/",
            "url": "https://shaogezhu.cn/2022/3/24dc16aab990/",
            "title": "JVMåƒåœ¾å›æ”¶-ä¸‰è‰²æ ‡è®°",
            "date_published": "2022-03-11T17:25:23.000Z",
            "content_html": "<div class=\"note info\">\n<p>JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šä¸‰è‰²æ ‡è®°</p>\n</div>\n<p>ğŸ‹Â è¿™æ¬¡ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ JVM åƒåœ¾å›æ”¶<strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong>çš„å®ç°åŸç†ã€‚</p>\n<p>ğŸˆğŸˆğŸˆä¸Šç¯‡æ–‡ç« <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc2hhb2dlemh1LmNuLzIwMjIvMy9jOGQ2ZmNkYjZmMDcv\">ã€ŠJVM åƒåœ¾å›æ”¶ - è®°å¿†é›†å’Œå¡è¡¨ã€‹</span> å·²ç»å’Œå¤§å®¶ä»‹ç»äº† JVM æ˜¯å¦‚ä½•å¿«é€Ÿçš„æ‰«æå’Œæ ‡è®° GC Roots çš„ã€‚æ ‡è®°\tå®Œ GC Roots ä¹‹åï¼ŒJVM å°±éœ€è¦ä» GC Roots å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾äº†ï¼ˆå³å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ï¼‰ã€‚<br />\n<br></p>\n<p><strong>é‚£ä¹ˆ JVM åˆæ˜¯å¦‚ä½•éå†å¯¹è±¡å›¾çš„å‘¢ï¼Ÿ</strong></p>\n<p>â˜•ç°ä»£å¤§å¤šæ•°è·Ÿè¸ªåƒåœ¾æ”¶é›†å™¨ (å¦‚ CMSã€G1ã€Shenandoah) éƒ½å®ç°<span class=\"blue\"><strong>ä¸‰è‰²æ ‡è®°</strong></span>æŠ½è±¡çš„ä¸€äº›å˜ä½“æ¥å¯¹ â€œåƒåœ¾â€ è¿›è¡Œæ ‡è®°çš„ã€‚ä¹‹æ‰€ä»¥éƒ½é€‰æ‹©ä¸‰è‰²æ ‡è®°æ˜¯å› ä¸ºå®ƒèƒ½å¤Ÿ<strong>è§£å†³æˆ–è€…é™ä½ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ã€‚</strong> ğŸš€ğŸš€ğŸš€</p>\n<p>ä¸‹é¢å°±è¿›å…¥æœ¬æ–‡æ­£é¢˜ï¼š</p>\n<h2 id=\"ä¸‰è‰²æ ‡è®°\"><a class=\"anchor\" href=\"#ä¸‰è‰²æ ‡è®°\">#</a> ä¸‰è‰²æ ‡è®°</h2>\n<p>â˜˜ä¸‰è‰²æ ‡è®°ç®—æ³•æŠŠéå†å¯¹è±¡å›¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¯¹è±¡ï¼ŒæŒ‰ç…§ â€œæ˜¯å¦è¢«è®¿é—®è¿‡â€ åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§é¢œè‰²ï¼š</p>\n<ul>\n<li><strong>ç™½è‰²âœ¨ï¼š</strong> è¡¨ç¤ºå¯¹è±¡å°šæœªè¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ã€‚ <span class=\"grey\">ï¼ˆæ˜¾ç„¶åœ¨å¯è¾¾æ€§åˆ†æåˆšåˆšå¼€å§‹çš„é˜¶æ®µï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ï¼Œè‹¥åœ¨åˆ†æç»“æŸçš„é˜¶æ®µï¼Œä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡ï¼Œå³ä»£è¡¨ä¸å¯è¾¾ï¼‰</span></li>\n<li><strong>ç°è‰²âœ¨ï¼š</strong> è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä½†è¿™ä¸ªå¯¹è±¡ä¸Šè‡³å°‘å­˜åœ¨ä¸€ä¸ªå¼•ç”¨è¿˜æ²¡æœ‰è¢«æ‰«æè¿‡ã€‚</li>\n<li><strong>é»‘è‰²âœ¨ï¼š</strong> è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä¸”è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½å·²ç»æ‰«æè¿‡ã€‚ <span class=\"grey\">ï¼ˆé»‘è‰²çš„å¯¹è±¡ä»£è¡¨å·²ç»æ‰«æè¿‡ï¼Œå®ƒæ˜¯å®‰å…¨å­˜æ´»çš„ï¼Œå¦‚æœæœ‰å…¶ä»–å¯¹è±¡å¼•ç”¨æŒ‡å‘äº†é»‘è‰²å¯¹è±¡ï¼Œæ— é¡»é‡æ–°æ‰«æä¸€éã€‚é»‘è‰²å¯¹è±¡ä¸å¯èƒ½ç›´æ¥ (ä¸ç»è¿‡ç°è‰²å¯¹è±¡) æŒ‡å‘æŸä¸ªç™½è‰²å¯¹è±¡ï¼‰</span></li>\n</ul>\n<p>ğŸŒ´ğŸŒ´ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä¸‰è‰²æ ‡è®°éå†å¯¹è±¡å›¾çš„å¤§è‡´è¿‡ç¨‹ï¼š<br />\n<img data-src=\"/assets/2022-3/jjm.gif\" alt=\"image.png\" /></p>\n<p><strong>â­åˆå§‹çŠ¶æ€</strong>åªæœ‰ GC Roots æ˜¯é»‘è‰²çš„ã€‚è¢« GC Roots ç›´æ¥å¼•ç”¨çš„å¯¹è±¡ä¼šå˜æˆç°è‰²</p>\n<p><strong>â­æ‰«æè¿‡ç¨‹ä¸­</strong>ï¼ŒæŒ‰ç…§ä»¥ä¸‹ä¸¤ç‚¹æ‰«ææ•´ä¸ªå¼•ç”¨é“¾</p>\n<ul>\n<li>å½“å‰ç°è‰²èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹çš„è¯ï¼Œå°†å½“å‰èŠ‚ç‚¹å˜ä¸ºé»‘è‰²ã€‚</li>\n<li>å½“å‰ç°è‰²èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹çš„è¯ï¼Œå½“å‰èŠ‚ç‚¹å˜ä¸ºé»‘è‰²ï¼Œä¸”å­èŠ‚ç‚¹å˜ä¸ºç°è‰²ã€‚</li>\n</ul>\n<p><strong>â­æ‰«æå®Œæˆæ—¶</strong>ï¼Œé»‘è‰²å¯¹è±¡å°±æ˜¯å­˜æ´»çš„å¯¹è±¡ï¼Œç™½è‰²å¯¹è±¡å°±æ˜¯å·²æ¶ˆäº¡å¯å›æ”¶çš„å¯¹è±¡</p>\n<p>æ‰«æå®Œæˆä¹‹åï¼Œåƒåœ¾æ”¶é›†å™¨åªéœ€è¦å›æ”¶ä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜å³å¯ã€‚ä¹ä¸€çœ‹ä¸Šé¢çš„è¿‡ç¨‹å¥½åƒæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä¸è¦å¿˜äº†æˆ‘ä»¬çš„<span class=\"green\"><strong>æ”¶é›†çº¿ç¨‹æ˜¯å’Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„</strong></span>ã€‚ğŸš€ğŸš€ğŸš€</p>\n<p>ğŸŒ»ğŸŒ»é‚£ä¹ˆå°±ä¼šé‡åˆ°ä¸€äº›é—®é¢˜äº†ï¼Œæˆ‘ä»¬çš„æ”¶é›†å™¨åœ¨å¯¹è±¡å›¾ä¸Šæ ‡è®°é¢œè‰²çš„åŒæ—¶ï¼Œç”¨æˆ·çº¿ç¨‹åœ¨ä¿®æ”¹å¼•ç”¨å…³ç³» â€”â€” å³ä¿®æ”¹å¯¹è±¡å›¾çš„ç»“æ„ï¼Œè¿™æ ·å¯èƒ½ä¼šå‡ºç°ä¸‹é¢ä¸¤ç§åæœï¼š</p>\n<p>ğŸ“ä¸€ç§æ˜¯<font color=\"red\"><strong>æŠŠåŸæœ¬æ¶ˆäº¡çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå­˜æ´»</strong></font>ï¼Œè¿™ä¸æ˜¯å¥½äº‹ï¼Œä½†å…¶å®æ˜¯å¯ä»¥å®¹å¿çš„ï¼Œåªä¸è¿‡äº§ç”Ÿäº†ä¸€ç‚¹é€ƒè¿‡æœ¬æ¬¡æ”¶é›†çš„æµ®åŠ¨åƒåœ¾è€Œå·²ï¼Œä¸‹æ¬¡æ”¶é›†æ¸…ç†æ‰å°±å¥½ã€‚</p>\n<p>ğŸ“å¦ä¸€ç§æ˜¯<font color=\"red\"><strong>æŠŠåŸæœ¬å­˜æ´»çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå·²æ¶ˆäº¡</strong></font>ï¼Œè¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†ï¼Œç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯ã€‚</p>\n<p>ä¸‹é¢æ¥æ¼”ç¤ºä¸€ä¸‹ä¸Šé¢çš„é”™è¯¯å…·ä½“æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚</p>\n<h3 id=\"ç¬¬ä¸€ç§æµ®åŠ¨åƒåœ¾\"><a class=\"anchor\" href=\"#ç¬¬ä¸€ç§æµ®åŠ¨åƒåœ¾\">#</a> ç¬¬ä¸€ç§ï¼šæµ®åŠ¨åƒåœ¾</h3>\n<p>ğŸºå‡è®¾ GC çº¿ç¨‹å·²ç»éå†åˆ° Eï¼ˆå˜ä¸ºç°è‰²äº†ï¼‰ï¼Œæ­¤æ—¶ D &gt; E çš„å¼•ç”¨æ–­å¼€ï¼š</p>\n<p><img data-src=\"/assets/2022-3/jjm1.png\" alt=\"image.png\" /></p>\n<p>D &gt; E çš„å¼•ç”¨æ–­å¼€ä¹‹åï¼ŒEã€Hã€GÂ ä¸‰ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼Œåº”è¯¥è¦è¢«å›æ”¶çš„ã€‚ç„¶è€Œå› ä¸º E å·²ç»å˜ä¸ºç°è‰²äº†ï¼Œå…¶ä»ä¼šè¢«å½“ä½œå­˜æ´»å¯¹è±¡ç»§ç»­éå†ä¸‹å»ã€‚æœ€ç»ˆçš„ç»“æœæ˜¯ï¼šè¿™éƒ¨åˆ†å¯¹è±¡ä»ä¼šè¢«æ ‡è®°ä¸ºå­˜æ´»ï¼Œå³æœ¬è½® GC ä¸ä¼šå›æ”¶è¿™éƒ¨åˆ†å†…å­˜ã€‚</p>\n<p>ğŸ‘©è¿™éƒ¨åˆ†æœ¬åº”è¯¥å›æ”¶ä½†æ˜¯æ²¡æœ‰å›æ”¶åˆ°çš„å†…å­˜ï¼Œè¢«ç§°ä¹‹ä¸ºæµ®åŠ¨åƒåœ¾ã€‚æµ®åŠ¨åƒåœ¾å¹¶ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œä¸‹æ¬¡æ”¶é›†æ—¶æ¸…ç†æ‰å°±å¥½ã€‚</p>\n<br>\n<h3 id=\"ç¬¬äºŒç§å¯¹è±¡æ¶ˆå¤±\"><a class=\"anchor\" href=\"#ç¬¬äºŒç§å¯¹è±¡æ¶ˆå¤±\">#</a> ç¬¬äºŒç§ï¼šâ€œå¯¹è±¡æ¶ˆå¤±â€</h3>\n<p>ğŸ¬å‡è®¾ GC çº¿ç¨‹å·²ç»éå†åˆ° Eï¼ˆå˜ä¸ºç°è‰²äº†ï¼‰ï¼Œæ­¤æ—¶ E &gt; G çš„å¼•ç”¨æ–­å¼€ï¼Œæ–°å¢ D &gt; G çš„å¼•ç”¨ï¼š</p>\n<p><img data-src=\"/assets/2022-3/jjm2.png\" alt=\"image.png\" /></p>\n<p>ğŸ‘€æ­¤æ—¶å› ä¸º E å·²ç»æ²¡æœ‰å¯¹ G çš„å¼•ç”¨äº†ï¼Œæ‰€ä»¥ä¸ä¼šå°† G ç½®ä¸ºç°è‰²ï¼›å°½ç®¡å› ä¸º D é‡æ–°å¼•ç”¨äº† Gï¼Œä½†å› ä¸º D å·²ç»æ˜¯é»‘è‰²äº†ï¼Œä¸ä¼šå†é‡æ–°åšéå†å¤„ç†ã€‚</p>\n<p>ğŸ‘æœ€ç»ˆå¯¼è‡´çš„ç»“æœæ˜¯ï¼šG ä¼šä¸€ç›´æ˜¯ç™½è‰²ï¼Œæœ€åè¢«å½“ä½œåƒåœ¾è¿›è¡Œæ¸…é™¤ã€‚è¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†ï¼Œç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯ï¼Œæ˜¯ä¸å¯ä»¥æ¥å—çš„ã€‚</p>\n<br>\n<p>ğŸ¥‡æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°å‘ç”Ÿè¿™ç§é”™è¯¯æ˜¯éœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ‰å¯ä»¥æˆç«‹çš„ï¼š</p>\n<p><strong>ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼š</strong> èµ‹å€¼å™¨æ’å…¥äº†ä¸€æ¡æˆ–å¤šæ¡ä»é»‘è‰²å¯¹è±¡åˆ°ç™½è‰²å¯¹è±¡çš„æ–°å¼•ç”¨ã€‚(å³æ–°å¢ D&gt; G çš„å¼•ç”¨)</p>\n<p><strong>ç¬¬äºŒä¸ªæ¡ä»¶ï¼š</strong> èµ‹å€¼å™¨åˆ é™¤äº†å…¨éƒ¨ä»ç°è‰²å¯¹è±¡åˆ°è¯¥ç™½è‰²å¯¹è±¡çš„ç›´æ¥æˆ–é—´æ¥å¼•ç”¨ã€‚(å³æ–­å¼€ E&gt; G çš„å¼•ç”¨)</p>\n<p>ğŸ¹æˆ‘ä»¬è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€ç ´åè¿™ä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä»»æ„ä¸€ä¸ªæ¡ä»¶ å³å¯é¿å…å‘ç”Ÿå¹¶å‘æ‰«ææ—¶çš„å¯¹è±¡æ¶ˆå¤±é—®é¢˜ã€‚</p>\n<br>\n<p>ğŸğŸå…ˆæ¥ç ´åç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œå½“é»‘è‰²å¯¹è±¡æ’å…¥æ–°çš„æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªæ–°æ’å…¥çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œç­‰å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„é»‘è‰²å¯¹è±¡ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™å¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ<strong>é»‘è‰²å¯¹è±¡ä¸€æ—¦æ–°æ’å…¥äº†æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ä¹‹åï¼Œå®ƒå°±å˜å›ç°è‰²å¯¹è±¡äº†ã€‚</strong> è¿™ç§è§£å†³æ–¹æ¡ˆç§°ä¸º<font color=\"blue\"><strong>å¢é‡æ›´æ–°</strong></font>ã€‚</p>\n<p>ğŸ‰ğŸ‰ä¹Ÿå¯ä»¥ç ´åç¬¬äºŒä¸ªæ¡ä»¶ï¼Œå½“ç°è‰²å¯¹è±¡è¦åˆ é™¤æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼Œæˆ‘ä»¬å°±å°†è¿™ä¸ªè¦åˆ é™¤çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œåœ¨å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„ç°è‰²å¯¹è±¡ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™ä¹Ÿå¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ<strong>æ— è®ºå¼•ç”¨å…³ç³»åˆ é™¤ä¸å¦ï¼Œéƒ½ä¼šæŒ‰ç…§åˆšåˆšå¼€å§‹æ‰«æé‚£ä¸€åˆ»çš„å¯¹è±¡å›¾å¿«ç…§æ¥è¿›è¡Œæœç´¢ã€‚</strong> è¿™ç§è§£å†³æ–¹æ¡ˆç§°ä¸º<font color=\"green\"><strong>åŸå§‹å¿«ç…§</strong></font>ã€‚</p>\n<br>\n<p>ğŸ˜æ— è®ºé‡‡ç”¨å“ªä¸€ç§æ–¹æ¡ˆï¼Œéƒ½å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚åœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œå¢é‡æ›´æ–°å’ŒåŸå§‹å¿«ç…§è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéƒ½æœ‰å®é™…åº”ç”¨ï¼Œè­¬å¦‚ï¼ŒCMS å°±æ˜¯åŸºäºå¢é‡æ›´æ–°æ¥åšå¹¶å‘æ ‡è®°çš„ï¼ŒG1ã€Shenandoah åˆ™æ˜¯ç”¨åŸå§‹å¿«ç…§æ–¹å¼æ¥å®ç°ã€‚</p>\n<p>ğŸ™‡è¯»å®Œä¸Šé¢çš„å†…å®¹ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹ JVM å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚JVM è™šæ‹Ÿæœºæ ‡è®°å®Œä¸å¯è¾¾å¯¹è±¡ä¹‹åè¿˜éœ€è¦å¯¹è¿™äº›å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜è¿›è¡Œå›æ”¶ï¼Œå…·ä½“çš„å›æ”¶åŠ¨ä½œæ˜¯ç”±è™šæ‹Ÿæœºé‡‡ç”¨å“ªæ¬¾åƒåœ¾å›æ”¶å™¨æ‰€å†³å®šçš„ã€‚</p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "JVM",
                "java",
                "åƒåœ¾å›æ”¶"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2022/3/53fe22309155/",
            "url": "https://shaogezhu.cn/2022/3/53fe22309155/",
            "title": "JVMåƒåœ¾å›æ”¶-è®°å¿†é›†å’Œå¡è¡¨",
            "date_published": "2022-03-05T16:23:23.000Z",
            "content_html": "<div class=\"note info\">\n<p>JVM åƒåœ¾å›æ”¶ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šè®°å¿†é›†å’Œå¡è¡¨</p>\n</div>\n<p>ğŸ¥‚åœ¨è¯´è®°å¿†é›†å’Œå¡è¡¨ä¹‹å‰ï¼Œå…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹<strong>è·¨ä»£å¼•ç”¨</strong>çš„é—®é¢˜ã€‚</p>\n<p><img data-src=\"/assets/2022-3/jvm1.png\" alt=\"image\" /></p>\n<p>ğŸ«å‡å¦‚è¦ç°åœ¨è¿›è¡Œä¸€æ¬¡åªå±€é™äºæ–°ç”Ÿä»£åŒºåŸŸå†…çš„æ”¶é›† (Minor GC)ï¼Œä½†æ–°ç”Ÿä»£çš„å®ä¾‹å¯¹è±¡ 1 åœ¨è€å¹´ä»£ä¸­è¢«å¼•ç”¨ï¼Œä¸ºäº†æ‰¾å‡ºè¯¥åŒºåŸŸ (æ–°ç”Ÿä»£) ä¸­æ‰€æœ‰çš„å­˜æ´»å¯¹è±¡ï¼Œä¸å¾—ä¸åœ¨å›ºå®šçš„ GC Roots ä¹‹å¤–ï¼Œå†<strong>é¢å¤–éå†æ•´ä¸ªè€å¹´ä»£</strong>ä¸­æ‰€æœ‰å¯¹è±¡æ¥ç¡®ä¿å¯è¾¾æ€§åˆ†æç»“æœçš„æ­£ç¡®æ€§ï¼Œåè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·ã€‚éå†æ•´ä¸ªè€å¹´ä»£æ‰€æœ‰å¯¹è±¡çš„æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œï¼Œä½†æ— ç–‘ä¼šä¸ºå†…å­˜å›æ”¶å¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½è´Ÿæ‹…ã€‚</p>\n<p>ğŸ‘‰ğŸ»äº‹å®ä¸Šå¹¶ä¸åªæ˜¯æ–°ç”Ÿä»£ã€è€å¹´ä»£ä¹‹é—´æ‰æœ‰<strong>è·¨ä»£å¼•ç”¨</strong>çš„é—®é¢˜ï¼Œæ‰€æœ‰æ¶‰åŠéƒ¨åˆ†åŒºåŸŸæ”¶é›†ï¼ˆPartial GC) è¡Œä¸ºçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå…¸å‹çš„å¦‚<span class=\"blue\"><strong> G1</strong></span>ã€<span class=\"blue\"><strong>ZGC</strong></span> å’Œ<span class=\"blue\"><strong> Shenandoah</strong></span> æ”¶é›†å™¨ï¼Œéƒ½ä¼šé¢ä¸´ç›¸åŒçš„é—®é¢˜ã€‚</p>\n<h2 id=\"é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢\"><a class=\"anchor\" href=\"#é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢\">#</a> é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è§£å†³è·¨ä»£å¼•ç”¨å‘¢ï¼Ÿ</h2>\n<p>é¦–å…ˆï¼Œ<strong>è·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£å¼•ç”¨æ¥è¯´ä»…å æå°‘æ•°</strong>ã€‚åŸå› æ˜¯è·¨ä»£å¼•ç”¨çš„å¯¹è±¡åº”è¯¥å€¾å‘äºåŒæ—¶ç”Ÿå­˜æˆ–è€…åŒæ—¶æ­»äº¡çš„ï¼ˆä¸¾ä¸ªğŸŒ°ï¼šå¦‚æœæŸä¸ªæ–°ç”Ÿä»£å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨ï¼Œç”±äºè€å¹´ä»£å¯¹è±¡éš¾ä»¥æ¶ˆäº¡ï¼Œè¯¥å¼•ç”¨ä¼šä½¿å¾—æ–°ç”Ÿä»£å¯¹è±¡åœ¨æ”¶é›†æ—¶åŒæ ·å¾—ä»¥å­˜æ´»ï¼Œè¿›è€Œåœ¨å¹´é¾„å¢é•¿ä¹‹åæ™‹å‡åˆ°è€å¹´ä»£ä¸­ï¼Œè¿™æ—¶è·¨ä»£å¼•ç”¨ä¹Ÿéšå³è¢«æ¶ˆé™¤äº†ï¼‰ã€‚</p>\n<p>ğŸŒ´ğŸŒ´ä¾æ®ä¸Šé¢è¯´æ‰€ï¼Œå°±ä¸åº”å†ä¸ºäº†å°‘é‡çš„è·¨ä»£å¼•ç”¨å»æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼Œä¹Ÿä¸å¿…æµªè´¹ç©ºé—´ä¸“é—¨è®°å½•æ¯ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨åŠå­˜åœ¨å“ªäº›è·¨ä»£å¼•ç”¨ï¼Œåªéœ€åœ¨æ–°ç”Ÿä»£ä¸Šå»ºç«‹ä¸€ä¸ªå…¨å±€çš„æ•°æ®ç»“æ„ï¼ˆè¯¥ç»“æ„è¢«ç§°ä¸º <strong>â€œè®°å¿†é›†â€</strong> ï¼ŒRemembered Set)ï¼Œ <strong>è¿™ä¸ªç»“æ„æŠŠè€å¹´ä»£åˆ’åˆ†æˆè‹¥å¹²å°å—ï¼Œæ ‡è¯†å‡ºè€å¹´ä»£çš„å“ªä¸€å—å†…å­˜ä¼šå­˜åœ¨è·¨ä»£å¼•ç”¨ã€‚</strong> æ­¤åå½“å‘ç”Ÿ Minor GC æ—¶ï¼Œåªæœ‰åŒ…å«äº†è·¨ä»£å¼•ç”¨çš„å°å—å†…å­˜é‡Œçš„å¯¹è±¡æ‰ä¼šè¢«åŠ å…¥åˆ° GCRoots è¿›è¡Œæ‰«æã€‚è™½ç„¶è¿™ç§æ–¹æ³•éœ€è¦åœ¨å¯¹è±¡æ”¹å˜å¼•ç”¨å…³ç³» (å¦‚å°†è‡ªå·±æˆ–è€…æŸä¸ªå±æ€§èµ‹å€¼) æ—¶ç»´æŠ¤è®°å½•æ•°æ®çš„æ­£ç¡®æ€§ï¼Œä¼šå¢åŠ ä¸€äº›è¿è¡Œæ—¶çš„å¼€é”€ï¼Œä½†æ¯”èµ·æ”¶é›†æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£æ¥è¯´ä»ç„¶æ˜¯åˆ’ç®—çš„ã€‚</p>\n<p>ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ªå…¨å±€çš„æ•°æ®ç»“æ„è®°å¿†é›†ã€‚</p>\n<h2 id=\"è®°å¿†é›†\"><a class=\"anchor\" href=\"#è®°å¿†é›†\">#</a> è®°å¿†é›†</h2>\n<p>âœ¨è®°å¿†é›†æ˜¯ä¸€ç§ç”¨äºè®°å½•ä»<span class=\"blue\"><strong>éæ”¶é›†åŒºåŸŸ</strong></span>æŒ‡å‘<span class=\"pink\"><strong>æ”¶é›†åŒºåŸŸ</strong></span>çš„æŒ‡é’ˆé›†åˆçš„<span class=\"red\"><strong>æŠ½è±¡</strong></span>æ•°æ®ç»“æ„ã€‚å¦‚æœæˆ‘ä»¬ä¸è€ƒè™‘æ•ˆç‡å’Œæˆæœ¬çš„è¯ï¼Œæœ€ç®€å•çš„å®ç°å¯ä»¥ç”¨éæ”¶é›†åŒºåŸŸä¸­æ‰€æœ‰å«è·¨ä»£å¼•ç”¨çš„å¯¹è±¡æ•°ç»„æ¥å®ç°è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤º:</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// ä»¥å¯¹è±¡æŒ‡é’ˆæ¥å®ç°è®°å¿†é›†çš„ä¼ªä»£ç </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Class</span> <span class=\"token class-name\">RememberedSet</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> set<span class=\"token punctuation\">[</span>OBJECT_INTERGENERATIONAL_REFERENCE_SIZE<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ğŸˆè¿™ç§è®°å½•å…¨éƒ¨å«è·¨ä»£å¼•ç”¨å¯¹è±¡çš„å®ç°æ–¹æ¡ˆï¼Œæ— è®ºæ˜¯ç©ºé—´å ç”¨è¿˜æ˜¯ç»´æŠ¤æˆæœ¬éƒ½ç›¸å½“é«˜æ˜‚ã€‚è€Œåœ¨åƒåœ¾æ”¶é›†çš„åœºæ™¯ä¸­ï¼Œ<strong>æ”¶é›†å™¨åªéœ€è¦é€šè¿‡è®°å¿†é›†åˆ¤æ–­å‡ºæŸä¸€å—éæ”¶é›†åŒºåŸŸæ˜¯å¦å­˜åœ¨æœ‰æŒ‡å‘äº†æ”¶é›†åŒºåŸŸçš„æŒ‡é’ˆå°±å¯ä»¥äº†</strong>ï¼Œå¹¶ä¸éœ€è¦äº†è§£è¿™äº›è·¨ä»£æŒ‡é’ˆçš„å…¨éƒ¨ç»†èŠ‚ã€‚é‚£è®¾è®¡è€…åœ¨å®ç°è®°å¿†é›†çš„æ—¶å€™ï¼Œä¾¿å¯ä»¥é€‰æ‹©æ›´ä¸ºç²—çŠ·çš„è®°å½•ç²’åº¦æ¥èŠ‚çœè®°å¿†é›†çš„å­˜å‚¨å’Œç»´æŠ¤æˆæœ¬ã€‚ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å¯ä¾›é€‰æ‹©ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„ï¼‰çš„è®°å½•ç²¾åº¦ï¼š</p>\n<ul>\n<li><strong>å­—é•¿ç²¾åº¦ï¼š</strong> æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªæœºå™¨å­—é•¿ï¼ˆå°±æ˜¯å¤„ç†å™¨çš„å¯»å€ä½æ•°ï¼Œå¦‚å¸¸è§çš„ 32 ä½æˆ– 64 ä½ï¼Œè¿™ä¸ª ç²¾åº¦å†³å®šäº†æœºå™¨è®¿é—®ç‰©ç†å†…å­˜åœ°å€çš„æŒ‡é’ˆé•¿åº¦ï¼‰ï¼Œè¯¥å­—åŒ…å«è·¨ä»£æŒ‡é’ˆã€‚</li>\n<li><strong>å¯¹è±¡ç²¾åº¦ï¼š</strong> æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡é‡Œæœ‰å­—æ®µå«æœ‰è·¨ä»£æŒ‡é’ˆã€‚</li>\n<li><strong>å¡ç²¾åº¦ï¼š</strong> æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€å—å†…å­˜åŒºåŸŸï¼Œè¯¥åŒºåŸŸå†…æœ‰å¯¹è±¡å«æœ‰è·¨ä»£æŒ‡é’ˆã€‚</li>\n</ul>\n<p>ğŸğŸä¸Šé¢çš„ï¼Œç¬¬ä¸‰ç§ â€œå¡ç²¾åº¦â€ æ‰€æŒ‡çš„æ˜¯ç”¨ä¸€ç§ç§°ä¸º **â€œå¡è¡¨â€(Card Table)** çš„æ–¹å¼å»å®ç°è®°å¿†é›†ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„è®°å¿†é›†çš„å®ç°å½¢å¼ã€‚</p>\n<h3 id=\"å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢\"><a class=\"anchor\" href=\"#å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢\">#</a> å¡è¡¨å’Œè®°å¿†é›†åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</h3>\n<p>ğŸ‘€å‰é¢ä»‹ç»è®°å¿†é›†çš„æ—¶å€™æåˆ° è®°å¿†é›†å…¶å®æ˜¯ä¸€ç§<span class=\"red\"><strong> &quot; æŠ½è±¡â€</strong></span> çš„æ•°æ®ç»“æ„ï¼ŒæŠ½è±¡çš„æ„æ€æ˜¯<span class=\"orange\">åªå®šä¹‰äº†è®°å¿†é›†çš„è¡Œä¸ºæ„å›¾ï¼Œå¹¶æ²¡æœ‰å®šä¹‰å…¶è¡Œä¸ºçš„å…·ä½“å®ç°</span>ã€‚<strong><span class=\"blue\">å¡è¡¨</span>å°±æ˜¯è®°å¿†é›†çš„ä¸€ç§å…·ä½“å®ç°</strong>ï¼Œå®ƒå®šä¹‰äº†è®°å¿†é›†çš„è®°å½•ç²¾åº¦ã€ä¸å †å†…å­˜çš„æ˜ å°„å…³ç³»ç­‰ã€‚å…³äºè®°å¿†é›†ä¸å¡è¡¨çš„å…³ç³»ï¼Œå¯ä»¥æŒ‰ç…§ Java ä¸­ Map ä¸ HashMap çš„å…³ç³»æ¥ç±»æ¯”ç†è§£ï¼ˆå³æ¥å£å’Œå®ç°ç±»æ¥çš„å…³ç³»ï¼‰ã€‚</p>\n<p>ğŸ‹ä¸‹é¢æ¥è¯¦ç»†è¯´ä¸€ä¸‹è®°å¿†é›†çš„å…·ä½“å®ç°å¡è¡¨</p>\n<h2 id=\"å¡è¡¨\"><a class=\"anchor\" href=\"#å¡è¡¨\">#</a> å¡è¡¨</h2>\n<p>âœ¨å¡è¡¨æ˜¯ä½¿ç”¨ä¸€ä¸ª ** å­—èŠ‚æ•°ç»„ CARD_TABLE []Â ** å®ç°ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”å…¶æ ‡è¯†çš„å†…å­˜åŒºåŸŸä¸€å—ç‰¹å®šå¤§å°çš„å†…å­˜å—ï¼Œæ¯ä¸ªå†…å­˜å—ç§°ä¸ºå¡é¡µï¼Œhotspot ä½¿ç”¨çš„å¡é¡µæ˜¯ 2^9 å¤§å° å³ 512 å­—èŠ‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p>\n<p><img data-src=\"/assets/2022-3/jvm2.png\" alt=\"image\" /></p>\n<p>ğŸ¦è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæŸä¸ªåŒºåŸŸæŒ‰ç…§å¡é¡µè¿›è¡Œåˆ’åˆ†ï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨è¦å¯¹æ–°ç”Ÿä»£åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠè€å¹´ä»£åŒºåŸŸçœ‹æˆæ˜¯ä¸€ä¸ªå¡é¡µä¸€ä¸ªå¡é¡µåˆ’åˆ†å¥½çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img data-src=\"/assets/2022-3/jvm3.png\" alt=\"image\" /></p>\n<p>å¦‚å›¾æ‰€ç¤ºğŸ¹ï¼Œå› ä¸º cardpage1 ä¸­å­˜åœ¨æŒ‡å‘æ–°ç”Ÿä»£çš„è·¨ä»£å¼•ç”¨ï¼Œæ‰€ä»¥å¯¹åº”å¡è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸º 1ï¼Œè¡¨æ˜è¯¥ page åŒºåŸŸå­˜åœ¨è·¨ä»£åº”ç”¨çš„å¯¹è±¡ã€‚</p>\n<p><strong>ğŸ“å¡è¡¨è§’åº¦ï¼š</strong> å› ä¸º page1 ä¸­å­˜åœ¨è·¨ä»£é¥®ç”¨çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¡è¡¨å¯¹åº”çš„ç¬¬ä¸€ä¸ªä½ç½®è®°ä¸º 1ï¼Œè¡¨æ˜ page1 è¿™ä¸ªå…ƒç´ å˜è„ã€‚</p>\n<p><strong>ğŸ“å†…å­˜å›æ”¶è§’åº¦ï¼š</strong> å› ä¸ºå¡è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸º 1ï¼Œè¡¨æ˜è¯¥ page åŒºåŸŸå­˜åœ¨è·¨ä»£åº”ç”¨çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶çš„æ—¶å€™éœ€è¦æ‰«æè¯¥åŒºåŸŸã€‚</p>\n<p>ğŸ˜ä¸€ä¸ªå¡é¡µçš„å†…å­˜ä¸­é€šå¸¸åŒ…å«ä¸æ­¢ä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦å¡é¡µå†…æœ‰ä¸€ä¸ª (æˆ–æ›´å¤šï¼‰å¯¹è±¡çš„å­—æ®µå­˜åœ¨ç€è·¨ä»£æŒ‡é’ˆï¼Œé‚£å°±å°†å¯¹åº”å¡è¡¨çš„æ•°ç»„å…ƒç´ çš„å€¼æ ‡è¯†ä¸º 1ï¼Œç§°ä¸ºè¿™ä¸ª<span class=\"purple\">å…ƒç´ å˜è„ï¼ˆDirty)</span>ï¼Œæ²¡æœ‰åˆ™æ ‡è¯†ä¸º 0ã€‚åœ¨åƒåœ¾æ”¶é›†å‘ç”Ÿæ—¶ï¼Œ** åªè¦ç­›é€‰å‡ºå¡è¡¨ä¸­å˜è„çš„å…ƒç´ ï¼Œå°±èƒ½è½»æ˜“å¾—å‡ºå“ªäº›å¡é¡µå†…å­˜å—ä¸­åŒ…å«è·¨ä»£æŒ‡é’ˆï¼ŒæŠŠå®ƒä»¬åŠ å…¥ GC Roots ä¸­ä¸€å¹¶æ‰«æã€‚** è¿™æ ·å°±ä¸éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£å¤§å¤§å‡å°‘ GC Roots çš„æ‰«æèŒƒå›´ã€‚</p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "JVM",
                "java",
                "åƒåœ¾å›æ”¶"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/11/275d4281e1a0/",
            "url": "https://shaogezhu.cn/2021/11/275d4281e1a0/",
            "title": "MySQLä¸­ï¼šä¸€æ¡updateè¯­å¥æ˜¯æ€æ ·æ‰§è¡Œçš„",
            "date_published": "2021-11-30T15:29:53.000Z",
            "content_html": "<div class=\"note info\">\n<p>ğŸ¥‚ä¸Šä¸€ç¯‡æ–‡ç« è¯´å®Œ MySQL çš„äº‹åŠ¡å’Œé”äº†ï¼Œè¿™æ¬¡æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹åœ¨ MySQL ä¸­ä¸€æ¡æ›´æ–°è¯­å¥çš„è¯¦ç»†æ‰§è¡Œæµç¨‹ (æœ¬æ–‡æ— ç‰¹æ®Šè¯´æ˜å‡æ˜¯é‡‡ç”¨ Innodb å­˜å‚¨å¼•æ“)ã€‚</p>\n</div>\n<h2 id=\"å‰æœŸå‡†å¤‡\"><a class=\"anchor\" href=\"#å‰æœŸå‡†å¤‡\">#</a> å‰æœŸå‡†å¤‡</h2>\n<p>â­â­é¦–å…ˆåˆ›å»ºä¸€å¼ è¡¨ï¼Œç„¶åæ’å…¥ä¸‰æ¡æ•°æ®ï¼š</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> T<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tID <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tc <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span>ID<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COMMENT</span><span class=\"token operator\">=</span><span class=\"token string\">'æµ‹è¯•è¡¨'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> T<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è®©åæ‰§è¡Œæ›´æ–°æ“ä½œï¼š</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">update</span> T <span class=\"token keyword\">set</span> c<span class=\"token operator\">=</span>c<span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token keyword\">where</span> ID<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>åœ¨è¯´æ›´æ–°æ“ä½œå‰ï¼Œå¤§å®¶å…ˆæ¥çœ‹ä¸€ä¸‹ sql è¯­å¥åœ¨ MySQL ä¸­çš„æ‰§è¡Œæµç¨‹ğŸ¬~</p>\n<h2 id=\"sqlè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹\"><a class=\"anchor\" href=\"#sqlè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹\">#</a> SQL è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹</h2>\n<p><img data-src=\"/assets/2021-11/sql1.png\" alt=\"image.png\" /></p>\n<p>ğŸ‘©å¦‚å›¾æ‰€ç¤ºï¼šMySQL æ•°æ®åº“ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªå±‚çº§ï¼š<strong>æœåŠ¡å±‚</strong>å’Œ<strong>å­˜å‚¨å¼•æ“å±‚æœåŠ¡å±‚</strong>ï¼š<span class=\"blue\"><strong>server å±‚åŒ…æ‹¬</strong></span>ï¼šè¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ï¼ŒåŒ…æ‹¬å¤§å¤šæ•° MySQL ä¸­çš„æ ¸å¿ƒåŠŸèƒ½æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼ŒåŒ…æ‹¬ å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚ <span class=\"purple\"><strong>å­˜å‚¨å¼•æ“å±‚</strong></span>ï¼šå­˜å‚¨å¼•æ“å±‚åŒ…æ‹¬ MySQL å¸¸è§çš„å­˜å‚¨å¼•æ“ï¼ŒåŒ…æ‹¬ MyISAMã€InnoDB å’Œ Memory ç­‰ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ InnoDBï¼Œä¹Ÿæ˜¯ç°åœ¨ MySQL çš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚</p>\n<h3 id=\"serverå±‚ä¸­çš„ç»„ä»¶ä»‹ç»\"><a class=\"anchor\" href=\"#serverå±‚ä¸­çš„ç»„ä»¶ä»‹ç»\">#</a> server å±‚ä¸­çš„ç»„ä»¶ä»‹ç»</h3>\n<ol>\n<li><strong>è¿æ¥å™¨âœ¨ï¼š</strong> éœ€è¦ MySQL å®¢æˆ·ç«¯ç™»å½•ï¼Œéœ€è¦ä¸€ä¸ª è¿æ¥å™¨ æ¥è¿æ¥ç”¨æˆ·å’Œ MySQL æ•°æ®åº“ï¼Œâ€œmysql -u ç”¨æˆ·å -p å¯†ç â€ è¿›è¡Œ MySQL ç™»å½•ï¼Œåœ¨å®Œæˆ TCP æ¡æ‰‹ åï¼Œè¿æ¥å™¨ä¼šæ ¹æ®è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç éªŒè¯ç™»å½•èº«ä»½ã€‚</li>\n<li><strong>æŸ¥è¯¢ç¼“å­˜âœ¨ï¼š</strong> MySQL åœ¨å¾—åˆ°ä¸€ä¸ªæ‰§è¡Œè¯·æ±‚åï¼Œä¼šé¦–å…ˆå» æŸ¥è¯¢ç¼“å­˜ ä¸­æŸ¥æ‰¾ï¼Œæ˜¯å¦æ‰§è¡Œè¿‡è¿™æ¡ SQL è¯­å¥ï¼Œä¹‹å‰æ‰§è¡Œè¿‡å¾—è¯­å¥ä»¥åŠç»“æœä¼šä»¥ key-value å¯¹çš„å½¢å¼ï¼Œæ”¾åœ¨å†…å­˜ä¸­ã€‚key æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œvalue æ˜¯æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœé€šè¿‡ key èƒ½å¤ŸæŸ¥æ‰¾åˆ°è¿™æ¡ SQL è¯­å¥ï¼Œç›´æ¥è¿”å› SQL çš„æ‰§è¡Œç»“æœã€‚è‹¥ä¸å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœå°±ä¼šè¢«æ”¾å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ã€‚ä½†æ˜¯æŸ¥è¯¢ç¼“å­˜ä¸å»ºè®®ä½¿ç”¨ï¼Œ å› ä¸ºåœ¨ MySQL ä¸­å¯¹æŸå¼ è¡¨è¿›è¡Œäº†æ›´æ–°æ“ä½œï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜å°±ä¼šå¤±æ•ˆï¼Œå¯¹äºæ›´æ–°é¢‘ç¹çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡å¾ˆä½ã€‚éœ€è¦æ³¨æ„ï¼šåœ¨ MySQL8.0 ç‰ˆæœ¬ï¼ŒæŸ¥è¯¢ç¼“å­˜åŠŸèƒ½å°±åˆ é™¤äº†ï¼Œä¸å­˜åœ¨æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½äº†</li>\n<li><strong>åˆ†æå™¨âœ¨:</strong> åˆ†ä¸ºè¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æ\n<ul>\n<li><strong>è¯æ³•åˆ†æï¼š</strong> é¦–å…ˆï¼ŒMySQL ä¼šæ ¹æ® SQL è¯­å¥è¿›è¡Œè§£æï¼Œåˆ†æå™¨ä¼šå…ˆåš è¯æ³•åˆ†æï¼Œä½ å†™çš„ SQL å°±æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡ SQL è¯­å¥ï¼ŒMySQL éœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚</li>\n<li><strong>è¯­æ³•åˆ†æï¼š</strong> ç„¶åè¿›è¡Œ è¯­æ³•åˆ†æï¼Œ æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚å¦‚æœ SQL è¯­å¥ä¸æ­£ç¡®ï¼Œå°±æç¤ºï¼šYou have an error in your SQL suntax</li>\n</ul>\n</li>\n<li><strong>ä¼˜åŒ–å™¨âœ¨ï¼š</strong> ç»è¿‡åˆ†æå™¨åˆ†æåï¼ŒSQL å°±åˆæ³•äº†ï¼Œä½†åœ¨æ‰§è¡Œä¹‹å‰ï¼Œè¿˜éœ€è¦è¿›è¡Œä¼˜åŒ–å™¨çš„å¤„ç†ï¼Œ<font color=\"blue\">ä¼˜åŒ–å™¨ä¼šåˆ¤æ–­ä½¿ç”¨äº†å“ªç§ç´¢å¼•ï¼Œä½¿ç”¨å“ªç§è¿æ¥</font>ï¼Œä¼˜åŒ–å™¨çš„ä½œç”¨ å°±æ˜¯ç¡®å®šæ•ˆç‡æœ€é«˜çš„æ‰§è¡Œæ–¹æ¡ˆã€‚</li>\n<li><strong>æ‰§è¡Œå™¨âœ¨ï¼š</strong> åœ¨æ‰§è¡Œé˜¶æ®µï¼ŒMySQL é¦–å…ˆä¼šåˆ¤æ–­æœ‰æ²¡æœ‰æ‰§è¡Œè¯­å¥çš„æƒé™ï¼Œè‹¥æ— æƒé™ï¼Œè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼›è‹¥æœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨æ—¶ï¼Œæ‰§è¡Œå™¨ä¼šæ ¹æ®æ ‡çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¯¥å¼•æ“æä¾›çš„æ¥å£ï¼Œå¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ç±»ä¼¼ã€‚</li>\n</ol>\n<p>äº†è§£å®Œ SQL è¯­å¥çš„æ‰§è¡Œæµç¨‹æˆ‘ä»¬æ¥ä¸‹æ¥è¯¦ç»†åˆ†æä¸€ä¸‹ä¸Šé¢ <code>update T set c=c+1 where ID=2;</code>  æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚</p>\n<h2 id=\"updateè¯­å¥åˆ†æ\"><a class=\"anchor\" href=\"#updateè¯­å¥åˆ†æ\">#</a> Update è¯­å¥åˆ†æ</h2>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">update</span> T <span class=\"token keyword\">set</span> c<span class=\"token operator\">=</span>c<span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token keyword\">where</span> ID<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>ğŸ…åœ¨æ‰§è¡Œ<strong> update æ›´æ–°</strong>æ“ä½œçš„æ—¶å€™ï¼Œè·Ÿè¿™ä¸ªè¡¨æœ‰å…³çš„æŸ¥è¯¢ç¼“å­˜ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥å°±ä¼šæŠŠè¡¨ T ä¸Šæ‰€æœ‰ç¼“å­˜ç»“æœéƒ½æ¸…ç©ºã€‚æ¥ä¸‹æ¥ï¼Œåˆ†æå™¨ä¼šç»è¿‡è¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼ŒçŸ¥é“äº†è¿™æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥åï¼Œä¼˜åŒ–å™¨å†³å®šè¦ä½¿ç”¨å“ªä¸€ä¸ªç´¢å¼•ï¼Œç„¶åæ‰§è¡Œå™¨è´Ÿè´£å…·ä½“çš„æ‰§è¡Œï¼Œå…ˆæ‰¾åˆ°è¿™ä¸€è¡Œï¼Œç„¶ååšæ›´æ–°ã€‚</p>\n</blockquote>\n<p>æŒ‰ç…§æˆ‘ä»¬å¹³å¸¸çš„æ€è·¯ï¼Œå°±æ˜¯ <strong>æ‰¾å‡ºè¿™æ¡è®°å½•ï¼ŒæŠŠå®ƒçš„å€¼æ”¹å¥½ï¼Œä¿å­˜å°± OK äº†</strong> ã€‚ä½†æˆ‘ä»¬è¿½ç©¶ä¸€ä¸‹ç»†èŠ‚ï¼Œç”±äºæ¶‰åŠåˆ°ä¿®æ”¹æ•°æ®ï¼Œæ‰€ä»¥æ¶‰åŠåˆ°æ—¥å¿—äº†ã€‚æ›´æ–°æ“ä½œæ¶‰åŠåˆ°ä¸¤ä¸ªé‡è¦çš„æ—¥å¿—æ¨¡å—ã€‚ <code>redo log(é‡åšæ—¥å¿—)</code> ï¼Œ <code>bin log(å½’æ¡£æ—¥å¿—)</code> ã€‚MySQL ä¸­çš„è¿™ä¸¤ä¸ªæ—¥å¿—ä¹Ÿæ˜¯å¿…å­¦çš„ã€‚</p>\n<h3 id=\"redo-logé‡åšæ—¥å¿—\"><a class=\"anchor\" href=\"#redo-logé‡åšæ—¥å¿—\">#</a> redo log (é‡åšæ—¥å¿—)</h3>\n<ul>\n<li>åœ¨ MySQL é‡Œï¼Œå¦‚æœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹ IO æˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜ã€‚<br />\nMySQL é‡Œä½¿ç”¨ WAL (é¢„å†™å¼æ—¥å¿—) æŠ€æœ¯ï¼ŒWAL çš„å…¨ç§°æ˜¯  <code>Write-Ahead Logging</code> ï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯ <strong><font color=\"red\">å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜</font></strong>ã€‚</li>\n<li>å…·ä½“æ¥è¯´ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDB å¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° redo log é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDB å¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšã€‚</li>\n<li>InnoDB çš„ redo log æ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ 1GBï¼Œé‚£ä¹ˆæ€»å…±å°±å¯ä»¥è®°å½• 4GB çš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ã€‚</li>\n</ul>\n<p>å¬å®Œä¸Šé¢å¯¹ redo log æ—¥å¿—çš„ä»‹ç»åï¼Œå°ä¼™ä¼´ä»¬å¯èƒ½ä¼šé—®ï¼š <code>redo logæ—¥å¿—å­˜å‚¨åœ¨å“ªï¼Ÿ</code> ï¼Œ   <code>æ•°æ®åº“ä¿¡æ¯ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œredo logæ—¥å¿—ä¹Ÿä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œä¸ºä»€ä¹ˆè¦å…ˆå†™åˆ°redo logä¸­å†å†™åˆ°æ•°æ®åº“ä¸­å‘¢ï¼Ÿ</code> ï¼Œ <code>redo logæ—¥å¿—å¦‚æœå­˜æ»¡æ•°æ®äº†æ€ä¹ˆåŠï¼Ÿ</code> ç­‰ç­‰ã€‚æ¥ä¸‹æ¥å°±è§£ç­”ä¸€ä¸‹è¿™äº›ç–‘é—®ã€‚</p>\n<h4 id=\"redo-logå­˜å‚¨åœ¨å“ªé‡Œ\"><a class=\"anchor\" href=\"#redo-logå­˜å‚¨åœ¨å“ªé‡Œ\">#</a> redo log å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ</h4>\n<p>ğŸ¦InnoDB å¼•æ“å…ˆæŠŠè®°å½•å†™åˆ° redo log ä¸­ï¼Œredo log åœ¨å“ªï¼Œå®ƒä¹Ÿæ˜¯åœ¨ç£ç›˜ä¸Šï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå†™ç£ç›˜çš„è¿‡ç¨‹ï¼Œ ä½†æ˜¯ä¸æ›´æ–°è¿‡ç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ›´æ–°è¿‡ç¨‹æ˜¯åœ¨ç£ç›˜ä¸Šéšæœº IOï¼Œè´¹æ—¶ã€‚ è€Œå†™ redo log æ˜¯åœ¨ç£ç›˜ä¸Šé¡ºåº IOã€‚æ•ˆç‡è¦é«˜ã€‚</p>\n<h4 id=\"redo-log-ç©ºé—´æ˜¯å›ºå®šé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢\"><a class=\"anchor\" href=\"#redo-log-ç©ºé—´æ˜¯å›ºå®šé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢\">#</a> redo log ç©ºé—´æ˜¯å›ºå®šï¼Œé‚£å®ƒä¼šä¸ä¼šç”¨å®Œå‘¢ï¼Ÿ</h4>\n<p>ğŸ¹é¦–å…ˆä¸ç”¨æ‹…å¿ƒ redo log ä¼šç”¨å®Œç©ºé—´ï¼Œå› ä¸ºå®ƒæ˜¯<strong>å¾ªç¯åˆ©ç”¨</strong>çš„ã€‚ä¾‹å¦‚ redo log æ—¥å¿—é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶åˆ†åˆ«ä¸º 1Gã€‚å®ƒå†™çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š<br />\n<img data-src=\"/assets/2021-11/sql2.png\" alt=\"image.png\" /></p>\n<blockquote>\n<p><strong>ç®€å•æ€»ç»“ä¸€ä¸‹:</strong> redo log æ—¥å¿—æ˜¯ Innodb å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥åº”å¯¹<strong>å¼‚å¸¸æ¢å¤</strong>ï¼Œ<strong>Crash-safe</strong>ï¼Œredo å¯ä»¥ä¿è¯ mysql å¼‚å¸¸é‡å¯æ—¶ï¼Œå°†æœªæäº¤çš„äº‹åŠ¡å›æ»šï¼Œå·²æäº¤çš„äº‹åŠ¡å®‰å…¨è½åº“ã€‚</p>\n</blockquote>\n<p><strong>crash-safe:</strong> æœ‰äº† redo logï¼ŒInnoDB å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º crash-safeã€‚</p>\n<h3 id=\"binlogå½’æ¡£æ—¥å¿—\"><a class=\"anchor\" href=\"#binlogå½’æ¡£æ—¥å¿—\">#</a> binlog (å½’æ¡£æ—¥å¿—)</h3>\n<p>ğŸ™‡redo log æ˜¯ innoDB å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ã€‚è€Œ binlog æ˜¯ mysql server å±‚çš„æ—¥å¿—ã€‚</p>\n<blockquote>\n<p>å…¶å® bin log æ—¥å¿—å‡ºç°çš„æ—¶é—´æ¯” redo log æ—©ï¼Œå› ä¸ºæœ€å¼€å§‹ MySQL æ˜¯æ²¡æœ‰ InnoDB å­˜å‚¨å¼•æ“çš„ï¼Œ5.5 ä¹‹å‰æ˜¯ MyISAMã€‚ä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿ â€”â€” ä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚</p>\n</blockquote>\n<h4 id=\"redo-logå’Œbin-logçš„æ€»ç»“\"><a class=\"anchor\" href=\"#redo-logå’Œbin-logçš„æ€»ç»“\">#</a>  <code>redo log</code>  å’Œ <code>bin log</code>  çš„æ€»ç»“ğŸ“:</h4>\n<ul>\n<li>redo log æ˜¯ä¸ºäº†ä¿è¯ innoDB å¼•æ“çš„ crash-safe èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ mysql å¼‚å¸¸å®•æœºé‡å¯çš„æ—¶å€™ï¼Œä¹‹å‰æäº¤çš„äº‹åŠ¡å¯ä»¥ä¿è¯ä¸ä¸¢å¤±ï¼›(å› ä¸ºæˆåŠŸæäº¤çš„äº‹åŠ¡è‚¯å®šæ˜¯å†™å…¥äº† redo log, å¯ä»¥ä» redo log æ¢å¤)</li>\n<li>bin log æ˜¯å½’æ¡£æ—¥å¿—ï¼Œå°†æ¯ä¸ªæ›´æ–°æ“ä½œéƒ½è¿½åŠ åˆ°æ—¥å¿—ä¸­ã€‚è¿™æ ·å½“éœ€è¦å°†æ—¥å¿—æ¢å¤åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ ¹æ®å…¨é‡å¤‡ä»½ + bin log é‡æ”¾å®ç°ã€‚ å¦‚æœæ²¡æœ‰å¼€å¯ binlog, é‚£ä¹ˆæ•°æ®åªèƒ½æ¢å¤åˆ°å…¨é‡å¤‡ä»½çš„æ—¶é—´ç‚¹ï¼Œè€Œä¸èƒ½æ¢å¤åˆ°ä»»æ„æ—¶é—´ç‚¹ã€‚å¦‚æœè¿å…¨é‡å¤‡ä»½ä¹Ÿæ²¡åšï¼Œmysql å®•æœºï¼Œç£ç›˜ä¹Ÿåäº†ï¼Œé‚£å°±å¾ˆå°´å°¬äº†ã€‚ã€‚</li>\n</ul>\n<h4 id=\"redo-logå’Œbin-logçš„åŒºåˆ«\"><a class=\"anchor\" href=\"#redo-logå’Œbin-logçš„åŒºåˆ«\">#</a>  <code>redo log</code>  å’Œ <code>bin log</code>  çš„åŒºåˆ«ğŸ“:</h4>\n<ul>\n<li>redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›bin log æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li>\n<li><strong>redo log æ˜¯ç‰©ç†æ—¥å¿—</strong>ï¼Œè®°å½•çš„æ˜¯ â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›<strong>bin log æ˜¯é€»è¾‘æ—¥å¿—</strong>ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚ â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1â€ã€‚</li>\n<li>redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€ æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚</li>\n</ul>\n<h2 id=\"innodbå¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹\"><a class=\"anchor\" href=\"#innodbå¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹\">#</a> InnoDB å¼•æ“éƒ¨åˆ†åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„ update è¯­å¥çš„æ—¶å€™çš„å†…éƒ¨æµç¨‹</h2>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">update</span> T <span class=\"token keyword\">set</span> c<span class=\"token operator\">=</span>c<span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token keyword\">where</span> ID<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"/assets/2021-11/sql3.png\" alt=\"image.png\" /></p>\n<p><strong>ğŸ‘€æ‰‹åŠ¨ç”¨ begin å¼€å¯äº‹åŠ¡ï¼Œç„¶åæ‰§è¡Œ update è¯­å¥ï¼Œå†ç„¶åæ‰§è¡Œ commit è¯­å¥ï¼Œé‚£ä¸Šé¢çš„ update æ›´æ–°æµç¨‹ä¹‹å‰ å“ªäº›æ˜¯ update è¯­å¥æ‰§è¡Œä¹‹ååšçš„ï¼Œå“ªäº›æ˜¯ commit è¯­å¥æ‰§è¡Œä¹‹ååšçš„ï¼Ÿ</strong></p>\n<blockquote>\n<p>äº‹å®ä¸ŠğŸ‹ï¼Œredo log åœ¨å†…å­˜ä¸­æœ‰ä¸€ä¸ª <code>redo log buffer</code> ,binlog ä¹Ÿæœ‰ä¸€ä¸ª <code>binlog cache</code> . æ‰€ä»¥åœ¨æ‰‹åŠ¨å¼€å¯çš„äº‹åŠ¡ä¸­ï¼Œä½ æ‰§è¡Œ sql è¯­å¥ï¼Œå…¶å®æ˜¯å†™åˆ° <code>redo log buffer</code>  å’Œ <code>binlog cache</code>  ä¸­å»çš„ (è‚¯å®šä¸å¯èƒ½æ˜¯ç›´æ¥å†™ç£ç›˜æ—¥å¿—ï¼Œä¸€ä¸ªæ˜¯æ€§èƒ½å·®ä¸€ä¸ªæ˜¯å›æ»šçš„æ—¶å€™ä¸å¯èƒ½å»å›æ»šç£ç›˜æ—¥å¿—å§)ï¼Œç„¶åå½“ä½ æ‰§è¡Œ commit çš„æ—¶å€™ï¼Œé¦–å…ˆè¦å°† redo log çš„æäº¤çŠ¶æ€æ¸¸ prepare æ”¹ä¸º commit çŠ¶æ€ï¼Œç„¶åå°±è¦æŠŠ <code>binlog cache</code>  åˆ·æ–°åˆ° binlog æ—¥å¿— (å¯èƒ½ä¹Ÿåªæ˜¯ flush åˆ°æ“ä½œç³»ç»Ÿçš„ page cacheï¼Œè¿™ä¸ªå°±çœ‹ä½ çš„ mysql é…ç½®)ï¼Œ <code>redo log buffer</code>  åˆ·æ–°åˆ° redo log æ—¥å¿— (åˆ·æ–°æ—¶æœºä¹Ÿæ˜¯å¯ä»¥é…ç½®çš„)ã€‚ å¦‚æœä½ å›æ»šçš„è¯ï¼Œå°±åªç”¨æŠŠ <code>binlog cache</code>  å’Œ <code>redo log buffer</code>  ä¸­çš„æ•°æ®æ¸…é™¤å°±è¡Œäº†ã€‚</p>\n</blockquote>\n <br>\n<p><strong>ğŸˆåœ¨ update è¿‡ç¨‹ä¸­ï¼Œmysql çªç„¶å®•æœºï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</strong></p>\n<ol>\n<li>å¦‚æœ redolog å†™å…¥äº†ï¼Œå¤„äº prepare çŠ¶æ€ï¼Œbinlog è¿˜æ²¡å†™å…¥ï¼Œé‚£ä¹ˆå®•æœºé‡å¯åï¼Œredolog ä¸­çš„è¿™ä¸ªäº‹åŠ¡å°±ç›´æ¥å›æ»šäº†ã€‚</li>\n<li>å¦‚æœ redolog å†™å…¥äº†ï¼Œbinlog ä¹Ÿå†™å…¥äº†ï¼Œä½† redolog è¿˜æ²¡æœ‰æ›´æ–°ä¸º commit çŠ¶æ€ï¼Œé‚£ä¹ˆå®•æœºé‡å¯ä»¥åï¼Œmysql ä¼šå»æ£€æŸ¥å¯¹åº”äº‹åŠ¡åœ¨ binlog ä¸­æ˜¯å¦å®Œæ•´ã€‚å¦‚æœæ˜¯ï¼Œå°±æäº¤äº‹åŠ¡ï¼›å¦‚æœä¸æ˜¯ï¼Œå°±å›æ»šäº‹åŠ¡ã€‚ (redolog å¤„äº prepare çŠ¶æ€ï¼Œbinlog å®Œæ•´å¯åŠ¨æ—¶å°±æäº¤äº‹åŠ¡ï¼Œä¸ºå•¥è¦è¿™ä¹ˆè®¾è®¡ï¼Ÿä¸»è¦æ˜¯å› ä¸º binlog å†™å…¥äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¢«ä»åº“æˆ–è€…ç”¨è¿™ä¸ª binlog æ¢å¤å‡ºæ¥çš„åº“ä½¿ç”¨ï¼Œä¸ºäº†æ•°æ®ä¸€è‡´æ€§å°±é‡‡ç”¨äº†è¿™ä¸ªç­–ç•¥)<br />\n redo log å’Œ binlog æ˜¯é€šè¿‡ xid è¿™ä¸ªå­—æ®µå…³è”èµ·æ¥çš„ã€‚</li>\n</ol>\n<p>ğŸš€ğŸš€ğŸš€</p>\n<br>",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "MySQL",
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/11/2a1449b2531c/",
            "url": "https://shaogezhu.cn/2021/11/2a1449b2531c/",
            "title": "MySQLå¸¸è§çš„é”åˆ†æ",
            "date_published": "2021-11-21T08:43:00.000Z",
            "content_html": "<div class=\"note info\">\n<p>ğŸŒ´ğŸŒ´æ•°æ®åº“é”å®šæœºåˆ¶ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°æ®åº“<strong>ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§</strong>ï¼Œè€Œä½¿å„ç§å…±äº«èµ„æºåœ¨è¢«å¹¶å‘è®¿é—®å˜å¾—æœ‰åºæ‰€è®¾è®¡çš„ä¸€ç§è§„åˆ™ã€‚å¯¹äºä»»ä½•ä¸€ç§æ•°æ®åº“æ¥è¯´éƒ½éœ€è¦æœ‰ç›¸åº”çš„é”å®šæœºåˆ¶ï¼Œæ‰€ä»¥ MySQL è‡ªç„¶ä¹Ÿä¸èƒ½ä¾‹å¤–ã€‚ä¸‹é¢å°±ç»™å¤§å®¶è¯¦ç»†ä»‹ç»ä¸€ä¸‹</p>\n</div>\n<h2 id=\"mysqlçš„é”\"><a class=\"anchor\" href=\"#mysqlçš„é”\">#</a> MySQL çš„é”</h2>\n<h3 id=\"æ¦‚è¿°\"><a class=\"anchor\" href=\"#æ¦‚è¿°\">#</a> æ¦‚è¿°</h3>\n<p>ğŸŒ»ğŸŒ»MySQL æ•°æ®åº“ç”±äºå…¶è‡ªèº«æ¶æ„çš„ç‰¹ç‚¹ï¼Œå­˜åœ¨å¤šç§æ•°æ®å­˜å‚¨å¼•æ“ï¼Œæ¯ç§å­˜å‚¨å¼•æ“æ‰€é’ˆå¯¹çš„åº”ç”¨åœºæ™¯ç‰¹ç‚¹éƒ½ä¸å¤ªä¸€æ ·ï¼Œä¸ºäº†æ»¡è¶³å„è‡ªç‰¹å®šåº”ç”¨åœºæ™¯çš„éœ€æ±‚ï¼Œæ¯ç§å­˜å‚¨å¼•æ“çš„é”å®šæœºåˆ¶éƒ½æ˜¯ä¸ºå„è‡ªæ‰€é¢å¯¹çš„ç‰¹å®šåœºæ™¯è€Œä¼˜åŒ–è®¾è®¡ï¼Œæ‰€ä»¥å„å­˜å‚¨å¼•æ“çš„é”å®šæœºåˆ¶ä¹Ÿæœ‰è¾ƒå¤§åŒºåˆ«ã€‚æœ¬æ–‡æ²¡æœ‰è¯´æ˜çš„æƒ…å†µä¸‹é»˜è®¤ä½¿ç”¨çš„æ˜¯ Innodb å¼•æ“ã€‚</p>\n<h4 id=\"innodbåŸç†ç®€å•è¯´ä¸€ä¸‹\"><a class=\"anchor\" href=\"#innodbåŸç†ç®€å•è¯´ä¸€ä¸‹\">#</a> Innodb åŸç† (ç®€å•è¯´ä¸€ä¸‹)ï¼š</h4>\n<ul>\n<li>innodb ä¸€å®šå­˜åœ¨èšç°‡ç´¢å¼•ï¼Œé»˜è®¤ä»¥ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•ğŸš€</li>\n<li>æœ‰å‡ ä¸ªç´¢å¼•ï¼Œå°±æœ‰å‡ æ£µ B + æ ‘ (ä¸è€ƒè™‘ hash ç´¢å¼•çš„æƒ…å½¢)ğŸš€</li>\n<li>èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸ºç£ç›˜ä¸Šçš„çœŸå®æ•°æ®ã€‚éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹è¿˜æ˜¯ç´¢å¼•ï¼ŒæŒ‡å‘èšç°‡ç´¢å¼• B + æ ‘ã€‚ğŸš€</li>\n</ul>\n<h2 id=\"é”çš„åˆ†ç±»\"><a class=\"anchor\" href=\"#é”çš„åˆ†ç±»\">#</a> é”çš„åˆ†ç±»</h2>\n<ul>\n<li><strong>å…±äº«é” (S é”)ğŸ”’:</strong> å‡è®¾äº‹åŠ¡ T1 å¯¹æ•°æ® A åŠ ä¸Šå…±äº«é”ï¼Œé‚£ä¹ˆäº‹åŠ¡ T2 å¯ä»¥è¯»æ•°æ® Aï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® Aã€‚</li>\n<li><strong>æ’ä»–é” (X é”)ğŸ”’:</strong> å‡è®¾äº‹åŠ¡ T1 å¯¹æ•°æ® A åŠ ä¸Šæ’ä»–é”ï¼Œé‚£ä¹ˆäº‹åŠ¡ T2 ä¸èƒ½è¯»æ•°æ® Aï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® Aã€‚<br />\næˆ‘ä»¬é€šè¿‡ <code>update</code> ã€ <code>delete</code>  ç­‰è¯­å¥åŠ ä¸Šçš„é”éƒ½æ˜¯è¡Œçº§åˆ«çš„é”ã€‚åªæœ‰ <code>LOCK TABLE â€¦ READ</code>  å’Œ <code>LOCK TABLE â€¦ WRITE</code>  æ‰èƒ½ç”³è¯·è¡¨çº§åˆ«çš„é”ã€‚</li>\n<li><strong>æ„å‘å…±äº«é” (IS é”)ğŸ”’:</strong> ä¸€ä¸ªäº‹åŠ¡åœ¨è·å–ï¼ˆä»»ä½•ä¸€è¡Œ / æˆ–è€…å…¨è¡¨ï¼‰S é”ä¹‹å‰ï¼Œä¸€å®šä¼šå…ˆåœ¨æ‰€åœ¨çš„è¡¨ä¸ŠåŠ  IS é”ã€‚</li>\n<li><strong>æ„å‘æ’ä»–é” (IX é”)ğŸ”’:</strong> ä¸€ä¸ªäº‹åŠ¡åœ¨è·å–ï¼ˆä»»ä½•ä¸€è¡Œ / æˆ–è€…å…¨è¡¨ï¼‰X é”ä¹‹å‰ï¼Œä¸€å®šä¼šå…ˆåœ¨æ‰€åœ¨çš„è¡¨ä¸ŠåŠ  IX é”ã€‚</li>\n</ul>\n<h3 id=\"æ„å‘é”å­˜åœ¨çš„ç›®çš„\"><a class=\"anchor\" href=\"#æ„å‘é”å­˜åœ¨çš„ç›®çš„\">#</a> æ„å‘é”å­˜åœ¨çš„ç›®çš„</h3>\n<blockquote>\n<p>è¿™é‡Œè¯´ä¸€ä¸‹æ„å‘é”å­˜åœ¨çš„ç›®çš„ã€‚å‡è®¾äº‹åŠ¡ T1ï¼Œç”¨ X é”æ¥é”ä½äº†è¡¨ä¸Šçš„å‡ æ¡è®°å½•ï¼Œé‚£ä¹ˆæ­¤æ—¶è¡¨ä¸Šå­˜åœ¨ IX é”ï¼Œå³æ„å‘æ’ä»–é”ã€‚é‚£ä¹ˆæ­¤æ—¶äº‹åŠ¡ T2 è¦è¿›è¡Œ <code>LOCK TABLE â€¦ WRITE</code>  çš„è¡¨çº§åˆ«é”çš„è¯·æ±‚ï¼Œå¯ä»¥ç›´æ¥æ ¹æ®æ„å‘é”æ˜¯å¦å­˜åœ¨è€Œåˆ¤æ–­æ˜¯å¦æœ‰é”å†²çªã€‚ğŸˆ</p>\n</blockquote>\n<h3 id=\"åŠ é”ç®—æ³•\"><a class=\"anchor\" href=\"#åŠ é”ç®—æ³•\">#</a> åŠ é”ç®—æ³•</h3>\n<ul>\n<li><strong>Record Locksï¼š</strong> ç®€å•ç¿»è¯‘ä¸º<strong>è¡Œé”</strong>ã€‚æ³¨æ„äº†ï¼Œè¯¥é”æ˜¯å¯¹ç´¢å¼•è®°å½•è¿›è¡ŒåŠ é”ï¼é”æ˜¯åŠ åœ¨ç´¢å¼•ä¸Šè€Œä¸æ˜¯è¡Œä¸Šçš„ã€‚æ³¨æ„äº†ï¼Œinnodb ä¸€å®šå­˜åœ¨èšç°‡ç´¢å¼•ï¼Œå› æ­¤è¡Œé”æœ€ç»ˆéƒ½ä¼šè½åˆ°èšç°‡ç´¢å¼•ä¸Šï¼</li>\n<li><strong>Gap Locksï¼š</strong> ç®€å•ç¿»è¯‘ä¸º<strong>é—´éš™é”</strong>ï¼Œæ˜¯å¯¹ç´¢å¼•çš„é—´éš™åŠ é”ï¼Œå…¶ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œé˜²æ­¢å…¶ä»–äº‹ç‰©æ’å…¥æ•°æ®ã€‚åœ¨ <code>Read Committed</code>  éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸ä¼šä½¿ç”¨é—´éš™é”ã€‚è¿™é‡Œæˆ‘å¯¹å®˜ç½‘è¡¥å……ä¸€ä¸‹ï¼Œéš”ç¦»çº§åˆ«æ¯” <code>Read Committed</code>  ä½çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨é—´éš™é”ï¼Œå¦‚éš”ç¦»çº§åˆ«ä¸º <code>Read Uncommited</code>  æ—¶ï¼Œä¹Ÿä¸å­˜åœ¨é—´éš™é”ã€‚å½“éš”ç¦»çº§åˆ«ä¸º <code>Repeatable Read</code>  å’Œ <code>Serializable</code>  æ—¶ï¼Œå°±ä¼šå­˜åœ¨é—´éš™é”ã€‚</li>\n<li><strong>Next-Key Locksï¼š</strong> è¿™ä¸ªç†è§£ä¸º Record Lock + ç´¢å¼•å‰é¢çš„ Gap Lockã€‚è®°ä½äº†ï¼Œé”ä½çš„æ˜¯ç´¢å¼•å‰é¢çš„é—´éš™ï¼æ¯”å¦‚ä¸€ä¸ªç´¢å¼•åŒ…å«å€¼ï¼Œ10ï¼Œ11ï¼Œ13 å’Œ 20ã€‚é‚£ä¹ˆï¼Œé—´éš™é”çš„èŒƒå›´å¦‚ä¸‹</li>\n</ul>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span>negative infinity<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> positive infinity<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥çœ‹ä¸€ä¸‹ MySQL çš„å®˜æ–¹æ–‡æ¡£ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXYubXlzcWwuY29tL2RvYy9yZWZtYW4vNS43L2VuL2lubm9kYi1sb2NraW5nLmh0bWw=\">https://dev.mysql.com/doc/refman/5.7/en/innodb-locking.html</span></p>\n<h3 id=\"å¿«ç…§è¯»å’Œå½“å‰è¯»\"><a class=\"anchor\" href=\"#å¿«ç…§è¯»å’Œå½“å‰è¯»\">#</a> å¿«ç…§è¯»å’Œå½“å‰è¯»</h3>\n<blockquote>\n<p>åœ¨ mysql ä¸­ select åˆ†ä¸ºå¿«ç…§è¯»å’Œå½“å‰è¯»ï¼Œæ‰§è¡Œä¸‹é¢çš„è¯­å¥<br />\n <code>select * from table where id = ?; </code> <br />\næ‰§è¡Œçš„æ˜¯å¿«ç…§è¯»ï¼Œè¯»çš„æ˜¯æ•°æ®åº“è®°å½•çš„å¿«ç…§ç‰ˆæœ¬ï¼Œæ˜¯ä¸åŠ é”çš„ã€‚ï¼ˆè¿™ç§è¯´æ³•åœ¨éš”ç¦»çº§åˆ«ä¸º Serializable ä¸­ä¸æˆç«‹ï¼Œåé¢ä¼šå†è¡¥å……ã€‚ï¼‰</p>\n</blockquote>\n<blockquote>\n<p>é‚£ä¹ˆï¼Œæ‰§è¡Œ<br />\n <code>select * from table where id = ? lock in share mode; </code> <br />\nä¼šå¯¹è¯»å–è®°å½•åŠ  S é” (å…±äº«é”)ï¼Œæ‰§è¡Œ\t<br />\n <code>select * from table where id = ? for update</code> <br />\n ä¼šå¯¹è¯»å–è®°å½•åŠ  X é” (æ’ä»–é”)ï¼Œé‚£ä¹ˆåŠ çš„æ˜¯è¡¨é”è¿˜æ˜¯è¡Œé”å‘¢ï¼Ÿ</p>\n</blockquote>\n<h3 id=\"è¡¨é”orè¡Œé”\"><a class=\"anchor\" href=\"#è¡¨é”orè¡Œé”\">#</a> è¡¨é” or è¡Œé”</h3>\n<p>ğŸ¦é’ˆå¯¹è¿™ç‚¹ï¼Œæˆ‘ä»¬å…ˆå›å¿†ä¸€ä¸‹äº‹åŠ¡çš„å››ä¸ªéš”ç¦»çº§åˆ«ï¼Œä»–ä»¬ç”±å¼±åˆ°å¼ºå¦‚ä¸‹æ‰€ç¤º:</p>\n<ul>\n<li><strong>Read Uncommited(RU)ï¼š</strong> è¯»æœªæäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼</li>\n<li><strong>Read Committed (RC)ï¼š</strong> è¯»å·²æäº¤ï¼Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼</li>\n<li><strong>Repeatable Read (RR):</strong> å¯é‡å¤è¯»ï¼ŒåŠ å…¥é—´éš™é”ï¼Œä¸€å®šç¨‹åº¦ä¸Šé¿å…äº†å¹»è¯»çš„äº§ç”Ÿï¼æ³¨æ„äº†ï¼Œåªæ˜¯ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¹¶æ²¡æœ‰å®Œå…¨é¿å…ï¼æˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« è¯´æ˜ï¼å¦å¤–å°±æ˜¯è®°ä½ä»è¯¥çº§åˆ«æ‰å¼€å§‹åŠ å…¥é—´éš™é” (è¿™å¥è¯è®°ä¸‹æ¥ï¼Œåé¢æœ‰ç”¨åˆ°)!</li>\n<li><strong>Serializableï¼š</strong> ä¸²è¡ŒåŒ–ï¼Œè¯¥çº§åˆ«ä¸‹è¯»å†™ä¸²è¡ŒåŒ–ï¼Œä¸”æ‰€æœ‰çš„ <code>select</code>  è¯­å¥åéƒ½è‡ªåŠ¨åŠ ä¸Š <code>lock in share mode</code> ï¼Œå³ä½¿ç”¨äº†å…±äº«é”ã€‚å› æ­¤åœ¨è¯¥éš”ç¦»çº§åˆ«ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯å½“å‰è¯»ï¼Œè€Œä¸æ˜¯å¿«ç…§è¯»ã€‚</li>\n</ul>\n<p>é‚£ä¹ˆå…³äºæ˜¯è¡¨é”è¿˜æ˜¯è¡Œé”ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°ç½‘ä¸Šæœ€æµä¼ çš„ä¸€ä¸ªè¯´æ³•æ˜¯è¿™æ ·çš„</p>\n<blockquote>\n<p>InnoDB è¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ï¼Œè¿™ä¸€ç‚¹ MySQL ä¸ Oracle ä¸åŒï¼Œåè€…æ˜¯é€šè¿‡åœ¨æ•°æ®å—ä¸­å¯¹ç›¸åº”æ•°æ®è¡ŒåŠ é”æ¥å®ç°çš„ã€‚ InnoDB è¿™ç§è¡Œé”å®ç°ç‰¹ç‚¹æ„å‘³ç€ï¼šåªæœ‰é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼ŒInnoDB æ‰ä½¿ç”¨è¡Œçº§é”ï¼Œå¦åˆ™ï¼ŒInnoDB å°†ä½¿ç”¨è¡¨é”ï¼</p>\n</blockquote>\n<p>ğŸ‹è¿™å¥è¯å¤§å®¶å¯ä»¥æœä¸€ä¸‹ï¼Œéƒ½æ˜¯ä½ æŠ„æˆ‘çš„ï¼Œæˆ‘æŠ„ä½ çš„ã€‚é‚£ä¹ˆï¼Œè¿™å¥è¯æœ¬èº«æœ‰ä¸¤å¤„é”™è¯¯ï¼<br />\n<strong>é”™è¯¯ä¸€:</strong> å¹¶ä¸æ˜¯ç”¨è¡¨é”æ¥å®ç°é”è¡¨çš„æ“ä½œï¼Œè€Œæ˜¯åˆ©ç”¨äº† <code>Next-Key Locks</code> ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ç”¨äº†è¡Œé” + é—´éš™é”æ¥å®ç°é”è¡¨çš„æ“ä½œï¼</p>\n<p>ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œæˆ‘æ¥ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰è¡¨æ•°æ®å¦‚ä¸‹ï¼ŒpId ä¸ºä¸»é”®ç´¢å¼•</p>\n<table>\n<thead>\n<tr>\n<th>pId(int)</th>\n<th>name(varchar)</th>\n<th>num(int)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>aaa</td>\n<td>100</td>\n</tr>\n<tr>\n<td>2</td>\n<td>bbb</td>\n<td>200</td>\n</tr>\n<tr>\n<td>7</td>\n<td>ccc</td>\n<td>200</td>\n</tr>\n</tbody>\n</table>\n<p>æ‰§è¡Œè¯­å¥ (name åˆ—æ— ç´¢å¼•)</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">where</span> name <span class=\"token operator\">=</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>aaa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">for</span> <span class=\"token keyword\">update</span></pre></td></tr></table></figure><p>é‚£ä¹ˆæ­¤æ—¶åœ¨ pId=1,2,7 è¿™ä¸‰æ¡è®°å½•ä¸Šå­˜åœ¨è¡Œé” (æŠŠè¡Œé”ä½äº†)ã€‚å¦å¤–ï¼Œåœ¨ (-âˆ,1)(1,2)(2,7)(7,+âˆ) ä¸Šå­˜åœ¨é—´éš™é” (æŠŠé—´éš™é”ä½äº†)ã€‚å› æ­¤ï¼Œç»™äººä¸€ç§æ•´ä¸ªè¡¨é”ä½çš„é”™è§‰ï¼</p>\n<p><strong>ps:</strong> å¯¹è¯¥ç»“è®ºæœ‰ç–‘é—®çš„ï¼Œå¯è‡ªè¡Œæ‰§è¡Œ <code>show engine innodb status</code> ; è¯­å¥è¿›è¡Œåˆ†æã€‚</p>\n<p><strong>é”™è¯¯äºŒ:</strong> æ‰€æœ‰æ–‡ç« éƒ½ä¸æéš”ç¦»çº§åˆ«ï¼<br />\næ³¨æ„ä¸Šé¢è¯´çš„ï¼Œä¹‹æ‰€ä»¥èƒ½å¤Ÿé”è¡¨ï¼Œæ˜¯é€šè¿‡<strong>è¡Œé” + é—´éš™é”</strong>æ¥å®ç°çš„ã€‚é‚£ä¹ˆï¼ŒRU å’Œ RC éƒ½ä¸å­˜åœ¨é—´éš™é”ï¼Œè¿™ç§è¯´æ³•åœ¨ RU å’Œ RC ä¸­è¿˜èƒ½æˆç«‹ä¹ˆï¼Ÿ<br />\nå› æ­¤ï¼Œè¯¥è¯´æ³•åªåœ¨ RR å’Œ Serializable ä¸­æ˜¯æˆç«‹çš„ã€‚å¦‚æœéš”ç¦»çº§åˆ«ä¸º RU å’Œ RCï¼Œæ— è®ºæ¡ä»¶åˆ—ä¸Šæ˜¯å¦æœ‰ç´¢å¼•ï¼Œéƒ½ä¸ä¼šé”è¡¨ï¼Œåªé”è¡Œï¼</p>\n<h3 id=\"åˆ†æ\"><a class=\"anchor\" href=\"#åˆ†æ\">#</a> åˆ†æ</h3>\n<p>ğŸ¹ä¸‹é¢æ¥å¯¹å¼€å§‹çš„é—®é¢˜ä½œå‡ºè§£ç­”ï¼Œå‡è®¾æœ‰è¡¨å¦‚ä¸‹ï¼ŒpId ä¸ºä¸»é”®ç´¢å¼•</p>\n<table>\n<thead>\n<tr>\n<th>pId(int)</th>\n<th>name(varchar)</th>\n<th>num(int)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>aaa</td>\n<td>100</td>\n</tr>\n<tr>\n<td>2</td>\n<td>bbb</td>\n<td>200</td>\n</tr>\n<tr>\n<td>3</td>\n<td>bbb</td>\n<td>300</td>\n</tr>\n<tr>\n<td>7</td>\n<td>ccc</td>\n<td>200</td>\n</tr>\n</tbody>\n</table>\n<p><strong>ğŸğŸRC/RU + æ¡ä»¶åˆ—éç´¢å¼•</strong></p>\n<ol>\n<li><code>select * from table where num = 200</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where num = 200 lock in share mode</code> <br />\n å½“ num = 200ï¼Œæœ‰ä¸¤æ¡è®°å½•ã€‚è¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200 lock in share mode</code> <br />\n å½“ num &gt; 200ï¼Œæœ‰ä¸€æ¡è®°å½•ã€‚è¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ ä¸Šè¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num = 200 for update</code> <br />\n å½“ num = 200ï¼Œæœ‰ä¸¤æ¡è®°å½•ã€‚è¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200 for update</code> <br />\n å½“ num &gt; 200ï¼Œæœ‰ä¸€æ¡è®°å½•ã€‚è¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ ä¸Šè¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n</ol>\n<p><strong>ğŸ‰ğŸ‰RC/RU + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•</strong><br />\næ©ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“ pId æ˜¯ä¸»é”®åˆ—ï¼Œå› æ­¤ pId ç”¨çš„å°±æ˜¯èšç°‡ç´¢å¼•ã€‚æ­¤æƒ…å†µå…¶å®å’Œ RC/RU + æ¡ä»¶åˆ—éç´¢å¼•æƒ…å†µæ˜¯ç±»ä¼¼çš„ã€‚</p>\n<ol>\n<li><code>select * from table where pId = 2</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where pId &gt; 2</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where pId = 2 lock in share mode</code> <br />\n åœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  S é”ï¼Œä¸ºå½“å‰è¯»ã€‚</li>\n<li><code>select * from table where pId &gt; 2 lock in share mode</code> <br />\n åœ¨ pId=3ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  S é”ï¼Œä¸ºå½“å‰è¯»ã€‚</li>\n<li><code>select * from table where pId = 2 for update</code> <br />\n åœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  X é”ï¼Œä¸ºå½“å‰è¯»ã€‚</li>\n<li><code>select * from table where pId &gt; 2 for update</code> <br />\n åœ¨ pId=3ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸Šï¼ŒåŠ  X é”ï¼Œä¸ºå½“å‰è¯»ã€‚</li>\n</ol>\n<h3 id=\"ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•åŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•åŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„\">#</a> ä¸ºä»€ä¹ˆæ¡ä»¶åˆ—åŠ ä¸åŠ ç´¢å¼•ï¼ŒåŠ é”æƒ…å†µæ˜¯ä¸€æ ·çš„ï¼Ÿ</h3>\n<blockquote>\n<p>å…¶å®æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨ RC/RU éš”ç¦»çº§åˆ«ä¸­ï¼ŒMySQL Server åšäº†ä¼˜åŒ–ã€‚åœ¨æ¡ä»¶åˆ—æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œå°½ç®¡é€šè¿‡èšç°‡ç´¢å¼•æ¥æ‰«æå…¨è¡¨ï¼Œè¿›è¡Œå…¨è¡¨åŠ é”ã€‚ä½†æ˜¯ï¼ŒMySQL Server å±‚ä¼šè¿›è¡Œè¿‡æ»¤å¹¶æŠŠä¸ç¬¦åˆæ¡ä»¶çš„é”å½“å³é‡Šæ”¾æ‰ï¼Œå› æ­¤ä½ çœ‹èµ·æ¥æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ RC/RU + æ¡ä»¶åˆ—éç´¢å¼•æ¯”æœ¬ä¾‹å¤šäº†ä¸€ä¸ªé‡Šæ”¾ä¸ç¬¦åˆæ¡ä»¶çš„é”çš„è¿‡ç¨‹ï¼</p>\n</blockquote>\n<p><strong>ğŸğŸRC/RU + æ¡ä»¶åˆ—æ˜¯éèšç°‡ç´¢å¼•</strong><br />\nğŸ‘‰ğŸ»æˆ‘ä»¬åœ¨ num åˆ—ä¸Šå»ºä¸Šéå”¯ä¸€ç´¢å¼•ã€‚æ­¤æ—¶æœ‰ä¸€æ£µèšç°‡ç´¢å¼• (ä¸»é”®ç´¢å¼•ï¼ŒpId) å½¢æˆçš„ B + ç´¢å¼•æ ‘ï¼Œå…¶å¶å­èŠ‚ç‚¹ä¸ºç¡¬ç›˜ä¸Šçš„çœŸå®æ•°æ®ã€‚ä»¥åŠå¦ä¸€æ£µéèšç°‡ç´¢å¼• (éå”¯ä¸€ç´¢å¼•ï¼Œnum) å½¢æˆçš„ B + ç´¢å¼•æ ‘ï¼Œå…¶å¶å­èŠ‚ç‚¹ä¾ç„¶ä¸ºç´¢å¼•èŠ‚ç‚¹ï¼Œä¿å­˜äº† num åˆ—çš„å­—æ®µå€¼ï¼Œå’Œå¯¹åº”çš„èšç°‡ç´¢å¼•ã€‚</p>\n<p>æ¥ä¸‹æ¥åˆ†æå¼€å§‹ğŸ‘€</p>\n<ol>\n<li><code>select * from table where num = 200</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200</code> <br />\n ä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚</li>\n<li><code>select * from table where num = 200 lock in share mode</code> <br />\n å½“ num = 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ num = 200 çš„ä¸¤æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ S é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200 lock in share mode</code> <br />\n å½“ num &gt; 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ç¬¦åˆæ¡ä»¶çš„ num = 300 çš„ä¸€æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ S é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ S é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num = 200 for update</code> <br />\n å½“ num = 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ num = 200 çš„ä¸¤æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ X é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™ä¸¤æ¡è®°å½•å¯¹åº”çš„ pId=2ï¼Œ7ï¼Œå› æ­¤åœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n<li><code>select * from table where num &gt; 200 for update</code> <br />\n å½“ num &gt; 200ï¼Œç”±äº num åˆ—ä¸Šæœ‰ç´¢å¼•ï¼Œå› æ­¤å…ˆåœ¨ç¬¦åˆæ¡ä»¶çš„ num = 300 çš„ä¸€æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ è¡Œçº§ X é”ã€‚æ¥ç€ï¼Œå»èšç°‡ç´¢å¼•æ ‘ä¸ŠæŸ¥è¯¢ï¼Œè¿™æ¡è®°å½•å¯¹åº”çš„ pId=3ï¼Œå› æ­¤åœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ è¡Œçº§ X é”ï¼Œé‡‡ç”¨å½“å‰è¯»ã€‚</li>\n</ol>\n<p><strong>RR/Serializable + æ¡ä»¶åˆ—éç´¢å¼•ğŸ“</strong><br />\nRR çº§åˆ«éœ€è¦å¤šè€ƒè™‘çš„å°±æ˜¯ <code>gap lock</code> ï¼Œä»–çš„åŠ é”ç‰¹å¾åœ¨äºï¼Œæ— è®ºä½ æ€ä¹ˆæŸ¥éƒ½æ˜¯é”å…¨è¡¨ã€‚å¦‚ä¸‹æ‰€ç¤º<br />\næ¥ä¸‹æ¥åˆ†æå¼€å§‹</p>\n<ol>\n<li><code>select * from table where num = 200</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œåœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n<li><code>select * from table where num &gt; 200</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œåœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n<li><code>select * from table where num = 200 lock in share mode</code> <br />\n åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n<li><code>select * from table where num &gt; 200 lock in share mode</code> <br />\n åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n<li><code>select * from table where num = 200 for update</code> <br />\n åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n<li><code>select * from table where num &gt; 200 for update</code> <br />\n åœ¨ pId = 1,2,3,7ï¼ˆå…¨è¡¨æ‰€æœ‰è®°å½•ï¼‰çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚å¹¶ä¸”åœ¨<br />\nèšç°‡ç´¢å¼•çš„æ‰€æœ‰é—´éš™ (-âˆ,1)(1,2)(2,3)(3,7)(7,+âˆ) åŠ  gap lock</li>\n</ol>\n<p><strong>RR/Serializable + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•ğŸ“</strong><br />\næ©ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“ pId æ˜¯ä¸»é”®åˆ—ï¼Œå› æ­¤ pId ç”¨çš„å°±æ˜¯èšç°‡ç´¢å¼•ã€‚è¯¥æƒ…å†µçš„åŠ é”ç‰¹å¾åœ¨äºï¼Œå¦‚æœ where åçš„æ¡ä»¶ä¸ºç²¾ç¡®æŸ¥è¯¢ (= çš„æƒ…å†µ)ï¼Œé‚£ä¹ˆåªå­˜åœ¨ record lockã€‚å¦‚æœ where åçš„æ¡ä»¶ä¸ºèŒƒå›´æŸ¥è¯¢ (&gt; æˆ– &lt; çš„æƒ…å†µ)ï¼Œé‚£ä¹ˆå­˜åœ¨çš„æ˜¯ record lock+gap lockã€‚</p>\n<ol>\n<li><code>select * from table where pId = 2</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œä¸å­˜åœ¨ gap lockã€‚</li>\n<li><code>select * from table where pId &gt; 2</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock</li>\n<li><code>select * from table where pId = 2 lock in share mode</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œä¸å­˜åœ¨ gap lockã€‚</li>\n<li><code>select * from table where pId &gt; 2 lock in share mode</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock</li>\n<li><code>select * from table where pId = 2 for update</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚</li>\n<li><code>select * from table where pId &gt; 2 for update</code> <br />\n åœ¨ pId=3,7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  X é”ã€‚åœ¨ (2,3)(3,7)(7,+âˆ) åŠ ä¸Š gap lock</li>\n<li><code>select * from table where pId = 6 [lock in share mode|for update]</code> <br />\n æ³¨æ„äº†ï¼ŒpId=6 æ˜¯ä¸å­˜åœ¨çš„åˆ—ï¼Œè¿™ç§æƒ…å†µä¼šåœ¨ (3,7) ä¸ŠåŠ  gap lockã€‚</li>\n<li><code>select * from table where pId &gt; 18 [lock in share mode|for update]</code> <br />\n æ³¨æ„äº†ï¼ŒpId&gt;18ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ç©ºçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯åœ¨ (7,+âˆ) ä¸ŠåŠ  gap lockã€‚</li>\n</ol>\n<p><strong>RR/Serializable + æ¡ä»¶åˆ—æ˜¯éèšç°‡ç´¢å¼•ğŸ“</strong></p>\n<blockquote>\n<p>è¿™é‡Œéèšç°‡ç´¢å¼•ï¼Œéœ€è¦åŒºåˆ†æ˜¯å¦ä¸ºå”¯ä¸€ç´¢å¼•ã€‚å› ä¸ºå¦‚æœæ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œé—´éš™é”çš„åŠ é”æ–¹å¼æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>\n</blockquote>\n<blockquote>\n<p>å…ˆè¯´ä¸€ä¸‹ï¼Œå”¯ä¸€ç´¢å¼•çš„æƒ…å†µã€‚å¦‚æœæ˜¯å”¯ä¸€ç´¢å¼•ï¼Œæƒ…å†µå’Œ RR/Serializable + æ¡ä»¶åˆ—æ˜¯èšç°‡ç´¢å¼•ç±»ä¼¼ï¼Œå”¯ä¸€æœ‰åŒºåˆ«çš„æ˜¯ï¼šè¿™ä¸ªæ—¶å€™æœ‰ä¸¤æ£µç´¢å¼•æ ‘ï¼ŒåŠ é”æ˜¯åŠ åœ¨å¯¹åº”çš„éèšç°‡ç´¢å¼•æ ‘å’Œèšç°‡ç´¢å¼•æ ‘ä¸Šï¼å¤§å®¶å¯ä»¥è‡ªè¡Œæ¨æ•²ï¼</p>\n</blockquote>\n<p>ä¸‹é¢è¯´ä¸€ä¸‹ï¼Œéèšç°‡ç´¢å¼•æ˜¯éå”¯ä¸€ç´¢å¼•çš„æƒ…å†µï¼Œä»–å’Œå”¯ä¸€ç´¢å¼•çš„åŒºåˆ«å°±æ˜¯é€šè¿‡ç´¢å¼•è¿›è¡Œç²¾ç¡®æŸ¥è¯¢ä»¥åï¼Œä¸ä»…å­˜åœ¨ record lockï¼Œè¿˜å­˜åœ¨ gap lockã€‚è€Œé€šè¿‡å”¯ä¸€ç´¢å¼•è¿›è¡Œç²¾ç¡®æŸ¥è¯¢åï¼Œåªå­˜åœ¨ record lockï¼Œä¸å­˜åœ¨ gap lockã€‚è€è§„çŸ©åœ¨ num åˆ—å»ºç«‹éå”¯ä¸€ç´¢å¼•</p>\n<ol>\n<li><code>select * from table where num = 200</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚</li>\n<li><code>select * from table where num &gt; 200</code> <br />\n åœ¨ RR çº§åˆ«ä¸‹ï¼Œä¸åŠ ä»»ä½•é”ï¼Œæ˜¯å¿«ç…§è¯»ã€‚<br />\nåœ¨ Serializable çº§åˆ«ä¸‹ï¼Œæ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lock</li>\n<li><code>select * from table where num = 200 lock in share mode</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚</li>\n<li><code>select * from table where num &gt; 200 lock in share mode</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  S é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lockã€‚</li>\n<li><code>select * from table where num = 200 for update</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=2ï¼Œ7 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=200 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  X é”ï¼Œåœ¨ (100,200)(200,300) åŠ ä¸Š gap lockã€‚</li>\n<li><code>select * from table where num &gt; 200 for update</code> <br />\n æ˜¯å½“å‰è¯»ï¼Œåœ¨ pId=3 çš„èšç°‡ç´¢å¼•ä¸ŠåŠ  S é”ï¼Œåœ¨ num=300 çš„éèšé›†ç´¢å¼•ä¸ŠåŠ  X é”ã€‚åœ¨ (200,300)(300,+âˆ) åŠ ä¸Š gap lock</li>\n<li><code>select * from table where num = 250 [lock in share mode|for update]</code> <br />\n æ³¨æ„äº†ï¼Œnum=250 æ˜¯ä¸å­˜åœ¨çš„åˆ—ï¼Œè¿™ç§æƒ…å†µä¼šåœ¨ (200,300) ä¸ŠåŠ  gap lockã€‚</li>\n<li><code>select * from table where num &gt; 400 [lock in share mode|for update]</code> <br />\n æ³¨æ„äº†ï¼ŒpId&gt;400ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ç©ºçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯åœ¨ (400,+âˆ) ä¸ŠåŠ  gap lockã€‚</li>\n</ol>\n<h2 id=\"mysqlä¸­çš„æ­»é”\"><a class=\"anchor\" href=\"#mysqlä¸­çš„æ­»é”\">#</a> MySQL ä¸­çš„æ­»é”</h2>\n<h3 id=\"æ­»é”çš„äº§ç”Ÿ\"><a class=\"anchor\" href=\"#æ­»é”çš„äº§ç”Ÿ\">#</a> æ­»é”çš„äº§ç”Ÿ</h3>\n<p><strong>æ­»é”ğŸ”’ï¼š</strong> æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹ã€‚è¡¨çº§é”ä¸ä¼šäº§ç”Ÿæ­»é”ã€‚æ‰€ä»¥è§£å†³æ­»é”ä¸»è¦è¿˜æ˜¯é’ˆå¯¹äºæœ€å¸¸ç”¨çš„ InnoDBã€‚</p>\n<blockquote>\n<p>æ­»é”çš„å…³é”®åœ¨äºï¼šä¸¤ä¸ª (æˆ–ä»¥ä¸Š) çš„ Select åŠ é”çš„é¡ºåºä¸ä¸€è‡´ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆå¯¹åº”çš„è§£å†³æ­»é”é—®é¢˜çš„å…³é”®å°±æ˜¯ï¼šè®©ä¸åŒçš„ Select åŠ é”æœ‰æ¬¡åº</p>\n<h3 id=\"æ­»é”çš„æ£€æµ‹\"><a class=\"anchor\" href=\"#æ­»é”çš„æ£€æµ‹\">#</a> æ­»é”çš„æ£€æµ‹</h3>\n<p>âœ¨åœ¨å¹¶å‘ç³»ç»Ÿä¸­ä¸åŒçº¿ç¨‹å‡ºç°å¾ªç¯èµ„æºä¾èµ–ï¼Œæ¶‰åŠçš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…åˆ«çš„çº¿ç¨‹é‡Šæ”¾èµ„æºæ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™å‡ ä¸ªçº¿ç¨‹éƒ½è¿›å…¥æ— é™ç­‰å¾…çš„çŠ¶æ€ï¼Œç§°ä¸ºæ­»é”ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>äº‹åŠ¡ A</th>\n<th>äº‹åŠ¡ B</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td colspan=\"2\"><code>begin; </code></td>\n</tr>\n<tr>\n<td><code>update t set k=k+1 where id=1; </code></td>\n<td><code>begin; </code></td>\n</tr>\n<tr>\n<td><code>update t set k=k+1 where id=2; </code></td>\n</tr>\n<tr>\n<td colspan=\"2\"><code>update t set k=k+1 where id=2; </code></td>\n</tr>\n<tr>\n<td><code>update t set k=k+1 where id=1; </code></td>\n</tr>\n</tbody>\n</table>\n<p>äº‹åŠ¡ A åœ¨ç­‰å¾…äº‹åŠ¡ B é‡Šæ”¾ id=2 çš„è¡Œé”ï¼Œè€Œäº‹åŠ¡ B åœ¨ç­‰å¾…äº‹åŠ¡ A é‡Šæ”¾ id=1 çš„è¡Œé”ã€‚äº‹åŠ¡ A å’Œäº‹åŠ¡ B åœ¨äº’ç›¸ç­‰å¾…å¯¹æ–¹çš„èµ„æºé‡Šæ”¾ï¼Œå°±æ˜¯è¿›å…¥äº†æ­»é”çŠ¶æ€ã€‚å½“å‡ºç°æ­»é”ä»¥åï¼Œæœ‰ä¸¤ç§ç­–ç•¥ğŸ¥‚ï¼š</p>\n<ul>\n<li>ä¸€ç§ç­–ç•¥æ˜¯ï¼Œç›´æ¥è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°è¶…æ—¶ã€‚è¿™ä¸ªè¶…æ—¶æ—¶é—´å¯ä»¥é€šè¿‡å‚æ•° <code>innodb_lock_wait_timeout</code>  æ¥è®¾ç½®</li>\n<li>å¦ä¸€ç§ç­–ç•¥æ˜¯ï¼Œå‘èµ·æ­»é”æ£€æµ‹ï¼Œå‘ç°æ­»é”åï¼Œä¸»åŠ¨å›æ»šæ­»é”é“¾æ¡ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶ä»–äº‹åŠ¡å¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚å°†å‚æ•° <code>innodb_deadlock_detect</code>  è®¾ç½®ä¸º onï¼Œè¡¨ç¤ºå¼€å¯è¿™ä¸ªé€»è¾‘</li>\n</ul>\n<p>åœ¨ InnoDB ä¸­ï¼Œ <code>innodb_lock_wait_timeout</code>  çš„é»˜è®¤å€¼æ˜¯ 50sï¼Œæ„å‘³ç€å¦‚æœé‡‡ç”¨ç¬¬ä¸€ä¸ªç­–ç•¥ï¼Œå½“å‡ºç°æ­»é”ä»¥åï¼Œç¬¬ä¸€ä¸ªè¢«é”ä½çš„çº¿ç¨‹è¦è¿‡ 50s æ‰ä¼šè¶…æ—¶é€€å‡ºï¼Œç„¶åå…¶ä»–çº¿ç¨‹æ‰æœ‰å¯èƒ½ç»§ç»­æ‰§è¡Œã€‚å¯¹äºåœ¨çº¿æœåŠ¡æ¥è¯´ï¼Œè¿™ä¸ªç­‰å¾…æ—¶é—´å¾€å¾€æ˜¯æ— æ³•æ¥å—çš„</p>\n<p>âœ¨æ­£å¸¸æƒ…å†µä¸‹è¿˜æ˜¯è¦é‡‡ç”¨ä¸»åŠ¨æ­»é”æ£€æŸ¥ç­–ç•¥ï¼Œè€Œä¸” <code>innodb_deadlock_detect</code>  çš„é»˜è®¤å€¼æœ¬èº«å°±æ˜¯ onã€‚ä¸»åŠ¨æ­»é”ç›‘æµ‹åœ¨å‘ç”Ÿæ­»é”çš„æ—¶å€™ï¼Œæ˜¯èƒ½å¤Ÿå¿«é€Ÿå‘ç°å¹¶è¿›è¡Œå¤„ç†çš„ï¼Œä½†æ˜¯å®ƒæœ‰é¢å¤–è´Ÿæ‹…çš„ã€‚æ¯å½“ä¸€ä¸ªäº‹åŠ¡è¢«é”çš„æ—¶å€™ï¼Œå°±è¦çœ‹çœ‹å®ƒæ‰€ä¾èµ–çš„çº¿ç¨‹æœ‰æ²¡æœ‰è¢«åˆ«äººé”ä½ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œæœ€ååˆ¤æ–­æ˜¯å¦å‡ºç°äº†å¾ªç¯ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯æ­»é”</p>\n<p>ğŸ¬å¦‚æœæ‰€æœ‰äº‹åŠ¡éƒ½è¦æ›´æ–°åŒä¸€è¡Œçš„åœºæ™¯ï¼Œæ¯ä¸ªæ–°æ¥çš„è¢«å µä½çš„çº¿ç¨‹éƒ½è¦åˆ¤æ–­ä¼šä¸ä¼šç”±äºè‡ªå·±çš„åŠ å…¥å¯¼è‡´æ­»é”ï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦æ˜¯ <strong>O(n)</strong> çš„æ“ä½œ</p>\n<p><strong>ğŸ‘©æ€ä¹ˆè§£å†³ç”±è¿™ç§çƒ­ç‚¹è¡Œæ›´æ–°å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼Ÿ</strong></p>\n<ol>\n<li>å¦‚æœç¡®ä¿è¿™ä¸ªä¸šåŠ¡ä¸€å®šä¸ä¼šå‡ºç°æ­»é”ï¼Œå¯ä»¥ä¸´æ—¶æŠŠæ­»é”æ£€æµ‹å…³æ‰</li>\n<li>æ§åˆ¶å¹¶å‘åº¦</li>\n<li>å°†ä¸€è¡Œæ”¹æˆé€»è¾‘ä¸Šçš„å¤šè¡Œæ¥å‡å°‘é”å†²çªã€‚ä»¥å½±é™¢è´¦æˆ·ä¸ºä¾‹ï¼Œå¯ä»¥è€ƒè™‘æ”¾åœ¨å¤šæ¡è®°å½•ä¸Šï¼Œæ¯”å¦‚ 10 ä¸ªè®°å½•ï¼Œå½±é™¢çš„è´¦æˆ·æ€»é¢ç­‰äºè¿™ 10 ä¸ªè®°å½•çš„å€¼çš„æ€»å’Œã€‚è¿™æ ·æ¯æ¬¡è¦ç»™å½±é™¢è´¦æˆ·åŠ é‡‘é¢çš„æ—¶å€™ï¼Œéšæœºé€‰å…¶ä¸­ä¸€æ¡è®°å½•æ¥åŠ ã€‚è¿™æ ·æ¯æ¬¡å†²çªæ¦‚ç‡å˜æˆå‘˜åŸæ¥çš„ 1/10ï¼Œå¯ä»¥å‡å°‘é”ç­‰å¾…ä¸ªæ•°ï¼Œä¹Ÿå°±å‡å°‘äº†æ­»é”æ£€æµ‹çš„ CPU æ¶ˆè€—</li>\n</ol>\n<h3 id=\"è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•\"><a class=\"anchor\" href=\"#è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•\">#</a> è§£é™¤æ­»é”çš„ä¸¤ç§æ–¹æ³•</h3>\n<ol>\n<li>â­ç»ˆæ­¢ï¼ˆæˆ–æ’¤é”€ï¼‰è¿›ç¨‹ã€‚ç»ˆæ­¢ï¼ˆæˆ–æ’¤é”€ï¼‰ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ­»é”è¿›ç¨‹ï¼Œç›´è‡³æ‰“ç ´å¾ªç¯ç¯è·¯ï¼Œä½¿ç³»ç»Ÿä»æ­»é”çŠ¶æ€ä¸­è§£é™¤å‡ºæ¥ã€‚</li>\n<li>â­æŠ¢å èµ„æºã€‚ä»ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ä¸­æŠ¢å è¶³å¤Ÿæ•°é‡çš„èµ„æºï¼Œåˆ†é…ç»™æ­»é”è¿›ç¨‹ï¼Œä»¥æ‰“ç ´æ­»é”çŠ¶æ€ã€‚</li>\n</ol>\n<p><strong>ğŸ”‘ç¬¬ä¸€ç§æ–¹æ³•æ‰‹åŠ¨å®ç°ï¼š</strong><br />\nåœ¨ mysql ä¸­ï¼Œè¾“å…¥</p>\n<pre><code>show processlist;\n</code></pre>\n<p>kill æ‰ç­‰å¾…ä¸­æˆ–è€…ç¡çœ çš„è¿›ç¨‹ï¼Œé‡å¤æ“ä½œå³å¯</p>\n<pre><code>kill 10430(è¿›ç¨‹Id);\n</code></pre>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "MySQL"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/11/f5f4ddb13fdd/",
            "url": "https://shaogezhu.cn/2021/11/f5f4ddb13fdd/",
            "title": "lambdaQueryWrapperä¸­å¸¸ç”¨çš„æ–¹æ³•",
            "date_published": "2021-11-16T14:31:30.000Z",
            "content_html": "<div class=\"note info\">\n<p>âœ¨mybatis-plus æ˜¯ç°åœ¨æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ’ä»¶ï¼Œæå¤§çš„æé«˜äº†æˆ‘ä»¬å¼€å‘çš„æ•ˆç‡ï¼ŒLambdaQueryWrapper ç±»æˆ‘ä»¬ä¹Ÿç»å¸¸ä½¿ç”¨ï¼Œæˆ‘æŠŠå¤§éƒ¨åˆ†çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠæœ¬ç½‘å€æ”¶è—èµ·æ¥ æ–¹ä¾¿ä»¥åæŸ¥é˜…ã€‚</p>\n</div>\n<br>\n<p><img data-src=\"/assets/2021-11/lm.png\" alt=\"image.png\" /></p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "MySQL",
                "èµ„æ–™",
                "mybatis"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/11/a702195cf0e5/",
            "url": "https://shaogezhu.cn/2021/11/a702195cf0e5/",
            "title": "HTTPåè®® å’Œ HTTPSåè®® è¯¦è§£",
            "date_published": "2021-11-05T14:57:49.000Z",
            "content_html": "<div class=\"note info\">\n<p>æˆ‘ä»¬ç»å¸¸è¯´çš„é€šä¿¡åè®®ï¼Œä»¥åŠä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ï¼Œéƒ½æ˜¯ä»€ä¹ˆï¼Ÿ http å’Œ https æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå»ºç«‹é“¾æ¥çš„æµç¨‹ä¸€æ ·ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ https å°±å®‰å…¨äº†ï¼Ÿ è¯»å®Œè¿™ç¯‡æ–‡ç« ä½ å°±ä¼šæœ‰éå¸¸æ·±åˆ»çš„è®¤è¯†ğŸ™‡</p>\n</div>\n<h2 id=\"åè®®\"><a class=\"anchor\" href=\"#åè®®\">#</a> åè®®</h2>\n<blockquote>\n<p>ğŸ“Œç½‘ç»œåè®®æ˜¯è®¡ç®—æœºä¹‹é—´ä¸ºäº†å®ç°ç½‘ç»œé€šä¿¡è€Œè¾¾æˆçš„ä¸€ç§ â€œçº¦å®šâ€ æˆ–è€…â€ è§„åˆ™ â€œï¼Œæœ‰äº†è¿™ç§â€ çº¦å®š â€œï¼Œä¸åŒå‚å•†çš„ç”Ÿäº§è®¾å¤‡ï¼Œä»¥åŠä¸åŒæ“ä½œç³»ç»Ÿç»„æˆçš„è®¡ç®—æœºä¹‹é—´ï¼Œå°±å¯ä»¥å®ç°é€šä¿¡ã€‚</p>\n</blockquote>\n<h2 id=\"http-åè®®\"><a class=\"anchor\" href=\"#http-åè®®\">#</a> HTTP åè®®</h2>\n<p><strong>âœ¨HTTP</strong>ï¼ˆHyperText Transfer Protocolï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„åº”ç”¨å±‚åè®®ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶ HTML é¡µé¢çš„æ–¹æ³•ï¼Œè¢«ç”¨äºåœ¨ Web æµè§ˆå™¨å’Œç½‘ç«™æœåŠ¡å™¨ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚</p>\n<h4 id=\"httpå»ºç«‹é“¾æ¥çš„è¿‡ç¨‹\"><a class=\"anchor\" href=\"#httpå»ºç«‹é“¾æ¥çš„è¿‡ç¨‹\">#</a> http å»ºç«‹é“¾æ¥çš„è¿‡ç¨‹</h4>\n<ul>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æŠ¥æ–‡</li>\n<li>æœåŠ¡å™¨æ ¹æ®è¯·æ±‚æŠ¥æ–‡æ”¶é›†å¯¹åº”çš„ç»„åˆæˆå“åº”æŠ¥æ–‡</li>\n<li>å®¢æˆ·ç«¯æ”¶åˆ°å“åº”æŠ¥æ–‡åè¿›è¡Œè§£ææ¸²æŸ“</li>\n</ul>\n<h4 id=\"httpç‰¹ç‚¹\"><a class=\"anchor\" href=\"#httpç‰¹ç‚¹\">#</a> HTTP ç‰¹ç‚¹</h4>\n<ol>\n<li>http åè®®æ”¯æŒå®¢æˆ·ç«¯ / æœåŠ¡ç«¯æ¨¡å¼ï¼Œä¹Ÿæ˜¯ä¸€ç§è¯·æ±‚ / å“åº”æ¨¡å¼çš„åè®®ã€‚</li>\n<li>ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰ GETã€HEADã€POSTã€‚</li>\n<li>çµæ´»ï¼šHTTP å…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚ä¼ è¾“çš„ç±»å‹ç”± Content-Type åŠ ä»¥æ ‡è®°ã€‚</li>\n<li>æ— è¿æ¥ï¼šé™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ï¼Œä½†æ˜¯å´ä¸åˆ©äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¿æŒä¼šè¯è¿æ¥ï¼Œä¸ºäº†å¼¥è¡¥è¿™ç§ä¸è¶³ï¼Œäº§ç”Ÿäº†ä¸¤é¡¹è®°å½• http çŠ¶æ€çš„æŠ€æœ¯ï¼Œä¸€ä¸ªå«åš Cookie, ä¸€ä¸ªå«åš Sessionã€‚</li>\n<li>æ— çŠ¶æ€ï¼šæ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†ï¼Œåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å¿…é¡»é‡ä¼ ã€‚</li>\n</ol>\n<h2 id=\"https-åè®®\"><a class=\"anchor\" href=\"#https-åè®®\">#</a> HTTPS åè®®</h2>\n<p><strong>âœ¨HTTPS</strong>ï¼ˆHypertext Transfer Protocol Secureï¼šè¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼‰æ˜¯ä¸€ç§é€è¿‡è®¡ç®—æœºç½‘ç»œè¿›è¡Œå®‰å…¨é€šä¿¡çš„ä¼ è¾“åè®®ã€‚HTTPS ç»ç”± HTTP è¿›è¡Œé€šä¿¡ï¼Œä½†åˆ©ç”¨ SSL/TLS æ¥åŠ å¯†æ•°æ®åŒ…ã€‚HTTPS å¼€å‘çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯æä¾›å¯¹ç½‘ç«™æœåŠ¡å™¨çš„èº«ä»½è®¤è¯ï¼Œä¿æŠ¤äº¤æ¢æ•°æ®çš„éšç§ä¸å®Œæ•´æ€§ã€‚</p>\n<h4 id=\"httpså»ºç«‹é“¾æ¥çš„è¿‡ç¨‹\"><a class=\"anchor\" href=\"#httpså»ºç«‹é“¾æ¥çš„è¿‡ç¨‹\">#</a> https å»ºç«‹é“¾æ¥çš„è¿‡ç¨‹</h4>\n<p><img data-src=\"/assets/2021-11/http1.png\" alt=\"image.png\" /></p>\n<p><strong>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>\n<ol>\n<li>client å‘ server å‘é€è¯·æ±‚ https://www.shaogezhu.cn ï¼Œç„¶åè¿æ¥åˆ° server çš„ 443 ç«¯å£ï¼Œå‘é€çš„ä¿¡æ¯åŒ…å«å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†ç®—æ³•ã€‚</li>\n<li>server æ¥æ”¶åˆ°ä¿¡æ¯ä¹‹åç»™äºˆ client å“åº”æ¡æ‰‹ä¿¡æ¯ï¼ŒåŒ…å«åŒ¹é…å¥½çš„åå•†åŠ å¯†ç®—æ³•ï¼Œè¿™ä¸ªåŠ å¯†ç®—æ³•ä¸€å®šæ˜¯ client å‘é€ç»™ server åŠ å¯†ç®—æ³•çš„å­é›†ã€‚</li>\n<li>éšå³ server ç»™ client å‘é€ç¬¬äºŒä¸ªå“åº”æŠ¥æ–‡æ˜¯æ•°å­—è¯ä¹¦ã€‚æœåŠ¡ç«¯å¿…é¡»è¦æœ‰ä¸€å¥—æ•°å­—è¯ä¹¦ï¼Œå¯ä»¥è‡ªå·±åˆ¶ä½œï¼Œä¹Ÿå¯ä»¥å‘ç»„ç»‡ç”³è¯·ã€‚åŒºåˆ«å°±æ˜¯è‡ªå·±é¢å‘çš„è¯ä¹¦éœ€è¦å®¢æˆ·ç«¯éªŒè¯é€šè¿‡ï¼Œæ‰å¯ä»¥ç»§ç»­è®¿é—®ï¼Œè€Œä½¿ç”¨å—ä¿¡ä»»çš„å…¬å¸ç”³è¯·çš„è¯ä¹¦åˆ™ä¸ä¼šå¼¹å‡ºæç¤ºé¡µé¢ï¼Œè¿™å¥—è¯ä¹¦å…¶å®å°±æ˜¯ä¸€å¯¹å…¬é’¥å’Œç§é’¥ã€‚ä¼ é€è¯ä¹¦ï¼Œè¿™ä¸ªè¯ä¹¦å…¶å®å°±æ˜¯å…¬é’¥ï¼Œåªæ˜¯åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ï¼Œå¦‚è¯ä¹¦çš„é¢å‘æœºæ„ï¼Œè¿‡æœŸæ—¶é—´ã€æœåŠ¡ç«¯çš„å…¬é’¥ï¼Œç¬¬ä¸‰æ–¹è¯ä¹¦è®¤è¯æœºæ„ (CA) çš„ç­¾åï¼ŒæœåŠ¡ç«¯çš„åŸŸåä¿¡æ¯ç­‰å†…å®¹ã€‚</li>\n<li>å®¢æˆ·ç«¯è§£æéªŒè¯è¯ä¹¦ï¼Œè¿™éƒ¨åˆ†å·¥ä½œæ˜¯ç”±å®¢æˆ·ç«¯çš„ SSL/TLS æ¥å®Œæˆçš„ï¼Œé¦–å…ˆä¼šéªŒè¯å…¬é’¥æ˜¯å¦æœ‰æ•ˆï¼Œæ¯”å¦‚é¢å‘æœºæ„ï¼Œè¿‡æœŸæ—¶é—´ç­‰ç­‰ï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œåˆ™ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†ï¼Œæç¤ºè¯ä¹¦å­˜åœ¨é—®é¢˜ã€‚å¦‚æœè¯ä¹¦æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå°±ç”Ÿæˆä¸€ä¸ªéšå³å€¼ï¼ˆé¢„ä¸»ç§˜é’¥ï¼‰ã€‚</li>\n<li>å®¢æˆ·ç«¯è®¤è¯è¯ä¹¦é€šè¿‡ä¹‹åï¼Œæ¥ä¸‹æ¥æ˜¯é€šè¿‡ç”Ÿæˆä¼šè¯å¯†é’¥ã€‚ç„¶åé€šè¿‡è¯ä¹¦çš„å…¬é’¥åŠ å¯†ä¼šè¯å¯†é’¥ã€‚</li>\n<li>æœåŠ¡ç«¯ä½¿ç”¨ç§é’¥è§£å¯†å¾—åˆ°ä¼šè¯å¯†é’¥ï¼Œç„¶åæœåŠ¡ç«¯ä¼šé€šè¿‡ä¼šè¯ç§˜é’¥åŠ å¯†ä¸€æ¡æ¶ˆæ¯å›ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå®¢æˆ·ç«¯èƒ½å¤Ÿæ­£å¸¸æ¥å—çš„è¯è¡¨æ˜ SSL å±‚è¿æ¥å»ºç«‹å®Œæˆäº†ã€‚</li>\n</ol>\n<h4 id=\"httpsçš„ç‰¹ç‚¹\"><a class=\"anchor\" href=\"#httpsçš„ç‰¹ç‚¹\">#</a> https çš„ç‰¹ç‚¹</h4>\n<ol>\n<li><strong>å†…å®¹åŠ å¯†ï¼š</strong> é‡‡ç”¨æ··åˆåŠ å¯†æŠ€æœ¯ï¼Œä¸­é—´è€…æ— æ³•ç›´æ¥æŸ¥çœ‹æ˜æ–‡å†…å®¹</li>\n<li><strong>éªŒè¯èº«ä»½ï¼š</strong> é€šè¿‡è¯ä¹¦è®¤è¯å®¢æˆ·ç«¯è®¿é—®çš„æ˜¯è‡ªå·±çš„æœåŠ¡å™¨</li>\n<li><strong>ä¿æŠ¤æ•°æ®å®Œæ•´æ€§ï¼š</strong> é˜²æ­¢ä¼ è¾“çš„å†…å®¹è¢«ä¸­é—´äººå†’å……æˆ–è€…ç¯¡æ”¹</li>\n</ol>\n<h2 id=\"http-ä¸-https-åŒºåˆ«\"><a class=\"anchor\" href=\"#http-ä¸-https-åŒºåˆ«\">#</a> HTTP ä¸ HTTPS åŒºåˆ«</h2>\n<ol>\n<li>HTTP æ˜æ–‡ä¼ è¾“ï¼Œæ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œå®‰å…¨æ€§è¾ƒå·®ï¼ŒHTTPSï¼ˆSSL+HTTPï¼‰ æ•°æ®ä¼ è¾“è¿‡ç¨‹æ˜¯åŠ å¯†çš„ï¼Œå®‰å…¨æ€§è¾ƒå¥½ã€‚</li>\n<li>ä½¿ç”¨ HTTPS åè®®éœ€è¦åˆ° <strong>CA</strong>ï¼ˆCertificate Authorityï¼Œæ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼‰ ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦è¾ƒå°‘ï¼Œå› è€Œéœ€è¦ä¸€å®šè´¹ç”¨ã€‚</li>\n<li>HTTP é¡µé¢å“åº”é€Ÿåº¦æ¯” HTTPS å¿«ï¼Œä¸»è¦æ˜¯å› ä¸º HTTP ä½¿ç”¨ TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº¤æ¢ 3 ä¸ªåŒ…ï¼Œè€Œ HTTPS é™¤äº† TCP çš„ä¸‰ä¸ªåŒ…ï¼Œè¿˜è¦åŠ ä¸Š ssl æ¡æ‰‹éœ€è¦çš„ 9 ä¸ªåŒ…ï¼Œæ‰€ä»¥ä¸€å…±æ˜¯ 12 ä¸ªåŒ…ã€‚</li>\n<li>http å’Œ https ä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ã€‚</li>\n<li>HTTPS å…¶å®å°±æ˜¯å»ºæ„åœ¨ SSL/TLS ä¹‹ä¸Šçš„ HTTP åè®®ï¼Œæ‰€ä»¥ï¼Œè¦æ¯”è¾ƒ HTTPS æ¯” HTTP è¦æ›´è€—è´¹æœåŠ¡å™¨èµ„æºã€‚</li>\n</ol>\n<blockquote>\n<p><strong>CA è®¤è¯</strong>ï¼šç¬¬ä¸‰æ–¹æ•°å­—ç­¾åè®¤è¯æœºæ„ï¼Œä¸ºäº†ç¡®è®¤ https ä¸­æœåŠ¡å™¨å‘é€çš„å…¬å¼€ç§˜é’¥æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œå› æ­¤ä¼šå…ˆå‘é€ç»™å¯ä¿¡çš„ç¬¬ä¸‰æ–¹è¿›è¡Œç­¾åï¼Œå®¢æˆ·ç«¯ä½¿ç”¨æœºæ„çš„å…¬å¼€ç§˜é’¥è¿›è¡Œç­¾åè®¤è¯ï¼Œç”¨æ¥ä¿è¯æœåŠ¡å™¨å…¬å¼€ç§˜é’¥çš„å¯é æ€§ã€‚</p>\n<p><strong>æ•°å­—æ‘˜è¦ï¼š</strong> é€šè¿‡å•å‘ hash å‡½æ•°å¯¹åŸæ–‡è¿›è¡Œå“ˆå¸Œï¼Œå°†éœ€åŠ å¯†çš„æ˜æ–‡ â€œæ‘˜è¦â€ æˆä¸€ä¸²å›ºå®šé•¿åº¦ (å¦‚ 128bit) çš„å¯†æ–‡ï¼Œä¸åŒçš„æ˜æ–‡æ‘˜è¦æˆçš„å¯†æ–‡å…¶ç»“æœæ€»æ˜¯ä¸ç›¸åŒï¼ŒåŒæ ·çš„æ˜æ–‡å…¶æ‘˜è¦å¿…å®šä¸€è‡´ï¼Œå¹¶ä¸”å³ä½¿çŸ¥é“äº†æ‘˜è¦ä¹Ÿä¸èƒ½åæ¨å‡ºæ˜æ–‡ã€‚</p>\n</blockquote>\n<h4 id=\"å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†\"><a class=\"anchor\" href=\"#å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†\">#</a> å¯¹ç§°ç§˜é’¥åŠ å¯†å’Œéå¯¹ç§°ç§˜é’¥åŠ å¯†</h4>\n<p><strong>éå¯¹ç§°åŠ å¯†ğŸŒ´ï¼š</strong> å…¬å¼€ç§˜é’¥æ˜¯ä»»ä½•äººéƒ½å¯ä»¥è½»æ˜“è·å¾—ï¼Œå¹¶ä¸”å¯ä»¥éšæ„å‘é€ã€‚ä½†æ˜¯å…¬å¼€å¯†é’¥åŠ å¯†åçš„å†…å®¹åªæœ‰æä¾›å…¬å¼€ç§˜é’¥çš„æœåŠ¡æ–¹å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§æœ‰ç§˜é’¥è¿›è¡Œè§£å¯†<br />\n<strong>å¯¹ç§°åŠ å¯†ğŸŒ´ï¼š</strong> åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯åŒä¸€ç§˜é’¥ï¼Œæ‰€ä»¥åªè¦è·å¾—åŠ å¯†ç§˜é’¥å°±å¯ä»¥è¿›è¡Œè§£å¯†ã€‚</p>\n<h4 id=\"tcpä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹\"><a class=\"anchor\" href=\"#tcpä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹\">#</a> TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹</h4>\n<p><img data-src=\"/assets/2021-11/http2.png\" alt=\"image.png\" /></p>\n<p><strong>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ğŸ‘€ï¼š</strong><br />\nï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å°è¯•è¿æ¥æœåŠ¡å™¨ï¼Œå‘æœåŠ¡å™¨å‘é€ syn åŒ…ï¼ˆåŒæ­¥åºåˆ—ç¼–å· Synchronize Sequence Numbersï¼‰ï¼Œseq=aï¼Œå®¢æˆ·ç«¯è¿›å…¥ SYN_SEND çŠ¶æ€ç­‰å¾…æœåŠ¡å™¨ç¡®è®¤</p>\n<p>ï¼ˆ2ï¼‰ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯ syn åŒ…å¹¶ç¡®è®¤ï¼ˆAck=a+1ï¼‰ï¼Œseq=bï¼ŒåŒæ—¶å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª SYN åŒ…ï¼ˆsyn=1ï¼‰ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥ SYN_RECV çŠ¶æ€</p>\n<p>ï¼ˆ3ï¼‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ SYN+ACK åŒ…ï¼Œå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ… ACK (ack=b+1ï¼‰ï¼Œæ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹</p>\n<p>ï¼ˆ4ï¼‰Server ç«¯åœ¨æ”¶åˆ° Client çš„ ACK å¸§ä¹‹åï¼Œä¼šä» SYN_RCVD çŠ¶æ€ä¼šè¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œè‡³æ­¤ï¼ŒServer æ–¹å‘çš„é€šé“è¿æ¥å»ºç«‹æˆåŠŸï¼ŒServer å¯ä»¥å‘é€æ•°æ®ç»™ Clientï¼ŒTCP çš„å…¨åŒå·¥è¿æ¥å»ºç«‹å®Œæˆã€‚</p>\n<h4 id=\"å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹\"><a class=\"anchor\" href=\"#å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹\">#</a> å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹</h4>\n<p><img data-src=\"/assets/2021-11/http3.png\" alt=\"image.png\" /></p>\n<p><strong>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ğŸ‘€ï¼š</strong><br />\nï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨æ–­å¼€æ–¹ï¼ˆå¯ä»¥æ˜¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼‰ï¼Œå‘å¯¹æ–¹å‘é€ä¸€ä¸ª FIN ç»“æŸè¯·æ±‚æŠ¥æ–‡ï¼Œæ­¤æŠ¥æ–‡çš„ FIN ä½è¢«è®¾ç½®ä¸º 1ï¼Œå¹¶ä¸”æ­£ç¡®è®¾ç½® Sequence Numberï¼ˆåºåˆ—å·ï¼‰å’Œ AcknowledgmentNumberï¼ˆç¡®è®¤å·ï¼‰ã€‚å‘é€å®Œæˆåï¼Œä¸»åŠ¨æ–­å¼€æ–¹è¿›å…¥ FIN_WAIT_1 çŠ¶æ€ï¼Œè¿™è¡¨ç¤ºä¸»åŠ¨æ–­å¼€æ–¹æ²¡æœ‰ä¸šåŠ¡æ•°æ®è¦å‘é€ç»™å¯¹æ–¹ï¼Œå‡†å¤‡å…³é—­ SOCKET è¿æ¥äº†ã€‚</p>\n<p>ï¼ˆ2ï¼‰ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ”¶åˆ°äº†ä¸»åŠ¨æ–­å¼€æ–¹å‘é€çš„ FIN æ–­å¼€è¯·æ±‚æŠ¥æ–‡åï¼Œè¢«åŠ¨æ–­å¼€æ–¹ä¼šå‘é€ä¸€ä¸ª ACK å“åº”æŠ¥æ–‡ï¼ŒæŠ¥æ–‡çš„ Acknowledgment Numberï¼ˆç¡®è®¤å·ï¼‰å€¼ä¸ºæ–­å¼€è¯·æ±‚æŠ¥æ–‡çš„ Sequence Numberï¼ˆåºåˆ—å·ï¼‰åŠ  1ï¼Œè¯¥ ACK ç¡®è®¤æŠ¥æ–‡çš„å«ä¹‰æ˜¯ï¼šâ€œæˆ‘åŒæ„ä½ çš„è¿æ¥æ–­å¼€è¯·æ±‚â€ã€‚ä¹‹åï¼Œè¢«åŠ¨æ–­å¼€æ–¹å°±è¿›å…¥äº† CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ï¼ŒTCP åè®®æœåŠ¡ä¼šé€šçŸ¥é«˜å±‚çš„åº”ç”¨è¿›ç¨‹ï¼Œå¯¹æ–¹å‘æœ¬åœ°æ–¹å‘çš„è¿æ¥å·²ç»å…³é—­ï¼Œå¯¹æ–¹å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œè‹¥æœ¬åœ°è¿˜è¦å‘é€æ•°æ®ç»™å¯¹æ–¹ï¼Œå¯¹æ–¹ä¾ç„¶ä¼šæ¥å—ã€‚è¢«åŠ¨æ–­å¼€æ–¹çš„ CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰è¿˜è¦æŒç»­ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ª CLOSE-WAIT çŠ¶æ€æŒç»­çš„æ—¶é—´ã€‚</p>\n<p>ğŸ‘‰ğŸ»ä¸»åŠ¨æ–­å¼€æ–¹åœ¨æ”¶åˆ°äº† ACK æŠ¥æ–‡åï¼Œç”± FIN_WAIT_1 è½¬æ¢æˆ FIN_WAIT_2 çŠ¶æ€ã€‚</p>\n<p>ï¼ˆ3ï¼‰ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šåœ¨å‘é€å®Œæˆ ACK æŠ¥æ–‡åï¼Œè¢«åŠ¨æ–­å¼€æ–¹è¿˜å¯ä»¥ç»§ç»­å®Œæˆä¸šåŠ¡æ•°æ®çš„å‘é€ï¼Œå¾…å‰©ä½™æ•°æ®å‘é€å®Œæˆåï¼Œæˆ–è€… CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰æˆªæ­¢åï¼Œè¢«åŠ¨æ–­å¼€æ–¹ä¼šå‘ä¸»åŠ¨æ–­å¼€æ–¹å‘é€ä¸€ä¸ª FIN+ACK ç»“æŸå“åº”æŠ¥æ–‡ï¼Œè¡¨ç¤ºè¢«åŠ¨æ–­å¼€æ–¹çš„æ•°æ®éƒ½å‘é€å®Œäº†ï¼Œç„¶åï¼Œè¢«åŠ¨æ–­å¼€æ–¹è¿›å…¥ LAST_ACK çŠ¶æ€ã€‚</p>\n<p>ï¼ˆ4ï¼‰ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨æ–­å¼€æ–¹æ”¶åœ¨åˆ° FIN+ACK æ–­å¼€å“åº”æŠ¥æ–‡åï¼Œè¿˜éœ€è¦è¿›è¡Œæœ€åçš„ç¡®è®¤ï¼Œå‘è¢«åŠ¨æ–­å¼€æ–¹å‘é€ä¸€ä¸ª ACK ç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åï¼Œè‡ªå·±å°±è¿›å…¥ TIME_WAIT çŠ¶æ€ï¼Œç­‰å¾…è¶…æ—¶åæœ€ç»ˆå…³é—­è¿æ¥ã€‚å¤„äº TIME_WAIT çŠ¶æ€çš„ä¸»åŠ¨æ–­å¼€æ–¹ï¼Œåœ¨ç­‰å¾…å®Œæˆ 2MSL çš„æ—¶é—´åï¼Œå¦‚æœæœŸé—´æ²¡æœ‰æ”¶åˆ°å…¶ä»–æŠ¥æ–‡ï¼Œåˆ™è¯æ˜å¯¹æ–¹å·²æ­£å¸¸å…³é—­ï¼Œä¸»åŠ¨æ–­å¼€æ–¹çš„è¿æ¥æœ€ç»ˆå…³é—­ã€‚</p>\n<h2 id=\"æ‹“å±•çŸ¥è¯†\"><a class=\"anchor\" href=\"#æ‹“å±•çŸ¥è¯†\">#</a> æ‹“å±•çŸ¥è¯†</h2>\n<h4 id=\"ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹\">#</a> ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ</h4>\n<ul>\n<li>å› ä¸ºå½“ Server ç«¯æ”¶åˆ° Client ç«¯çš„ SYN è¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€ SYN+ACK æŠ¥æ–‡ã€‚å…¶ä¸­ ACK æŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYN æŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“ Server ç«¯æ”¶åˆ° FIN æŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­ SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œå‘Šè¯‰ Client ç«¯ï¼Œ&quot;ä½ å‘çš„ FIN æŠ¥æ–‡æˆ‘æ”¶åˆ°äº†&quot;ã€‚åªæœ‰ç­‰åˆ°æˆ‘ Server ç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€ FIN æŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ã€‚æ•…éœ€è¦å››æ­¥æ¡æ‰‹ã€‚</li>\n</ul>\n<h4 id=\"ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—\">#</a> ä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¯ä»¥æ”¹æˆä¸¤æ¬¡æ¡æ‰‹å—ï¼Ÿ</h4>\n<ul>\n<li>3 æ¬¡æ¡æ‰‹å®Œæˆä¸¤ä¸ªé‡è¦çš„åŠŸèƒ½ï¼Œæ—¢è¦åŒæ–¹åšå¥½å‘é€æ•°æ®çš„å‡†å¤‡å·¥ä½œ (åŒæ–¹éƒ½çŸ¥é“å½¼æ­¤å·²å‡†å¤‡å¥½)ï¼Œä¹Ÿè¦å…è®¸åŒæ–¹å°±åˆå§‹åºåˆ—å·è¿›è¡Œåå•†ï¼Œè¿™ä¸ªåºåˆ—å·åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­è¢«å‘é€å’Œç¡®è®¤ã€‚ç°åœ¨æŠŠä¸‰æ¬¡æ¡æ‰‹æ”¹æˆä»…éœ€è¦ä¸¤æ¬¡æ¡æ‰‹ï¼Œæ­»é”æ˜¯å¯èƒ½å‘ç”Ÿçš„ã€‚ä½œä¸ºä¾‹å­ï¼Œè€ƒè™‘è®¡ç®—æœº S å’Œ C ä¹‹é—´çš„é€šä¿¡ï¼Œå‡å®š C ç»™ S å‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚åˆ†ç»„ï¼ŒS æ”¶åˆ°äº†è¿™ä¸ªåˆ†ç»„ï¼Œå¹¶å‘ é€äº†ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚æŒ‰ç…§ä¸¤æ¬¡æ¡æ‰‹çš„åå®šï¼ŒS è®¤ä¸ºè¿æ¥å·²ç»æˆåŠŸåœ°å»ºç«‹äº†ï¼Œå¯ä»¥å¼€å§‹å‘é€æ•°æ®åˆ†ç»„ã€‚å¯æ˜¯ï¼ŒC åœ¨ S çš„åº”ç­”åˆ†ç»„åœ¨ä¼ è¾“ä¸­è¢«ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼Œå°†ä¸çŸ¥é“ S æ˜¯å¦å·²å‡†å¤‡å¥½ï¼Œä¸çŸ¥é“ S å»ºç«‹ä»€ä¹ˆæ ·çš„åºåˆ—å·ï¼ŒC ç”šè‡³æ€€ç–‘ S æ˜¯å¦æ”¶åˆ°è‡ªå·±çš„è¿æ¥è¯·æ±‚åˆ†ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒC è®¤ä¸ºè¿æ¥è¿˜æœªå»ºç«‹æˆåŠŸï¼Œå°†å¿½ç•¥ S å‘æ¥çš„ä»»ä½•æ•°æ®åˆ† ç»„ï¼Œåªç­‰å¾…è¿æ¥ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚è€Œ S åœ¨å‘å‡ºçš„åˆ†ç»„è¶…æ—¶åï¼Œé‡å¤å‘é€åŒæ ·çš„åˆ†ç»„ã€‚è¿™æ ·å°±å½¢æˆäº†æ­»é”ã€‚</li>\n</ul>\n<h4 id=\"ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨time-waitçŠ¶æ€å¿…é¡»ç­‰å¾…2mslçš„æ—¶é—´\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨time-waitçŠ¶æ€å¿…é¡»ç­‰å¾…2mslçš„æ—¶é—´\">#</a> ä¸ºä»€ä¹ˆä¸»åŠ¨æ–­å¼€æ–¹åœ¨ TIME-WAIT çŠ¶æ€å¿…é¡»ç­‰å¾… 2MSL çš„æ—¶é—´ï¼Ÿ</h4>\n<ul>\n<li>è™½ç„¶æŒ‰é“ç†ï¼Œå››ä¸ªæŠ¥æ–‡éƒ½å‘é€å®Œæ¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥ CLOSE çŠ¶æ€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»å‡è±¡ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼Œæœ‰å¯ä»¥æœ€åä¸€ä¸ª ACK ä¸¢å¤±ã€‚æ‰€ä»¥ TIME_WAIT çŠ¶æ€å°±æ˜¯ç”¨æ¥é‡å‘å¯èƒ½ä¸¢å¤±çš„ ACK æŠ¥æ–‡ã€‚åœ¨ Client å‘é€å‡ºæœ€åçš„ ACK å›å¤ï¼Œä½†è¯¥ ACK å¯èƒ½ä¸¢å¤±ã€‚Server å¦‚æœæ²¡æœ‰æ”¶åˆ° ACKï¼Œå°†ä¸æ–­é‡å¤å‘é€ FIN ç‰‡æ®µã€‚æ‰€ä»¥ Client ä¸èƒ½ç«‹å³å…³é—­ï¼Œå®ƒå¿…é¡»ç¡®è®¤ Server æ¥æ”¶åˆ°äº†è¯¥ ACKã€‚Client ä¼šåœ¨å‘é€å‡º ACK ä¹‹åè¿›å…¥åˆ° TIME_WAIT çŠ¶æ€ã€‚Client ä¼šè®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œç­‰å¾… 2MSL çš„æ—¶é—´ã€‚å¦‚æœåœ¨è¯¥æ—¶é—´å†…å†æ¬¡æ”¶åˆ° FINï¼Œé‚£ä¹ˆ Client ä¼šé‡å‘ ACK å¹¶å†æ¬¡ç­‰å¾… 2MSLã€‚æ‰€è°“çš„ 2MSL æ˜¯ä¸¤å€çš„ MSL (Maximum Segment Lifetime)ã€‚MSL æŒ‡ä¸€ä¸ªç‰‡æ®µåœ¨ç½‘ç»œä¸­æœ€å¤§çš„å­˜æ´»æ—¶é—´ï¼Œ2MSL å°±æ˜¯ä¸€ä¸ªå‘é€å’Œä¸€ä¸ªå›å¤æ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚å¦‚æœç›´åˆ° 2MSLï¼ŒClient éƒ½æ²¡æœ‰å†æ¬¡æ”¶åˆ° FINï¼Œé‚£ä¹ˆ Client æ¨æ–­ ACK å·²ç»è¢«æˆåŠŸæ¥æ”¶ï¼Œåˆ™ç»“æŸ TCP è¿æ¥ã€‚</li>\n</ul>\n<h4 id=\"å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠ\"><a class=\"anchor\" href=\"#å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠ\">#</a> å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ</h4>\n<ul>\n<li>TCP è¿˜è®¾æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º 2 å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš” 75 ç§’é’Ÿå‘é€ä¸€æ¬¡ã€‚è‹¥ä¸€è¿å‘é€ 10 ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿æ¥ã€‚</li>\n</ul>\n<h4 id=\"tcpæ€ä¹ˆä¿è¯å¯é æ€§\"><a class=\"anchor\" href=\"#tcpæ€ä¹ˆä¿è¯å¯é æ€§\">#</a> TCP æ€ä¹ˆä¿è¯å¯é æ€§</h4>\n<ol>\n<li><strong>åºåˆ—å·å’Œç¡®è®¤å·æœºåˆ¶ï¼š</strong><br />\nTCP å‘é€ç«¯å‘é€æ•°æ®åŒ…çš„æ—¶å€™ä¼šé€‰æ‹©åºåˆ—å·ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°æ•°æ®åŒ…åä¼šæ£€æµ‹æ•°æ®åŒ…çš„å®Œæ•´æ€§ï¼Œå¦‚æœæ£€æµ‹é€šè¿‡ä¼šå“åº”ç¡®è®¤å·è¡¨ç¤ºæ”¶åˆ°äº†æ•°æ®åŒ…ã€‚</li>\n<li><strong>è¶…æ—¶é‡å‘æœºåˆ¶ï¼š</strong><br />\nå‘é€ç«¯å‘é€äº†æ•°æ®åŒ…åä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦‚æœä¸€å®šæ—¶é—´æ²¡æœ‰æ”¶åˆ°æ¥æ”¶ç«¯çš„ç¡®è®¤ï¼Œå°†ä¼šé‡æ–°å‘é€è¯¥æ•°æ®åŒ…ã€‚</li>\n<li><strong>å¯¹ä¹±åºæ•°æ®åŒ…é‡æ–°æ’åºï¼š</strong><br />\nä» IP ç½‘ç»œå±‚ä¼ è¾“åˆ° TCP å±‚çš„æ•°æ®åŒ…å¯èƒ½ä¼šä¹±åºï¼ŒTCP å±‚ä¼šå¯¹æ•°æ®åŒ…é‡æ–°æ’åºå†å‘ç»™åº”ç”¨å±‚ã€‚</li>\n<li><strong>ä¸¢å¼ƒé‡å¤æ•°æ®ï¼š</strong><br />\nä» IP ç½‘ç»œå±‚ä¼ è¾“åˆ° TCP å±‚çš„æ•°æ®åŒ…å¯èƒ½ä¼šé‡å¤ï¼ŒTCP å±‚ä¼šä¸¢å¼ƒé‡å¤çš„æ•°æ®åŒ…ã€‚</li>\n<li><strong>æµé‡æ§åˆ¶ï¼š</strong><br />\nTCP å‘é€ç«¯å’Œæ¥æ”¶ç«¯éƒ½æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ï¼Œä¸ºäº†é˜²æ­¢å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿåº¦å¤ªå¿«å¯¼è‡´æ¥æ”¶ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå‘é€ç«¯åªèƒ½å‘é€æ¥æ”¶ç«¯å¯ä»¥æ¥çº³çš„æ•°æ®ï¼Œä¸ºäº†è¾¾åˆ°è¿™ç§æ§åˆ¶æ•ˆæœï¼ŒTCP ç”¨äº†æµé‡æ§åˆ¶åè®®ï¼ˆå¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®ï¼‰æ¥å®ç°ã€‚<br />\nã€æ»‘åŠ¨çª—å£è¯¦è§£ã€‘<br />\næ»‘åŠ¨çª—å£é€šä¿—æ¥è®²å°±æ˜¯ä¸€ç§æµé‡æ§åˆ¶æŠ€æœ¯ã€‚<br />\nå®ƒæœ¬è´¨ä¸Šæ˜¯æè¿°æ¥æ”¶æ–¹çš„ TCP æ•°æ®æŠ¥ç¼“å†²åŒºå¤§å°çš„æ•°æ®ï¼Œå‘é€æ–¹æ ¹æ®è¿™ä¸ªæ•°æ®æ¥è®¡ç®—è‡ªå·±æœ€å¤šèƒ½å‘é€å¤šé•¿çš„æ•°æ®ï¼Œå¦‚æœå‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹çš„çª—å£å¤§å°ä¸º 0 çš„è¯ï¼Œé‚£ä¹ˆå‘é€æ–¹å°†åœæ­¢å‘é€æ•°æ®ï¼Œç­‰åˆ°æ¥æ”¶æ–¹å‘é€çª—å£å¤§å°ä¸ä¸º 0 çš„æ•°æ®æŠ¥çš„åˆ°æ¥ã€‚é¦–æ¬¡å‘é€æ•°æ®æ—¶çš„çª—å£æ˜¯é“¾è·¯å¸¦å®½å†³å®šã€‚</li>\n<li><strong>æ‹¥å¡æ§åˆ¶ï¼š</strong><br />\nåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”±äºç½‘ç»œçŠ¶æ€çš„é—®é¢˜ï¼Œé€ æˆç½‘ç»œæ‹¥å µï¼Œæ­¤æ—¶å¼•å…¥æ‹¥å¡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨ä¿è¯ TCP å¯é æ€§çš„åŒæ—¶ï¼Œæé«˜æ€§èƒ½ï¼Œå…·ä½“ä¸ºæ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ä¸å¿«æ¢å¤â€¦â€¦</li>\n</ol>\n<p><strong>ã€æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‘</strong><br />\n<img data-src=\"/assets/2021-11/http4.png\" alt=\"image.png\" /></p>\n<ul>\n<li><strong>æ…¢å¯åŠ¨ï¼š</strong> TCP åˆšå»ºç«‹è¿æ¥ä¹‹åï¼Œä¼šä¸€ç‚¹ä¸€ç‚¹æé«˜å‘é€æ•°æ®æŠ¥çš„æ•°é‡ï¼Œå³æ¯å½“å‘é€æ–¹æ”¶åˆ°ä¸€ä¸ª ACKï¼Œå°±ä¼šå°†æ‹¥å¡çª—å£çš„å¤§å°å˜ä¸ºåŸæ¥çš„ 2 å€ï¼›å½“å¢é•¿åˆ°æ…¢å¯åŠ¨é—¨é™ ssthresh æ—¶ï¼Œå¯åŠ¨æ‹¥å¡é¿å…ç®—æ³•</li>\n<li><strong>æ‹¥å¡é¿å…ï¼š</strong> ä¸ºäº†é¿å…æ‹¥å¡ï¼Œè¶…è¿‡æ…¢å¯åŠ¨é—¨é™åï¼Œæ‹¥å¡çª—å£çš„å¤§å°æ¯æ”¶åˆ°ä¸€ä¸ª ACKï¼ŒåŠ  1ï¼Œä¸ºçº¿æ€§å¢é•¿</li>\n<li><strong>å¿«é‡ä¼ ï¼š</strong> å½“å‡ºç°æ‹¥å¡çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†ä¸¢åŒ…çš„ç°è±¡ï¼Œå¿«é€Ÿé‡ä¼ ç®— *** å°†æ‹¥å¡çª—å£å˜ä¸ºåŸæ¥çš„ä¸€åŠï¼Œå¹¶ä¸”è®©æ…¢å¯åŠ¨é—¨é™å˜ä¸ºæ‹¥å¡çª—å£å¤§å°<br />\nå¦‚æœä¸è¿›è¡Œå¿«é€Ÿé‡ä¼ ï¼Œè¿›è¡Œè¶…æ—¶é‡ä¼ ï¼Œåˆ™æ˜¯å°†æ…¢å¯åŠ¨é—¨é™è®¾ç½®ä¸ºæ‹¥å¡çª—å£å¤§å°çš„ä¸€åŠï¼Œå¹¶ä¸”å°†æ‹¥å¡çª—å£å¤§å°ç½®ä¸º 1</li>\n<li><strong>å¿«æ¢å¤ï¼š</strong> è®©æ‹¥å¡çª—å£å¤§å° +3 ï¼ˆå³ç¡®è®¤æ”¶åˆ°äº†ä¸‰ä¸ªæ•°æ®æŠ¥ï¼‰ï¼Œå¹¶æ‰§è¡Œæ‹¥å¡é¿å…çš„çº¿æ€§å¢é•¿</li>\n</ul>\n<h4 id=\"çŠ¶æ€ç åˆ†ç±»\"><a class=\"anchor\" href=\"#çŠ¶æ€ç åˆ†ç±»\">#</a> çŠ¶æ€ç åˆ†ç±»</h4>\n<ul>\n<li>1XX- ä¿¡æ¯å‹ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ“ä½œã€‚</li>\n<li>2XX- æˆåŠŸå‹ï¼Œè¯·æ±‚æˆåŠŸæ”¶åˆ°ï¼Œç†è§£å¹¶å¤„ç†ã€‚</li>\n<li>3XX - é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ã€‚</li>\n<li>4XX - å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ã€‚</li>\n<li>5XX - æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚</li>\n</ul>\n<h4 id=\"å¸¸è§çš„çŠ¶æ€ç \"><a class=\"anchor\" href=\"#å¸¸è§çš„çŠ¶æ€ç \">#</a> å¸¸è§çš„çŠ¶æ€ç </h4>\n<ul>\n<li>200 OK - å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ</li>\n<li>301 - èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰è¢«æ°¸ä¹…è½¬ç§»åˆ°å…¶å®ƒ URL</li>\n<li>302 - ä¸´æ—¶è·³è½¬</li>\n<li>400 Bad Request - å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£</li>\n<li>401 Unauthorized - è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’Œ WWW- Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ï¼ˆç®€å•ç†è§£ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ ä»¤ç‰Œï¼Œç”¨æˆ·åï¼Œå¯†ç é”™è¯¯ï¼‰</li>\n<li>403 Forbidden ä»£è¡¨å®¢æˆ·ç«¯é”™è¯¯ï¼ŒæŒ‡çš„æ˜¯æœåŠ¡å™¨ç«¯æœ‰èƒ½åŠ›å¤„ç†è¯¥è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æˆæƒè®¿é—®ã€‚</li>\n<li>404 - è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯è¾“å…¥äº†é”™è¯¯çš„ URL</li>\n<li>500 - æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿäº†ä¸å¯é¢„æœŸçš„é”™è¯¯</li>\n<li>503 Server Unavailable - æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸ã€‚</li>\n</ul>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "å…«è‚¡æ–‡",
                "åŸºç¡€"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/11/5c2b3693deda/",
            "url": "https://shaogezhu.cn/2021/11/5c2b3693deda/",
            "title": "å½»åº•ç†è§£ è¿›ç¨‹ã€çº¿ç¨‹ã€å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹",
            "date_published": "2021-11-02T15:31:06.000Z",
            "content_html": "<div class=\"note info\">\n<p>é¢è¯•ç»å¸¸è¢«é—®åˆ°çš„é—®é¢˜ï¼Œä»Šå¤©ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ğŸ“Œ</p>\n</div>\n<h2 id=\"è¿›ç¨‹å’Œçº¿ç¨‹\"><a class=\"anchor\" href=\"#è¿›ç¨‹å’Œçº¿ç¨‹\">#</a> è¿›ç¨‹å’Œçº¿ç¨‹</h2>\n<h3 id=\"è¿›ç¨‹\"><a class=\"anchor\" href=\"#è¿›ç¨‹\">#</a> è¿›ç¨‹</h3>\n<p>æ•™ç§‘ä¹¦ä¸Šè§£é‡Šï¼š<strong><font color=\"blue\">è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½</font></strong></p>\n<p>ğŸ‘€å¯ä»¥ç†è§£ä¸ºï¼šå…ˆåŠ è½½ç¨‹åº A çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åå¼€å§‹æ‰§è¡Œ Aï¼Œä¿å­˜ç¨‹åº A çš„ä¸Šä¸‹æ–‡ï¼Œè°ƒå…¥ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ç¨‹åº B çš„ç¨‹åºä¸Šä¸‹æ–‡ï¼Œç„¶åå¼€å§‹æ‰§è¡Œ B, ä¿å­˜ç¨‹åº B çš„ä¸Šä¸‹æ–‡ã€‚è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæœ‰<strong>è°ƒå…¥ï¼Œæ‰§è¡Œï¼Œä¿å­˜</strong>çš„è¿‡ç¨‹ã€‚</p>\n<h3 id=\"çº¿ç¨‹\"><a class=\"anchor\" href=\"#çº¿ç¨‹\">#</a> çº¿ç¨‹</h3>\n<p>æ•™ç§‘ä¹¦ä¸Šè§£é‡Šï¼š<strong><font color=\"blue\">çº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½</font></strong></p>\n<p>ğŸ‘€å¯ä»¥ç†è§£ä¸ºï¼šä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æ‰§è¡Œå¯èƒ½æœ‰å¤šä¸ªåˆ†æ”¯å’Œå¤šä¸ªç¨‹åºæ®µï¼Œå°±å¥½æ¯”è¦å®ç°ç¨‹åº Aï¼Œå®é™…åˆ†æˆ aï¼Œbï¼Œc ç­‰å¤šä¸ªå—ï¼›è¿™é‡Œçš„ aï¼Œbï¼Œc å°±æ˜¯çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹æ˜¯å…±äº«äº†è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå•æ ¸ä»»åŠ¡ä¸­åˆ’åˆ†æ›´ä¸ºç»†å°çš„ CPU æ—¶é—´æ®µã€‚</p>\n<h3 id=\"è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«\">#</a> è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</h3>\n<p><strong>è¿›ç¨‹ğŸŒ´ï¼š</strong> æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹ä¹‹é—´çš„å†…å­˜ç©ºé—´ä¸å…±äº«ã€‚è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æœ‰æ“ä½œç³»ç»Ÿä¼ é€’ï¼Œå¯¼è‡´é€šè®¯æ•ˆç‡ä½ï¼Œåˆ‡æ¢å¼€é”€å¤§ã€‚</p>\n<p><strong>çº¿ç¨‹ğŸŒ´ï¼š</strong> ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çº¿ç¨‹<strong>å…±äº«</strong>è¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œé€šè®¯æ•ˆç‡é«˜ï¼Œåˆ‡æ¢å¼€é”€å°ã€‚(PSï¼šå…±äº«æ„å‘³ç€ç«äº‰ï¼Œå¯¼è‡´æ•°æ®ä¸å®‰å…¨ï¼Œä¸ºäº†ä¿æŠ¤å†…å­˜ç©ºé—´çš„æ•°æ®å®‰å…¨ï¼Œå¼•å…¥ &quot;äº’æ–¥é”&quot;ã€‚ä¸€ä¸ªçº¿ç¨‹åœ¨è®¿é—®å†…å­˜ç©ºé—´çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹ä¸å…è®¸è®¿é—®ï¼Œå¿…é¡»ç­‰å¾…ä¹‹å‰çš„çº¿ç¨‹è®¿é—®ç»“æŸï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå†…å­˜ç©ºé—´)</p>\n<h2 id=\"å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹\"><a class=\"anchor\" href=\"#å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹\">#</a> å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹</h2>\n<h3 id=\"å…±åŒç‚¹\"><a class=\"anchor\" href=\"#å…±åŒç‚¹\">#</a> å…±åŒç‚¹ï¼š</h3>\n<p>ğŸ‘‰ğŸ»è¡¨ç¤ºå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹çš„è°ƒåº¦æ˜¯ç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨å®Œæˆã€‚</p>\n<h3 id=\"åŒºåˆ«\"><a class=\"anchor\" href=\"#åŒºåˆ«\">#</a> åŒºåˆ«ï¼š</h3>\n<table>\n<thead>\n<tr>\n<th>å¯¹æ¯”ç»´åº¦</th>\n<th>å¤šè¿›ç¨‹</th>\n<th>å¤šçº¿ç¨‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ•°æ®å…±äº«ã€åŒæ­¥</td>\n<td>æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨ IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•</td>\n<td>å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼Œä½†ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å¯¼è‡´åŒæ­¥å¤æ‚</td>\n</tr>\n<tr>\n<td>å†…å­˜ã€CPU</td>\n<td>å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPU åˆ©ç”¨ç‡ä½</td>\n<td>å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPU åˆ©ç”¨ç‡é«˜</td>\n</tr>\n<tr>\n<td>åˆ›å»ºé”€æ¯ã€åˆ‡æ¢</td>\n<td>åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢</td>\n<td>åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«</td>\n</tr>\n<tr>\n<td>ç¼–ç¨‹ã€è°ƒè¯•</td>\n<td>ç¼–ç¨‹ç®€å•ï¼Œè°ƒè¯•ç®€å•</td>\n<td>ç¼–ç¨‹å¤æ‚ï¼Œè°ƒè¯•å¤æ‚</td>\n</tr>\n<tr>\n<td>å¯é æ€§</td>\n<td>è¿›ç¨‹é—´ä¸ä¼šäº’ç›¸å½±å“</td>\n<td>ä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰å°†å¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚æ‰</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"é€šä¿¡æ–¹å¼\"><a class=\"anchor\" href=\"#é€šä¿¡æ–¹å¼\">#</a> é€šä¿¡æ–¹å¼</h3>\n<h3 id=\"è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\"><a class=\"anchor\" href=\"#è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\">#</a> è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼</h3>\n<ol>\n<li><strong>æ¶ˆæ¯é˜Ÿåˆ—ğŸ“ï¼š</strong> æ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå…·æœ‰ç‰¹å®šçš„æ ¼å¼ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚æ¶ˆæ¯é˜Ÿåˆ—å­˜æ”¾åœ¨å†…æ ¸ä¸­ï¼Œåªæœ‰åœ¨å†…æ ¸é‡å¯ (å³ï¼Œæ“ä½œç³»ç»Ÿé‡å¯) æˆ–è€…æ˜¾ç¤ºåœ°åˆ é™¤ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼Œè¯¥æ¶ˆæ¯é˜Ÿåˆ—æ‰ä¼šè¢«çœŸæ­£çš„åˆ é™¤ã€‚</li>\n<li><strong>å¥—æ¥å­—ğŸ“ï¼š</strong> æ­¤æ–¹æ³•ä¸»è¦ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚å¥—æ¥å­—æ˜¯æ”¯æŒ TCP/IP çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹ï¼Œç®€å•çš„è¯´å°±æ˜¯é€šä¿¡çš„ä¸¤æ–¹çš„ä¸€ç§çº¦å®šï¼Œç”¨å¥—æ¥å­—ä¸­çš„ç›¸å…³å‡½æ•°æ¥å®Œæˆé€šä¿¡è¿‡ç¨‹ã€‚</li>\n<li><strong>ä¿¡å·é‡ğŸ“ï¼š</strong> ä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºå¤šè¿›ç¨‹å¯¹å…±äº«æ•°æ®çš„è®¿é—®ï¼Œä¿¡å·é‡çš„æ„å›¾åœ¨äºè¿›ç¨‹é—´åŒæ­¥ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦ç”¨äºè§£å†³ä¸åŒæ­¥ç›¸å…³çš„é—®é¢˜å¹¶é¿å…ç«äº‰æ¡ä»¶ã€‚</li>\n<li><strong>å…±äº«å†…å­˜ğŸ“ï¼š</strong> ä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®çš„æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚å¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚</li>\n</ol>\n<h3 id=\"çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼java\"><a class=\"anchor\" href=\"#çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼java\">#</a> çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼ˆJavaï¼‰</h3>\n<ol>\n<li><strong>volatile</strong>ï¼šä¿è¯äº†çº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼Œå…¶ä¸­å¯è§æ€§å°±æ˜¯å¯ä»¥è®©çº¿ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</li>\n<li><strong>ç­‰å¾… / é€šçŸ¥æœºåˆ¶</strong>ï¼šwait (),notify () å’Œ notifyAll ()</li>\n<li><strong>threadLocal</strong> å‚è§æ–‡ç« ï¼š<a href=\"http://shaogezhu.cn/2021/10/17f071d31a96/\">å½»åº•æ˜ç™½ ThreadLocal</a></li>\n</ol>\n<h2 id=\"åº”ç”¨åœºæ™¯\"><a class=\"anchor\" href=\"#åº”ç”¨åœºæ™¯\">#</a> åº”ç”¨åœºæ™¯</h2>\n<h3 id=\"å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯\"><a class=\"anchor\" href=\"#å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯\">#</a> å¤šè¿›ç¨‹åº”ç”¨åœºæ™¯</h3>\n<ul>\n<li>nginx ä¸»æµçš„å·¥ä½œæ¨¡å¼æ˜¯å¤šè¿›ç¨‹æ¨¡å¼ï¼ˆä¹Ÿæ”¯æŒå¤šçº¿ç¨‹æ¨¡å‹ï¼‰</li>\n<li>å‡ ä¹æ‰€æœ‰çš„ web server æœåŠ¡å™¨æœåŠ¡éƒ½æœ‰å¤šè¿›ç¨‹çš„ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹é…åˆä¸€ä¸ª worker è¿›ç¨‹ï¼Œä¾‹å¦‚ apached,httpd ç­‰ç­‰ä»¥ d ç»“å°¾çš„è¿›ç¨‹åŒ…æ‹¬ init.d æœ¬èº«å°±æ˜¯ 0 çº§æ€»è¿›ç¨‹ï¼Œæ‰€æœ‰ä½ è®¤çŸ¥çš„è¿›ç¨‹éƒ½æ˜¯å®ƒçš„å­è¿›ç¨‹ï¼›</li>\n<li>chrome æµè§ˆå™¨ä¹Ÿæ˜¯å¤šè¿›ç¨‹æ–¹å¼ã€‚ ï¼ˆ<strong>åŸå› ï¼š</strong> â‘ å¯èƒ½å­˜åœ¨ä¸€äº›ç½‘é¡µä¸ç¬¦åˆç¼–ç¨‹è§„èŒƒï¼Œå®¹æ˜“å´©æºƒï¼Œé‡‡ç”¨å¤šè¿›ç¨‹ä¸€ä¸ªç½‘é¡µå´©æºƒä¸ä¼šå½±å“å…¶ä»–ç½‘é¡µï¼›è€Œé‡‡ç”¨å¤šçº¿ç¨‹ä¼šã€‚â‘¡ç½‘é¡µä¹‹é—´äº’ç›¸éš”ç¦»ï¼Œä¿è¯å®‰å…¨ï¼Œä¸å¿…æ‹…å¿ƒæŸä¸ªç½‘é¡µä¸­çš„æ¶æ„ä»£ç ä¼šå–å¾—å­˜æ”¾åœ¨å…¶ä»–ç½‘é¡µä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚ï¼‰</li>\n<li>redis ä¹Ÿå¯ä»¥å½’ç±»åˆ° â€œå¤šè¿›ç¨‹å•çº¿ç¨‹â€ æ¨¡å‹ï¼ˆå¹³æ—¶å·¥ä½œæ˜¯å•ä¸ªè¿›ç¨‹ï¼Œæ¶‰åŠåˆ°è€—æ—¶æ“ä½œå¦‚æŒä¹…åŒ–æˆ– aof é‡å†™æ—¶ä¼šç”¨åˆ°å¤šä¸ªè¿›ç¨‹ï¼‰</li>\n</ul>\n<h3 id=\"å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯\"><a class=\"anchor\" href=\"#å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯\">#</a> å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯</h3>\n<ul>\n<li>çº¿ç¨‹é—´æœ‰æ•°æ®å…±äº«ï¼Œå¹¶ä¸”æ•°æ®æ˜¯éœ€è¦ä¿®æ”¹çš„ï¼ˆä¸åŒä»»åŠ¡é—´éœ€è¦å¤§é‡å…±äº«æ•°æ®æˆ–é¢‘ç¹é€šä¿¡æ—¶ï¼‰ã€‚</li>\n<li>æä¾›éå‡è´¨çš„æœåŠ¡ï¼ˆæœ‰ä¼˜å…ˆçº§ä»»åŠ¡å¤„ç†ï¼‰äº‹ä»¶å“åº”æœ‰ä¼˜å…ˆçº§ã€‚</li>\n<li>å•ä»»åŠ¡å¹¶è¡Œè®¡ç®—ï¼Œåœ¨é CPU Bound çš„åœºæ™¯ä¸‹æé«˜å“åº”é€Ÿåº¦ï¼Œé™ä½æ—¶å»¶ã€‚</li>\n<li>ä¸äººæœ‰ IO äº¤äº’çš„åº”ç”¨ï¼Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼ˆé”®ç›˜é¼ æ ‡çš„è¾“å…¥ï¼Œç«‹åˆ»å“åº”ï¼‰</li>\n<li>æ¡ˆä¾‹ï¼š<br />\næ¡Œé¢è½¯ä»¶ï¼Œå“åº”ç”¨æˆ·è¾“å…¥çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œåå°ç¨‹åºå¤„ç†æ˜¯å¦å¤–çš„çº¿ç¨‹ï¼›</li>\n</ul>\n<h2 id=\"å¦‚ä½•é€‰\"><a class=\"anchor\" href=\"#å¦‚ä½•é€‰\">#</a> å¦‚ä½•é€‰ï¼Ÿ</h2>\n<ol>\n<li><strong>éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„ä¼˜å…ˆç”¨çº¿ç¨‹ï¼ˆè¿›ç¨‹çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€è¿‡å¤§ï¼‰</strong><br />\nè¿™ç§åŸåˆ™æœ€å¸¸è§çš„åº”ç”¨å°±æ˜¯ Web æœåŠ¡å™¨äº†ï¼Œæ¥ä¸€ä¸ªè¿æ¥å»ºç«‹ä¸€ä¸ªçº¿ç¨‹ï¼Œæ–­äº†å°±é”€æ¯çº¿ç¨‹ï¼Œè¦æ˜¯ç”¨è¿›ç¨‹ï¼Œåˆ›å»ºå’Œé”€æ¯çš„ä»£ä»·æ˜¯å¾ˆéš¾æ‰¿å—çš„ã€‚</li>\n<li><strong>éœ€è¦è¿›è¡Œå¤§é‡è®¡ç®—çš„ä¼˜å…ˆä½¿ç”¨çº¿ç¨‹ï¼ˆCPU é¢‘ç¹åˆ‡æ¢ï¼‰</strong><br />\næ‰€è°“å¤§é‡è®¡ç®—ï¼Œå½“ç„¶å°±æ˜¯è¦è€—è´¹å¾ˆå¤š CPUï¼Œåˆ‡æ¢é¢‘ç¹äº†ï¼Œè¿™ç§æƒ…å†µä¸‹çº¿ç¨‹æ˜¯æœ€åˆé€‚çš„ã€‚</li>\n<li><strong>éƒ½æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œç”¨ä½ æœ€ç†Ÿæ‚‰ã€æœ€æ‹¿æ‰‹çš„æ–¹å¼</strong><br />\nè‡³äº â€œæ•°æ®å…±äº«ã€åŒæ­¥â€ã€â€œ ç¼–ç¨‹ ã€è°ƒè¯•â€ã€â€œå¯é æ€§â€ è¿™å‡ ä¸ªç»´åº¦çš„æ‰€è°“çš„ â€œå¤æ‚ã€ç®€å•â€ åº”è¯¥æ€ä¹ˆå–èˆï¼Œåªèƒ½è¯´ï¼šæ²¡æœ‰æ˜ç¡®çš„é€‰æ‹©æ–¹æ³•ã€‚é€‰æ‹©åŸåˆ™ï¼šå¦‚æœå¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹éƒ½èƒ½å¤Ÿæ»¡è¶³è¦æ±‚ï¼Œé‚£ä¹ˆé€‰æ‹©ä½ æœ€ç†Ÿæ‚‰ã€æœ€æ‹¿æ‰‹çš„é‚£ä¸ªã€‚</li>\n</ol>\n<p>ğŸ™‡å®é™…åº”ç”¨ä¸­åŸºæœ¬ä¸Šéƒ½æ˜¯ â€œè¿›ç¨‹ + çº¿ç¨‹â€ çš„ç»“åˆæ–¹å¼ï¼Œåƒä¸‡ä¸è¦çœŸçš„é™·å…¥ä¸€ç§éæ­¤å³å½¼çš„è¯¯åŒºã€‚</p>\n<h2 id=\"æ‹“å±•çŸ¥è¯†\"><a class=\"anchor\" href=\"#æ‹“å±•çŸ¥è¯†\">#</a> æ‹“å±•çŸ¥è¯†</h2>\n<h3 id=\"è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•\"><a class=\"anchor\" href=\"#è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•\">#</a> è¿›ç¨‹é—´çš„è°ƒåº¦ç®—æ³•</h3>\n<ol>\n<li><strong>å…ˆåˆ°å…ˆæœåŠ¡</strong>  ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å…ˆè¿›å…¥è¯¥é˜Ÿåˆ—çš„è¿›ç¨‹ä¸ºä¹‹åˆ†é…èµ„æºï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œåˆ°å®Œæˆæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå ç”¨ CPU æ—¶å†é‡æ–°è°ƒåº¦ã€‚</li>\n<li><strong>çŸ­ä½œä¸šä¼˜å…ˆ</strong> ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰å‡ºä¸€ä¸ªä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹ä¸ºä¹‹åˆ†é…èµ„æºï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œåˆ°å®Œæˆæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå ç”¨ CPU æ—¶å†é‡æ–°è°ƒåº¦ã€‚</li>\n<li><strong>æ—¶é—´ç‰‡è½®è½¬</strong> æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦æ˜¯ä¸€ç§æœ€å¤è€ï¼Œæœ€ç®€å•ï¼Œæœ€å…¬å¹³ä¸”ä½¿ç”¨æœ€å¹¿çš„ç®—æ³•ï¼Œåˆç§° RR (Round robin) è°ƒåº¦ã€‚æ¯ä¸ªè¿›ç¨‹è¢«åˆ†é…ä¸€ä¸ªæ—¶é—´æ®µï¼Œç§°ä½œå®ƒçš„æ—¶é—´ç‰‡ï¼Œå³è¯¥è¿›ç¨‹å…è®¸è¿è¡Œçš„æ—¶é—´ã€‚</li>\n<li><strong>ä¼˜å…ˆçº§è°ƒåº¦</strong>  ä¸ºæ¯ä¸ªæµç¨‹åˆ†é…ä¼˜å…ˆçº§ï¼Œé¦–å…ˆæ‰§è¡Œå…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿›ç¨‹ä»¥ FCFS æ–¹å¼æ‰§è¡Œã€‚å¯ä»¥æ ¹æ®å†…å­˜è¦æ±‚ï¼Œæ—¶é—´è¦æ±‚æˆ–ä»»ä½•å…¶ä»–èµ„æºè¦æ±‚æ¥ç¡®å®šä¼˜å…ˆçº§ã€‚</li>\n<li><strong>å¤šçº§åé¦ˆé˜Ÿåˆ—</strong> å‰é¢ä»‹ç»çš„å‡ ç§è¿›ç¨‹è°ƒåº¦çš„ç®—æ³•éƒ½æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚å¦‚çŸ­è¿›ç¨‹ä¼˜å…ˆçš„è°ƒåº¦ç®—æ³•ï¼Œä»…ç…§é¡¾äº†çŸ­è¿›ç¨‹è€Œå¿½ç•¥äº†é•¿è¿›ç¨‹ ã€‚å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•æ—¢èƒ½ä½¿é«˜ä¼˜å…ˆçº§çš„ä½œä¸šå¾—åˆ°å“åº”åˆèƒ½ä½¿çŸ­ä½œä¸šï¼ˆè¿›ç¨‹ï¼‰è¿…é€Ÿå®Œæˆã€‚ï¼Œå› è€Œå®ƒæ˜¯ç›®å‰è¢«å…¬è®¤çš„ä¸€ç§è¾ƒå¥½çš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼ŒUNIX æ“ä½œç³»ç»Ÿé‡‡å–çš„ä¾¿æ˜¯è¿™ç§è°ƒåº¦ç®—æ³•ã€‚</li>\n</ol>\n<h2 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<blockquote>\n<p>æ¯”å–»â­ï¼šå¦‚æœè¯´è¿›ç¨‹æ˜¯å·¥å‚ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±æ˜¯å·¥å‚é‡Œçš„å·¥äººï¼Œè€Œå·¥äººæ˜¯è¦å¹²æ´»çš„ã€‚å·¥å‚ï¼ˆè¿›ç¨‹ï¼‰ç»™å·¥äººï¼ˆçº¿ç¨‹ï¼‰æä¾›äº†å†…å­˜ç©ºé—´ï¼Œè®©å·¥äººï¼ˆçº¿ç¨‹ï¼‰å¹²æ´»ã€‚</p>\n</blockquote>\n<p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚å› æ­¤ï¼ŒæŸç§æ„ä¹‰ä¸Šå¯ä»¥è¯´åœ¨æ”¯æŒçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„è¿›ç¨‹è°ƒåº¦ï¼Œè€Œéƒ½æ˜¯çº¿ç¨‹è°ƒåº¦ã€‚çº¿ç¨‹çš„å‡ºç°ä¸»è¦æ˜¯ä¸ºäº†å¼¥è¡¥è¿›ç¨‹å„ç§æ“ä½œå¼€é”€å¤§çš„é—®é¢˜ï¼Œé™¤è¿™ç‚¹å¤–ï¼Œçº¿ç¨‹å’Œè¿›ç¨‹æ˜¯å·®ä¸å¤šçš„ã€‚å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ä¸€æ ·ï¼Œä¸€æ–¹é¢ä¸ºäº†å……åˆ†åˆ©ç”¨ CPU èµ„æºï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/10/61a222d598ec/",
            "url": "https://shaogezhu.cn/2021/10/61a222d598ec/",
            "title": "springäº‹åŠ¡ å¸¸è§çš„å¤±æ•ˆåœºæ™¯",
            "date_published": "2021-10-29T14:49:32.000Z",
            "content_html": "<div class=\"note info\">\n<p>ä½¿ç”¨ spring çš„é¡¹ç›®ï¼Œåœ¨å¤„ç†<strong>è½¬è´¦ã€ä»˜æ¬¾</strong>ç­‰æ“ä½œçš„æ—¶å€™ï¼Œä¸ºäº†æ•°æ®èƒ½è¢«æ­£ç¡®çš„ä¿®æ”¹ï¼Œé€šå¸¸ä¼šä½¿ç”¨ spring çš„æ³¨è§£ @Transactional å¯¹äº‹åŠ¡è¿›è¡Œæ§åˆ¶ã€‚spring å¯¹äº‹ç‰©ä¹Ÿæœ‰å¤±æ•ˆçš„åœºæ™¯æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œé˜²æ­¢ä»¥åç¨‹åºå‡ºç° bugğŸ‘€</p>\n</div>\n<h2 id=\"springäº‹åŠ¡å¤±æ•ˆåœºæ™¯\"><a class=\"anchor\" href=\"#springäº‹åŠ¡å¤±æ•ˆåœºæ™¯\">#</a> spring äº‹åŠ¡å¤±æ•ˆåœºæ™¯</h2>\n<h3 id=\"1-æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡\"><a class=\"anchor\" href=\"#1-æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡\">#</a> 1ã€æ•°æ®åº“å¼•æ“ä¸æ”¯æŒäº‹åŠ¡</h3>\n<p>ä»¥ MySQL ä¸ºä¾‹ğŸŒ°ï¼Œå…¶ MyISAM å¼•æ“æ˜¯ä¸æ”¯æŒäº‹åŠ¡æ“ä½œçš„ï¼ŒInnoDB æ‰æ˜¯æ”¯æŒäº‹åŠ¡çš„å¼•æ“ï¼Œä¸€èˆ¬è¦æ”¯æŒäº‹åŠ¡éƒ½ä¼šä½¿ç”¨ InnoDBã€‚</p>\n<h3 id=\"2-æ²¡æœ‰è¢«-spring-ç®¡ç†\"><a class=\"anchor\" href=\"#2-æ²¡æœ‰è¢«-spring-ç®¡ç†\">#</a> 2ã€æ²¡æœ‰è¢« Spring ç®¡ç†</h3>\n<p>å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// @Service</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderServiceImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OrderService</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Transactional</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">updateOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Order</span> order<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¦‚æœæŠŠ @Service æ³¨è§£æ³¨é‡Šæ‰ï¼Œè¿™ä¸ªç±»å°±ä¸ä¼šè¢«åŠ è½½æˆä¸€ä¸ª Beanï¼Œé‚£è¿™ä¸ªç±»å°±ä¸ä¼šè¢« Spring ç®¡ç†äº†ï¼Œäº‹åŠ¡è‡ªç„¶å°±å¤±æ•ˆäº†ã€‚</p>\n<h3 id=\"3-æ–¹æ³•ä¸æ˜¯-public-çš„\"><a class=\"anchor\" href=\"#3-æ–¹æ³•ä¸æ˜¯-public-çš„\">#</a> 3ã€æ–¹æ³•ä¸æ˜¯ public çš„</h3>\n<p>ä»¥ä¸‹æ¥è‡ª Spring å®˜æ–¹æ–‡æ¡£âœ¨ï¼š</p>\n<blockquote>\n<p>When using proxies, you should apply the @Transactional annotation only to methods with public visibility. If you do annotate protected, private or package-visible methods with the @Transactional annotation, no error is raised, but the annotated method does not exhibit the configured transactional settings. Consider the use of AspectJ (see below) if you need to annotate non-public methods.</p>\n<p>å¤§æ¦‚æ„æ€å°±æ˜¯ <strong>@Transactional</strong> åªèƒ½ç”¨äº <strong>public</strong> çš„æ–¹æ³•ä¸Šï¼Œå¦åˆ™äº‹åŠ¡ä¸ä¼šå¤±æ•ˆï¼Œå¦‚æœè¦ç”¨åœ¨é public æ–¹æ³•ä¸Šï¼Œå¯ä»¥å¼€å¯ AspectJ ä»£ç†æ¨¡å¼ã€‚</p>\n</blockquote>\n<h3 id=\"4-å¼‚å¸¸è¢«æ•è·äº†\"><a class=\"anchor\" href=\"#4-å¼‚å¸¸è¢«æ•è·äº†\">#</a> 4ã€å¼‚å¸¸è¢«æ•è·äº†</h3>\n<p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Service</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderServiceImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OrderService</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Transactional</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">updateOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Order</span> order<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\">// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å°†å¼‚å¸¸æ•è·äº†ï¼Œæ²¡æœ‰æŠ›å‡ºæ¥ï¼Œspring å¹¶ä¸çŸ¥é“å‘ç”Ÿäº†å¼‚å¸¸ï¼Œæ‰€ä»¥ä¸ä¼šå›æ»šã€‚</p>\n<h3 id=\"5-å¼‚å¸¸ç±»å‹é”™è¯¯\"><a class=\"anchor\" href=\"#5-å¼‚å¸¸ç±»å‹é”™è¯¯\">#</a> 5ã€å¼‚å¸¸ç±»å‹é”™è¯¯</h3>\n<p>è¿˜æ˜¯ä¸Šé¢çš„åˆ—å­ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Service</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderServiceImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OrderService</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Transactional</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">updateOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Order</span> order<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\">// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‘ç”Ÿå¼‚å¸¸\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿™æ ·äº‹åŠ¡ä¹Ÿæ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œå› ä¸ºé»˜è®¤å›æ»šçš„æ˜¯ï¼šRuntimeExceptionï¼Œå¦‚æœä½ æƒ³è§¦å‘å…¶ä»–å¼‚å¸¸çš„å›æ»šï¼Œéœ€è¦åœ¨æ³¨è§£ä¸Šé…ç½®ä¸€ä¸‹ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>rollbackFor <span class=\"token operator\">=</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®ä»…é™äº Throwable å¼‚å¸¸ç±»åŠå…¶å­ç±»ã€‚</p>\n<h3 id=\"6-ä¸æ”¯æŒäº‹åŠ¡\"><a class=\"anchor\" href=\"#6-ä¸æ”¯æŒäº‹åŠ¡\">#</a> 6ã€ä¸æ”¯æŒäº‹åŠ¡</h3>\n<p>æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Service</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderServiceImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OrderService</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Transactional</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Order</span> order<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">updateOrder</span><span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// è°ƒç”¨ä¸‹è¾¹çš„æ–¹æ³•</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>propagation <span class=\"token operator\">=</span> <span class=\"token class-name\">Propagation</span><span class=\"token punctuation\">.</span>NOT_SUPPORTED<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">updateOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Order</span> order<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// æ•°æ®åº“å¢åˆ æ”¹æ“ä½œ</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ğŸˆPropagation.NOT_SUPPORTEDï¼š è¡¨ç¤ºä¸ä»¥äº‹åŠ¡è¿è¡Œï¼Œå½“å‰è‹¥å­˜åœ¨äº‹åŠ¡åˆ™æŒ‚èµ·ï¼Œè¯¦ç»†çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶åœ¨ä¸‹é¢ã€‚</p>\n<h2 id=\"springäº‹åŠ¡çš„7ç§ä¼ æ’­æœºåˆ¶\"><a class=\"anchor\" href=\"#springäº‹åŠ¡çš„7ç§ä¼ æ’­æœºåˆ¶\">#</a> spring äº‹åŠ¡çš„ 7 ç§ä¼ æ’­æœºåˆ¶</h2>\n<ul>\n<li>\n<p><strong>REQUIRED</strong></p>\n<blockquote>\n<p>å¦‚æœå½“å‰æ–¹æ³•æœ‰äº‹åŠ¡åˆ™åŠ å…¥äº‹åŠ¡ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>NOT_SUPPORTED</strong></p>\n<blockquote>\n<p>ä¸æ”¯æŒäº‹åŠ¡ï¼Œå¦‚æœå½“å‰æœ‰äº‹åŠ¡åˆ™æŒ‚èµ·äº‹åŠ¡è¿è¡Œã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>REQUIREDS_NEW</strong></p>\n<blockquote>\n<p>æ–°å»ºä¸€ä¸ªäº‹åŠ¡å¹¶åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡å°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚æ–°å»ºçš„äº‹åŠ¡çš„æäº¤ä¸å›æ»šä¸€æŒ‚èµ·äº‹åŠ¡æ²¡æœ‰è”ç³»ï¼Œä¸ä¼šå½±å“æŒ‚èµ·äº‹åŠ¡çš„æ“ä½œã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>MANDATORY</strong></p>\n<blockquote>\n<p>å¼ºåˆ¶å½“å‰æ–¹æ³•ä½¿ç”¨äº‹åŠ¡è¿è¡Œï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>NEVER</strong></p>\n<blockquote>\n<p>å½“å‰æ–¹æ³•ä¸èƒ½å­˜åœ¨äº‹åŠ¡ï¼Œå³éäº‹åŠ¡çŠ¶æ€è¿è¡Œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>SUPPORTS</strong></p>\n<blockquote>\n<p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡äº‹åŠ¡ä¹Ÿæ”¯æŒéäº‹åŠ¡çŠ¶æ€è¿è¡Œã€‚</p>\n</blockquote>\n</li>\n<li>\n<p><strong>NESTED</strong></p>\n<blockquote>\n<p>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚åµŒå¥—äº‹åŠ¡çš„æäº¤ä¸å›æ»šä¸çˆ¶äº‹åŠ¡æ²¡æœ‰ä»»åŠ¡å…³ç³»ï¼Œåä¹‹ï¼Œå½“çˆ¶äº‹åŠ¡æäº¤åµŒå¥—äº‹åŠ¡ä¹Ÿä¸€èµ·æäº¤ï¼Œçˆ¶äº‹åŠ¡å›æ»šä¼šä¹Ÿå›æ»šåµŒå¥—äº‹åŠ¡çš„ã€‚</p>\n</blockquote>\n</li>\n</ul>\n<p>å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ–°å»ºä¸€ä¸ªäº‹åŠ¡è¿è¡Œï¼Œè¿™æ—¶å€™åˆ™ä¸ PROPAGATION_REQUIRED åœºæ™¯ä¸€è‡´ã€‚</p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "spring"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/10/17f071d31a96/",
            "url": "https://shaogezhu.cn/2021/10/17f071d31a96/",
            "title": "ç»ˆäºå¼„æ˜ç™½äº†ThreadLocal",
            "date_published": "2021-10-23T03:11:55.000Z",
            "content_html": "<div class=\"note info\">\n<p>ğŸŒˆå†™ SpringBoot é¡¹ç›®çš„æ—¶å€™ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€ä¸ªä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ç±»å°±æ˜¯ Threadlocalï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç±»ã€‚</p>\n</div>\n<h2 id=\"threadlocalæœ‰ä»€ä¹ˆç”¨\"><a class=\"anchor\" href=\"#threadlocalæœ‰ä»€ä¹ˆç”¨\">#</a> Threadlocal æœ‰ä»€ä¹ˆç”¨ï¼š</h2>\n<p>ğŸ“Œç®€å•çš„è¯´å°±æ˜¯ï¼Œ<font color=\"blue\">ä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„ï¼ˆæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼‰ã€‚</font>å¦‚ä¸‹å›¾ï¼š</p>\n<p><img data-src=\"/assets/2021-10/tl1.png\" alt=\"image.png\" /></p>\n<h2 id=\"threadlocalä½¿ç”¨å®ä¾‹\"><a class=\"anchor\" href=\"#threadlocalä½¿ç”¨å®ä¾‹\">#</a> ThreadLocal ä½¿ç”¨å®ä¾‹</h2>\n<h3 id=\"apiä»‹ç»\"><a class=\"anchor\" href=\"#apiä»‹ç»\">#</a> API ä»‹ç»</h3>\n<p>ğŸ¦„åœ¨ä½¿ç”¨ Threadlocal ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹ä»¥ä¸‹å®ƒçš„ APIï¼š<br />\n<img data-src=\"/assets/2021-10/tl2.png\" alt=\"16314961931.png\" /></p>\n<p>ThreadLocal ç±»çš„ API éå¸¸çš„ç®€å•ï¼Œåœ¨è¿™é‡Œæ¯”è¾ƒé‡è¦çš„å°±æ˜¯ get ()ã€set ()ã€remove (),set ç”¨äºèµ‹å€¼æ“ä½œï¼Œget ç”¨äºè·å–å˜é‡çš„å€¼ï¼Œremove å°±æ˜¯åˆ é™¤å½“å‰å˜é‡çš„å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ initialValue æ–¹æ³•ä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è¢«è§¦å‘ï¼Œç”¨äºåˆå§‹åŒ–å½“å‰å˜é‡å€¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ initialValue è¿”å›çš„æ˜¯ nullã€‚</p>\n<h3 id=\"threadlocalçš„ä½¿ç”¨\"><a class=\"anchor\" href=\"#threadlocalçš„ä½¿ç”¨\">#</a> ThreadLocal çš„ä½¿ç”¨</h3>\n<p>ğŸ‹è¯´å®Œäº† ThreadLocal ç±»çš„ API äº†ï¼Œé‚£æˆ‘ä»¬å°±æ¥åŠ¨æ‰‹å®è·µä¸€ä¸‹äº†ï¼Œæ¥ç†è§£å‰é¢çš„é‚£å¥è¯ï¼š<strong>ä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„ï¼ˆæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼‰</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ThreadLocalTest</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">ThreadLocal</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> threadLocal <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadLocal</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token comment\">// é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä¿®æ”¹ â€œçº¿ç¨‹å˜é‡â€ çš„åˆå§‹å€¼ï¼Œé»˜è®¤æ˜¯ null</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">initialValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">InterruptedException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// ä¸€å·çº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Runnable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ä¸€å·çº¿ç¨‹setå‰ï¼š\"</span> <span class=\"token operator\">+</span> threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ä¸€å·çº¿ç¨‹setåï¼š\"</span> <span class=\"token operator\">+</span> threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">// äºŒå·çº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">new</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Runnable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"äºŒå·çº¿ç¨‹setå‰ï¼š\"</span> <span class=\"token operator\">+</span> threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"äºŒå·çº¿ç¨‹setåï¼š\"</span> <span class=\"token operator\">+</span> threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token comment\">// ä¸»çº¿ç¨‹ç¡ 1s</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token comment\">// ä¸»çº¿ç¨‹</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ä¸»çº¿ç¨‹çš„threadlocalå€¼ï¼š\"</span> <span class=\"token operator\">+</span> threadLocal<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>ç¨å¾®è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼šğŸ’¡</strong></p>\n<p>æ¯ä¸€ä¸ª ThreadLocal å®ä¾‹å°±ç±»ä¼¼äºä¸€ä¸ªå˜é‡åï¼Œä¸åŒçš„ ThreadLocal å®ä¾‹å°±æ˜¯ä¸åŒçš„å˜é‡åï¼Œå®ƒä»¬å†…éƒ¨ä¼šå­˜æœ‰ä¸€ä¸ªå€¼ï¼ˆæš‚æ—¶è¿™ä¹ˆç†è§£ï¼‰<font color=\"violet\">åœ¨åé¢çš„æè¿°ä¸­æ‰€è¯´çš„ â€œ<font color=\"blue\">ThreadLocal å˜é‡æˆ–è€…æ˜¯çº¿ç¨‹å˜é‡</font>â€ ä»£è¡¨çš„å°±æ˜¯ ThreadLocal ç±»çš„å®ä¾‹ã€‚</font></p>\n<p>åœ¨ç±»ä¸­åˆ›å»ºäº†ä¸€ä¸ªé™æ€çš„ <strong>â€œThreadLocal å˜é‡â€</strong>ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œåœ¨è¿™ä¸¤ä¸ªçº¿ç¨‹ä¸­åˆ†åˆ«è®¾ç½® ThreadLocal å˜é‡ä¸º 1 å’Œ 2ã€‚ç„¶åç­‰å¾…ä¸€å·å’ŒäºŒå·çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æŸ¥çœ‹ ThreadLocal å˜é‡çš„å€¼ã€‚</p>\n<p><strong>ç¨‹åºç»“æœåŠåˆ†æâŒ›</strong><br />\n<img data-src=\"/assets/2021-10/tl3.png\" alt=\"16314972101.png\" /></p>\n<p>ç¨‹åºç»“æœé‡ç‚¹çœ‹çš„æ˜¯ä¸»çº¿ç¨‹è¾“å‡ºçš„æ˜¯ 0ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œåœ¨ä¸€å·çº¿ç¨‹å’ŒäºŒå·çº¿ç¨‹ä¸­å°†æ™®é€šå˜é‡è®¾ç½®ä¸º 1 å’Œ 2ï¼Œé‚£ä¹ˆåœ¨ä¸€äºŒå·çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ååœ¨æ‰“å°è¿™ä¸ªå˜é‡ï¼Œè¾“å‡ºçš„å€¼è‚¯å®šæ˜¯ 1 æˆ–è€… 2ï¼ˆåˆ°åº•è¾“å‡ºå“ªä¸€ä¸ªç”±æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦é€»è¾‘æœ‰å…³ï¼‰ã€‚ä½†ä½¿ç”¨ ThreadLocal å˜é‡é€šè¿‡ä¸¤ä¸ªçº¿ç¨‹èµ‹å€¼åï¼Œåœ¨ä¸»çº¿ç¨‹ç¨‹ä¸­è¾“å‡ºçš„å´æ˜¯åˆå§‹å€¼ 0ã€‚åœ¨è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ â€œä¸€ä¸ª ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆæ˜¯éš”ç¦»çš„â€ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°è‡ªå·±çº¿ç¨‹çš„å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯ <font color=\"red\">ThreadLocal çš„æ ¸å¿ƒä½œç”¨ï¼šå®ç°çº¿ç¨‹èŒƒå›´çš„å±€éƒ¨å˜é‡ã€‚</font></p>\n<h2 id=\"threadlocal-çš„æºç åˆ†æ\"><a class=\"anchor\" href=\"#threadlocal-çš„æºç åˆ†æ\">#</a> Threadlocal çš„æºç åˆ†æ</h2>\n<h3 id=\"åŸç†\"><a class=\"anchor\" href=\"#åŸç†\">#</a> åŸç†</h3>\n<blockquote>\n<p>æ¯ä¸ª Thread å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª ThreadLocalMapï¼Œ<strong>å½“åˆ›å»ºä¸€ä¸ª ThreadLocal çš„æ—¶å€™ï¼Œå°±ä¼šå°†è¯¥ ThreadLocal å¯¹è±¡æ·»åŠ åˆ°è¯¥ Map ä¸­ï¼Œå…¶ä¸­é”®å°±æ˜¯ ThreadLocalï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</strong> è¿™å¥è¯åˆšçœ‹å¯èƒ½ä¸æ˜¯å¾ˆæ‡‚ï¼Œä¸‹é¢æˆ‘ä»¬ä¸€èµ·çœ‹å®Œæºç å°±æ˜ç™½äº†ã€‚</p>\n</blockquote>\n<p>å‰é¢æˆ‘ä»¬çš„ç†è§£æ˜¯æ‰€æœ‰çš„å¸¸é‡å€¼æˆ–è€…æ˜¯å¼•ç”¨ç±»å‹çš„å¼•ç”¨éƒ½æ˜¯ä¿å­˜åœ¨ ThreadLocal å®ä¾‹ä¸­çš„ï¼Œä½†å®é™…ä¸Šä¸æ˜¯çš„ï¼Œè¿™ç§è¯´æ³•åªæ˜¯è®©æˆ‘ä»¬æ›´å¥½çš„ç†è§£ ThreadLocal å˜é‡è¿™ä¸ªæ¦‚å¿µã€‚<font color = \"blue\"><strong>å‘ ThreadLocal å­˜å…¥ä¸€ä¸ªå€¼ï¼Œå®é™…ä¸Šæ˜¯å‘å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­çš„ ThreadLocalMap å­˜å…¥å€¼</strong></font>ï¼ŒThreadLocalMap æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£æˆä¸€ä¸ª Mapï¼Œè€Œå‘è¿™ä¸ª Map å­˜å€¼çš„ key å°±æ˜¯ ThreadLocal å®ä¾‹æœ¬èº«ã€‚</p>\n<h3 id=\"æºç \"><a class=\"anchor\" href=\"#æºç \">#</a> æºç </h3>\n<p><img data-src=\"/assets/2021-10/tl4.png\" alt=\"image.png\" /></p>\n<p>ğŸ‘‰ä¹Ÿå°±æ˜¯è¯´ï¼Œæƒ³è¦å­˜å…¥çš„ ThreadLocal ä¸­çš„æ•°æ®å®é™…ä¸Šå¹¶æ²¡æœ‰å­˜åˆ° ThreadLocal å¯¹è±¡ä¸­å»ï¼Œè€Œæ˜¯ä»¥<strong>è¿™ä¸ª ThreadLocal å®ä¾‹ä½œä¸º key å­˜åˆ°äº†å½“å‰çº¿ç¨‹ä¸­çš„ä¸€ä¸ª Map ä¸­å»äº†</strong>ï¼Œè·å– ThreadLocal çš„å€¼æ—¶åŒæ ·ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ ThreadLocal å¯ä»¥å®ç°çº¿ç¨‹ä¹‹é—´éš”ç¦»çš„åŸå› äº†ã€‚</p>\n<h2 id=\"å†…éƒ¨ç±»threadlocalmap\"><a class=\"anchor\" href=\"#å†…éƒ¨ç±»threadlocalmap\">#</a> å†…éƒ¨ç±» ThreadLocalMap</h2>\n<p>ThreadLocalMap æ˜¯ ThreadLocal çš„å†…éƒ¨ç±»ï¼Œå®ç°äº†ä¸€å¥—è‡ªå·±çš„ Map ç»“æ„âœ¨</p>\n<p><strong>ThreadLocalMap å±æ€§ï¼š</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Entry</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">WeakReference</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThreadLocal</span><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token class-name\">Object</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token class-name\">Entry</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ThreadLocal</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> k<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> v<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                value <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// åˆå§‹å®¹é‡ 16</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> INITIAL_CAPACITY <span class=\"token operator\">=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// æ•£åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Entry</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">//entry æœ‰æ•ˆæ•°é‡ </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> size <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// è´Ÿè½½å› å­</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> threshold<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ThreadLocalMap è®¾ç½® ThreadLocal å˜é‡</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ThreadLocal</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token class-name\">Entry</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token comment\">// ä¸è¿ç®—  &amp; (len-1) è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ è¦æ±‚æ•°ç»„ len è¦æ±‚ 2 çš„ n æ¬¡å¹‚ </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token comment\">// å› ä¸º len å‡ä¸€åæœ€åä¸€ä¸ª bit æ˜¯ 1 ä¸è¿ç®—è®¡ç®—å‡ºæ¥çš„æ•°å€¼ä¸‹æ ‡ èƒ½ä¿è¯å…¨è¦†ç›– </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\">// å¦è€…æ•°ç»„æœ‰æ•ˆä½ä¼šå‡åŠ </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token comment\">// å¦‚æœæ˜¯ hashmap è®¡ç®—å®Œä¸‹æ ‡å ä¼šå¢åŠ é“¾è¡¨ æˆ–çº¢é»‘æ ‘çš„æŸ¥æ‰¾è®¡ç®—é‡ </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span>threadLocalHashCode <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>len<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token comment\">// ä»ä¸‹æ ‡ä½ç½®å¼€å§‹å‘åå¾ªç¯æœç´¢  ä¸ä¼šæ­»å¾ªç¯  æœ‰æ‰©å®¹å› å­ å¿…å®šæœ‰ç©ºä½™æ§½ç‚¹</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Entry</span> e <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>   e <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>  e <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i <span class=\"token operator\">=</span> <span class=\"token function\">nextIndex</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token class-name\">ThreadLocal</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> k <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token comment\">// ä¸€ç§æƒ…å†µ æ˜¯å½“å‰å¼•ç”¨ è¿”å›å€¼</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>k <span class=\"token operator\">==</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                    e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token comment\">// æ§½ç‚¹è¢« GC æ‰ é‡è®¾çŠ¶æ€ </span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>k <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token function\">replaceStaleEntry</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t\t<span class=\"token comment\">// æ§½ç‚¹ä¸ºç©º è®¾ç½® value</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            tab<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Entry</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token comment\">// è®¾ç½® ThreadLocal æ•°é‡</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">int</span> sz <span class=\"token operator\">=</span> <span class=\"token operator\">++</span>size<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t\t<span class=\"token comment\">// æ²¡æœ‰å¯æ¸…ç†çš„æ§½ç‚¹ å¹¶ä¸”æ•°é‡å¤§äºè´Ÿè½½å› å­ rehash</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">cleanSomeSlots</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> sz<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> sz <span class=\"token operator\">>=</span> threshold<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token function\">rehash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ThreadLocalMap å±æ€§ä»‹ç»ğŸ˜ï¼š</p>\n<ul>\n<li>å’Œæ™®é€š Hashmap ç±»ä¼¼å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„å†…ï¼Œä½†ä¸ hashmap ä½¿ç”¨çš„æ‹‰é“¾æ³•è§£å†³æ•£åˆ—å†²çªä¸åŒçš„æ˜¯ ThreadLocalMap ä½¿ç”¨å¼€æ”¾åœ°å€æ³•</li>\n<li>æ•°ç»„ åˆå§‹å®¹é‡ 16ï¼Œè´Ÿè½½å› å­ 2/3</li>\n<li>node èŠ‚ç‚¹ çš„ key å°è£…äº† WeakReference ç”¨äºå›æ”¶</li>\n</ul>\n<h3 id=\"threadlocalmapå­˜å‚¨ä½ç½®\"><a class=\"anchor\" href=\"#threadlocalmapå­˜å‚¨ä½ç½®\">#</a> ThreadLocalMap å­˜å‚¨ä½ç½®</h3>\n<blockquote>\n<p>å‚¨å­˜åœ¨ Thread ä¸­ï¼Œæœ‰ä¸¤ä¸ª ThreadLocalMap å˜é‡</p>\n</blockquote>\n<p><img data-src=\"/assets/2021-10/tl4.5.png\" alt=\"16315167211.png\" /></p>\n<ol>\n<li>threadLocals åœ¨ ThreadLocal å¯¹è±¡æ–¹æ³• set ä¸­å»åˆ›å»º ä¹Ÿç”± ThreadLocal æ¥ç»´æŠ¤</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token class-name\">Thread</span> t <span class=\"token operator\">=</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentThread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">ThreadLocalMap</span> map <span class=\"token operator\">=</span> <span class=\"token function\">getMap</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>map <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            map<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token function\">createMap</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token function\">createMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Thread</span> t<span class=\"token punctuation\">,</span> <span class=\"token class-name\">T</span> firstValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        t<span class=\"token punctuation\">.</span>threadLocals <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadLocalMap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> firstValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"2\">\n<li>inheritableThreadLocals å’Œ ThreadLocal ç±»ä¼¼ InheritableThreadLocal é‡å†™äº† createMap æ–¹æ³•</li>\n</ol>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">createMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Thread</span> t<span class=\"token punctuation\">,</span> <span class=\"token class-name\">T</span> firstValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        t<span class=\"token punctuation\">.</span>inheritableThreadLocals <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadLocalMap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> firstValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>inheritableThreadLocals ä½œç”¨æ˜¯å°† ThreadLocalMap ä¼ é€’ç»™å­çº¿ç¨‹</li>\n</ol>\n<p><img data-src=\"/assets/2021-10/tl5.png\" alt=\"image.png\" /></p>\n<ol start=\"4\">\n<li>init æ–¹æ³•ä¸­ æ¡ä»¶æ»¡è¶³åç›´æ¥ä¸ºå­çº¿ç¨‹åˆ›å»º ThreadLocalMap</li>\n</ol>\n<p><img data-src=\"/assets/2021-10/tl6.png\" alt=\"image.png\" /></p>\n<p><strong>æ³¨æ„ï¼š</strong></p>\n<ol>\n<li>ä»…åœ¨åˆå§‹åŒ–å­çº¿ç¨‹çš„æ—¶å€™ä¼šä¼ é€’ ä¸­é€”æ”¹å˜å‰¯çº¿ç¨‹çš„ inheritableThreadLocals å˜é‡ ä¸ä¼šå°†å½±å“ç»“æœä¼ é€’åˆ°å­çº¿ç¨‹ ã€‚</li>\n<li>ä½¿ç”¨çº¿ç¨‹æ± è¦æ³¨æ„ çº¿ç¨‹ä¸å›æ”¶ å°½é‡é¿å…ä½¿ç”¨çˆ¶çº¿ç¨‹çš„ inheritableThreadLocals å¯¼è‡´é”™è¯¯</li>\n</ol>\n<h2 id=\"keyçš„å¼±å¼•ç”¨é—®é¢˜\"><a class=\"anchor\" href=\"#keyçš„å¼±å¼•ç”¨é—®é¢˜\">#</a> Key çš„å¼±å¼•ç”¨é—®é¢˜</h2>\n<p>ä¸ºä»€ä¹ˆè¦ç”¨å¼±å¼•ç”¨ï¼Œå®˜æ–¹æ˜¯è¿™æ ·å›ç­”çš„</p>\n<blockquote>\n<p>To help deal with very large and long-lived usages, the hash table entries use WeakReferences for keys.<br />\n ä¸ºäº†å¤„ç†éå¸¸å¤§å’Œç”Ÿå‘½å‘¨æœŸéå¸¸é•¿çš„çº¿ç¨‹ï¼Œå“ˆå¸Œè¡¨ä½¿ç”¨å¼±å¼•ç”¨ä½œä¸º keyã€‚</p>\n</blockquote>\n<p>ç”Ÿå‘½å‘¨æœŸé•¿çš„çº¿ç¨‹å¯ä»¥ç†è§£ä¸ºï¼šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹</p>\n<p>ThreadLocal åœ¨æ²¡æœ‰å¤–éƒ¨å¯¹è±¡å¼ºå¼•ç”¨æ—¶å¦‚ Threadï¼Œå‘ç”Ÿ GC æ—¶å¼±å¼•ç”¨ Key ä¼šè¢«å›æ”¶ï¼Œè€Œ Value æ˜¯å¼ºå¼•ç”¨ä¸ä¼šå›æ”¶ï¼Œå¦‚æœåˆ›å»º ThreadLocal çš„çº¿ç¨‹ä¸€ç›´æŒç»­è¿è¡Œå¦‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ª Entry å¯¹è±¡ä¸­çš„ value å°±æœ‰å¯èƒ½ä¸€ç›´å¾—ä¸åˆ°å›æ”¶ï¼Œå‘ç”Ÿå†…å­˜æ³„éœ²ã€‚</p>\n<ul>\n<li><strong>key ä½¿ç”¨å¼ºå¼•ç”¨ğŸŒ´ï¼š</strong> å¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œä½†æ˜¯ ThreadLocalMap è¿˜æŒæœ‰ ThreadLocal çš„å¼ºå¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¸ä¼šè¢«å›æ”¶ï¼Œå¯¼è‡´ Entry å†…å­˜æ³„æ¼ã€‚</li>\n<li><strong>key ä½¿ç”¨å¼±å¼•ç”¨ğŸŒ´ï¼š</strong> å¼•ç”¨çš„ ThreadLocal çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œç”±äº ThreadLocalMap æŒæœ‰ ThreadLocal çš„å¼±å¼•ç”¨ï¼Œå³ä½¿æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤ï¼ŒThreadLocal ä¹Ÿä¼šè¢«å›æ”¶ã€‚value åœ¨ä¸‹ä¸€æ¬¡ ThreadLocalMap è°ƒç”¨ set,getï¼Œremove çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ã€‚</li>\n</ul>\n<p>Java8 ä¸­å·²ç»åšäº†ä¸€äº›ä¼˜åŒ–å¦‚ï¼Œåœ¨ ThreadLocal çš„ get ()ã€set ()ã€remove () æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ä¼šæ¸…é™¤æ‰çº¿ç¨‹ ThreadLocalMap ä¸­æ‰€æœ‰ Entry ä¸­ Key ä¸º null çš„ Valueï¼Œå¹¶å°†æ•´ä¸ª Entry è®¾ç½®ä¸º nullï¼Œåˆ©äºä¸‹æ¬¡å†…å­˜å›æ”¶ã€‚</p>\n<h3 id=\"javaä¸­çš„å››ç§å¼•ç”¨\"><a class=\"anchor\" href=\"#javaä¸­çš„å››ç§å¼•ç”¨\">#</a> java ä¸­çš„å››ç§å¼•ç”¨</h3>\n<ol>\n<li><strong>å¼ºå¼•ç”¨ğŸ“ï¼š</strong> å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œå®ƒå°±ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚å³ä½¿å½“å‰å†…å­˜ç©ºé—´ä¸è¶³ï¼ŒJVM ä¹Ÿä¸ä¼šå›æ”¶å®ƒï¼Œè€Œæ˜¯æŠ›å‡º OutOfMemoryError é”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ã€‚å¦‚æœæƒ³ä¸­æ–­å¼ºå¼•ç”¨å’ŒæŸä¸ªå¯¹è±¡ä¹‹é—´çš„å…³è”ï¼Œå¯ä»¥æ˜¾å¼åœ°å°†å¼•ç”¨èµ‹å€¼ä¸º nullï¼Œè¿™æ ·ä¸€æ¥çš„è¯ï¼ŒJVM åœ¨åˆé€‚çš„æ—¶é—´å°±ä¼šå›æ”¶è¯¥å¯¹è±¡</li>\n<li><strong>è½¯å¼•ç”¨ğŸ“ï¼š</strong> åœ¨ä½¿ç”¨è½¯å¼•ç”¨æ—¶ï¼Œå¦‚æœå†…å­˜çš„ç©ºé—´è¶³å¤Ÿï¼Œè½¯å¼•ç”¨å°±èƒ½ç»§ç»­è¢«ä½¿ç”¨ï¼Œè€Œä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œè½¯å¼•ç”¨æ‰ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ï¼ˆè½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ï¼Œæ¯”å¦‚ç½‘é¡µç¼“å­˜ã€å›¾ç‰‡ç¼“å­˜ç­‰ã€‚ä½¿ç”¨è½¯å¼•ç”¨èƒ½é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œå¢å¼ºç¨‹åºçš„å¥å£®æ€§ï¼‰</li>\n<li><strong>å¼±å¼•ç”¨ğŸ“ï¼š</strong> å…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰çš„ç”Ÿå‘½å‘¨æœŸæ›´çŸ­æš‚ã€‚å› ä¸ºå½“ JVM è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸€æ—¦å‘ç°å¼±å¼•ç”¨å¯¹è±¡ï¼Œæ— è®ºå½“å‰å†…å­˜ç©ºé—´æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå°†å¼±å¼•ç”¨å›æ”¶ã€‚ä¸è¿‡ç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½çš„çº¿ç¨‹ï¼Œæ‰€ä»¥å¹¶ä¸ä¸€å®šèƒ½è¿…é€Ÿå‘ç°å¼±å¼•ç”¨å¯¹è±¡</li>\n<li><strong>è™šå¼•ç”¨ğŸ“ï¼š</strong> è™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚è™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ï¼ˆæ³¨æ„å“¦ï¼Œå…¶å®ƒå¼•ç”¨æ˜¯è¢« JVM å›æ”¶åæ‰è¢«ä¼ å…¥ ReferenceQueue ä¸­çš„ã€‚ç”±äºè¿™ä¸ªæœºåˆ¶ï¼Œæ‰€ä»¥è™šå¼•ç”¨å¤§å¤šè¢«ç”¨äºå¼•ç”¨é”€æ¯å‰çš„å¤„ç†å·¥ä½œã€‚å¯ä»¥ä½¿ç”¨åœ¨å¯¹è±¡é”€æ¯å‰çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚è¯´èµ„æºé‡Šæ”¾ç­‰ã€‚ï¼‰</li>\n</ol>\n<p>é€šå¸¸ ThreadLocalMap çš„ç”Ÿå‘½å‘¨æœŸè·Ÿ Threadï¼ˆæ³¨æ„çº¿ç¨‹æ± ä¸­çš„ Threadï¼‰ä¸€æ ·é•¿ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤å¯¹åº” keyï¼ˆçº¿ç¨‹ä½¿ç”¨ç»“æŸå½’è¿˜ç»™çº¿ç¨‹æ± äº†ï¼Œå…¶ä¸­çš„ KV ä¸å†è¢«ä½¿ç”¨ä½†åˆä¸ä¼š GC å›æ”¶ï¼Œå¯è®¤ä¸ºæ˜¯å†…å­˜æ³„æ¼ï¼‰ï¼Œä¸€å®šä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œä½†æ˜¯ä½¿ç”¨å¼±å¼•ç”¨å¯ä»¥å¤šä¸€å±‚ä¿éšœï¼šå¼±å¼•ç”¨ ThreadLocal ä¼šè¢« GC å›æ”¶ï¼Œä¸ä¼šå†…å­˜æ³„æ¼ï¼Œå¯¹åº”çš„ value åœ¨ä¸‹ä¸€æ¬¡ ThreadLocalMap è°ƒç”¨ set,get,remove çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ï¼ŒJava8 å·²ç»åšäº†ä¸Šé¢çš„ä»£ç ä¼˜åŒ–ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“ï¼š</h2>\n<p><strong>ThreadLocal çš„ä½œç”¨ï¼š</strong> å®ç°çº¿ç¨‹èŒƒå›´å†…çš„å±€éƒ¨å˜é‡ï¼Œå³ ThreadLocal åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯å…±äº«çš„ï¼Œåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´æ˜¯éš”ç¦»çš„ã€‚</p>\n<p><strong>ThreadLocal çš„åŸç†ï¼š</strong> ThreadLocal å­˜å…¥å€¼æ—¶<font color=\"red\">ä½¿ç”¨å½“å‰ ThreadLocal å®ä¾‹ä½œä¸º keyï¼ˆå¹¶ä¸æ˜¯ä»¥å½“å‰çº¿ç¨‹å¯¹è±¡ä½œä¸º keyï¼‰</font>ï¼Œå­˜å…¥å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­çš„ Map ä¸­å»ã€‚æœ€å¼€å§‹åœ¨çœ‹æºç ä¹‹å‰ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä»¥å½“å‰çº¿ç¨‹å¯¹è±¡ä½œä¸º key å°†å¯¹è±¡å­˜å…¥åˆ° ThreadLocal ä¸­çš„ Map ä¸­å»....</p>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "java"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/10/95416e47530f/",
            "url": "https://shaogezhu.cn/2021/10/95416e47530f/",
            "title": "å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»",
            "date_published": "2021-10-19T15:30:09.000Z",
            "content_html": "<h2 id=\"å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»\"><a class=\"anchor\" href=\"#å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»\">#</a> å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„éœ²çš„åŒºåˆ«ä¸è”ç³»</h2>\n<blockquote>\n<p><strong>å†…å­˜æº¢å‡ºï¼š</strong>ï¼ˆout of memoryï¼‰ï¼Œç®€å•è¯´å°±æ˜¯å†…å­˜ä¸å¤Ÿåˆ†äº†ï¼ŒæŒ‡ç¨‹åºè¦æ±‚çš„å†…å­˜è¶…å‡ºäº†ç³»ç»Ÿæ‰€èƒ½åˆ†é…çš„èŒƒå›´ï¼Œå‡ºç° OOMï¼›æ¯”å¦‚ç”³è¯·ä¸€ä¸ª int ç±»å‹ï¼Œä½†ç»™äº†å®ƒä¸€ä¸ª int æ‰èƒ½å­˜æ”¾çš„æ•°ï¼Œå°±ä¼šå‡ºç°å†…å­˜æº¢å‡ºï¼Œæˆ–è€…æ˜¯åˆ›å»ºä¸€ä¸ªå¤§çš„å¯¹è±¡ï¼Œè€Œå †å†…å­˜æ”¾ä¸ä¸‹è¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯å†…å­˜æº¢å‡ºã€‚</p>\n<p><strong>å†…å­˜æ³„æ¼ï¼š</strong>ï¼ˆMemory Leakï¼‰ï¼Œæ˜¯æŒ‡ç¨‹åºåœ¨ç”³è¯·å†…å­˜åï¼Œæ— æ³•é‡Šæ”¾å·²ç”³è¯·çš„å†…å­˜ç©ºé—´ <strong>(æŒ‡åˆ†é…å‡ºå»çš„å†…å­˜æ— æ³•è¢« gc å›æ”¶)</strong>ã€‚ä¸€æ¬¡å†…å­˜æ³„éœ²å±å®³å¯ä»¥å¿½ç•¥ï¼Œä½†å†…å­˜æ³„éœ²å †ç§¯åæœå¾ˆä¸¥é‡ï¼Œæ— è®ºå¤šå°‘å†…å­˜ï¼Œè¿Ÿæ—©ä¼šè¢«å å…‰ã€‚</p>\n</blockquote>\n<p>å› æ­¤ï¼Œä»ä¸Šé¢ä¹Ÿå¯ä»¥æ¨æ–­å‡ºå†…å­˜æ³„éœ²å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p>\n<p>äºŒè€…çš„å…³ç³»ï¼šğŸ¥‚<br />\nå†…å­˜æº¢å‡ºä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå†…å­˜æ³„éœ²ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¤§å¤šæ•°æ—¶å€™ç¨‹åºçœ‹èµ·æ¥æ˜¯æ­£å¸¸è¿è¡Œçš„ã€‚</p>\n<h3 id=\"å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ\"><a class=\"anchor\" href=\"#å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ\">#</a> å†…å­˜æº¢å‡ºæˆ–æ³„éœ²åŸå› åˆ†æ</h3>\n<p><strong>åˆ†æå †å†…å­˜æº¢å‡ºçš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼šğŸŒ´</strong></p>\n<ol>\n<li>ä½¿ç”¨äº†å¤§é‡çš„é€’å½’æˆ–æ— é™é€’å½’ï¼ˆé€’å½’ä¸­ç”¨åˆ°äº†å¤§é‡çš„æ–°å»ºçš„å¯¹è±¡ï¼‰</li>\n<li>ä½¿ç”¨äº†å¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯ï¼ˆå¾ªç¯ä¸­ç”¨åˆ°äº†å¤§é‡çš„æ–°å»ºçš„å¯¹è±¡ï¼‰</li>\n<li>ç±»ä¸­å’Œå¼•ç”¨å˜é‡è¿‡å¤šä½¿ç”¨äº† Static ä¿®é¥° å¦‚ public staitc Student sï¼›åœ¨ç±»ä¸­çš„å±æ€§ä¸­ä½¿ç”¨ static ä¿®é¥°çš„æœ€å¥½åªç”¨åŸºæœ¬ç±»å‹æˆ–å­—ç¬¦ä¸²ã€‚å¦‚ public static int i = 0; //public static String str;</li>\n<li>æ•°ç»„ï¼ŒListï¼ŒMap ä¸­å­˜æ”¾çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨è€Œä¸æ˜¯å¯¹è±¡ï¼Œå› ä¸ºè¿™äº›å¼•ç”¨ä¼šè®©å¯¹åº”çš„å¯¹è±¡ä¸èƒ½è¢«é‡Šæ”¾ï¼Œä¼šå¤§é‡å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚</li>\n</ol>\n<p><strong>åˆ†ææ ˆå†…å­˜æº¢å‡ºçš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼šğŸŒ´</strong></p>\n<ol>\n<li>ä½¿ç”¨äº†å¤§é‡çš„é€’å½’æˆ–æ— é™é€’å½’</li>\n<li>ä½¿ç”¨äº†å¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯ï¼ˆå¦‚å¾ªç¯ä¸­ä¸åœè°ƒç”¨æ–¹æ³•ï¼‰</li>\n<li>listï¼Œmapï¼Œæ•°ç»„ç­‰é•¿åº¦è¿‡å¤§ç­‰ã€‚</li>\n</ol>\n<h3 id=\"å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ\"><a class=\"anchor\" href=\"#å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ\">#</a> å‡ºç°å†…å­˜æº¢å‡ºæˆ–å†…å­˜æ³„éœ²çš„è§£å†³æ–¹æ¡ˆ</h3>\n<ol>\n<li>ä¿®æ”¹ JVM å¯åŠ¨å‚æ•° (-Xmsï¼Œ-Xmx)ï¼Œç›´æ¥å¢åŠ è™šæ‹Ÿæœºå†…å­˜ã€‚</li>\n<li>æ£€æŸ¥é”™è¯¯æ—¥å¿—ã€‚</li>\n<li>ä½¿ç”¨å†…å­˜æŸ¥çœ‹å·¥å…·æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ (å¦‚ jconsole)</li>\n<li>å¯¹ä»£ç è¿›è¡Œä»”ç»†åˆ†æï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿå†…å­˜æº¢å‡ºçš„ä½ç½®ã€‚</li>\n</ol>\n<p><strong>è¯¦ç»†æ’æŸ¥æ–¹æ¡ˆå¦‚ä¸‹:ğŸˆ</strong></p>\n<ul>\n<li>æ£€æŸ¥åœ¨æ•°æ®åº“ä¸­å–çš„æ•°æ®é‡æ˜¯å¦è¶…è¿‡å†…å­˜</li>\n<li>æ£€æŸ¥æ˜¯å¦æœ‰è¿‡å¤§çš„é›†åˆæˆ–å¯¹è±¡</li>\n<li>æ£€æŸ¥æ˜¯æ­»å¾ªç¯æˆ–é€’å½’æ˜¯å¦ä¼šå¯¼è‡´æº¢å‡º</li>\n<li>æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡å¯¹è±¡çš„åˆ›å»ºæ˜¯å¦ä¼šå‡ºç°å†…å­˜é—®é¢˜</li>\n<li>æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡çš„è¿æ¥å¯¹è±¡æˆ–ç›‘å¬å™¨ç­‰æœªå…³é—­<br />\n......</li>\n</ul>\n<h3 id=\"åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²\"><a class=\"anchor\" href=\"#åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²\">#</a> åœ¨å¼€å‘ä¸­åº”å¦‚ä½•é¿å…å‡ºç°å†…å­˜æ³„éœ²</h3>\n<ol>\n<li>å°½é‡å°‘ä½¿ç”¨æšä¸¾</li>\n<li>å°½é‡ä½¿ç”¨é™æ€å†…éƒ¨ç±»è€Œä¸æ˜¯å†…éƒ¨ç±»</li>\n<li>å°½é‡ä½¿ç”¨è½»é‡çº§çš„æ•°æ®ç»“æ„</li>\n<li>å…»æˆå…³é—­è¿æ¥å’Œæ³¨é”€ç›‘å¬å™¨çš„ä¹ æƒ¯</li>\n<li>è°¨æ…ä½¿ç”¨ static å…³é”®å­—</li>\n<li>è°¨æ…ä½¿ç”¨å•ä¾‹æ¨¡å¼</li>\n</ol>\n<p>ğŸš€ğŸš€ğŸš€<br />\n<br></p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "java"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/10/4eb7eccc7c2a/",
            "url": "https://shaogezhu.cn/2021/10/4eb7eccc7c2a/",
            "title": "Redis å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ",
            "date_published": "2021-10-11T13:45:48.000Z",
            "content_html": "<div class=\"note primary\">\n<p>Redis æ˜¯é¢è¯•ä¸­çš„æœ€ç»å¸¸é—®åˆ°çš„æ•°æ®åº“ä¹‹ä¸€ï¼Œåœ¨æ—¥å¸¸é¡¹ç›®ä¸­æˆ‘ä»¬ä¸ºäº†å¿«é€Ÿè®¿é—®åˆ°ä¸€äº›æ•°æ®ï¼Œé¦–å…ˆæƒ³åˆ°çš„è‚¯å®šå°±æ˜¯ Redis äº†ã€‚ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹ Redis çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä»¥åä½¿ç”¨ğŸ‘©</p>\n</div>\n<h2 id=\"redis-å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ\"><a class=\"anchor\" href=\"#redis-å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ\">#</a> Redis å¸¸è§æ•°æ®ç»“æ„ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†æ</h2>\n<p><strong>redis æ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œä¸åŒçš„åœºæ™¯ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹å¯ä»¥æœ‰æ•ˆçš„ä¼˜åŒ–å†…å­˜æ•°æ®çš„å­˜æ”¾ç©ºé—´ï¼šğŸŒ´ğŸŒ´</strong></p>\n<blockquote>\n<ol>\n<li><strong>stringï¼š</strong> æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼ŒäºŒè¿›åˆ¶å®‰å…¨çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§ 512Mã€‚</li>\n<li><strong>listï¼š</strong> æŒ‰ç…§æ·»åŠ é¡ºåºä¿æŒé¡ºåºçš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚</li>\n<li><strong>hashï¼š</strong> key-value å¯¹çš„ä¸€ç§é›†åˆã€‚</li>\n<li><strong>setï¼š</strong> æ— åºçš„å­—ç¬¦ä¸²é›†åˆï¼Œä¸å­˜åœ¨é‡å¤çš„å…ƒç´ ã€‚</li>\n<li><strong>sorted setï¼š</strong> å·²æ’åºçš„å­—ç¬¦ä¸²é›†åˆã€‚</li>\n<li><strong>bitmapï¼š</strong> æ›´ç»†åŒ–çš„ä¸€ç§æ“ä½œï¼Œä»¥ bit ä¸ºå•ä½ã€‚</li>\n<li><strong>hyperloglogï¼š</strong> åŸºäºæ¦‚ç‡çš„æ•°æ®ç»“æ„ã€‚ # 2.8.9 æ–°å¢</li>\n<li><strong>Geo:</strong>  åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œ å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œ   # 3.2 æ–°å¢</li>\n<li><strong>æµï¼ˆStreamï¼‰</strong> # 5.0 æ–°å¢</li>\n</ol>\n</blockquote>\n<br>\n<h4 id=\"string\"><a class=\"anchor\" href=\"#string\">#</a> String</h4>\n<ol>\n<li><strong>ä»‹ç» ï¼š</strong> string æ•°æ®ç»“æ„æ˜¯ç®€å•çš„ key-value ç±»å‹ã€‚è™½ç„¶ Redis æ˜¯ç”¨ C è¯­è¨€å†™çš„ï¼Œä½†æ˜¯ Redis å¹¶æ²¡æœ‰ä½¿ç”¨ C çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè€Œæ˜¯è‡ªå·±æ„å»ºäº†ä¸€ç§ <strong><span class=\"blue\">ç®€å•åŠ¨æ€å­—ç¬¦ä¸²</span></strong> (simple dynamic stringï¼Œ<strong>SDS</strong>)ã€‚ç›¸æ¯”äº C çš„åŸç”Ÿå­—ç¬¦ä¸²ï¼ŒRedis çš„ SDS ä¸å…‰å¯ä»¥ä¿å­˜æ–‡æœ¬æ•°æ®è¿˜å¯ä»¥ä¿å­˜äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶ä¸”è·å–å­—ç¬¦ä¸²é•¿åº¦å¤æ‚åº¦ä¸º O (1)ï¼ˆC å­—ç¬¦ä¸²ä¸º O (N)ï¼‰, é™¤æ­¤ä¹‹å¤–ï¼ŒRedis çš„ SDS API æ˜¯å®‰å…¨çš„ï¼Œä¸ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong> set,get,strlen,exists,decr,incr,setex ç­‰ç­‰ã€‚</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong> ä¸€èˆ¬å¸¸ç”¨åœ¨éœ€è¦è®¡æ•°çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„è®¿é—®æ¬¡æ•°ã€çƒ­ç‚¹æ–‡ç« çš„ç‚¹èµè½¬å‘æ•°é‡ç­‰ç­‰ã€‚</li>\n</ol>\n<p>ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ˜<br />\n<strong>æ™®é€šå­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> key value <span class=\"token comment\">#è®¾ç½® key-value ç±»å‹çš„å€¼</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get key <span class=\"token comment\"># æ ¹æ® key è·å¾—å¯¹åº”çš„ value</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string\">\"value\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> exists key  <span class=\"token comment\"># åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> strlen key <span class=\"token comment\"># è¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> del key <span class=\"token comment\"># åˆ é™¤æŸä¸ª key å¯¹åº”çš„å€¼</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get key</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span>nil<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><strong>æ‰¹é‡è®¾ç½® :</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mset key1 value1 key2 value2 <span class=\"token comment\"># æ‰¹é‡è®¾ç½® key-value ç±»å‹çš„å€¼</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> mget key1 key2 <span class=\"token comment\"># æ‰¹é‡è·å–å¤šä¸ª key å¯¹åº”çš„ value</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr></table></figure><p><strong>è®¡æ•°å™¨ï¼ˆå­—ç¬¦ä¸²çš„å†…å®¹ä¸ºæ•´æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ï¼‰ï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> <span class=\"token builtin class-name\">set</span> number <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> incr number <span class=\"token comment\"># å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get number</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"2\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> decr number <span class=\"token comment\"># å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> get number</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token string\">\"1\"</span></pre></td></tr></table></figure><p><strong>è¿‡æœŸï¼ˆé»˜è®¤ä¸ºæ°¸ä¸è¿‡æœŸï¼‰ï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> expire key  <span class=\"token number\">60</span> <span class=\"token comment\"># æ•°æ®åœ¨ 60s åè¿‡æœŸ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setex key <span class=\"token number\">60</span> value <span class=\"token comment\"># æ•°æ®åœ¨ 60s åè¿‡æœŸ (setex:[set] + [ex] pire)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> ttl key <span class=\"token comment\"># æŸ¥çœ‹æ•°æ®è¿˜æœ‰å¤šä¹…è¿‡æœŸ</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">56</span></pre></td></tr></table></figure><br>\n<h4 id=\"list\"><a class=\"anchor\" href=\"#list\">#</a> List</h4>\n<ol>\n<li><strong>ä»‹ç» ï¼š</strong> list å³æ˜¯ <strong>é“¾è¡¨</strong>ã€‚é“¾è¡¨æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œç‰¹ç‚¹æ˜¯æ˜“äºæ•°æ®å…ƒç´ çš„æ’å…¥å’Œåˆ é™¤å¹¶ä¸”å¯ä»¥çµæ´»è°ƒæ•´é“¾è¡¨é•¿åº¦ï¼Œä½†æ˜¯é“¾è¡¨çš„éšæœºè®¿é—®å›°éš¾ã€‚è®¸å¤šé«˜çº§ç¼–ç¨‹è¯­è¨€éƒ½å†…ç½®äº†é“¾è¡¨çš„å®ç°æ¯”å¦‚ Java ä¸­çš„ LinkedListï¼Œä½†æ˜¯ C è¯­è¨€å¹¶æ²¡æœ‰å®ç°é“¾è¡¨ï¼Œæ‰€ä»¥ Redis å®ç°äº†è‡ªå·±çš„é“¾è¡¨æ•°æ®ç»“æ„ã€‚Redis çš„ list çš„å®ç°ä¸ºä¸€ä¸ª <strong><span class=\"orange\">åŒå‘é“¾è¡¨</span></strong>ï¼Œå³å¯ä»¥æ”¯æŒåå‘æŸ¥æ‰¾å’Œéå†ï¼Œæ›´æ–¹ä¾¿æ“ä½œï¼Œä¸è¿‡å¸¦æ¥äº†éƒ¨åˆ†é¢å¤–çš„å†…å­˜å¼€é”€ã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤:</strong> rpush,lpop,lpush,rpop,lrange,llen ç­‰ã€‚</li>\n<li><strong>åº”ç”¨åœºæ™¯:</strong> å‘å¸ƒä¸è®¢é˜…æˆ–è€…è¯´æ¶ˆæ¯é˜Ÿåˆ—ã€æ…¢æŸ¥è¯¢ã€‚</li>\n</ol>\n<p>ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ¬</p>\n<p><strong>é€šè¿‡ rpush/lpop å®ç°é˜Ÿåˆ—ï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpush myList value1 <span class=\"token comment\"># å‘ list çš„å¤´éƒ¨ï¼ˆå³è¾¹ï¼‰æ·»åŠ å…ƒç´ </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpush myList value2 value3 <span class=\"token comment\"># å‘ list çš„å¤´éƒ¨ï¼ˆæœ€å³è¾¹ï¼‰æ·»åŠ å¤šä¸ªå…ƒç´ </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lpop myList <span class=\"token comment\"># å°† list çš„å°¾éƒ¨ (æœ€å·¦è¾¹) å…ƒç´ å–å‡º</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myList <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡çš„ list åˆ—è¡¨ï¼Œ 0 ä¸º start,1 ä¸º end</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myList <span class=\"token number\">0</span> -1 <span class=\"token comment\"># æŸ¥çœ‹åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œ-1 è¡¨ç¤ºå€’æ•°ç¬¬ä¸€</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr></table></figure><p><strong>é€šè¿‡ rpush/rpop å®ç°æ ˆï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpush myList2 value1 value2 value3</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpop myList2 <span class=\"token comment\"># å°† list çš„å¤´éƒ¨ (æœ€å³è¾¹) å…ƒç´ å–å‡º</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string\">\"value3\"</span></pre></td></tr></table></figure><p>ä¸‹è¾¹å›¾æ–¹ä¾¿å¤§å®¶ç†è§£ï¼š<br />\n<img data-src=\"/assets/2021-10/r1.png\" alt=\"image.png\" /></p>\n<p><strong>é€šè¿‡ lrange æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡èŒƒå›´çš„åˆ—è¡¨å…ƒç´ ï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> rpush myList value1 value2 value3</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myList <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡çš„ list åˆ—è¡¨ï¼Œ 0 ä¸º start,1 ä¸º end</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> lrange myList <span class=\"token number\">0</span> -1 <span class=\"token comment\"># æŸ¥çœ‹åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œ-1 è¡¨ç¤ºå€’æ•°ç¬¬ä¸€</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr></table></figure><p>é€šè¿‡ lrange å‘½ä»¤ï¼Œä½ å¯ä»¥åŸºäº list å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œæ€§èƒ½éå¸¸é«˜ï¼<br />\n<strong>é€šè¿‡ llen æŸ¥çœ‹é“¾è¡¨é•¿åº¦ï¼š</strong></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> llen myList</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><br>\n<h4 id=\"hash\"><a class=\"anchor\" href=\"#hash\">#</a> Hash</h4>\n<ol>\n<li><strong>ä»‹ç» ï¼š</strong> hash ç±»ä¼¼äº JDK1.8 å‰çš„ HashMapï¼Œå†…éƒ¨å®ç°ä¹Ÿå·®ä¸å¤š (æ•°ç»„ + é“¾è¡¨)ã€‚ä¸è¿‡ï¼ŒRedis çš„ hash åšäº†æ›´å¤šä¼˜åŒ–ã€‚å¦å¤–ï¼Œhash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œ<strong><span class=\"pink\">ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡</span></strong>ï¼Œåç»­æ“ä½œçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥ä»…ä»…ä¿®æ”¹è¿™ä¸ªå¯¹è±¡ä¸­çš„æŸä¸ªå­—æ®µçš„å€¼ã€‚ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ hash æ•°æ®ç»“æ„æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œå•†å“ä¿¡æ¯ç­‰ç­‰ã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong> hset,hmset,hexists,hget,hgetall,hkeys,hvals ç­‰ã€‚</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong>  ç³»ç»Ÿä¸­å¯¹è±¡æ•°æ®çš„å­˜å‚¨ã€‚</li>\n</ol>\n<p>ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸˆ</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hmset userInfoKey name <span class=\"token string\">\"guide\"</span> description <span class=\"token string\">\"dev\"</span> age <span class=\"token string\">\"24\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OK</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hexists userInfoKey name <span class=\"token comment\"># æŸ¥çœ‹ key å¯¹åº”çš„ value ä¸­æŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hget userInfoKey name <span class=\"token comment\"># è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"guide\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hget userInfoKey age</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token string\">\"24\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hgetall userInfoKey <span class=\"token comment\"># è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š key çš„æ‰€æœ‰å­—æ®µå’Œå€¼</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"name\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"guide\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"description\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"dev\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"age\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"24\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hkeys userInfoKey <span class=\"token comment\"># è·å– key åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"name\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"description\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"age\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hvals userInfoKey <span class=\"token comment\"># è·å– value åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"guide\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"dev\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"24\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hset userInfoKey name <span class=\"token string\">\"GuideGeGe\"</span> <span class=\"token comment\"># ä¿®æ”¹æŸä¸ªå­—æ®µå¯¹åº”çš„å€¼</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> hget userInfoKey name</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token string\">\"GuideGeGe\"</span></pre></td></tr></table></figure><br>\n<h4 id=\"set\"><a class=\"anchor\" href=\"#set\">#</a> Set</h4>\n<ol>\n<li><strong>ä»‹ç» ï¼š</strong> set ç±»ä¼¼äº Java ä¸­çš„ HashSet ã€‚Redis ä¸­çš„ set ç±»å‹æ˜¯ä¸€ç§æ— åºé›†åˆï¼Œé›†åˆä¸­çš„å…ƒç´ æ²¡æœ‰å…ˆåé¡ºåºã€‚å½“ä½ éœ€è¦å­˜å‚¨ä¸€ä¸ªåˆ—è¡¨æ•°æ®ï¼Œåˆä¸å¸Œæœ›å‡ºç°é‡å¤æ•°æ®æ—¶ï¼Œset æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå¹¶ä¸” set æä¾›äº†åˆ¤æ–­æŸä¸ªæˆå‘˜æ˜¯å¦åœ¨ä¸€ä¸ª set é›†åˆå†…çš„é‡è¦æ¥å£ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ list æ‰€ä¸èƒ½æä¾›çš„ã€‚å¯ä»¥åŸºäº set è½»æ˜“å®ç°äº¤é›†ã€å¹¶é›†ã€å·®é›†çš„æ“ä½œã€‚æ¯”å¦‚ï¼šä½ å¯ä»¥å°†ä¸€ä¸ªç”¨æˆ·æ‰€æœ‰çš„å…³æ³¨äººå­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œå°†å…¶æ‰€æœ‰ç²‰ä¸å­˜åœ¨ä¸€ä¸ªé›†åˆã€‚Redis å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®ç°å¦‚å…±åŒå…³æ³¨ã€å…±åŒç²‰ä¸ã€å…±åŒå–œå¥½ç­‰åŠŸèƒ½ã€‚è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå°±æ˜¯æ±‚äº¤é›†çš„è¿‡ç¨‹ã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong> sadd,spop,smembers,sismember,scard,sinterstore,sunion ç­‰ã€‚</li>\n<li><strong>åº”ç”¨åœºæ™¯:</strong> éœ€è¦å­˜æ”¾çš„æ•°æ®ä¸èƒ½é‡å¤ä»¥åŠéœ€è¦è·å–å¤šä¸ªæ•°æ®æºäº¤é›†å’Œå¹¶é›†ç­‰åœºæ™¯</li>\n</ol>\n<p>ä¸‹é¢æˆ‘ä»¬ç®€å•çœ‹çœ‹å®ƒçš„ä½¿ç”¨ï¼ğŸ™‡</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd mySet value1 value2 <span class=\"token comment\"># æ·»åŠ å…ƒç´ è¿›å»</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd mySet value1 <span class=\"token comment\"># ä¸å…è®¸æœ‰é‡å¤å…ƒç´ </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smembers mySet <span class=\"token comment\"># æŸ¥çœ‹ set ä¸­æ‰€æœ‰çš„å…ƒç´ </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> scard mySet <span class=\"token comment\"># æŸ¥çœ‹ set çš„é•¿åº¦</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sismember mySet value1 <span class=\"token comment\"># æ£€æŸ¥æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ set ä¸­ï¼Œåªèƒ½æ¥æ”¶å•ä¸ªå…ƒç´ </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sadd mySet2 value2 value3</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> sinterstore mySet3 mySet mySet2 <span class=\"token comment\"># è·å– mySet å’Œ mySet2 çš„äº¤é›†å¹¶å­˜æ”¾åœ¨ mySet3 ä¸­</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> smembers mySet3</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr></table></figure><br>\n<h4 id=\"sorted-set\"><a class=\"anchor\" href=\"#sorted-set\">#</a> Sorted set</h4>\n<ol>\n<li><strong>ä»‹ç»ï¼š</strong> å’Œ set ç›¸æ¯”ï¼Œsorted set å¢åŠ äº†ä¸€ä¸ªæƒé‡å‚æ•° scoreï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰ score è¿›è¡Œæœ‰åºæ’åˆ—ï¼Œè¿˜å¯ä»¥é€šè¿‡ score çš„èŒƒå›´æ¥è·å–å…ƒç´ çš„åˆ—è¡¨ã€‚æœ‰ç‚¹åƒæ˜¯ Java ä¸­ HashMap å’Œ TreeSet çš„ç»“åˆä½“ã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong> zadd,zcard,zscore,zrange,zrevrange,zrem ç­‰ã€‚</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong> éœ€è¦å¯¹æ•°æ®æ ¹æ®æŸä¸ªæƒé‡è¿›è¡Œæ’åºçš„åœºæ™¯ã€‚æ¯”å¦‚åœ¨ç›´æ’­ç³»ç»Ÿä¸­ï¼Œå®æ—¶æ’è¡Œä¿¡æ¯åŒ…å«ç›´æ’­é—´åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼Œå„ç§ç¤¼ç‰©æ’è¡Œæ¦œï¼Œå¼¹å¹•æ¶ˆæ¯ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‰æ¶ˆæ¯ç»´åº¦çš„æ¶ˆæ¯æ’è¡Œæ¦œï¼‰ç­‰ä¿¡æ¯ã€‚</li>\n</ol>\n<p>å¸¸ç”¨å‘½ä»¤å±•ç¤ºï¼šğŸ‹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd myZset <span class=\"token number\">3.0</span> value1 <span class=\"token comment\"># æ·»åŠ å…ƒç´ åˆ° sorted set ä¸­ 3.0 ä¸ºæƒé‡</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zadd myZset <span class=\"token number\">2.0</span> value2 <span class=\"token number\">1.0</span> value3 <span class=\"token comment\"># ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zcard myZset <span class=\"token comment\"># æŸ¥çœ‹ sorted set ä¸­çš„å…ƒç´ æ•°é‡</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zscore myZset value1 <span class=\"token comment\"># æŸ¥çœ‹æŸä¸ª value çš„æƒé‡</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token string\">\"3\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange  myZset <span class=\"token number\">0</span> -1 <span class=\"token comment\"># é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 -1 è¡¨ç¤ºè¾“å‡ºæ‰€æœ‰å…ƒç´ </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrange  myZset <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start  1 ä¸º stop</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> zrevrange  myZset <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token comment\"># é€†åºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start  1 ä¸º stop</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr></table></figure><br>\n<h4 id=\"bitmap-ä½å›¾\"><a class=\"anchor\" href=\"#bitmap-ä½å›¾\">#</a> Bitmap ä½å›¾</h4>\n<ol>\n<li><strong>ä»‹ç»ï¼š</strong>  bitmap å­˜å‚¨çš„æ˜¯è¿ç»­çš„äºŒè¿›åˆ¶æ•°å­—ï¼ˆ0 å’Œ 1ï¼‰ï¼Œé€šè¿‡ bitmap, åªéœ€è¦ä¸€ä¸ª bit ä½æ¥è¡¨ç¤ºæŸä¸ªå…ƒç´ å¯¹åº”çš„å€¼æˆ–è€…çŠ¶æ€ï¼Œkey å°±æ˜¯å¯¹åº”å…ƒç´ æœ¬èº« ã€‚æˆ‘ä»¬çŸ¥é“ 8 ä¸ª bit å¯ä»¥ç»„æˆä¸€ä¸ª byteï¼Œæ‰€ä»¥ bitmap æœ¬èº«ä¼šæå¤§çš„èŠ‚çœå‚¨å­˜ç©ºé—´ã€‚</li>\n<li><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong>  setbit ã€getbit ã€bitcountã€bitop</li>\n<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong>  é€‚åˆéœ€è¦ä¿å­˜çŠ¶æ€ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯å¦ç­¾åˆ°ã€æ˜¯å¦ç™»å½•...ï¼‰å¹¶éœ€è¦è¿›ä¸€æ­¥å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œåˆ†æçš„åœºæ™¯ã€‚æ¯”å¦‚ç”¨æˆ·ç­¾åˆ°æƒ…å†µã€æ´»è·ƒç”¨æˆ·æƒ…å†µã€ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ï¼ˆæ¯”å¦‚æ˜¯å¦ç‚¹èµè¿‡æŸä¸ªè§†é¢‘ï¼‰ã€‚</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># SETBIT ä¼šè¿”å›ä¹‹å‰ä½çš„å€¼ï¼ˆé»˜è®¤æ˜¯ 0ï¼‰è¿™é‡Œä¼šç”Ÿæˆ 7 ä¸ªä½</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit mykey <span class=\"token number\">7</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit mykey <span class=\"token number\">7</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> getbit mykey <span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit mykey <span class=\"token number\">6</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit mykey <span class=\"token number\">8</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># é€šè¿‡ bitcount ç»Ÿè®¡è¢«è¢«è®¾ç½®ä¸º 1 çš„ä½çš„æ•°é‡ã€‚</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitcount mykey</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><p>é’ˆå¯¹ä¸Šé¢æåˆ°çš„ä¸€äº›åœºæ™¯ï¼Œè¿™é‡Œè¿›è¡Œè¿›ä¸€æ­¥è¯´æ˜ã€‚</p>\n<p><strong>ä½¿ç”¨åœºæ™¯ä¸€ğŸ“ï¼šç”¨æˆ·è¡Œä¸ºåˆ†æ</strong> å¾ˆå¤šç½‘ç«™ä¸ºäº†åˆ†æä½ çš„å–œå¥½ï¼Œéœ€è¦ç ”ç©¶ä½ ç‚¹èµè¿‡çš„å†…å®¹ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># è®°å½•ä½ å–œæ¬¢è¿‡ 001 å·å°å§å§</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit beauty_girl_001 uid <span class=\"token number\">1</span></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åœºæ™¯äºŒğŸ“ï¼šç»Ÿè®¡æ´»è·ƒç”¨æˆ·</strong></p>\n<p>ä½¿ç”¨æ—¶é—´ä½œä¸º keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœå½“æ—¥æ´»è·ƒè¿‡å°±è®¾ç½®ä¸º 1</p>\n<p>é‚£ä¹ˆæˆ‘è¯¥å¦‚ä½•è®¡ç®—æŸå‡ å¤© / æœˆ / å¹´çš„æ´»è·ƒç”¨æˆ·å‘¢ (æš‚ä¸”çº¦å®šï¼Œç»Ÿè®¡æ—¶é—´å†…åªè¦æœ‰ä¸€å¤©åœ¨çº¿å°±ç§°ä¸ºæ´»è·ƒ)ï¼Œæœ‰è¯·ä¸‹ä¸€ä¸ª redis çš„å‘½ä»¤</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªä¿å­˜äºŒè¿›åˆ¶ä½çš„å­—ç¬¦ä¸² key è¿›è¡Œä½å…ƒæ“ä½œï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ° destkey ä¸Šã€‚</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># BITOP å‘½ä»¤æ”¯æŒ AND ã€ OR ã€ NOT ã€ XOR è¿™å››ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§å‚æ•°</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>BITOP operation destkey key <span class=\"token punctuation\">[</span>key <span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>åˆå§‹åŒ–æ•°æ®ï¼š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit <span class=\"token number\">20210308</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit <span class=\"token number\">20210308</span> <span class=\"token number\">2</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> setbit <span class=\"token number\">20210309</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><p>ç»Ÿè®¡ 20210308~20210309 æ€»æ´»è·ƒç”¨æˆ·æ•°: 1</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitop and desk1 <span class=\"token number\">20210308</span> <span class=\"token number\">20210309</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitcount desk1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>ç»Ÿè®¡ 20210308~20210309 åœ¨çº¿æ´»è·ƒç”¨æˆ·æ•°: 2</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitop or desk2 <span class=\"token number\">20210308</span> <span class=\"token number\">20210309</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> bitcount desk2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åœºæ™¯ä¸‰ğŸ“ï¼šç”¨æˆ·åœ¨çº¿çŠ¶æ€</strong></p>\n<p>å¯¹äºè·å–æˆ–è€…ç»Ÿè®¡ç”¨æˆ·åœ¨çº¿çŠ¶æ€ï¼Œä½¿ç”¨ bitmap æ˜¯ä¸€ä¸ªèŠ‚çº¦ç©ºé—´ä¸”æ•ˆç‡åˆé«˜çš„ä¸€ç§æ–¹æ³•ã€‚</p>\n<p>åªéœ€è¦ä¸€ä¸ª keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœåœ¨çº¿å°±è®¾ç½®ä¸º 1ï¼Œä¸åœ¨çº¿å°±è®¾ç½®ä¸º 0ã€‚</p>\n<br>\n<h4 id=\"hyperloglog-åŸºæ•°ç»Ÿè®¡\"><a class=\"anchor\" href=\"#hyperloglog-åŸºæ•°ç»Ÿè®¡\">#</a> HyperLogLog åŸºæ•°ç»Ÿè®¡</h4>\n<p><strong>Redis çš„åŸºæ•°ç»Ÿè®¡</strong>ï¼Œè¿™ä¸ªç»“æ„å¯ä»¥éå¸¸çœå†…å­˜çš„å»ç»Ÿè®¡å„ç§è®¡æ•°ï¼Œæ¯”å¦‚æ³¨å†Œ IP æ•°ã€æ¯æ—¥è®¿é—® IP æ•°ã€é¡µé¢å®æ—¶ UVï¼‰ã€åœ¨çº¿ç”¨æˆ·æ•°ç­‰ã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰å±€é™æ€§ï¼Œå°±æ˜¯åªèƒ½ç»Ÿè®¡æ•°é‡ï¼Œè€Œæ²¡åŠæ³•å»çŸ¥é“å…·ä½“çš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚</p>\n<blockquote>\n<p>å½“ç„¶ç”¨é›†åˆä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯ä¸€ä¸ªå¤§å‹çš„ç½‘ç«™ï¼Œæ¯å¤© IP æ¯”å¦‚æœ‰ 100 ä¸‡ï¼Œç²—ç®—ä¸€ä¸ª IP æ¶ˆè€— 15 å­—èŠ‚ï¼Œé‚£ä¹ˆ 100 ä¸‡ä¸ª IP å°±æ˜¯ 15Mã€‚è€Œ HyperLogLog åœ¨ Redis ä¸­æ¯ä¸ªé”®å ç”¨çš„å†…å®¹éƒ½æ˜¯ 12Kï¼Œç†è®ºå­˜å‚¨è¿‘ä¼¼æ¥è¿‘ 2^64 ä¸ªå€¼ï¼Œä¸ç®¡å­˜å‚¨çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå®ƒä¸€ä¸ªåŸºäºåŸºæ•°ä¼°ç®—çš„ç®—æ³•ï¼Œåªèƒ½æ¯”è¾ƒå‡†ç¡®çš„ä¼°ç®—å‡ºåŸºæ•°ï¼Œå¯ä»¥ä½¿ç”¨å°‘é‡å›ºå®šçš„å†…å­˜å»å­˜å‚¨å¹¶è¯†åˆ«é›†åˆä¸­çš„å”¯ä¸€å…ƒç´ ã€‚è€Œä¸”è¿™ä¸ªä¼°ç®—çš„åŸºæ•°å¹¶ä¸ä¸€å®šå‡†ç¡®ï¼Œæ˜¯ä¸€ä¸ªå¸¦æœ‰ 0.81% æ ‡å‡†é”™è¯¯çš„è¿‘ä¼¼å€¼ã€‚</p>\n</blockquote>\n<p><strong>åº”ç”¨åœºæ™¯:âœ¨</strong><br />\nHyperLogLog ä¸»è¦çš„åº”ç”¨åœºæ™¯å°±æ˜¯è¿›è¡ŒåŸºæ•°ç»Ÿè®¡ã€‚è¿™ä¸ªé—®é¢˜çš„åº”ç”¨åœºæ™¯å…¶å®æ˜¯ååˆ†å¹¿æ³›çš„ã€‚ä¾‹å¦‚ï¼šå¯¹äº Google ä¸»é¡µé¢è€Œè¨€ï¼ŒåŒä¸€ä¸ªè´¦æˆ·å¯èƒ½ä¼šè®¿é—® Google ä¸»é¡µé¢å¤šæ¬¡ã€‚äºæ˜¯ï¼Œåœ¨è¯¸å¤šçš„è®¿é—®æµæ°´ä¸­ï¼Œå¦‚ä½•è®¡ç®—å‡º Google ä¸»é¡µé¢æ¯å¤©è¢«å¤šå°‘ä¸ªä¸åŒçš„è´¦æˆ·è®¿é—®è¿‡å°±æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚é‚£ä¹ˆå¯¹äº Google è¿™ç§è®¿é—®é‡å·¨å¤§çš„ç½‘é¡µè€Œè¨€ï¼Œå…¶å®ç»Ÿè®¡å‡ºæœ‰åäº¿ çš„è®¿é—®é‡æˆ–è€…åäº¿é›¶åä¸‡çš„è®¿é—®é‡å…¶å®æ˜¯æ²¡æœ‰å¤ªå¤šçš„åŒºåˆ«çš„ï¼Œå› æ­¤ï¼Œåœ¨è¿™ç§ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œä¸ºäº†èŠ‚çœæˆæœ¬ï¼Œå…¶å®å¯ä»¥åªè®¡ç®—å‡ºä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œè€Œæ²¡æœ‰å¿…è¦è®¡ç®—å‡ºç²¾å‡†çš„å€¼ã€‚</p>\n<p>è¿™ä¸ªæ•°æ®ç»“æ„çš„å‘½ä»¤æœ‰ä¸‰ä¸ªï¼šPFADDã€PFCOUNTã€PFMERGE</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>redis<span class=\"token operator\">></span> PFADD databases <span class=\"token string\">\"Redis\"</span> <span class=\"token string\">\"MongoDB\"</span> <span class=\"token string\">\"MySQL\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>redis<span class=\"token operator\">></span> PFADD databases <span class=\"token string\">\"Redis\"</span>  <span class=\"token comment\"># Redis å·²ç»å­˜åœ¨ï¼Œä¸å¿…å¯¹ä¼°è®¡æ•°é‡è¿›è¡Œæ›´æ–°</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>redis<span class=\"token operator\">></span> PFCOUNT databases</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">3</span></pre></td></tr></table></figure><br>\n<h4 id=\"geo-åœ°ç†ä½ç½®\"><a class=\"anchor\" href=\"#geo-åœ°ç†ä½ç½®\">#</a> Geo åœ°ç†ä½ç½®</h4>\n<p>Redis çš„ GEO ç‰¹æ€§åœ¨ Redis 3.2 ç‰ˆæœ¬ä¸­æ¨å‡ºï¼Œ è¿™ä¸ªåŠŸèƒ½å¯ä»¥å°†ç”¨æˆ·ç»™å®šçš„åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œ å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œã€‚GEO çš„æ•°æ®ç»“æ„æ€»å…±æœ‰å…­ä¸ªå‘½ä»¤ï¼šgeoaddã€geoposã€geodistã€georadiusã€georadiusbymemberã€gethash,<strong>GEO ä½¿ç”¨çš„æ˜¯å›½é™…é€šç”¨åæ ‡ç³» WGS-84ã€‚</strong></p>\n<p>å¸¸ç”¨æŒ‡ä»¤ï¼š</p>\n<blockquote>\n<ol>\n<li>GEOADD: æ·»åŠ åœ°ç†ä½ç½®</li>\n<li>GEOPOSï¼šæŸ¥è¯¢åœ°ç†ä½ç½®ï¼ˆç»çº¬åº¦ï¼‰ï¼Œè¿”å›æ•°ç»„</li>\n<li>GEODISTï¼šè®¡ç®—ä¸¤ä½ä½ç½®é—´çš„è·ç¦»</li>\n<li>GEORADIUSï¼šä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ è¿”å›é”®åŒ…å«çš„ä½ç½®å…ƒç´ å½“ä¸­ï¼Œ ä¸ä¸­å¿ƒçš„è·ç¦»ä¸è¶…è¿‡ç»™å®šæœ€å¤§è·ç¦»çš„æ‰€æœ‰ä½ç½®å…ƒç´ ã€‚</li>\n<li>GEORADIUSBYMEMBERï¼šä»¥ç»™å®šçš„åœ°ç†ä½ç½®ä¸ºä¸­å¿ƒï¼Œ è¿”å›é”®åŒ…å«çš„ä½ç½®å…ƒç´ å½“ä¸­ï¼Œ ä¸ä¸­å¿ƒçš„è·ç¦»ä¸è¶…è¿‡ç»™å®šæœ€å¤§è·ç¦»çš„æ‰€æœ‰ä½ç½®å…ƒç´ ã€‚</li>\n</ol>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd kcityGeo <span class=\"token number\">116.405285</span> <span class=\"token number\">39.904989</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geoadd kcityGeo <span class=\"token number\">121.472644</span> <span class=\"token number\">31.231706</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geodist kcityGeo beijing shanghai km</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token string\">\"1067.5980\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geopos kcityGeo beijing</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"116.40528291463851929\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"39.9049884229125027\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> geohash kcityGeo beijing</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"wx4g0b7xrt0\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> georadiusbymember kcityGeo beijing <span class=\"token number\">1200</span> km withdist withcoord asc count <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"beijing\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"0.0000\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"116.40528291463851929\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"39.9049884229125027\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"shanghai\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1067.5980\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"121.47264629602432251\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"31.23170490709807012\"</span></pre></td></tr></table></figure><br>\n<h4 id=\"streams-æµ\"><a class=\"anchor\" href=\"#streams-æµ\">#</a> Streams æµ</h4>\n<p><strong>æ”¯æŒå¤šæ’­çš„å¯æŒä¹…åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºå®ç°å‘å¸ƒè®¢é˜…åŠŸèƒ½</strong>ï¼Œå€Ÿé‰´äº† kafka çš„è®¾è®¡ã€‚Redis Stream çš„ç»“æ„æœ‰ä¸€ä¸ªæ¶ˆæ¯é“¾è¡¨ï¼Œå°†æ‰€æœ‰åŠ å…¥çš„æ¶ˆæ¯éƒ½ä¸²èµ·æ¥ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ ID å’Œå¯¹åº”çš„å†…å®¹ã€‚æ¶ˆæ¯æ˜¯æŒä¹…åŒ–çš„ï¼ŒRedis é‡å¯åï¼Œå†…å®¹è¿˜åœ¨ã€‚ğŸš€ğŸš€ğŸš€</p>\n<p><img data-src=\"/assets/2021-10/r2.png\" alt=\"image.png\" /></p>\n<p>æ¯ä¸ª Stream éƒ½æœ‰å”¯ä¸€çš„åç§°ï¼Œå®ƒå°±æ˜¯ Redis çš„ keyï¼Œåœ¨æˆ‘ä»¬é¦–æ¬¡ä½¿ç”¨ xadd æŒ‡ä»¤è¿½åŠ æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºã€‚</p>\n<blockquote>\n<p>æ¯ä¸ª<strong> Stream</strong> éƒ½å¯ä»¥æŒ‚å¤šä¸ªæ¶ˆè´¹ç»„ï¼Œæ¯ä¸ªæ¶ˆè´¹ç»„ä¼šæœ‰ä¸ªæ¸¸æ ‡ last_delivered_id åœ¨ Stream æ•°ç»„ä¹‹ä¸Šå¾€å‰ç§»åŠ¨ï¼Œè¡¨ç¤ºå½“å‰æ¶ˆè´¹ç»„å·²ç»æ¶ˆè´¹åˆ°å“ªæ¡æ¶ˆæ¯äº†ã€‚æ¯ä¸ªæ¶ˆè´¹ç»„éƒ½æœ‰ä¸€ä¸ª Stream å†…å”¯ä¸€çš„åç§°ï¼Œæ¶ˆè´¹ç»„ä¸ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå®ƒéœ€è¦å•ç‹¬çš„æŒ‡ä»¤ xgroup create è¿›è¡Œåˆ›å»ºï¼Œéœ€è¦æŒ‡å®šä» Stream çš„æŸä¸ªæ¶ˆæ¯ ID å¼€å§‹æ¶ˆè´¹ï¼Œè¿™ä¸ª ID ç”¨æ¥åˆå§‹åŒ– last_delivered_id å˜é‡ã€‚</p>\n<p>æ¯ä¸ª<strong>æ¶ˆè´¹ç»„</strong> (Consumer Group) çš„çŠ¶æ€éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç›¸äº’ä¸å—å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€ä»½ Stream å†…éƒ¨çš„æ¶ˆæ¯ä¼šè¢«æ¯ä¸ªæ¶ˆè´¹ç»„éƒ½æ¶ˆè´¹åˆ°ã€‚</p>\n<p>åŒä¸€ä¸ªæ¶ˆè´¹ç»„ (Consumer Group) å¯ä»¥æŒ‚æ¥å¤šä¸ªæ¶ˆè´¹è€… (Consumer)ï¼Œè¿™äº›æ¶ˆè´¹è€…ä¹‹é—´æ˜¯ç«äº‰å…³ç³»ï¼Œä»»æ„ä¸€ä¸ªæ¶ˆè´¹è€…è¯»å–äº†æ¶ˆæ¯éƒ½ä¼šä½¿æ¸¸æ ‡ last_delivered_id å¾€å‰ç§»åŠ¨ã€‚æ¯ä¸ªæ¶ˆè´¹è€…è€…æœ‰ä¸€ä¸ªç»„å†…å”¯ä¸€åç§°ã€‚</p>\n<p><strong>æ¶ˆè´¹è€…</strong> (Consumer) å†…éƒ¨ä¼šæœ‰ä¸ªçŠ¶æ€å˜é‡ pending_idsï¼Œå®ƒè®°å½•äº†å½“å‰å·²ç»è¢«å®¢æˆ·ç«¯è¯»å–çš„æ¶ˆæ¯ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ ackã€‚å¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰ ackï¼Œè¿™ä¸ªå˜é‡é‡Œé¢çš„æ¶ˆæ¯ ID ä¼šè¶Šæ¥è¶Šå¤šï¼Œä¸€æ—¦æŸä¸ªæ¶ˆæ¯è¢« ackï¼Œå®ƒå°±å¼€å§‹å‡å°‘ã€‚è¿™ä¸ª pending_ids å˜é‡åœ¨ Redis å®˜æ–¹è¢«ç§°ä¹‹ä¸º PELï¼Œä¹Ÿå°±æ˜¯ Pending Entries Listï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„æ•°æ®ç»“æ„ï¼Œå®ƒç”¨æ¥ç¡®ä¿å®¢æˆ·ç«¯è‡³å°‘æ¶ˆè´¹äº†æ¶ˆæ¯ä¸€æ¬¡ï¼Œè€Œä¸ä¼šåœ¨ç½‘ç»œä¼ è¾“çš„ä¸­é€”ä¸¢å¤±äº†æ²¡å¤„ç†ã€‚</p>\n<p><strong>æ¶ˆæ¯ IDï¼š</strong> æ¶ˆæ¯ ID çš„å½¢å¼æ˜¯ timestampInMillis-sequenceï¼Œä¾‹å¦‚ 1527846880572-5ï¼Œå®ƒè¡¨ç¤ºå½“å‰çš„æ¶ˆæ¯åœ¨æ¯«ç±³æ—¶é—´æˆ³ 1527846880572 æ—¶äº§ç”Ÿï¼Œå¹¶ä¸”æ˜¯è¯¥æ¯«ç§’å†…äº§ç”Ÿçš„ç¬¬ 5 æ¡æ¶ˆæ¯ã€‚æ¶ˆæ¯ ID å¯ä»¥ç”±æœåŠ¡å™¨è‡ªåŠ¨ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ç”±å®¢æˆ·ç«¯è‡ªå·±æŒ‡å®šï¼Œä½†æ˜¯å½¢å¼å¿…é¡»æ˜¯æ•´æ•° - æ•´æ•°ï¼Œè€Œä¸”å¿…é¡»æ˜¯åé¢åŠ å…¥çš„æ¶ˆæ¯çš„ ID è¦å¤§äºå‰é¢çš„æ¶ˆæ¯ IDã€‚</p>\n<p><strong>æ¶ˆæ¯å†…å®¹ï¼š</strong> æ¶ˆæ¯å†…å®¹å°±æ˜¯é”®å€¼å¯¹ï¼Œå½¢å¦‚ hash ç»“æ„çš„é”®å€¼å¯¹ï¼Œè¿™æ²¡ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ã€‚</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> XADD mystream * field1 value1 field2 value2 field3 value3</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">\"1588491680862-0\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> XADD mystream * username lisi age <span class=\"token number\">18</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string\">\"1588491854070-0\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> xlen mystream</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> XADD mystream * username lisi age <span class=\"token number\">18</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token string\">\"1588491861215-0\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> xrange mystream - + </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1588491680862-0\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field1\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field2\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field3\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1588491854070-0\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"username\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lisi\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"age\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"18\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1588491861215-0\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"username\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lisi\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"age\"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"18\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> xdel mystream <span class=\"token number\">1588491854070</span>-0 </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> xrange mystream - + </pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1588491680862-0\"</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field1\"</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value1\"</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field2\"</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value2\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"field3\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"value3\"</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"1588491861215-0\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>   <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"username\"</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"lisi\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"age\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token string\">\"18\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token number\">127.0</span>.0.1:637<span class=\"token operator\"><span class=\"token file-descriptor important\">9</span>></span> xlen mystream</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">(</span>integer<span class=\"token punctuation\">)</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><br>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "Redis"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/10/a3c0f04e5e30/",
            "url": "https://shaogezhu.cn/2021/10/a3c0f04e5e30/",
            "title": "æ‰‹å†™åˆ†å¸ƒå¼é›ªèŠ±(Snowflake)ç®—æ³•ç”ŸæˆID",
            "date_published": "2021-10-02T12:45:48.000Z",
            "content_html": "<div class=\"note info\">\n<p>æˆ‘ä»¬ç°åœ¨å¤§å¤š MySQL æ•°æ®åº“ï¼Œç”Ÿæˆ ID çš„ç®—æ³•å°±æ˜¯ç”¨çš„<span class=\"pink\"> SnowFlake</span>ï¼Œä¸‹é¢æˆ‘ä»¬äº†è§£ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„ç”ŸæˆåŸç†ï¼Œä»¥åŠæ˜¯å¦‚ä½•å·¥ä½œçš„ğŸ‘€</p>\n</div>\n<h2 id=\"snowflakeç®—æ³•\"><a class=\"anchor\" href=\"#snowflakeç®—æ³•\">#</a> SnowFlake ç®—æ³•</h2>\n<blockquote>\n<p>SnowFlake æ˜¯ twitter å…¬å¸å†…éƒ¨åˆ†å¸ƒå¼é¡¹ç›®é‡‡ç”¨çš„ ID ç”Ÿæˆç®—æ³•ï¼Œå¼€æºåå¹¿å—å›½å†…å¤§å‚çš„å¥½è¯„ã€‚ç”±è¿™ç§ç®—æ³•ç”Ÿæˆçš„ IDï¼Œæˆ‘ä»¬å°±å«åš SnowFlakeIDã€‚</p>\n</blockquote>\n<p>SnowFlake ç®—æ³•ç”Ÿæˆ id çš„ç»“æœæ˜¯ä¸€ä¸ª 64bit å¤§å°çš„æ•´æ•°ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹å›¾ï¼š<br />\n<img data-src=\"/assets/2021-10/sn1.png\" alt=\"image.png\" /></p>\n<blockquote>\n<p>åˆ†ä¸ºå››æ®µï¼š</p>\n<p><strong>ç¬¬ä¸€æ®µï¼š</strong> 1 ä½ä¸ºæœªä½¿ç”¨ï¼Œæ°¸è¿œå›ºå®šä¸º 0ã€‚<br />\nï¼ˆå› ä¸ºäºŒè¿›åˆ¶ä¸­æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ1 è¡¨ç¤ºè´Ÿæ•°ï¼Œ0 è¡¨ç¤ºæ­£æ•°ã€‚ç”Ÿæˆçš„ id ä¸€èˆ¬éƒ½æ˜¯ç”¨æ­£æ•´æ•°ï¼Œæ‰€ä»¥æœ€é«˜ä½å›ºå®šä¸º 0 ï¼‰</p>\n<p><strong>ç¬¬äºŒæ®µï¼š</strong> 41 ä½ä¸ºæ¯«ç§’çº§æ—¶é—´ (41 ä½çš„é•¿åº¦å¯ä»¥ä½¿ç”¨ 69 å¹´)</p>\n<p><strong>ç¬¬ä¸‰æ®µï¼š</strong> 10 ä½ä¸º workerId (10 ä½çš„é•¿åº¦æœ€å¤šæ”¯æŒéƒ¨ç½² 1024 ä¸ªèŠ‚ç‚¹ï¼‰<br />\n(è¿™é‡Œçš„ 10 ä½åˆåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ† 5 ä½è¡¨ç¤ºæ•°æ®ä¸­å¿ƒ IDï¼ˆ0-31ï¼‰ç¬¬äºŒéƒ¨åˆ† 5 ä½è¡¨ç¤ºæœºå™¨ IDï¼ˆ0-31ï¼‰)</p>\n<p><strong>ç¬¬å››æ®µï¼š</strong> 12 ä½ä¸ºæ¯«ç§’å†…çš„è®¡æ•°ï¼ˆ12 ä½çš„è®¡æ•°é¡ºåºå·æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹æ¯æ¯«ç§’äº§ç”Ÿ 4096 ä¸ª ID åºå·ï¼‰</p>\n</blockquote>\n<p><strong>ä»£ç å®ç°ï¼šğŸ˜</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HashSet</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SnowFlake</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// æ—¶é—´ 41 ä½</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> lastTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// æ•°æ®ä¸­å¿ƒ ID 5 ä½ (é»˜è®¤ 0-31)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> datacenterId <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> datacenterIdShift <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// æœºæˆ¿æœºå™¨ ID 5 ä½ (é»˜è®¤ 0-31)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> workerId <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> workerIdShift <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">// éšæœºæ•° 12 ä½ (é»˜è®¤ 0~4095)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">AtomicLong</span> random <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> randomShift <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\">// éšæœºæ•°çš„æœ€å¤§å€¼</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> maxRandom <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> randomShift<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SnowFlake</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SnowFlake</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> workerIdShift<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> datacenterIdShift<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>workerIdShift <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                datacenterIdShift <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                workerIdShift <span class=\"token operator\">+</span> datacenterIdShift <span class=\"token operator\">></span> <span class=\"token number\">22</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‚æ•°ä¸åŒ¹é…\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>workerIdShift <span class=\"token operator\">=</span> workerIdShift<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>datacenterIdShift <span class=\"token operator\">=</span> datacenterIdShift<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>randomShift <span class=\"token operator\">=</span> <span class=\"token number\">22</span> <span class=\"token operator\">-</span> datacenterIdShift <span class=\"token operator\">-</span> workerIdShift<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>maxRandom <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> randomShift<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\">// è·å–é›ªèŠ±çš„ ID</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> <span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> lastTime <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>workerIdShift <span class=\"token operator\">+</span> datacenterIdShift <span class=\"token operator\">+</span> randomShift<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                workerId <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>datacenterIdShift <span class=\"token operator\">+</span> randomShift<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                datacenterId <span class=\"token operator\">&lt;&lt;</span> randomShift <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                random<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token comment\">// ç”Ÿæˆä¸€ä¸ªæ–°çš„ ID</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">long</span> <span class=\"token function\">nextId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">long</span> now <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token comment\">// å¦‚æœå½“å‰æ—¶é—´å’Œä¸Šä¸€æ¬¡æ—¶é—´ä¸åœ¨åŒä¸€æ¯«ç§’å†…ï¼Œç›´æ¥è¿”å›</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>now <span class=\"token operator\">></span> lastTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            lastTime <span class=\"token operator\">=</span> now<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            random<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t<span class=\"token comment\">// å°†æœ€åçš„éšæœºæ•°ï¼Œè¿›è¡Œ + 1 æ“ä½œ</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> maxRandom<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token comment\">// è‡ªé€‰ç­‰å¾…ä¸‹ä¸€æ¯«ç§’</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>now <span class=\"token operator\">&lt;=</span> lastTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            now <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        lastTime <span class=\"token operator\">=</span> now<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        random<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token comment\">// æµ‹è¯•</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token class-name\">SnowFlake</span> snowFlake <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SnowFlake</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token class-name\">HashSet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span> set <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashSet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            set<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>snowFlake<span class=\"token punctuation\">.</span><span class=\"token function\">nextId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>set<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ä»£ç ä¸­è·å– id çš„æ–¹æ³•åˆ©ç”¨<strong>ä½è¿ç®—</strong>å®ç°</p>\n<p><img data-src=\"/assets/2021-10/sn2.png\" alt=\"16312623841.png\" /></p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>1  |                    41                        |  5  |   5  |     12      </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   0|0001100 10100010 10111110 10001001 01011100 00|00000|0 0000|0000 00000000 //41ä½çš„æ—¶é—´</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   0|000000â€­0 00000000 00000000 00000000 00000000 00|10001|0 0000|0000 00000000 //5ä½çš„æ•°æ®ä¸­å¿ƒID</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   0|0000000 00000000 00000000 00000000 00000000 00|00000|1 1001|0000 00000000 //5ä¸ºçš„æœºå™¨ID</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>or 0|0000000 00000000 00000000 00000000 00000000 00|00000|0 0000|â€­0000 00000000â€¬ //12ä½çš„sequence</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>------------------------------------------------------------------------------------------</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   0|0001100 10100010 10111110 10001001 01011100 00|10001|1 1001|â€­0000 00000000â€¬ //ç»“æœï¼š910499571847892992</pre></td></tr></table></figure><h3 id=\"snowflakeä¼˜ç‚¹\"><a class=\"anchor\" href=\"#snowflakeä¼˜ç‚¹\">#</a> SnowFlake ä¼˜ç‚¹ï¼š</h3>\n<ol>\n<li>æ‰€æœ‰ç”Ÿæˆçš„ id æŒ‰æ—¶é—´è¶‹åŠ¿é€’å¢</li>\n<li>æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”Ÿé‡å¤ idï¼ˆå› ä¸ºæœ‰ datacenterId å’Œ workerId æ¥åšåŒºåˆ†ï¼‰</li>\n</ol>\n<h3 id=\"snowflakeä¸è¶³\"><a class=\"anchor\" href=\"#snowflakeä¸è¶³\">#</a> SnowFlake ä¸è¶³ï¼š</h3>\n<p>ç”±äº SnowFlake å¼ºä¾èµ–æ—¶é—´æˆ³ï¼Œæ‰€ä»¥æ—¶é—´çš„å˜åŠ¨ä¼šé€ æˆ SnowFlake çš„ç®—æ³•äº§ç”Ÿé”™è¯¯ã€‚</p>\n<br>\n",
            "tags": [
                "Java",
                "æŠ€æœ¯å®è·µ",
                "é¢è¯•",
                "java",
                "ç®—æ³•"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/9/fc647db813d3/",
            "url": "https://shaogezhu.cn/2021/9/fc647db813d3/",
            "title": "å¸¸è§çš„é™æµç®—æ³•åˆ†æä»¥åŠæ‰‹å†™å®ç°ï¼ˆè®¡æ•°å™¨ã€æ¼æ–—ã€ä»¤ç‰Œæ¡¶ï¼‰",
            "date_published": "2021-09-23T14:46:48.000Z",
            "content_html": "<h2 id=\"å¸¸è§çš„é™æµç®—æ³•åˆ†æ\"><a class=\"anchor\" href=\"#å¸¸è§çš„é™æµç®—æ³•åˆ†æ\">#</a> å¸¸è§çš„é™æµç®—æ³•åˆ†æ</h2>\n<div class=\"note primary\">\n<p>é™æµåœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç»å¸¸è§åˆ°ï¼Œå¦‚<strong>ç«è½¦ç«™é—¨å£çš„æ æ†</strong>ã€<strong>ä¸€äº›æ™¯ç‚¹çš„é—¨ç¥¨åªå‡ºå”®ä¸€å®šçš„æ•°é‡</strong> ç­‰ç­‰ã€‚åœ¨æˆ‘ä»¬çš„å¼€å‘ä¸­ä¹Ÿç”¨åˆ°äº†è¿™ç§æ€æƒ³ã€‚</p>\n</div>\n<h3 id=\"ä¸ºä»€ä¹ˆè¦é™æµ\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆè¦é™æµ\">#</a> ä¸ºä»€ä¹ˆè¦é™æµ</h3>\n<p>ğŸ«åœ¨ä¿è¯å¯ç”¨çš„æƒ…å†µä¸‹å°½å¯èƒ½å¤šå¢åŠ è¿›å…¥çš„äººæ•°ï¼Œå…¶ä½™çš„äººåœ¨æ’é˜Ÿç­‰å¾…ï¼Œæˆ–è€…è¿”å›å‹å¥½æç¤ºï¼Œä¿è¯é‡Œé¢çš„è¿›è¡Œç³»ç»Ÿçš„ç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œ <strong><font color=\"blue\">é˜²æ­¢ç³»ç»Ÿé›ªå´©</font></strong>ã€‚</p>\n<h3 id=\"é™æµç®—æ³•\"><a class=\"anchor\" href=\"#é™æµç®—æ³•\">#</a> é™æµç®—æ³•</h3>\n<p>ğŸŒ´ğŸŒ´é™æµç®—æ³•å¾ˆå¤šï¼Œå¸¸è§çš„æœ‰ä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ <strong><font color=\"purple\">è®¡æ•°å™¨ç®—æ³•</font> <strong>ã€</strong><font color=\"orange\">æ¼æ¡¶ç®—æ³•</font></strong>ã€<strong><font color=\"green\">ä»¤ç‰Œæ¡¶ç®—æ³•</font></strong> ã€‚</p>\n<blockquote>\n<p>ï¼ˆ1ï¼‰<strong>è®¡æ•°å™¨ï¼š</strong></p>\n<p>Â Â Â Â Â Â Â Â Â Â åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚</p>\n<p>ï¼ˆ2ï¼‰<strong>æ¼æ¡¶ï¼š</strong></p>\n<p>Â Â Â Â Â Â Â Â Â Â æ¼æ¡¶å¤§å°å›ºå®šï¼Œå¤„ç†é€Ÿåº¦å›ºå®šï¼Œä½†è¯·æ±‚è¿›å…¥é€Ÿåº¦ä¸å›ºå®šï¼ˆåœ¨çªå‘æƒ…å†µè¯·æ±‚è¿‡å¤šæ—¶ï¼Œä¼šä¸¢å¼ƒè¿‡å¤šçš„è¯·æ±‚ï¼‰ã€‚</p>\n<p>ï¼ˆ3ï¼‰<strong>ä»¤ç‰Œæ¡¶ï¼š</strong></p>\n<p>Â Â Â Â Â Â Â Â Â Â ä»¤ç‰Œæ¡¶çš„å¤§å°å›ºå®šï¼Œä»¤ç‰Œçš„äº§ç”Ÿé€Ÿåº¦å›ºå®šï¼Œä½†æ˜¯æ¶ˆè€—ä»¤ç‰Œï¼ˆå³è¯·æ±‚ï¼‰é€Ÿåº¦ä¸å›ºå®šï¼ˆå¯ä»¥åº”å¯¹ä¸€äº›æŸäº›æ—¶é—´è¯·æ±‚è¿‡å¤šçš„æƒ…å†µï¼‰ï¼›æ¯ä¸ªè¯·æ±‚éƒ½ä¼šä»ä»¤ç‰Œæ¡¶ä¸­å–å‡ºä»¤ç‰Œï¼Œå¦‚æœæ²¡æœ‰ä»¤ç‰Œåˆ™ä¸¢å¼ƒè¯¥æ¬¡è¯·æ±‚ã€‚</p>\n</blockquote>\n<h3 id=\"è®¡æ•°å™¨é™æµ\"><a class=\"anchor\" href=\"#è®¡æ•°å™¨é™æµ\">#</a> è®¡æ•°å™¨é™æµ</h3>\n<p>ğŸº<strong>åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚</strong></p>\n<p>ä¸¾ä¸ªğŸŒ°, æ¯”å¦‚æˆ‘ä»¬è§„å®šå¯¹äº A æ¥å£ï¼Œæˆ‘ä»¬ 1 åˆ†é’Ÿçš„è®¿é—®æ¬¡æ•°ä¸èƒ½è¶…è¿‡ 100 æ¬¡ã€‚</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p>\n<p>ğŸˆåœ¨ä¸€å¼€ å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ counterï¼Œæ¯å½“ä¸€ä¸ªè¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œcounter å°±åŠ  1ï¼Œå¦‚æœ counter çš„å€¼å¤§äº 100 å¹¶ä¸”è¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´è¿˜åœ¨ 1 åˆ†é’Ÿä¹‹å†…ï¼Œé‚£ä¹ˆè¯´æ˜è¯·æ±‚æ•°è¿‡å¤šï¼Œæ‹’ç»è®¿é—®ï¼›</p>\n<p>ğŸ¬å¦‚æœè¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´å¤§äº 1 åˆ†é’Ÿï¼Œä¸” counter çš„å€¼è¿˜åœ¨é™æµèŒƒå›´å†…ï¼Œé‚£ä¹ˆå°±é‡ç½® counter, å°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ã€‚</p>\n<p><img data-src=\"https://img-blog.csdnimg.cn/333bdec3d3524f4c95172376841dd180.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-pkGvVRdd-1647523333397)(/upload/2021/09/image-0cbbc44ec76d446896e989962e8122e5.png)]\" /></p>\n<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorService</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Executors</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// è®¡æ•°å™¨ é™æµ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CounterLimiter</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// èµ·å§‹æ—¶é—´</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> startTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// æ—¶é—´é—´éš” 1000ms</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> interval <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// æ¯ä¸ªæ—¶é—´é—´éš”å†…ï¼Œé™åˆ¶æ•°é‡</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> limit <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">// ç´¯åŠ å™¨</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">AtomicLong</span> accumulator <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">long</span> nowTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">// åˆ¤æ–­æ˜¯å¦åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nowTime <span class=\"token operator\">&lt;</span> startTime <span class=\"token operator\">+</span> interval<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token comment\">// å¦‚æœè¿˜åœ¨ä¸Šä¸ªæ—¶é—´é—´éš”å†…</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">long</span> count <span class=\"token operator\">=</span> accumulator<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">&lt;=</span> limit<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token comment\">// å¦‚æœä¸åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">synchronized</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CounterLimiter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token comment\">// é˜²æ­¢é‡å¤åˆå§‹åŒ–</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nowTime <span class=\"token operator\">></span> startTime <span class=\"token operator\">+</span> interval<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                    startTime <span class=\"token operator\">=</span> nowTime<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                    accumulator<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token comment\">// å†æ¬¡è¿›è¡Œåˆ¤æ–­</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token keyword\">long</span> count <span class=\"token operator\">=</span> accumulator<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">&lt;=</span> limit<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token comment\">// æµ‹è¯•</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token class-name\">ExecutorService</span> pool <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token class-name\">AtomicInteger</span> limited <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ•°</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> threads <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token comment\">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> turns <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token comment\">// åŒæ­¥å™¨</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token class-name\">CountDownLatch</span> countDownLatch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">(</span>threads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">long</span> start <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> threads<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            pool<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> turns<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                        <span class=\"token keyword\">boolean</span> flag <span class=\"token operator\">=</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                            <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                            limited<span class=\"token punctuation\">.</span><span class=\"token function\">getAndIncrement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                <span class=\"token comment\">// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">countDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">await</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token keyword\">float</span> time <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000F</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token comment\">// è¾“å‡ºç»Ÿè®¡ç»“æœ</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                <span class=\"token string\">\",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns <span class=\"token operator\">-</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">\"s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre></pre></td></tr><tr><td data-num=\"106\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>è®¡æ•°å™¨é™æµçš„ä¸è¶³ï¼š</strong> ğŸŒ´</p>\n<p>è¿™ä¸ªç®—æ³•è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å­˜åœ¨<strong>ä¸´ç•Œé—®é¢˜</strong>ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š</p>\n<p><img data-src=\"https://img-blog.csdnimg.cn/e5b54ef9aa614eab9ada0ab8850d9b1b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-xUvgpono-1647523333398)(/upload/2021/09/image-d55d813bbcb544479109dd2248e90ff0.png)]\" /></p>\n<p>ğŸ‘‰ğŸ»ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ¶æ„ç”¨æˆ·ï¼Œä»–åœ¨ 0:59 æ—¶ï¼Œç¬é—´å‘é€äº† 100 ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸” 1:00 åˆç¬é—´å‘é€äº† 100 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆå…¶å®è¿™ä¸ªç”¨æˆ·åœ¨ 1 ç§’é‡Œé¢ï¼Œç¬é—´å‘é€äº† 200 ä¸ªè¯·æ±‚ã€‚</p>\n<p>ğŸ¦æˆ‘ä»¬åˆšæ‰è§„å®šçš„æ˜¯ 1 åˆ†é’Ÿæœ€å¤š 100 ä¸ªè¯·æ±‚ï¼ˆè§„åˆ’çš„ååé‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’é’Ÿæœ€å¤š 1.7 ä¸ªè¯·æ±‚ï¼Œç”¨æˆ·é€šè¿‡åœ¨æ—¶é—´çª—å£çš„é‡ç½®èŠ‚ç‚¹å¤„çªå‘è¯·æ±‚ï¼Œ å¯ä»¥ç¬é—´è¶…è¿‡æˆ‘ä»¬çš„é€Ÿç‡é™åˆ¶ã€‚</p>\n<p>ç”¨æˆ·æœ‰å¯èƒ½é€šè¿‡ç®—æ³•çš„è¿™ä¸ªæ¼æ´ï¼Œç¬é—´å‹å®æˆ‘ä»¬çš„åº”ç”¨ã€‚ğŸ™‡ğŸ»â€â™€ï¸</p>\n<p><span><span style=\"font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;\"><span style=\"font-size:14px;\"><span style=\"font-family:Arial;line-height:26px;\"><br></span></span></span></span></p>\n<p><span><span style=\"font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;\"><span style=\"font-size:14px;\"><span style=\"font-family:Arial;line-height:26px;\"><br></span></span></span></span></p>\n<h3 id=\"æ¼æ¡¶é™æµ\"><a class=\"anchor\" href=\"#æ¼æ¡¶é™æµ\">#</a> æ¼æ¡¶é™æµ</h3>\n<p>âœ¨æ¼æ¡¶ç®—æ³•é™æµçš„åŸºæœ¬åŸç†ä¸ºï¼š<strong>æ°´ï¼ˆå¯¹åº”è¯·æ±‚ï¼‰ä»è¿›æ°´å£è¿›å…¥åˆ°æ¼æ¡¶é‡Œï¼Œæ¼æ¡¶ä»¥ä¸€å®šçš„é€Ÿåº¦å‡ºæ°´ï¼ˆè¯·æ±‚æ”¾è¡Œï¼‰ï¼Œå½“æ°´æµå…¥é€Ÿåº¦è¿‡å¤§ï¼Œæ¡¶å†…çš„æ€»æ°´é‡å¤§äºæ¡¶å®¹é‡ä¼šç›´æ¥æº¢å‡ºï¼Œè¯·æ±‚è¢«æ‹’ç»ã€‚</strong><br />\nå¤§è‡´çš„æ¼æ¡¶é™æµè§„åˆ™å¦‚ä¸‹ï¼šğŸ“<br />\nï¼ˆ1ï¼‰è¿›æ°´å£ï¼ˆå¯¹åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼‰ä»¥ä»»æ„é€Ÿç‡æµå…¥è¿›å…¥æ¼æ¡¶ã€‚<br />\nï¼ˆ2ï¼‰æ¼æ¡¶çš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œå‡ºæ°´ï¼ˆæ”¾è¡Œï¼‰é€Ÿç‡ä¹Ÿæ˜¯å›ºå®šçš„ã€‚<br />\nï¼ˆ3ï¼‰æ¼æ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œå¦‚æœå¤„ç†é€Ÿåº¦å¤ªæ…¢ï¼Œæ¡¶å†…æ°´é‡ä¼šè¶…å‡ºäº†æ¡¶çš„å®¹é‡ï¼Œåˆ™åé¢æµå…¥çš„æ°´æ»´ä¼šæº¢å‡ºï¼Œè¡¨ç¤ºè¯·æ±‚æ‹’ç»ã€‚<br />\n<img data-src=\"https://img-blog.csdnimg.cn/27e69fa5f58e45128755cbabf27cc2ed.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-ohzhfhmz-1647523333399)(/upload/2021/09/image-afa56bce847f4d8b99e2dfd1eb3509aa.png)]\" /></p>\n<p>â­æ¼æ¡¶ç®—æ³•å…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥ç²—ç•¥çš„è®¤ä¸ºå°±æ˜¯æ³¨æ°´æ¼æ°´è¿‡ç¨‹ï¼Œå¾€æ¡¶ä¸­ä»¥ä»»æ„é€Ÿç‡æµå…¥æ°´ï¼Œä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œå½“æ°´è¶…è¿‡æ¡¶å®¹é‡ï¼ˆcapacityï¼‰åˆ™ä¸¢å¼ƒï¼Œå› ä¸ºæ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œä¿è¯äº†æ•´ä½“çš„é€Ÿç‡ã€‚</p>\n<p>ä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œ<br />\n<img data-src=\"https://img-blog.csdnimg.cn/ef3bb3929e4a4e44b34dce33187e672a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-hFtmsnIH-1647523333399)(/upload/2021/09/image-c7d684d693f74fa5bf4077febb8fccbc.png)]\" /></p>\n<p><strong>å‰Šå³°ğŸ“ï¼š</strong> æœ‰å¤§é‡æµé‡è¿›å…¥æ—¶ï¼Œä¼šå‘ç”Ÿæº¢å‡ºï¼Œä»è€Œé™æµä¿æŠ¤æœåŠ¡å¯ç”¨</p>\n<p><strong>ç¼“å†²ğŸ“ï¼š</strong> ä¸è‡³äºç›´æ¥è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç¼“å†²å‹åŠ›</p>\n<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorService</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Executors</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// æ¼æ–—é™æµ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LeakBucketLimiter</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// æ¡¶çš„å¤§å°</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> capacity <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// æµå‡ºé€Ÿç‡ï¼Œæ¯ç§’ä¸¤ä¸ª</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> rate <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// å¼€å§‹æ—¶é—´</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> startTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// æ¡¶ä¸­å‰©ä½™çš„æ°´</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">AtomicLong</span> water <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token comment\">// å¦‚æœæ¡¶çš„ä½™é‡é—® 0ï¼Œç›´æ¥æ”¾è¡Œ</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>water<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            startTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            water<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token comment\">// è®¡ç®—ä»å½“å‰æ—¶é—´åˆ°å¼€å§‹æ—¶é—´æµå‡ºçš„æ°´ï¼Œå’Œç°åœ¨æ¡¶ä¸­å‰©ä½™çš„æ°´</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">// æ¡¶ä¸­å‰©ä½™çš„æ°´</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        water<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>water<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> startTime<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token comment\">// é˜²æ­¢å‡ºç° & lt;0 çš„æƒ…å†µ</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        water<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> water<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token comment\">// è®¾ç½®æ–°çš„å¼€å§‹æ—¶é—´</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        startTime <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> startTime<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token comment\">// å¦‚æœå½“å‰æ°´å°äºå®¹é‡ï¼Œè¡¨ç¤ºå¯ä»¥æ”¾è¡Œ</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>water<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> capacity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            water<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token comment\">// æµ‹è¯•</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token class-name\">ExecutorService</span> pool <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token class-name\">AtomicInteger</span> limited <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ•°</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> threads <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token comment\">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> turns <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token comment\">// åŒæ­¥å™¨</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token class-name\">CountDownLatch</span> countDownLatch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">(</span>threads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token keyword\">long</span> start <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> threads<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            pool<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> turns<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                        <span class=\"token keyword\">boolean</span> flag <span class=\"token operator\">=</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                            <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                            limited<span class=\"token punctuation\">.</span><span class=\"token function\">getAndIncrement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                <span class=\"token comment\">// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">countDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>            countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">await</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">float</span> time <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000F</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token comment\">// è¾“å‡ºç»Ÿè®¡ç»“æœ</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                <span class=\"token string\">\",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns <span class=\"token operator\">-</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">\"s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>æ¼æ¡¶çš„ä¸è¶³ï¼š</strong> ğŸ¤·â€â™€ï¸<br />\næ¼æ¡¶çš„å‡ºæ°´é€Ÿåº¦å›ºå®šï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚æ”¾è¡Œé€Ÿåº¦æ˜¯å›ºå®šçš„ã€‚<br />\næ¼æ¡¶å‡ºå£çš„é€Ÿåº¦å›ºå®šï¼Œä¸èƒ½çµæ´»çš„åº”å¯¹åç«¯èƒ½åŠ›æå‡ã€‚æ¯”å¦‚ï¼Œé€šè¿‡åŠ¨æ€æ‰©å®¹ï¼Œåç«¯æµé‡ä» 1000QPS æå‡åˆ° 1WQPSï¼Œæ¼æ¡¶æ²¡æœ‰åŠæ³•ã€‚</p>\n<p><span><span style=\"font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;\"><span style=\"font-size:14px;\"><span style=\"font-family:Arial;line-height:26px;\"><br></span></span></span></span></p>\n<p><span><span style=\"font-family:Verdana, Arial, Helvetica, sans-serif;line-height:19px;text-indent:26px;\"><span style=\"font-size:14px;\"><span style=\"font-family:Arial;line-height:26px;\"><br></span></span></span></span></p>\n<h3 id=\"ä»¤ç‰Œæ¡¶é™æµ\"><a class=\"anchor\" href=\"#ä»¤ç‰Œæ¡¶é™æµ\">#</a> ä»¤ç‰Œæ¡¶é™æµ</h3>\n<p><strong>ğŸ¬ä»¤ç‰Œæ¡¶ç®—æ³•ä¸­æ–°è¯·æ±‚åˆ°æ¥æ—¶ä¼šä»æ¡¶é‡Œæ‹¿èµ°ä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœæ¡¶å†…æ²¡æœ‰ä»¤ç‰Œå¯æ‹¿ï¼Œå°±æ‹’ç»æœåŠ¡ã€‚</strong>  å½“ç„¶ï¼Œä»¤ç‰Œçš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸Šé™çš„ã€‚ä»¤ç‰Œçš„æ•°é‡ä¸æ—¶é—´å’Œå‘æ”¾é€Ÿç‡å¼ºç›¸å…³ï¼Œæ—¶é—´æµé€çš„æ—¶é—´è¶Šé•¿ï¼Œä¼šä¸æ–­å¾€æ¡¶é‡ŒåŠ å…¥è¶Šå¤šçš„ä»¤ç‰Œï¼Œå¦‚æœä»¤ç‰Œå‘æ”¾çš„é€Ÿåº¦æ¯”ç”³è¯·é€Ÿåº¦å¿«ï¼Œä»¤ç‰Œæ¡¶ä¼šæ”¾æ»¡ä»¤ç‰Œï¼Œç›´åˆ°ä»¤ç‰Œå æ»¡æ•´ä¸ªä»¤ç‰Œæ¡¶ã€‚</p>\n<p>ä»¤ç‰Œæ¡¶é™æµå¤§è‡´çš„è§„åˆ™å¦‚ä¸‹ï¼šğŸ™‡ğŸ»â€<br />\nï¼ˆ1ï¼‰è¿›æ°´å£æŒ‰ç…§æŸä¸ªé€Ÿåº¦ï¼Œå‘æ¡¶ä¸­æ”¾å…¥ä»¤ç‰Œã€‚<br />\nï¼ˆ2ï¼‰ä»¤ç‰Œçš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯æ”¾è¡Œçš„é€Ÿåº¦ä¸æ˜¯å›ºå®šçš„ï¼Œåªè¦æ¡¶ä¸­è¿˜æœ‰å‰©ä½™ä»¤ç‰Œï¼Œä¸€æ—¦è¯·æ±‚è¿‡æ¥å°±èƒ½ç”³è¯·æˆåŠŸï¼Œç„¶åæ”¾è¡Œã€‚<br />\nï¼ˆ3ï¼‰å¦‚æœä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œæ…¢äºè¯·æ±‚åˆ°æ¥é€Ÿåº¦ï¼Œæ¡¶å†…å°±æ— ç‰Œå¯é¢†ï¼Œè¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚</p>\n<p>æ€»ä¹‹ï¼Œä»¤ç‰Œçš„å‘é€é€Ÿç‡å¯ä»¥è®¾ç½®ï¼Œä»è€Œå¯ä»¥å¯¹çªå‘çš„å‡ºå£æµé‡è¿›è¡Œæœ‰æ•ˆçš„åº”å¯¹ã€‚<br />\n<img data-src=\"https://img-blog.csdnimg.cn/04bc89a81781443aa1e0bfb07260ab58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55Sw5Z-C44CB,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-OlS9VCnB-1647523333401)(/upload/2021/09/image-f5b402eae3b2409c8939b34d8be41f9c.png)]\" /></p>\n<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorService</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Executors</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span>atomic<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// ä»¤ç‰Œæ¡¶</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TokenBucketLimiter</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// æ¡¶çš„å®¹é‡</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> capacity <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// æ”¾å…¥ä»¤ç‰Œçš„é€Ÿç‡ï¼Œæ¯ç§’ 2 ä¸ª</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> rate <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// ä¸Šæ¬¡æ”¾ç½®ä»¤ç‰Œçš„æ—¶é—´</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> lastTime <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// æ¡¶ä¸­ä»¤ç‰Œçš„ä½™é‡</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">AtomicLong</span> tokenNum <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token comment\">// æ›´æ–°æ¡¶ä¸­å‰©ä½™ä»¤ç‰Œçš„æ•°é‡</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">long</span> now <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        tokenNum<span class=\"token punctuation\">.</span><span class=\"token function\">addAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>now <span class=\"token operator\">-</span> lastTime<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        tokenNum<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>capacity<span class=\"token punctuation\">,</span> tokenNum<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// æ›´æ–°æ—¶é—´</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        lastTime <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>now <span class=\"token operator\">-</span> lastTime<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token comment\">// æ¡¶ä¸­è¿˜æœ‰ä»¤ç‰Œå°±æ”¾è¡Œ</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tokenNum<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            tokenNum<span class=\"token punctuation\">.</span><span class=\"token function\">decrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token comment\">// æµ‹è¯•</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token class-name\">ExecutorService</span> pool <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token class-name\">AtomicInteger</span> limited <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token comment\">// çº¿ç¨‹æ•°</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> threads <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token comment\">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> turns <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token comment\">// åŒæ­¥å™¨</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token class-name\">CountDownLatch</span> countDownLatch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CountDownLatch</span><span class=\"token punctuation\">(</span>threads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">long</span> start <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> threads<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            pool<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> turns<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                        <span class=\"token keyword\">boolean</span> flag <span class=\"token operator\">=</span> <span class=\"token function\">tryAcquire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                            <span class=\"token comment\">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                            limited<span class=\"token punctuation\">.</span><span class=\"token function\">getAndIncrement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                        <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                <span class=\"token comment\">// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">countDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            countDownLatch<span class=\"token punctuation\">.</span><span class=\"token function\">await</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token keyword\">float</span> time <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000F</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token comment\">// è¾“å‡ºç»Ÿè®¡ç»“æœ</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                <span class=\"token string\">\",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns <span class=\"token operator\">-</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> limited<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>threads <span class=\"token operator\">*</span> turns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š\"</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">\"s\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>ä»¤ç‰Œæ¡¶çš„å¥½å¤„ï¼š</strong> ğŸš€ğŸš€ğŸš€<br />\nä»¤ç‰Œæ¡¶çš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯å¯ä»¥æ–¹ä¾¿åœ°åº”å¯¹ çªå‘å‡ºå£æµé‡ï¼ˆåç«¯èƒ½åŠ›çš„æå‡ï¼‰ã€‚</p>\n<p>æ¯”å¦‚ï¼Œå¯ä»¥æ”¹å˜ä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œç®—æ³•èƒ½æŒ‰ç…§æ–°çš„å‘é€é€Ÿç‡è°ƒå¤§ä»¤ç‰Œçš„å‘æ”¾æ•°é‡ï¼Œä½¿å¾—å‡ºå£çªå‘æµé‡èƒ½è¢«å¤„ç†ã€‚</p>\n",
            "tags": [
                "Java",
                "æŠ€æœ¯å®è·µ",
                "java",
                "é™æµç®—æ³•"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/9/392314cccb3f/",
            "url": "https://shaogezhu.cn/2021/9/392314cccb3f/",
            "title": "èŠèŠ Redis çš„ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©",
            "date_published": "2021-09-15T13:12:45.000Z",
            "content_html": "<h1 id=\"èŠèŠredisçš„ç¼“å­˜ç©¿é€-ç¼“å­˜å‡»ç©¿-ç¼“å­˜é›ªå´©\"><a class=\"anchor\" href=\"#èŠèŠredisçš„ç¼“å­˜ç©¿é€-ç¼“å­˜å‡»ç©¿-ç¼“å­˜é›ªå´©\">#</a> èŠèŠ Redis çš„ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©</h1>\n<div class=\"note info\">\n<p>Redis çš„ç¼“å­˜ç›¸å…³å†…å®¹ï¼Œé¢è¯•çš„æ—¶å€™å¯æ˜¯ç»å¸¸é‡åˆ°çš„ï¼Œä»Šå¤©æ€»ç»“ä¸€ä¸‹ï¼Œè¿™æ–¹é¢çš„çŸ¥è¯†</p>\n</div>\n<h2 id=\"ç¼“å­˜ç©¿é€\"><a class=\"anchor\" href=\"#ç¼“å­˜ç©¿é€\">#</a> ç¼“å­˜ç©¿é€</h2>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€\">#</a> ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€</h3>\n<p>ğŸ‘€ç¼“å­˜ç©¿é€å°±æ˜¯å¤§é‡çš„è¯·æ±‚ key åœ¨ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œç›´æ¥è½åˆ°äº†æ•°æ®åº“ä¸Šã€‚æ¯”å¦‚æ”»å‡»è€…æ•…æ„åˆ¶é€ ç¼“å­˜ä¸­ä¸å­˜åœ¨çš„ keyï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œç©¿è¿‡ç¼“å­˜ï¼Œè½åœ¨äº†æ•°æ®åº“ä¸Šã€‚</p>\n<h3 id=\"ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•\"><a class=\"anchor\" href=\"#ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•\">#</a> ç¼“å­˜ç©¿é€çš„è§£å†³åŠæ³•</h3>\n<p>æœ€åŸºæœ¬çš„å°±æ˜¯â¾¸å…ˆåšå¥½å‚æ•°æ ¡éªŒï¼Œâ¼€äº›ä¸åˆæ³•çš„å‚æ•°è¯·æ±‚ç›´æ¥æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚â½å¦‚æŸ¥è¯¢çš„æ•°æ®åº“ id ä¸èƒ½â¼©äº 0ã€ä¼ â¼Šçš„é‚®ç®±æ ¼å¼ä¸å¯¹çš„æ—¶å€™ç›´æ¥è¿”å›é”™è¯¯æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ç­‰ç­‰ã€‚</p>\n<ol>\n<li>ç¼“å­˜â½†æ•ˆ key</li>\n</ol>\n<p>â€‹\tå¦‚æœç¼“å­˜å’Œæ•°æ®åº“éƒ½æŸ¥ä¸åˆ°æŸä¸ª key çš„æ•°æ®å°±å†™â¼€ä¸ªåˆ° Redis ä¸­å»å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ä½†æ˜¯è¿™ç§â½…æ¡ˆå¹¶ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³æ­¤é—®é¢˜ã€‚</p>\n<ol start=\"2\">\n<li>å¸ƒéš†è¿‡æ»¤å™¨</li>\n</ol>\n<p>â€‹\tå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§å·§å¦™çš„æ•°æ®ç»“æ„ï¼Œæ˜¯æ¦‚ç‡å‹æ•°æ®åº“ã€‚æ˜¯ä¸€ä¸ª bit å‘é‡æˆ–è€…è¯´ bit æ•°ç»„ã€‚å®ƒæœ‰å¤šç§å“ˆå¸Œå‡½æ•°ã€‚</p>\n<p>å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡</p>\n<p><strong>å¸ƒéš†è¿‡æ»¤å™¨è¯´æŸä¸ªå…ƒç´ å­˜åœ¨ï¼Œå°æ¦‚ç‡ä¼šè¯¯åˆ¤ã€‚å¸ƒéš†è¿‡æ»¤å™¨è¯´æŸä¸ªå…ƒç´ ä¸åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ â¼€å®šä¸åœ¨ã€‚</strong></p>\n<h2 id=\"ç¼“å­˜å‡»ç©¿\"><a class=\"anchor\" href=\"#ç¼“å­˜å‡»ç©¿\">#</a> ç¼“å­˜å‡»ç©¿</h2>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿\">#</a> ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿</h3>\n<p>ğŸ‘€ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ç¼“å­˜ä¸­çš„æŸä¸ª key çªç„¶å¤±æ•ˆï¼ˆä¸€èˆ¬æ˜¯ç¼“å­˜æ—¶é—´åˆ°æœŸï¼‰ï¼Œä½†æ˜¯è¿™æ˜¯çš„è¯·æ±‚ç‰¹åˆ«å¤šï¼Œç›´æ¥è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çš„å‹åŠ›ç¬é—´å¤§å¢ã€‚</p>\n<h3 id=\"ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•\"><a class=\"anchor\" href=\"#ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•\">#</a> ç¼“å­˜å‡»ç©¿çš„è§£å†³åŠæ³•</h3>\n<ol>\n<li>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</li>\n<li>åŠ äº’æ–¥é”</li>\n</ol>\n<h2 id=\"ç¼“å­˜é›ªå´©\"><a class=\"anchor\" href=\"#ç¼“å­˜é›ªå´©\">#</a> ç¼“å­˜é›ªå´©</h2>\n<h3 id=\"ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©\">#</a> ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©</h3>\n<p>ğŸ‘€ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­çš„æ•°æ®åœ¨åŒä¸€æ—¶é—´å†…å¤§é¢ç§¯å¤±æ•ˆï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚è½åœ¨æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—å¤§é‡è¯·æ±‚ï¼Œå¦‚é›ªå´©ä¸€èˆ¬ï¼Œç»™æ•°æ®é€ æˆè¶…å¤§çš„å‹åŠ›ï¼Œå¯èƒ½å¯¼è‡´å®•æœºã€‚</p>\n<p>ä¸¾ä¸ªä¾‹â¼¦ ï¼šç§’æ€å¼€å§‹ 12 ä¸ªâ¼©æ—¶ä¹‹å‰ï¼Œæˆ‘ä»¬ç»Ÿâ¼€å­˜æ”¾äº†â¼€æ‰¹å•†å“åˆ° Redis ä¸­ï¼Œè®¾ç½®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ä¹Ÿæ˜¯ 12 ä¸ªâ¼©æ—¶ï¼Œé‚£ä¹ˆç§’æ€å¼€å§‹çš„æ—¶å€™ï¼Œè¿™äº›ç§’æ€çš„å•†å“çš„è®¿é—®ç›´æ¥å°±å¤±æ•ˆäº†ã€‚å¯¼è‡´çš„æƒ…å†µå°±æ˜¯ï¼Œç›¸åº”çš„è¯·æ±‚ç›´æ¥å°±è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå°±åƒé›ªå´©â¼€æ ·å¯æ€•ã€‚</p>\n<h3 id=\"ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•\"><a class=\"anchor\" href=\"#ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•\">#</a> ç¼“å­˜é›ªå´©çš„è§£å†³åŠæ³•</h3>\n<ol>\n<li>ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚</li>\n<li>å¦‚æœç¼“å­˜æ•°æ®åº“æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²ï¼ŒRedis é›†ç¾¤ï¼Œå°†çƒ­ç‚¹æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒæå¾—ç¼“å­˜æ•°æ®åº“ä¸­ã€‚</li>\n<li>è®¾ç½®çƒ­ç‚¹æ•°æ®ç¼“å­˜æ°¸è¿œä¸è¿‡æœŸã€‚</li>\n</ol>\n<h3 id=\"å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§\"><a class=\"anchor\" href=\"#å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§\">#</a> å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§</h3>\n<p>â­æœ€ç®€å•çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨æ›´æ–°æ•°æ®åº“æ—¶ï¼Œæ›´æ–°æˆåŠŸåç›´æ¥åˆ æ‰ç¼“å­˜ã€‚å³ <strong>Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰</strong></p>\n<p>å¦‚æœæ•°æ®åº“åˆ é™¤å¤±è´¥çš„ï¼Œå¯ä»¥å¢åŠ é‡è¯•æœºåˆ¶æˆ–è€…å°†ç¼“å­˜æ—¶é—´ç¼©çŸ­ã€‚</p>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "é¢è¯•",
                "Redis"
            ]
        },
        {
            "id": "https://shaogezhu.cn/2021/9/b35e5850bf12/",
            "url": "https://shaogezhu.cn/2021/9/b35e5850bf12/",
            "title": "ç½‘ç«™å‹åŠ›æµ‹è¯•å·¥å…·ä¹‹ab (ApacheBench) å’Œ Jmeter è¯¦è§£",
            "date_published": "2021-09-03T12:46:25.000Z",
            "content_html": "<div class=\"note info\">\n<p>æˆ‘ä»¬å†™é¡¹ç›®çš„æ—¶å€™ç»å¸¸éœ€è¦æµ‹è¯•ï¼Œä¸ä»…éœ€è¦åŠŸèƒ½æµ‹è¯•è¿˜éœ€è¦å‹åŠ›æµ‹è¯•ã€‚æ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹å¤§å®¶ç»å¸¸ä½¿ç”¨çš„æµ‹è¯•å·¥å…·ã€‚åœ¨å­¦ä¹  DDoS çŸ¥è¯†çš„è¿‡ç¨‹ä¸­ï¼Œäº†è§£åˆ° ab è¿™ä¸ªæµ‹å‹å·¥å…·ï¼Œä¹‹å‰åœ¨å…¶ä»–åšå®¢ä¸Šä¹Ÿäº†è§£åˆ° jmeter çš„æµ‹å‹å·¥å…·ã€‚è¿™ä¸¤æ¬¾è½¯ä»¶éƒ½æ˜¯ Apache çš„å¼€æºé¡¹ç›®ï¼Œä¹Ÿæ˜¯ç›®å‰å¸¸ç”¨çš„ç½‘ç«™æµ‹å‹å·¥å…·ã€‚</p>\n</div>\n<h2 id=\"abå’Œjmeterçš„åŒºåˆ«\"><a class=\"anchor\" href=\"#abå’Œjmeterçš„åŒºåˆ«\">#</a> ab å’Œ jmeter çš„åŒºåˆ«</h2>\n<p><strong>1. jmeter æ˜¯ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚å’Œè¿”å›ï¼›AB åªæ˜¯å‘å‡ºå»è¯·æ±‚<br />\n 2. ab æ˜¯ shell æ¨¡å¼ä¸‹è½»é‡çº§çš„æµ‹è¯•å·¥å…·ï¼Œjmeter åˆ™ä½œä¸ºæœ‰ GUI ç•Œé¢çš„æ›´é«˜çº§æµ‹è¯•å·¥å…·<br />\n 3. jmeter å¯ä»¥æä¾›æ›´åŠ è¯¦ç»†çš„ç»Ÿè®¡ç»“æœæ•°æ®ï¼Œæ¯”å¦‚æ¥å£é”™è¯¯ä¿¡æ¯ã€å•çº¿ç¨‹çš„è¯·æ±‚æ—¶é—´ç­‰ï¼Œè€Œ AB åˆ™ä¸æ”¯æŒ<br />\n 4. ab æ›´åŠ è½»é‡çº§ï¼Œè½¯ä»¶æ¶ˆè€—çš„èµ„æºå°‘ï¼Œä¸ä¼šå ç”¨å¤ªå¤šå†…å­˜å’Œ cpuï¼Œè€Œ jmeter æ¶ˆè€—èµ„æºæ¯”è¾ƒå¤š<br />\n 5. Jmeter å¯ä»¥åŠ¨æ€æŸ¥çœ‹ç»“æœï¼Œè€Œ ab ä¸å¯ä»¥ï¼Œåªæœ‰æ‰§è¡Œå®Œæ‰å‡ºç»“æœï¼ŒåŒæ—¶ Jmeter çš„ç»“æœæ›´åŠ å‡†ç¡®</strong></p>\n<h2 id=\"abå¦‚ä½•ä½¿ç”¨\"><a class=\"anchor\" href=\"#abå¦‚ä½•ä½¿ç”¨\">#</a> ab å¦‚ä½•ä½¿ç”¨</h2>\n<p>ab æ˜¯ httpdï¼ˆä¹Ÿå« apacheï¼‰æºå¸¦çš„è½»é‡çº§æµ‹å‹å·¥å…·ï¼Œæˆ‘ä»¬è¦ä» apache çš„å®˜ç½‘ä¸Šä¸‹è½½ httpd</p>\n<h3 id=\"ä¸‹è½½httpdapache\"><a class=\"anchor\" href=\"#ä¸‹è½½httpdapache\">#</a> ä¸‹è½½ httpdï¼ˆapacheï¼‰ğŸ«</h3>\n<blockquote>\n<p>linux ç‰ˆæœ¬ä¸‹è½½æ¯”è¾ƒå®¹æ˜“ï¼Œä»¥ windows ç‰ˆæœ¬ï¼Œapache 2.4 ä¸ºä¾‹ã€‚</p>\n</blockquote>\n<p>å®˜ç½‘ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9odHRwZC5hcGFjaGUub3JnLw==\">https://httpd.apache.org/</span></p>\n<p><img data-src=\"/assets/2021-9/ab1.jpg\" alt=\"image.png\" /><br />\n ç‚¹å‡» download</p>\n<p><img data-src=\"/assets/2021-9/ab2.jpg\" alt=\"image.png\" /></p>\n<p>æ­¤å¤„éšä¾¿é€‰ä¸€ä¸ªæä¾›å•†ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab3.jpg\" alt=\"image.png\" /></p>\n<p>é€‰æ‹©ç‰ˆæœ¬ä¸‹è½½</p>\n<p><img data-src=\"/assets/2021-9/ab4.jpg\" alt=\"image.png\" /></p>\n<p>ä¸‹è½½å®Œä¹‹åè§£å‹</p>\n<h3 id=\"ä½¿ç”¨abå’Œabs\"><a class=\"anchor\" href=\"#ä½¿ç”¨abå’Œabs\">#</a> ä½¿ç”¨ ab å’Œ abs</h3>\n<p>è§£å‹åï¼Œåœ¨ bin ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå°å·¥å…· ab.exe å’Œ abs.exe ï¼Œåˆ†åˆ«ç”¨äº http å’Œ httpsã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab5.jpg\" alt=\"image.png\" /></p>\n<p>ä¹‹åå¯ä»¥æ‰“å¼€ cmd æˆ–è€… shellï¼Œç›´æ¥ä½¿ç”¨ ab å’Œ abs å·¥å…·</p>\n<p>ä½¿ç”¨ ab -help åˆ—å‡ºäº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„å‚æ•°</p>\n<p><img data-src=\"/assets/2021-9/ab6.jpg\" alt=\"image.png\" /></p>\n<p>æˆ‘ä»¬æœ€å¸¸ç”¨çš„æŒ‡ä»¤æ˜¯ ab -n 100 -c 10 <span class=\"exturl\" data-url=\"aHR0cDovL3Rlc3QuY29tLw==\">http://test.com/</span> å…¶ä¸­ï¼n è¡¨ç¤ºè¯·æ±‚æ€»æ•°ï¼Œï¼c è¡¨ç¤ºå¹¶å‘æ•°</p>\n<p>å¯¹äº https åè®® ä½¿ç”¨ abs -n 100 -c 10 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZXN0LmNvbS8=\">https://test.com/</span></p>\n<p>ä»¥å¯¹æˆ‘çš„ç½‘ç«™è¿›è¡Œæµ‹å‹ä¸ºä¾‹ï¼ˆåˆ«ä¹±ç”¨å•Šï¼‰ï¼š</p>\n<p>æ­£åœ¨æµ‹å‹ï¼š</p>\n<p><img data-src=\"/assets/2021-9/ab7.jpg\" alt=\"image.png\" /><br />\n è¿”å›çš„ç»“æœï¼š</p>\n<p><img data-src=\"/assets/2021-9/ab8.jpg\" alt=\"image.png\" /><br />\n æµ‹è¯•ç»“æœï¼š</p>\n<blockquote>\n<p><strong>Server Software:</strong> nginx/1.21.1 #è¢«æµ‹è¯•çš„ Web æœåŠ¡å™¨è½¯ä»¶åç§°ã€‚<br />\n<strong>Server Hostname:</strong> <a href=\"http://shaogezhu.cn/\">shaogezhu.cn/</a> #è¯·æ±‚çš„ URL ä¸»æœºåã€‚<br />\n<strong>Server Port:</strong> 443 #è¢«æµ‹è¯•çš„ Web æœåŠ¡å™¨è½¯ä»¶çš„ç›‘å¬ç«¯å£ã€‚<br />\n<strong>SSL/TLS Protocol:</strong> TLSv1.2,ECDHE-RSA-AES256-GCM-SHA384,2048,256 Server Temp Key: X25519 253 bits TLS</p>\n<p><strong>Server Name:</strong> <a href=\"http://shaogezhu.cn\">shaogezhu.cn</a><br />\n<strong>Document Path:</strong> / #è¯·æ±‚çš„ URL ä¸­çš„æ ¹ç»å¯¹è·¯å¾„ï¼Œé€šè¿‡è¯¥æ–‡ä»¶çš„åç¼€åï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥äº†è§£è¯¥è¯·æ±‚çš„ç±»å‹ã€‚</p>\n<p><strong>Document Length:</strong> 1270 bytes #è¡¨ç¤º HTTP å“åº”æ•°æ®çš„æ­£æ–‡é•¿åº¦ã€‚<br />\n<strong>Concurrency Level:</strong> 10 #å¹¶å‘ç”¨æˆ·æ•°ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¾ç½®çš„å‚æ•°ä¹‹ä¸€ã€‚<br />\n<strong>Time taken for tests:</strong> 27.378 seconds #æ‰€æœ‰è¿™äº›è¯·æ±‚è¢«å¤„ç†å®Œæˆæ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚</p>\n<p><strong>Complete requests:</strong> 100 #æ€»è¯·æ±‚æ•°é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¾ç½®çš„å‚æ•°ä¹‹ä¸€ã€‚ Failed requests: 1 #å¤±è´¥çš„è¯·æ±‚æ•°é‡ï¼Œ (Connect: 1, Receive: 0, Length: 0, Exceptions: 0) Total transferred: 150400 bytes # æ‰€æœ‰è¯·æ±‚çš„å“åº”æ•°æ®é•¿åº¦æ€»å’Œï¼ŒåŒ…æ‹¬æ¯ä¸ª HTTP å“åº”æ•°æ®çš„å¤´ä¿¡æ¯å’Œæ­£æ–‡æ•°æ®çš„é•¿åº¦ã€‚æ³¨æ„è¿™é‡Œä¸åŒ…æ‹¬ HTTP è¯·æ±‚æ•°æ®çš„é•¿åº¦ï¼Œä»…ä»…ä¸º web æœåŠ¡å™¨æµå‘ç”¨æˆ· PC çš„åº”ç”¨å±‚æ•°æ®æ€»é•¿åº¦ HTML transferred: 127000 bytes #è¡¨ç¤ºæ‰€æœ‰è¯·æ±‚çš„å“åº”æ•°æ®ä¸­æ­£æ–‡æ•°æ®çš„æ€»å’Œï¼Œä¹Ÿå°±æ˜¯å‡å»äº† Total transferred ä¸­ HTTP å“åº”æ•°æ®ä¸­çš„å¤´ä¿¡æ¯çš„é•¿åº¦ã€‚</p>\n<p><strong>Requests per second:</strong> 3.65 [#/sec] (mean) #æ¯ç§’å¤šå°‘è¯·æ±‚</p>\n<p><strong>Time per request:</strong> 2737.802 [ms] (mean) #ç”¨æˆ·å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´</p>\n<p><strong>Time per request:</strong> 273.780 [ms] (mean, across all concurrent requests) #æœåŠ¡å™¨å¹³å‡å¤„ç†æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨ååé‡çš„å€’æ•° Transfer rate: 5.36 [Kbytes/sec] received #è¡¨ç¤ºè¿™äº›è¯·æ±‚åœ¨å•ä½æ—¶é—´å†…ä»æœåŠ¡å™¨è·å–çš„æ•°æ®é•¿åº¦</p>\n<p><strong>Percentage of the requests served within a certain time (ms)</strong> #è¿™éƒ¨åˆ†æ•°æ®ç”¨äºæè¿°æ¯ä¸ªè¯·æ±‚å¤„ç†æ—¶é—´çš„åˆ†å¸ƒæƒ…å†µ 50% 584 66% 600 75% 624 80% 669 90% 862 95% 21606 98% 21623 99% 21626 100% 21626 (longest request)</p>\n</blockquote>\n<p><strong>æœ€é‡è¦çš„ä¸‰ä¸ªå‚æ•°ï¼š</strong> â­</p>\n<blockquote>\n<p><strong>Requests per secondï¼šååç‡ ï¼ŒæŒ‡çš„æ˜¯æŸä¸ªå¹¶å‘ç”¨æˆ·æ•°ä¸‹å•ä½æ—¶é—´å†…å¤„ç†çš„è¯·æ±‚æ•°</strong></p>\n<p><strong>Time per requestï¼šä¸Šé¢çš„æ˜¯ç”¨æˆ·å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´</strong></p>\n<p><strong>Time per requestï¼šä¸‹é¢çš„æ˜¯æœåŠ¡å™¨å¹³å‡è¯·æ±‚å¤„ç†æ—¶é—´ æ˜¯ååç‡çš„å€’æ•°</strong></p>\n</blockquote>\n<h2 id=\"ä½¿ç”¨jmeter\"><a class=\"anchor\" href=\"#ä½¿ç”¨jmeter\">#</a> ä½¿ç”¨ jmeter</h2>\n<p>JMeter æ˜¯ Apache ç»„ç»‡å¼€å‘çš„åŸºäº Java çš„å‹åŠ›æµ‹è¯•å·¥å…·ã€‚ç”¨äºå¯¹è½¯ä»¶åšå‹åŠ›æµ‹è¯•ï¼Œå®ƒæœ€åˆè¢«è®¾è®¡ç”¨äº Web åº”ç”¨æµ‹è¯•ï¼Œä½†åæ¥æ‰©å±•åˆ°å…¶ä»–æµ‹è¯•é¢†åŸŸã€‚ å®ƒå¯ä»¥ç”¨äºæµ‹è¯•é™æ€å’ŒåŠ¨æ€èµ„æºï¼Œä¾‹å¦‚é™æ€æ–‡ä»¶ã€Java å°æœåŠ¡ç¨‹åºã€CGI è„šæœ¬ã€Java å¯¹è±¡ã€æ•°æ®åº“ã€FTP æœåŠ¡å™¨ï¼Œ ç­‰ç­‰ã€‚JMeter è¿˜æ”¯æŒé€šè¿‡åˆ›å»ºå¸¦æœ‰æ–­è¨€çš„è„šæœ¬æ¥éªŒè¯ä½ çš„ç¨‹åºè¿”å›äº†ä½ æœŸæœ›çš„ç»“æœã€‚</p>\n<p>æ¨èä¸€ä¸ª jmeter çš„ä½¿ç”¨æ•™ç¨‹ï¼š<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5qbWV0ZXIuY29tLmNuL2NhdGVnb3J5L2ptZXRlci1ib29r\">http://www.jmeter.com.cn/category/jmeter-book</span></p>\n<h3 id=\"ä¸‹è½½\"><a class=\"anchor\" href=\"#ä¸‹è½½\">#</a> ä¸‹è½½</h3>\n<p>å› ä¸ºå®ƒæ˜¯åŸºäº java çš„ï¼Œä¸‹è½½å‰è¯·ç¡®ä¿ä½ æœ‰ jdkï¼ˆ8 ä»¥ä¸Šï¼‰çš„ç¯å¢ƒã€‚</p>\n<p><strong>ä¸‹è½½åœ°å€ï¼š<span class=\"exturl\" data-url=\"aHR0cDovL2ptZXRlci5hcGFjaGUub3JnL2Rvd25sb2FkX2ptZXRlci5jZ2k=\">http://jmeter.apache.org/download_jmeter.cgi</span></strong></p>\n<p>é€‰æ‹©å³ä¾§éœ€è¦ä¸‹è½½çš„å‹ç¼©åŒ…ç‰ˆæœ¬ï¼ˆæˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯ apache-jmeter-5.4.1.zipï¼‰ï¼Œä¸‹è½½å®Œæˆåè§£å‹å³å¯ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab9.jpg\" alt=\"image.png\" /></p>\n<h3 id=\"å¯åŠ¨\"><a class=\"anchor\" href=\"#å¯åŠ¨\">#</a> å¯åŠ¨</h3>\n<p>ğŸˆæˆ‘ä»¬åœ¨è§£å‹åçš„ bin ç›®å½•ä¸‹æ‰¾åˆ° jmeter.bat çš„æ‰¹å¤„ç†è„šæœ¬ï¼Œåªè¦æœ‰ jdk8 çš„ç³»ç»Ÿç¯å¢ƒï¼Œç‚¹å‡»å³å¯å¯åŠ¨ï¼Œå‡ºç°ä¸€ä¸ª cmd çª—å£å’Œ Jmeter çš„ GUI ç•Œé¢ï¼ˆåŸºäº Swingï¼‰ï¼Œæ³¨æ„ä¸è¦å…³é—­ cmd çª—å£ï¼Œä¸ç„¶ GUI çª—å£ä¹Ÿä¼šå…³é—­ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab10.jpg\" alt=\"image.png\" /><br />\n ä¹Ÿå¯ä»¥æŠŠ Jmeter æ”¾å…¥ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼Œå‘½ä»¤è¡Œä¸­è¾“å…¥ Jmeter å³å¯å¯åŠ¨ã€‚æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ä¸å¤šï¼Œå°±ä¸åšè®²è§£ï¼Œå¦‚æœæƒ³è¦äº†è§£è¯¦æƒ…ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢æä¾›çš„è¿æ¥ä¸­çš„ä½¿ç”¨æ•™ç¨‹ã€‚</p>\n<h3 id=\"ä½¿ç”¨\"><a class=\"anchor\" href=\"#ä½¿ç”¨\">#</a> ä½¿ç”¨</h3>\n<p>1. å³å‡»å·¦è¾¹çš„ Test Plan æ·»åŠ ä¸€ä¸ªçº¿ç¨‹ç»„ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab11.jpg\" alt=\"image.png\" /><br />\n åœ¨è¿™ä¸ªçº¿ç¨‹ç»„ä¸‹è¿™ä¸ªçº¿ç¨‹ç»„çš„çº¿ç¨‹æ•°ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ç”¨æˆ·æ•°ï¼Œå¾ªç¯æ¬¡æ•°æ¯ä¸ªå¹¶å‘ç”¨æˆ·çš„è¯·æ±‚æ•°ã€‚</p>\n<p>å‚æ•° ramp-up period ç”¨äºå‘ŠçŸ¥ JMeter è¦åœ¨å¤šé•¿æ—¶é—´å†…å»ºç«‹å…¨éƒ¨çš„çº¿ç¨‹ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚å‡å¦‚è¯´ ramp-up period ä¸ºé›¶ï¼Œ JMeter å°†ç«‹å³å»ºç«‹æ‰€æœ‰çº¿ç¨‹ï¼Œå¹¶å‘è®¿é—®ï¼Œå‡è®¾ ramp-up period è®¾ç½®æˆ T ç§’ï¼Œ å…¨éƒ¨çº¿ç¨‹æ•°è®¾ç½®æˆ N ä¸ªï¼Œ JMeter å°†æ¯éš” T/N ç§’å»ºç«‹ä¸€ä¸ªçº¿ç¨‹</p>\n<p>ğŸ‘‰ğŸ» Loop Count æ˜¯å¾ªç¯æ¬¡æ•°ï¼Œ<strong>è¯·æ±‚æ€»æ•°é‡ = çº¿ç¨‹æ•° * å¾ªç¯æ¬¡æ•°</strong>ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab12.jpg\" alt=\"image.png\" /></p>\n<p>2. åœ¨è¿™ä¸ªçº¿ç¨‹ç»„ä¸‹å³é”®åœ¨ samplerï¼ˆå–æ ·å™¨ï¼‰é‡Œé¢é€‰æ‹© http è¯·æ±‚ï¼Œåˆ›å»º http è¯·æ±‚ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab13.jpg\" alt=\"image.png\" /><br />\n å¯ä»¥è®¾ç½® http è¯·æ±‚çš„åè®®ï¼Œå‚æ•°ï¼Œè·¯å¾„ç­‰ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab14.jpg\" alt=\"image.png\" /><br />\n3. åœ¨ HTTP è¯·æ±‚å³é”®é‡Œé¢é€‰æ‹©ç›‘å¬å™¨ä¸‹çš„èšåˆæŠ¥å‘Šï¼Œåˆ›å»ºä¸€ä¸ªèšåˆæŠ¥å‘Šï¼Œå¯ä»¥æŸ¥çœ‹è¿™æ¬¡æµ‹è¯•çš„ç»“æœã€‚</p>\n<p>ä¹Ÿå¯ä»¥æ·»åŠ ç»“æœæ ‘ã€‚</p>\n<p><img data-src=\"/assets/2021-9/ab15.jpg\" alt=\"image.png\" /><br />\n4. ç‚¹å‡»å¯åŠ¨çš„å›¾æ ‡ï¼Œä¹‹åå†èšåˆæŠ¥å‘Šå’Œè§†å›¾ç»“æœæ ‘ä¸­æŸ¥çœ‹æœ¬æ¬¡æµ‹è¯•çš„ç»“æœã€‚</p>\n<p>èšåˆæŠ¥å‘Šå¯ä»¥æŸ¥çœ‹ç»Ÿè®¡æ•°æ®ï¼š</p>\n<p><img data-src=\"/assets/2021-9/ab16.jpg\" alt=\"image.png\" /></p>\n<p>æ•°æ®å«ä¹‰ï¼š</p>\n<blockquote>\n<p><strong>Labelï¼š</strong> æ¯ä¸ª JMeter çš„ elementï¼ˆä¾‹å¦‚ HTTP Requestï¼‰éƒ½æœ‰ä¸€ä¸ª Name å±æ€§ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„å°±æ˜¯ Name å±æ€§çš„å€¼</p>\n<p><strong>Samplesï¼š</strong> è¡¨ç¤ºä½ è¿™æ¬¡æµ‹è¯•ä¸­ä¸€å…±å‘å‡ºäº†å¤šå°‘ä¸ªè¯·æ±‚ï¼Œå¦‚æœæ¨¡æ‹Ÿ 10 ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·è¿­ä»£ 10 æ¬¡ï¼Œé‚£ä¹ˆè¿™é‡Œæ˜¾ç¤º 100</p>\n<p><strong>Averageï¼š</strong> å¹³å‡å“åº”æ—¶é—´ â€”â€” é»˜è®¤æƒ…å†µä¸‹æ˜¯å•ä¸ª Request çš„å¹³å‡å“åº”æ—¶é—´</p>\n<p><strong>Medianï¼š</strong>  ä¸­ä½æ•°ï¼Œä¹Ÿå°±æ˜¯ 50 ï¼…ç”¨æˆ·çš„å“åº”æ—¶é—´</p>\n<p><strong>90% Lineï¼š</strong>   90 ï¼…ç”¨æˆ·çš„å“åº”æ—¶é—´</p>\n<p><strong>Minï¼š</strong> æœ€å°å“åº”æ—¶é—´</p>\n<p><strong>Maxï¼š</strong>  æœ€å¤§å“åº”æ—¶é—´</p>\n<p><strong>Error%ï¼š</strong> æœ¬æ¬¡æµ‹è¯•ä¸­å‡ºç°é”™è¯¯çš„è¯·æ±‚çš„æ•°é‡ / è¯·æ±‚çš„æ€»æ•°</p>\n<p><strong>Throughputï¼š</strong> ååé‡ â€”â€” é»˜è®¤æƒ…å†µä¸‹è¡¨ç¤ºæ¯ç§’å®Œæˆçš„è¯·æ±‚æ•°</p>\n<p><strong>KB/Secï¼š</strong> æ¯ç§’ä»æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°çš„æ•°æ®é‡</p>\n</blockquote>\n<p>ç»“æœæ ‘å¯ä»¥æŸ¥çœ‹æ¯ä¸€ä¸ªè¯·æ±‚å’Œè¯·æ±‚è¿”å›çš„ç»“æœï¼š</p>\n<p><img data-src=\"/assets/2021-9/ab17.jpg\" alt=\"image.png\" /></p>\n<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè™½ç„¶è®¾ç½®ä¸ºäº† https å’Œ 443 ç«¯å£ï¼Œä½†æ˜¯ Jmeter è¿˜æ˜¯èµ°äº† httpï¼Œè€Œè¦è®© Jmeter ä½¿ç”¨ Https åè®®ï¼Œéœ€è¦æˆ‘ä»¬å¯¼å…¥ Https è¯ä¹¦ï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰å½•åˆ¶ Https å’Œæ‰‹åŠ¨é…ç½®è¯ä¹¦ä¸¤ç§åŠæ³•ã€‚</p>\n<p>å½•åˆ¶ httpsï¼š</p>\n<p>è¿™ç§æ–¹å¼ Jmeter ä¼šä»£ç†æµè§ˆå™¨çš„è¯·æ±‚å’Œå“åº”ã€‚</p>\n<p>æ‰‹åŠ¨é…ç½®è¯ä¹¦ï¼š</p>\n<p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è¿™ç§åŠæ³•ã€‚</p>\n<p>1ï¼‰ä¸‹è½½è¢«æµ‹ç½‘ç«™è¯ä¹¦å¯¼å…¥ Jmeter</p>\n<p><img data-src=\"/assets/2021-9/ab18.jpg\" alt=\"image.png\" /><br />\n<img data-src=\"/assets/2021-9/ab19.jpg\" alt=\"image.png\" /><br />\n ä½¿ç”¨ jdk è‡ªå¸¦çš„å·¥å…· keytool å°† cer æ ¼å¼çš„è¯ä¹¦è½¬æ¢ä¸º store æ ¼å¼</p>\n<p>å‘½ä»¤å¦‚ä¸‹ keytool -import -alias &quot;test.store&quot; -file &quot;my.cer&quot; -keystore test.store ä¸­é—´ä¼šè¦æ±‚è®¾ç½®å£ä»¤</p>\n<p><img data-src=\"/assets/2021-9/ab20.jpg\" alt=\"image.png\" /><br />\n å† Jmeter ä¸­é€‰æ‹© SSL Manager å¯¼å…¥è¯ä¹¦</p>\n<p><img data-src=\"/assets/2021-9/ab21.jpg\" alt=\"image.png\" /><br />\n2) ä¹‹åå³å¯ä½¿ç”¨ https åè®®</p>\n<h2 id=\"æœ€å\"><a class=\"anchor\" href=\"#æœ€å\">#</a> æœ€å</h2>\n<p>è¡¥å…… ab å·¥å…·çš„æ‰€æœ‰å‚æ•°è§£é‡ŠğŸš€ğŸš€ğŸš€</p>\n<blockquote>\n<p>-n æµ‹è¯•ä¼šè¯ä¸­æ‰€æ‰§è¡Œçš„è¯·æ±‚ä¸ªæ•°ï¼Œé»˜è®¤ä»…æ‰§è¡Œä¸€ä¸ªè¯·æ±‚<br />\n - c ä¸€æ¬¡äº§ç”Ÿçš„è¯·æ±‚ä¸ªæ•°ï¼Œå³åŒä¸€æ—¶é—´å‘å‡ºå¤šå°‘ä¸ªè¯·æ±‚ï¼Œé»˜è®¤ä¸ºä¸€æ¬¡ä¸€ä¸ª<br />\n - t æµ‹è¯•æ‰€è¿›è¡Œçš„æœ€å¤§ç§’æ•°ï¼Œé»˜è®¤ä¸ºæ— æ—¶é—´é™åˆ¶.... å…¶å†…éƒ¨éšå«å€¼æ˜¯ [-n 50000], å®ƒå¯ä»¥ä½¿å¯¹æœåŠ¡å™¨çš„æµ‹è¯•é™åˆ¶åœ¨ä¸€ä¸ªå›ºå®šçš„æ€»æ—¶é—´ä»¥å†…<br />\n - p åŒ…å«äº†éœ€è¦ POST çš„æ•°æ®çš„æ–‡ä»¶<br />\n - T POST æ•°æ®æ‰€ä½¿ç”¨çš„ Content-type å¤´ä¿¡æ¯<br />\n - v è®¾ç½®æ˜¾ç¤ºä¿¡æ¯çš„è¯¦ç»†ç¨‹åº¦<br />\n - w ä»¥ HTML è¡¨æ ¼çš„å½¢å¼è¾“å‡ºç»“æœï¼Œé»˜è®¤æ˜¯ç™½è‰²èƒŒæ™¯çš„ä¸¤åˆ—å®½åº¦çš„ä¸€å¼ è¡¨<br />\n - i ä»¥ HTML è¡¨æ ¼çš„å½¢å¼è¾“å‡ºç»“æœï¼Œé»˜è®¤æ˜¯ç™½è‰²èƒŒæ™¯çš„ä¸¤åˆ—å®½åº¦çš„ä¸€å¼ è¡¨<br />\n - C å¯¹è¯·æ±‚é™„åŠ ä¸€ä¸ª Cookie è¡Œï¼Œå…¶å…¸å‹å½¢å¼æ˜¯ name=value çš„å‚æ•°å¯¹ï¼Œæ­¤å‚æ•°å¯ä»¥é‡å¤<br />\n - H å¯¹è¯·æ±‚é™„åŠ é¢å¤–çš„å¤´ä¿¡æ¯ï¼Œæ­¤å‚æ•°çš„å…¸å‹å½¢å¼æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å¤´ä¿¡æ¯è¡Œï¼Œå…¶ä¸­åŒ…å«äº†ä»¥å†’å·åˆ†éš”çš„å­—æ®µå’Œå€¼çš„å¯¹ (å¦‚ &quot;Accept-Encoding: zip/zop;8bit&quot;)<br />\n-A HTTP éªŒè¯ï¼Œç”¨å†’å·ï¼šåˆ†éš”ä¼ é€’ç”¨æˆ·ååŠå¯†ç <br />\n - P æ— è®ºæœåŠ¡å™¨æ˜¯å¦éœ€è¦ (å³æ˜¯å¦å‘é€äº† 401 è®¤è¯éœ€æ±‚ä»£ç ), æ­¤å­—ç¬¦ä¸²éƒ½ä¼šè¢«å‘é€<br />\n - X å¯¹è¯·æ±‚ä½¿ç”¨ä»£ç†æœåŠ¡å™¨<br />\n - V æ˜¾ç¤ºç‰ˆæœ¬å·å¹¶é€€å‡º<br />\n - k å¯ç”¨ HTTP KeepAlive åŠŸèƒ½ï¼Œå³åœ¨ä¸€ä¸ª HTTP ä¼šè¯ä¸­æ‰§è¡Œå¤šä¸ªè¯·æ±‚ï¼Œé»˜è®¤ä¸ºä¸å¯ç”¨ KeepAlive åŠŸèƒ½<br />\n - d ä¸æ˜¾ç¤º &quot;percentage served within XX [ms] table&quot; çš„æ¶ˆæ¯ (ä¸ºä»¥å‰çš„ç‰ˆæœ¬æä¾›æ”¯æŒ)<br />\n-S ä¸æ˜¾ç¤ºä¸­å€¼å’Œæ ‡å‡†èƒŒç¦»å€¼ï¼Œä¸”å‡å€¼å’Œä¸­å€¼ä¸ºæ ‡å‡†èƒŒç¦»å€¼çš„ 1 åˆ° 2 å€æ—¶ï¼Œä¹Ÿä¸æ˜¾ç¤ºè­¦å‘Šæˆ–å‡ºé”™ä¿¡æ¯ï¼Œé»˜è®¤ä¼šæ˜¾ç¤ºæœ€å°å€¼ / å‡å€¼ / æœ€å¤§å€¼ç­‰ (ä¸ºä»¥å‰çš„ç‰ˆæœ¬æä¾›æ”¯æŒ)<br />\n-g æŠŠæ‰€æœ‰æµ‹è¯•ç»“æœå†™å…¥ä¸€ä¸ª 'gnuplot' æˆ–è€… TSV (ä»¥ Tab åˆ†éš”çš„) æ–‡ä»¶<br />\n - e äº§ç”Ÿä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„ (CSV) æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¤„ç†æ¯ä¸ªç›¸åº”ç™¾åˆ†æ¯”çš„è¯·æ±‚æ‰€éœ€è¦ (ä» 1% åˆ° 100%) çš„ç›¸åº”ç™¾åˆ†æ¯”çš„ (ä»¥å¾®å¦™ä¸ºå•ä½) æ—¶é—´ -h æ˜¾ç¤ºä½¿ç”¨æ–¹æ³•<br />\n - k å‘é€ keep-alive æŒ‡ä»¤åˆ°æœåŠ¡å™¨ç«¯</p>\n</blockquote>\n",
            "tags": [
                "Java",
                "å­¦ä¹ ç¬”è®°",
                "java",
                "æ•™ç¨‹",
                "å‹æµ‹",
                "å·¥å…·"
            ]
        }
    ]
}